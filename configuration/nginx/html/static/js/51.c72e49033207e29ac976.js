webpackJsonp([51],{Vib8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("mvHQ"),s=a.n(n),i=(a("s0MJ"),a("PO8r")),r=a("nQqC"),o=a("c2Ch"),l=a("c+aE"),c={components:{Menu:i.a,basecard:r.a,System:l.a},Systemname:"WorkOrder",data:function(){return{pickerOptions:{shortcuts:[{text:this.$t("terminal.pickeroptions4"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.setHours(0,0,0,0)),t.$emit("pick",[a,e])}},{text:this.$t("terminal.pickeroptions5"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.setHours(0,0,0,0)-1728e5),t.$emit("pick",[a,e])}},{text:this.$t("terminal.pickeroptions6"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.setHours(0,0,0,0)-5184e5),t.$emit("pick",[a,e])}}]},i8n:this.$store.state.i18n,tasktime:[],tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,delprio:this.$store.state.userInfo.delprio,contrForPrionum:this.$store.state.userInfo.prionum,tableData:[],logData:[],pageCount:20,searchList:{username:"",tenantid:"",superid:"",action:"",begintime:"",endtime:"",page:1,count:20},currentPage1:1,total:0,actionType:[{index:1,value:"Login"},{index:2,value:"Exit"},{index:3,value:"Add"},{index:4,value:"Update"},{index:5,value:"Delete"}],deleBtnDis:!1,deleId:"",del:!1,delData:[],multipleSelection:[]}},methods:{handleCurrentChange:function(t){this.searchList.page=t,this.searchList.count=this.pageCount,this.getSysLogs()},handleSizeChange:function(t){this.pageCount=t,this.searchList.count=t,this.searchList.page=1,this.currentPage1=1,this.getSysLogs()},datetimecut:function(t){if(!t)return"-";function e(t){return t>9?t:"0"+t}var a=new Date(t);return a.getFullYear()+"-"+e(a.getMonth()+1)+"-"+e(a.getDate())+" "+(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds())},formatDate:function(t,e){if(null==t.time||0==t.time)return"";var a=new Date(1e3*parseInt(t.time)).toUTCString();return this.datetimecut(a)},handleSelectionChange:function(t){this.multipleSelection=t},getSysLogs:function(){var t=this;Object(o._87)(t.searchList,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code&&(t.logData=e.data.list,t.total=e.data.size)})},searchInfo:function(){var t=this,e=this;this.tasktime&&this.tasktime.length>0?(this.searchList.begintime=Date.parse(new Date(e.tasktime[0]))/1e3,this.searchList.endtime=Date.parse(new Date(e.tasktime[1]))/1e3):(this.searchList.begintime="",this.searchList.endtime=""),this.searchList.page=1,this.currentPage1=1,Object(o._87)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(a){1001==a.code&&(e.logData=a.data.list,e.total=a.data.size,e.$message({message:e.$t("downlink.searchsuccess"),type:"success"})),t.searchList.count=20})},clearBtn:function(){1==this.$store.state.userInfo.prionum||2==this.$store.state.userInfo.prionum?this.searchList={username:"",tenantid:"",superid:"",action:"",begintime:"",endtime:"",page:1,count:20}:this.searchList={username:"",tenantid:"",superid:this.$store.state.userInfo.tenantid,action:"",begintime:"",endtime:"",page:1,count:20},this.tasktime=[],this.currentPage1=1,this.getSysLogs()},userDele:function(t){var e=this;5==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio||4==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio?this.$message({message:this.$t("warning.permissiondelete"),type:"warning"}):this.$confirm(this.$t("logmanagement.tet"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){e.deleId=e.logData[t].id,e.deleTrue()})},deleTrue:function(){var t=[];t.push(this.deleId);var e={ids:t},a=this;Object(o._0)(s()(e),this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){1001==t.code?(a.getSysLogs(),a.$message({message:a.$t("downlink.deletesuccess"),type:"success"})):a.$message({message:"zh"==a.$store.state.i18n?t.msg:t.enMsg,type:"error"})})},deleteLog:function(t){0!=this.multipleSelection.length?(this.delData=this.multipleSelection,this.del=!0):this.$message({message:this.$t("logmanagement.logrule2"),type:"warning"})},deleteTrue:function(){if(5==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio||4==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio)this.$message({message:this.$t("warning.permissiondelete"),type:"warning"});else{for(var t=this,e={ids:[]},a=0;a<this.delData.length;a++)e.ids.push(this.delData[a].id);Object(o._0)(s()(e),this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?(t.del=!1,t.getSysLogs(),t.$message({message:t.$t("downlink.deletesuccess"),type:"success"})):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}}},beforeMount:function(){1==this.$store.state.userInfo.prionum||2==this.$store.state.userInfo.prionum?this.searchList={username:"",tenantid:"",action:"",begintime:"",endtime:"",page:1,count:20}:this.searchList={username:"",tenantid:"",superid:this.$store.state.userInfo.tenantid,action:"",begintime:"",endtime:"",page:1,count:20},this.getSysLogs()},watch:{"$i18n.locale":function(){this.i8n=this.$store.state.i18n}}},m={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:5!=t.contrForPrionum?"home":"",staticStyle:{height:"100%"}},[n("div",{staticClass:"menu_header"},[n("Menu")],1),t._v(" "),n("div",{staticClass:"content"},[n("el-container",{staticClass:"asi"},[n("el-aside",[n("System")],1),t._v(" "),n("el-main",[n("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap"},attrs:{model:t.searchList}},[n("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("logmanagement.operator")}},[n("el-input",{staticStyle:{width:"95%",float:"left"},model:{value:t.searchList.username,callback:function(e){t.$set(t.searchList,"username",e)},expression:"searchList.username"}})],1),t._v(" "),n("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"1%","margin-right":"0"},attrs:{label:t.$t("logmanagement.operatype")}},[n("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("LocationIndoor.Pleaseenter")},model:{value:t.searchList.action,callback:function(e){t.$set(t.searchList,"action",e)},expression:"searchList.action"}},t._l(t.actionType,function(t){return n("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),n("el-form-item",{staticStyle:{display:"flex",width:"27%","margin-left":"1%","margin-right":"0"},attrs:{label:t.$t("logmanagement.chosetime")}},[n("el-date-picker",{staticStyle:{width:"95%",float:"left"},attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":t.$t("logmanagement.to"),"start-placeholder":t.$t("logmanagement.startdate"),"end-placeholder":t.$t("logmanagement.enddate"),align:"right"},model:{value:t.tasktime,callback:function(e){t.tasktime=e},expression:"tasktime"}})],1),t._v(" "),n("el-form-item",{staticStyle:{"margin-left":"2%"}},[n("el-button",{staticClass:"query",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("heartbeat.search")))]),t._v(" "),n("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("heartbeat.reset")))]),t._v(" "),n("el-button",{staticClass:"delLogs",attrs:{type:"primary"},on:{click:function(e){return t.deleteLog()}}},[t._v(t._s(t.$t("test.Batchdelete")))])],1)],1),t._v(" "),n("div",{staticClass:"content_user"},[n("el-table",{ref:"multipleTable",staticStyle:{width:"98%","text-align":"center","margin-left":"2%"},attrs:{data:t.logData,"max-height":"660",border:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{property:"username",label:t.$t("logmanagement.username"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{property:"action",label:t.$t("logmanagement.action"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{property:"zh"==t.i8n?"module":"enmodule",label:t.$t("logmanagement.action2"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{property:"detail",label:t.$t("logmanagement.detail"),"show-overflow-tooltip":"",align:"center","min-width":"190"}}),t._v(" "),n("el-table-column",{attrs:{property:"customername",label:t.$t("logmanagement.customername"),"show-overflow-tooltip":"",align:"center","min-width":"150"}}),t._v(" "),n("el-table-column",{attrs:{property:"time",label:t.$t("logmanagement.time"),"show-overflow-tooltip":"",align:"center","min-width":"190",formatter:t.formatDate}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("logmanagement.contron"),align:"center",fixed:"right","min-width":"70"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("warning.delete"),placement:"top"}},[n("el-button",{staticClass:"dels",attrs:{type:"danger"},on:{click:function(a){return t.userDele(e.$index)}}},[n("img",{attrs:{src:a("B32J")}})])],1)]}}])})],1),t._v(" "),n("div",{staticClass:"block",staticStyle:{"text-align":"center",width:"100%","margin-top":"1%"}},[n("el-pagination",{attrs:{"current-page":t.currentPage1,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-size":20},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})],1)],1),t._v(" "),n("el-dialog",{attrs:{title:t.$t("logmanagement.logrule1"),visible:t.del},on:{"update:visible":function(e){t.del=e}}},[n("el-table",{staticStyle:{width:"100%","text-align":"left"},attrs:{data:t.delData,"max-height":"660",stripe:""}},[n("el-table-column",{attrs:{property:"username",label:t.$t("logmanagement.username"),"show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{property:"action",label:t.$t("logmanagement.action"),"show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{property:"detail",label:t.$t("logmanagement.detail"),"show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{property:"customername",label:t.$t("logmanagement.customername"),"show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{property:"time",label:t.$t("logmanagement.time"),"show-overflow-tooltip":"",formatter:t.formatDate}})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.del=!1}}},[t._v(t._s(t.$t("terminal.cancel")))]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.deleteTrue}},[t._v(t._s(t.$t("terminal.confirm")))])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var u=a("VU/8")(c,m,!1,function(t){a("ZoJM")},"data-v-1050e72c",null);e.default=u.exports},ZoJM:function(t,e){}});
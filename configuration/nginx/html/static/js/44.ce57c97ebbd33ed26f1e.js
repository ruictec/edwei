webpackJsonp([44],{t0cw:function(e,t){},virG:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r("mvHQ"),i=r.n(s),a=r("3zDK"),o=r("PO8r"),n=r("nQqC"),d=r("c2Ch"),l=r("c+aE"),u={components:{Menu:o.a,basecard:n.a,System:l.a},Systemname:"OrderDetails",data:function(){return{i8n:this.$store.state.i18n,host:a.a,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,delprio:this.$store.state.userInfo.delprio,contrForPrionum:this.$store.state.userInfo.prionum,orderId:"",userOrders:!0,MsgBoardList:[],myorder:!1,userorder:!1,companyorder:!1,upgradeUserOrder:!0,orderCustomername:"",orderDetails:"",orderPrioritystr:"",orderPriority:"",enOrderPrioritystr:"",orderStatustr:"",enOrderStatustr:"",orderStatus:"",orderTitle:"",orderTypestr:"",enOrderTypestr:"",orderType:"",orderTime:"",orderFilenames:"",sendData:{questionid:"",username:this.$store.state.userInfo.username,details:""},editfilePath:a.a.host+"user/updateQuestionMapFile",editdataForFile:{},editfileList:[],editfileData:""}},methods:{datetimecut:function(e){if(!e)return"-";function t(e){return e>9?e:"0"+e}var r=new Date(e);return r.getFullYear()+"-"+t(r.getMonth()+1)+"-"+t(r.getDate())+" "+(r.getHours()<10?"0"+r.getHours():r.getHours())+":"+t(r.getMinutes())+":"+t(r.getSeconds())},formatDate:function(e,t){if(null==e.time||0==e.time)return"";var r=new Date(1e3*parseInt(e.time)).toUTCString();return this.datetimecut(r)},formatDatecreatime:function(e,t){if(null==e.creatime||0==e.creatime)return"";var r=new Date(1e3*parseInt(e.creatime)).toUTCString();return this.datetimecut(r)},edithandlePreview:function(e){e.name=e.name.replace(/\s*/g,"");var t=e.name,r=a.a.host+"question/"+e.name;this.downloadFile(t,r)},downloadFile:function(e,t){var r=new XMLHttpRequest;r.responseType="blob",r.open("GET",t),r.onload=function(){var t=window.URL.createObjectURL(this.response),r=document.createElement("a");document.body.appendChild(r),r.href=t,r.download=e,r.click()},r.send()},edithandleRemove:function(e,t){var r=this;this.editfileList=t;for(var s=[],a=0;a<t.length;a++)s.push(t[a].name);var o={delname:e.name,id:this.orderId,filename:s.toString()};Object(d.O)(i()(o),this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001!=e.code&&r.$message({message:"zh"==r.$store.state.i18n?e.msg:e.enMsg,type:"error"})}),0==t.length?this.haveFile=!1:this.haveFile=!0},edithandleChange:function(e,t){this.editfileList=t},editFileUpload:function(e){if(!(e.size/1024/1024<2))return this.$message.error(this.$t("tet.tet15")),!1;if(5==this.orderStatus)return this.$message({message:this.$t("companyorder.tet4"),type:"warning"}),this.$refs.uploads.abort(),!1;this.editdataForFile.id=this.orderId,this.editdataForFile.title=this.orderTitle,this.editdataForFile.type=this.orderType,this.editdataForFile.priority=this.orderPriority,this.editdataForFile.details=this.orderDetails,this.editdataForFile.status=this.orderStatus;for(var t=[],r=0;r<this.editfileList.length;r++)t.push(this.editfileList[r].name);this.editdataForFile.filename=t},editFileSuccess:function(e,t,r){if(1001!=e.code)this.$message({message:e.msg,type:"error"}),r.splice(r.length-1,1);else{this.editfileList=[],this.orderFilenames=e.data.split(",");for(var s=0;s<this.orderFilenames.length;s++)this.editfileList.push({url:a.a.host+"question/"+this.orderFilenames[s],name:this.orderFilenames[s]})}},getOrderDetail:function(e){var t=this;t.editfileList=[];var r={id:this.orderId};Object(d._84)(r,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code){switch(e.data.upgrade){case 1:t.upgradeUserOrder=!1;break;case 2:default:t.upgradeUserOrder=!0}if(t.orderDetails=e.data.details,t.orderCustomername=e.data.customername,t.orderPrioritystr=e.data.prioritystr,t.enOrderPrioritystr=e.data.enpriority,t.orderPriority=e.data.priority,t.orderStatustr=e.data.statustr,t.enOrderStatustr=e.data.enstatus,t.orderStatus=e.data.status,t.orderTitle=e.data.title,t.orderTypestr=e.data.typestr,t.enOrderTypestr=e.data.entype,t.orderType=e.data.type,t.orderTime=t.formatDatecreatime(e.data),t.$nextTick(function(){setTimeout(function(){t.$refs.scrollbar.$el.children[0].scrollTop=t.$refs.scrollbar.$el.children[0].scrollHeight},0)}),e.data.filename){t.orderFilenames=e.data.filename.split(",");for(var r=0;r<t.orderFilenames.length;r++)t.editfileList.push({url:a.a.host+"question/"+t.orderFilenames[r],name:t.orderFilenames[r]})}}else t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})}),this.getMsgBoards(this.orderId)},getMsgBoards:function(e){var t=this,r={questionid:e};Object(d._70)(r,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code){t.MsgBoardList=e.data;for(var r=0;r<t.MsgBoardList.length;r++)t.MsgBoardList[r].time=t.formatDate(t.MsgBoardList[r])}else t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})},sendMsg:function(){var e=this;this.sendData.questionid=this.orderId,this.sendData.details&&Object(d._121)(e.sendData,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(e.$message({message:e.$t("mapmanagement.Submittedsuccessfully"),type:"success"}),e.getOrderDetail(),e.sendData.details=""):e.$message({message:"zh"==e.$store.state.i18n?t.msg:t.enMsg,type:"error"})})},upgradeOrder:function(){var e=this,t=this;this.$confirm(this.$t("companyorder.tet5"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){var r={id:e.orderId,status:e.orderStatus,upgrade:"1"};Object(d._185)(r,e.tenantkey_A,e.tenantid_A,e.userName).then(function(e){1001==e.code?(t.$message({message:t.$t("companyorder.tet6"),type:"success"}),t.upgradeUserOrder=!1):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})})},upgradeOrderBack:function(){var e=this,t=this;this.$confirm(this.$t("companyorder.tet7"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){var r={id:e.orderId,status:e.orderStatus,upgrade:"2"};Object(d._185)(r,e.tenantkey_A,e.tenantid_A,e.userName).then(function(e){1001==e.code?(t.$message({message:t.$t("companyorder.tet8"),type:"success"}),t.upgradeUserOrder=!0):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})})}},beforeMount:function(){this.orderId=this.$route.query.orderId,this.$route.query.myorder?(this.myorder=!0,this.userOrders=!1):this.$route.query.userorder?(this.userOrders=!0,this.userorder=!0):this.$route.query.companyorder&&(this.userOrders=!0,this.companyorder=!0),this.getOrderDetail()},watch:{"$i18n.locale":function(){this.i8n=this.$store.state.i18n}}},c={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{class:5!=e.contrForPrionum?"home":"",staticStyle:{height:"100%"}},[5!=e.contrForPrionum?r("div",{staticClass:"menu_header"},[r("Menu")],1):e._e(),e._v(" "),r("div",{staticClass:"content"},[r("el-container",{class:5==e.contrForPrionum?"user":"asi"},[5!=e.contrForPrionum?r("el-aside",[r("System")],1):e._e(),e._v(" "),r("el-main",[r("div",[r("el-breadcrumb",{attrs:{separator:"/"}},[e.myorder?r("el-breadcrumb-item",{attrs:{to:{path:"/user/myorder"}}},[e._v(e._s(e.$t("Breadcrumb.Myworkorder")))]):e._e(),e._v(" "),e.userorder?r("el-breadcrumb-item",{attrs:{to:{path:"/userorder"}}},[e._v(e._s(e.$t("list.Userworkorder")))]):e._e(),e._v(" "),e.companyorder?r("el-breadcrumb-item",{attrs:{to:{path:"/companyorder"}}},[e._v(e._s(e.$t("list.Enterpriseworkorder")))]):e._e(),e._v(" "),r("el-breadcrumb-item",[r("a",[e._v(e._s(e.$t("Breadcrumb.Workorderdetails")))])])],1),e._v(" "),r("el-divider",{staticClass:"divider"}),e._v(" "),r("div",{staticClass:"order_detail1"},[r("div",{staticClass:"order_detail1_1"},[r("p",[r("span",[e._v(e._s(e.$t("myorderde.workordernumber")))]),e._v(" "),r("span",[e._v(e._s(e.orderId))])]),e._v(" "),r("p",[r("span",[e._v(e._s(e.$t("myorderde.title")))]),e._v(" "),r("span",[e._v(e._s(e.orderTitle))])]),e._v(" "),r("p",[r("span",[e._v(e._s(e.$t("myorderde.questioncategory")))]),e._v(" "),r("span",[e._v(e._s("zh"==e.i8n?e.orderTypestr:e.enOrderTypestr))])]),e._v(" "),r("p",[r("span",[e._v(e._s(e.$t("myorderde.priority")))]),e._v(" "),r("span",[e._v(e._s("zh"==e.i8n?e.orderPrioritystr:e.enOrderPrioritystr))])]),e._v(" "),r("p",[r("span",[e._v(e._s(e.$t("myorderde.workorderstatus")))]),e._v(" "),r("span",[e._v(e._s("zh"==e.i8n?e.orderStatustr:e.enOrderStatustr))])])]),e._v(" "),r("div",{staticClass:"order_detail1_2"},[r("p",[r("span",[e._v(e._s(e.$t("myorderde.company")))]),e._v(" "),r("span",[e._v(e._s(e.orderCustomername))])]),e._v(" "),r("p",[r("span",[e._v(e._s(e.$t("myorderde.Questioncontent")))]),e._v(" "),r("span",[e._v(e._s(e.orderDetails))])]),e._v(" "),r("p",[r("span",[e._v(e._s(e.$t("myorderde.Appendix")))]),e._v(" "),r("el-upload",{ref:"uploads",staticClass:"upload-demo",attrs:{action:e.editfilePath,data:e.editdataForFile,"on-preview":e.edithandlePreview,"on-remove":e.edithandleRemove,"file-list":e.editfileList,"on-change":e.edithandleChange,"auto-upload":!0,limit:5,"before-upload":e.editFileUpload,"on-success":e.editFileSuccess,disabled:5==e.orderStatus}},[r("a",{attrs:{slot:"trigger"},slot:"trigger"},[e._v(e._s(e.$t("myorder.Addattachments")))]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n                    "+e._s(e.$t("myorder.text1"))+"\n                  ")])])],1),e._v(" "),r("p",{staticClass:"uploadTime"},[r("span",[e._v(" "+e._s(e.$t("myorder.submissiontime")))]),e._v(" "),r("span",[e._v(e._s(e.orderTime))])])])])],1),e._v(" "),r("div",{staticStyle:{"margin-top":"3%"}},[r("h2",[e._v(e._s(e.$t("myorderde.UserComments")))]),e._v(" "),r("el-divider",{staticClass:"divider"}),e._v(" "),r("div",{staticClass:"order_detail2"},[r("el-scrollbar",{ref:"scrollbar",attrs:{"wrap-class":"scrolllist","view-class":"view-box",native:!1}},[0==e.MsgBoardList.length?r("p",{staticStyle:{"text-align":"left",color:"#6f6f6f","font-size":"14px"}},[e._v("\n                "+e._s(e.$t("myorderde.Nomessage"))+"\n              ")]):e._e(),e._v(" "),e._l(e.MsgBoardList,function(t){return r("ul",{key:t.id,staticClass:"item"},[r("li",[r("p",[r("span",{staticStyle:{"font-size":"16px","font-weight":"600","margin-right":"1.5%"}},[e._v(e._s(t.username))]),e._v(" "),r("span",{staticStyle:{color:"#6f6f6f"}},[e._v(e._s(t.time))])]),e._v(" "),r("p",[r("span",{staticStyle:{"font-size":"16px"}},[e._v(e._s(t.details))])])])])})],2),e._v(" "),1!=e.orderStatus&&5!=e.orderStatus?r("el-input",{attrs:{type:"textarea",maxlength:"255","show-word-limit":"",placeholder:e.$t("myorderde.text")},model:{value:e.sendData.details,callback:function(t){e.$set(e.sendData,"details",t)},expression:"sendData.details"}}):e._e(),e._v(" "),1!=e.orderStatus&&5!=e.orderStatus?r("div",{staticStyle:{display:"flex"}},[r("el-button",{staticClass:"sendMsg",attrs:{type:"primary"},on:{click:function(t){return e.sendMsg()}}},[e._v(e._s(e.$t("myorderde.Submitmessage")))]),e._v(" "),(3==e.contrForPrionum||4==e.contrForPrionum)&&e.upgradeUserOrder&&e.userOrders?r("el-button",{staticClass:"sendMsg",attrs:{type:"primary"},on:{click:function(t){return e.upgradeOrder()}}},[e._v(e._s(e.$t("myorderde.Liftingworkorder")))]):e._e(),e._v(" "),3!=e.contrForPrionum&&4!=e.contrForPrionum||e.upgradeUserOrder||!e.userOrders?e._e():r("el-button",{staticClass:"sendMsg",attrs:{type:"primary"},on:{click:function(t){return e.upgradeOrderBack()}}},[e._v(e._s(e.$t("myorderde.Withdrawpromotion")))])],1):e._e()],1)],1)])],1)],1)])},staticRenderFns:[]};var m=r("VU/8")(u,c,!1,function(e){r("t0cw")},"data-v-3c902c91",null);t.default=m.exports}});
webpackJsonp([12],{CCrk:function(t,e,i){"use strict";(function(t){var a=i("woOf"),n=i.n(a),s=i("mvHQ"),r=i.n(s),o=i("PO8r"),l=i("CTnB"),d=i("c2Ch"),u=i("ktr9"),c=(i.n(u),i("CXX0")),g=i("Mdwg"),m=i("WiOa"),h=(i("/LWt"),i("nq2H")),p=i("T18w"),b=i("Umvz"),f=i("WMwB"),v=i("Mjwz"),y=i("zOBh"),$=i("kZ1N"),_=i("TDso"),w=i("2YZ9"),k=i("lUmj"),I=i("beD/"),x=i("lVyT"),B=i("8cSO"),j=i("ItK/"),F=i("0Fy/");i("czjk"),i("flqW"),i("7rnj");e.a={components:{Menu:o.a,Project:l.a},name:"buildingManagement",data:function(){return{i8n:this.$store.state.i18n,openlayersSource:"",rightMenu:!1,vedio:!1,contrForPrionum:this.$store.state.userInfo.prionum,delprio:this.$store.state.userInfo.delprio,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,intoProjectName:this.$store.state.intoProjectName,intoProjectid:this.$store.state.intoProjectid,intoProjectprojectType:this.$store.state.intoProjectprojectType,map:"",seeLayer:"",view:"",modify:null,vectorLayer:null,source:null,startX:"",startY:"",endX:"",endY:"",imgSrc:"",imgMsg:"",isActives:"",edit:!1,mapType2:!1,mapType3:!1,building:0,building1:0,building2:0,building3:0,building4:0,building5:0,building6:0,building7:0,building8:0,building9:0,building10:0,building11:0,building12:0,building13:0,imgBtnInfo:[{index:1,src:"../../../static/offices//office.png",msg:this.$t("tet.Building")}],schoolImgInfo:[{index:1,src:"../../../static/school/academic.png",msg:this.$t("build.AcademicBuilding")},{index:2,src:"../../../static/school/basketball.png",msg:this.$t("build.BasketballCourt")},{index:3,src:"../../../static/school/guard.png",msg:this.$t("build.guard")},{index:4,src:"../../../static/school/laboratory.png",msg:this.$t("build.LaboratoryBuilding")},{index:5,src:"../../../static/school/library.png",msg:this.$t("build.library")},{index:6,src:"../../../static/school/park.png",msg:this.$t("build.Parkinglot")},{index:7,src:"../../../static/school/playground.png",msg:this.$t("build.playground")}],residenceImgInfo:[{index:1,src:"../../../static/residence/guard.png",msg:this.$t("build.guard")},{index:2,src:"../../../static/residence/park.png",msg:this.$t("build.Parkinglot")},{index:3,src:"../../../static/residence/residential.png",msg:this.$t("build.Residentialbuilding")}],hospitalImgInfo:[{index:1,src:"../../../static/hospital/Inpatient.png",msg:this.$t("build.InpatientWard")},{index:2,src:"../../../static/hospital/complex.png",msg:this.$t("build.Complexbuilding")},{index:3,src:"../../../static/hospital/guard.png",msg:this.$t("build.guard")},{index:4,src:"../../../static/hospital/outpatient.png",msg:this.$t("build.OutpatientDepartment")},{index:5,src:"../../../static/hospital/park.png",msg:this.$t("build.Parkinglot")}],marketImgInfo:[{index:1,src:"../../../static/market/market.png",msg:this.$t("build.market")},{index:2,src:"../../../static/market/park.png",msg:this.$t("build.Parkinglot")}],officesImgInfo:[{index:1,src:"../../../static/offices/office.png",msg:this.$t("build.OfficeBuilding")},{index:2,src:"../../../static/offices/park.png",msg:this.$t("build.Parkinglot")},{index:3,src:"../../../static/offices/guard.png",msg:this.$t("build.guard")}],warehouseImgInfo:[{index:1,src:"../../../static/warehouse/plant.png",msg:this.$t("build.Warehouseplant")},{index:2,src:"../../../static/warehouse/park.png",msg:this.$t("build.Parkinglot")}],workshopImgInfo:[{index:1,src:"../../../static/workshop/office.png",msg:this.$t("build.Factoryofficebuilding")},{index:2,src:"../../../static/workshop/workshop.png",msg:this.$t("build.Factoryworkshop")},{index:3,src:"../../../static/workshop/guard.png",msg:this.$t("build.guard")},{index:4,src:"../../../static/workshop/dormitory.png",msg:this.$t("build.dormitory")},{index:5,src:"../../../static/workshop/park.png",msg:this.$t("build.Parkinglot")}],mapInfo:"",buildingNameList:[],buildingIdList:[],editData:{building:"",src:"",id:"",lati:"",longi:"",projectid:""},editDataBuilding:"",arrs:[],editFeatureInfo:"",oldEditBUilding:"",menu_overlay:"",zoom:this.$store.state.mapZoom,longi:this.$store.state.longis,lati:this.$store.state.latis,mapCenter:[],headlistdata:"",showAllGround:"",showAllGroundEdit:!1,showGroundList:[{index:1,value:!0,label:"显示所有"},{index:1,value:!1,label:"显示单层"}]}},methods:{importExcel:function(){document.getElementById("articleImage").click()},importExcels:function(e){var a,n=this,s=event.currentTarget.files[0],o=new FileReader;FileReader.prototype.readAsBinaryString=function(e){var s,o,l="",u=new FileReader;u.onload=function(e){for(var c=new Uint8Array(u.result),g=c.byteLength,m=0;m<g;m++)l+=String.fromCharCode(c[m]);var h=i("uXZL");s=h.read(l,{type:"binary"}),o=h.utils.sheet_to_json(s.Sheets[s.SheetNames[0]]),a=n.dateTransition(o);var p={msg:r()(a)};Object(d._111)(p,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){1001==e.code?(n.$message({message:n.$t("terminal.tet2"),type:"warning"}),t("#articleImage").val(""),n.getBuildingByProjectids()):(n.$message({message:"zh"==n.$store.state.i18n?e.msg:e.enMsg,type:"error"}),t("#articleImage").val(""))})},u.readAsArrayBuffer(e)},o.readAsBinaryString(s)},dateTransition:function(t){for(var e=[],i={},a=0;a<t.length;a++){for(var n in i={},t[a])switch(n){case"ID":i.id=t[a][n];break;case this.$t("Building.Building1"):i.building=t[a][n];break;case this.$t("Building.BuildingType"):i.buildtype=t[a][n];break;case this.$t("beacon.lati"):i.lati=t[a][n];break;case this.$t("beacon.longi"):i.longi=t[a][n];break;case this.$t("Building.projectid"):i.projectid=t[a][n];break;case this.$t("Building.src"):i.src=t[a][n]}e.push(i)}return e},export2Excel:function(t){for(var e=this,a=this,n=[],s=["id","building","buildtype","lati","longi","projectid","src"],r=0;r<s.length;r++){n.push(s[r]);for(var o=0;o<a.headlistdata.length;o++)s[r]==a.headlistdata[o].value&&(s[r]=a.headlistdata[o].msg)}i.e(55).then(function(){var r=i("zWO4").export_json_to_excel,o=n,l=t;r(s,e.formatJson(o,l),a.$t("list.Buildingmanagement"))}.bind(null,i)).catch(i.oe)},formatJson:function(t,e){return e.map(function(e){return t.map(function(t){return e[t]})})},exportExcelAll:function(){var t=this;this.headlistdata=[{msg:"ID",value:"id"},{msg:t.$t("Building.Building1"),value:"building"},{msg:t.$t("Building.BuildingType"),value:"buildtype"},{msg:t.$t("beacon.lati"),value:"lati"},{msg:t.$t("beacon.longi"),value:"longi"},{msg:t.$t("Building.projectid"),value:"projectid"},{msg:t.$t("Building.src"),value:"src"}];var e={projectid:this.intoProjectid};Object(d._27)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?t.export2Excel(e.data):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})},showVideo:function(){this.vedio=!0},closeVedio:function(){var t=document.getElementById("video");t.pause(),t.currentTime=0},goProject:function(){this.$router.push("/projectmanagement")},initMap:function(){var t=this,e=this;this.map&&(this.map.setTarget("sss"),this.map=null),this.seeLayer=new g.a({className:"baseLayerClass",source:e.openlayersSource}),this.mapInfo.length>0?this.view=new c.b({projection:"EPSG:4326",center:[e.longi,e.lati],zoom:e.zoom}):this.view=new c.b({projection:"EPSG:4326",center:e.mapCenter,zoom:5}),setTimeout(function(){if(t.map=new c.a({target:"map",layers:[t.seeLayer],view:t.view}),t.map.addControl(new F.a),t.mapInfo.length>0)for(var i=0;i<e.mapInfo.length;i++)e.addIconMarkers(e.map,e.mapInfo[i]);t.mapClick(),t.mapRightClick(t.map),t.addLine(t.map)},0)},addIconMarkers:function(t,e){null==e.buildtype&&(e.buildtype=1);var i=new h.a({longi:e.longi,lati:e.lati,src:e.src,projectid:e.projectid,building:e.building,id:e.id,buildtype:e.buildtype,mapid:e.mapid,allGround:e.flag,geometry:new p.a([e.longi,e.lati])});this.source=new f.a({features:[i]});var a=new v.c({image:new y.a({anchor:[.5,1],src:e.src,scale:1,rotation:0}),text:new w.a({text:1==e.buildtype?e.building:e.building+"(3D)",font:"12px font-size",fill:new k.a({color:"white"}),offsetY:10})});this.vectorLayer=new b.a({source:this.source,style:a}),this.modifyFeature(t,this.vectorLayer.getSource()),t.addLayer(this.vectorLayer)},addIconMarker:function(t,e){var i,a=this;switch(this.imgMsg){case a.$t("build.Parkinglot"):a.building1+=1,a.building=a.building1;break;case a.$t("build.guard"):a.building2+=1,a.building=a.building2;break;case a.$t("build.AcademicBuilding"):a.building3+=1,a.building=a.building3;break;case a.$t("build.BasketballCourt"):a.building4+=1,a.building=a.building4;break;case a.$t("build.LaboratoryBuilding"):a.building5+=1,a.building=a.building5;break;case a.$t("build.library"):a.building6+=1,a.building=a.building6;break;case a.$t("build.playground"):a.building7+=1,a.building=a.building7;break;case a.$t("build.Residentialbuilding"):case a.$t("build.Complexbuilding"):a.building3+=1,a.building=a.building3;break;case a.$t("build.InpatientWard"):a.building4+=1,a.building=a.building4;break;case a.$t("build.OutpatientDepartment"):a.building5+=1,a.building=a.building5;break;case a.$t("build.market"):case a.$t("build.OfficeBuilding"):case a.$t("build.Warehouseplant"):case a.$t("build.Factoryofficebuilding"):a.building3+=1,a.building=a.building3;break;case a.$t("build.Factoryworkshop"):a.building4+=1,a.building=a.building4;break;case a.$t("build.dormitory"):a.building5+=1,a.building=a.building5;break;case a.$t("build.Building"):a.building+=1}i=this.imgMsg+this.building;for(var n=0;n<this.mapInfo.length;n++)i==a.mapInfo[n].building&&(a.building+=1,i=a.imgMsg+a.building);a=this;var s=new h.a({longi:e.x,lati:e.y,src:e.src,projectid:this.intoProjectid,building:i,id:"",buildtype:1,allGround:"false",geometry:new p.a([e.x,e.y])});this.source=new f.a({features:[s]});var r=new v.c({image:new y.a({anchor:[.5,1],src:e.src,scale:1}),text:new w.a({text:i,font:"12px font-size",fill:new k.a({color:"white"}),offsetY:10})});switch(this.vectorLayer=new b.a({source:this.source,style:r}),this.modifyFeature(t,this.vectorLayer.getSource()),t.addLayer(this.vectorLayer),this.buildingNameList.push(i),this.imgMsg){case a.$t("build.Parkinglot"):a.building1=a.building;break;case a.$t("build.guard"):a.building2=a.building;break;case a.$t("build.AcademicBuilding"):case a.$t("build.Residentialbuilding"):case a.$t("build.Complexbuilding"):case a.$t("build.market"):case a.$t("build.OfficeBuilding"):case a.$t("build.Warehouseplant"):case a.$t("build.Factoryofficebuilding"):a.building3=a.building;break;case a.$t("build.BasketballCourt"):case a.$t("build.InpatientWard"):case a.$t("build.Factoryworkshop"):a.building4=a.building;break;case a.$t("build.LaboratoryBuilding"):case a.$t("build.OutpatientDepartment"):case a.$t("build.dormitory"):a.building5=a.building;break;case a.$t("build.library"):a.building6=a.building;break;case a.$t("build.playground"):a.building7=a.building}var o={longi:e.x,lati:e.y,src:e.src,projectid:a.intoProjectid,building:i,id:"",buildtype:1,tenantid:a.$store.state.intoProjectTenantid};Object(d.e)(o,a.tenantkey_A,a.tenantid_A,a.userName).then(function(t){if(1001==t.code){var i={projectid:a.intoProjectid,longi:e.x,lati:e.y,zoom:a.map.getView().getZoom()};Object(d._182)(i,a.tenantkey_A,a.tenantid_A,a.userName).then(function(t){1001==t.code&&(a.$store.commit("changeMapZoom",a.map.getView().getZoom()),a.$store.commit("changeMapLongi",e.x),a.$store.commit("changeMapLati",e.y))});var n={projectid:a.intoProjectid};Object(d._27)(n,a.tenantkey_A,a.tenantid_A,a.userName).then(function(t){if(1001==t.code){var e=[];t.data.forEach(function(t){e.push(t.id)});var i=e.filter(function(t){return a.buildingIdList.every(function(e){return t!=e})})[0];a.buildingIdList.push(i),s.values_.id=i}})}else a.delFeature(s),a.$message({message:"zh"==a.$store.state.i18n?t.msg:t.enMsg,type:"error"})})},mapClick:function(){var t=this,e=this;this.map.on("click",function(i){if(t.map.forEachFeatureAtPixel(i.pixel,function(t){return t}));else{if(""==e.imgSrc)return void e.$message({message:t.$t("Building.Pleaseicon"),type:"warning"});t.$confirm(t.$t("Building.layout"),t.$t("Building.tips"),{confirmButtonText:t.$t("terminal.confirm"),cancelButtonText:t.$t("terminal.cancel"),type:"warning",callback:function(t){if("confirm"===t){var a={x:i.coordinate[0],y:i.coordinate[1],src:e.imgSrc};e.addIconMarker(e.map,a)}}})}})},mapRightClick:function(e){var i=this;this.rightMenu=!0;var a=new $.a({element:document.getElementById("contextmenu_container"),positioning:"center-center"});e.addOverlay(a),t(e.getViewport()).on("contextmenu",function(n){n.preventDefault();var s=e.getEventPixel(n.originalEvent),r=e.forEachFeatureAtPixel(s,function(t){return t});if(r&&(i.mapType2=!1,i.mapType3=!1,1!=r.values_.buildtype&&2!=r.values_.buildtype||3!=i.contrForPrionum&&4!=i.contrForPrionum||(i.mapType3=!0,i.mapType2=!0),r.values_.longi)){var o=e.getEventCoordinate(n.originalEvent);a.setPosition(o),t("#popup-closer").on("click",function(t){t.preventDefault(),a.setPosition(void 0),i.removeClick()}),t("#del").click(function(){i.delFeature(r,a)}),t("#edit").click(function(){i.editFeature(r,a)}),t("#maptype3").click(function(){i.setMaptype3D(r,a)}),t("#maptype2").click(function(){i.setMaptype2D(r,a)}),t("#triggerAlarm").click(function(){i.sendDevOtherAlarmMores("no",r)}),t("#cancelAlarm").click(function(){i.sendDevOtherAlarmMores("no",r)})}})},removeClick:function(){t("#del").unbind("click"),t("#edit").unbind("click"),t("#maptype3").unbind("click"),t("#maptype2").unbind("click"),t("#triggerAlarm").unbind("click"),t("#cancelAlarm").unbind("click")},sendDevOtherAlarmMores:function(t,e){var i=this;this.$confirm("yes"==t?this.$t("otherDev.triggerAlarmtrue"):this.$t("otherDev.cancelAlarmtrue"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){var a={alarm:t,devtype:4,inuse:1,buildid:e.values_.id,projectid:e.values_.projectid};Object(d._134)(a,i.tenantkey_A,i.tenantid_A,i.userName).then(function(t){1001==t.code?i.$message({message:"zh"==i.$store.state.i18n?t.msg:t.enMsg,type:"success"}):i.$message({message:"zh"==i.$store.state.i18n?t.msg:t.enMsg,type:"error"})})})},setMaptype3D:function(t,e){var i=this,a=this;this.$confirm(this.$t("build.Set3Dtet"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){var e={id:t.values_.id,building:t.values_.building,buildtype:2,longi:t.values_.longi,lati:t.values_.lati,src:t.values_.src,projectid:a.intoProjectid};Object(d._147)(e,a.tenantkey_A,a.tenantid_A,a.userName).then(function(e){1001==e.code?(a.$message({message:a.$t("Building.Setsuccessfully"),type:"success"}),t.values_.buildtype=2,t.setStyle(new v.c({image:new y.a({anchor:[.5,1],src:t.values_.src,scale:1}),text:new w.a({text:t.values_.building+"(3D)",font:"12px font-size",fill:new k.a({color:"white"}),offsetY:10})}))):a.$message({message:"zh"==a.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}).catch(function(){i.$message({type:"info",message:i.$t("Building.Cancelsetting")})})},setMaptype2D:function(t,e){var i=this,a=this;this.$confirm(this.$t("build.Set2Dtet"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){var e={id:t.values_.id,building:t.values_.building,buildtype:1,longi:t.values_.longi,lati:t.values_.lati,src:t.values_.src,projectid:a.intoProjectid};Object(d._147)(e,a.tenantkey_A,a.tenantid_A,a.userName).then(function(e){1001==e.code?(a.$message({message:a.$t("Building.Setsuccessfully"),type:"success"}),t.values_.buildtype=1,t.setStyle(new v.c({image:new y.a({anchor:[.5,1],src:t.values_.src,scale:1}),text:new w.a({text:t.values_.building,font:"12px font-size",fill:new k.a({color:"white"}),offsetY:10})}))):a.$message({message:"zh"==a.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}).catch(function(){i.$message({type:"info",message:i.$t("Building.Cancelsetting")})})},modifyFeature:function(t,e){var i=this,a=this;this.modify=new _.b({source:e}),this.modify.on("modifystart",function(t){i.startX=t.mapBrowserEvent.coordinate[0],i.startY=t.mapBrowserEvent.coordinate[1]}),this.modify.on("modifyend",function(t){i.endX=t.mapBrowserEvent.coordinate[0],i.endY=t.mapBrowserEvent.coordinate[1],e.getFeatures()[0].values_.longi=t.mapBrowserEvent.coordinate[0],e.getFeatures()[0].values_.lati=t.mapBrowserEvent.coordinate[1];var n={id:e.getFeatures()[0].values_.id,building:e.getFeatures()[0].values_.building,projectid:e.getFeatures()[0].values_.projectid,buildtype:e.getFeatures()[0].values_.buildtype,longi:e.getFeatures()[0].values_.longi,lati:e.getFeatures()[0].values_.lati,src:e.getFeatures()[0].values_.src};Object(d._147)(n,a.tenantkey_A,a.tenantid_A,a.userName).then(function(t){if(1001==t.code){var i={projectid:a.intoProjectid,longi:e.getFeatures()[0].values_.longi,lati:e.getFeatures()[0].values_.lati,zoom:a.map.getView().getZoom()};Object(d._182)(i,a.tenantkey_A,a.tenantid_A,a.userName).then(function(t){1001==t.code&&(a.$store.commit("changeMapZoom",a.map.getView().getZoom()),a.$store.commit("changeMapLongi",e.getFeatures()[0].values_.longi),a.$store.commit("changeMapLati",e.getFeatures()[0].values_.lati))})}1001!=t.code&&(a.$message({message:"zh"==a.$store.state.i18n?t.msg:t.enMsg,type:"error"}),e.getFeatures()[0].setGeometry(new p.a([a.startX,a.startY])))})}),t.addInteraction(this.modify)},addLine:function(t){var e=new I.e({stroke:new I.d({color:"#AA8DC6",width:10})}),i=new x.a([[122.9272781486751,23.848426854398152],[122.40150850225844,22.133416341086654],[121.78811058143899,21.35728019637634],[120.18576499235964,19.5296047588327],[119.25521102926318,17.337282710181967],[119.05017371536066,14.734886033725882],[118.98708531108292,12.810689703255191],[118.07230344905598,10.88649337278446],[116.57395384745995,8.96229704231377],[111.37587218970845,3.8613280294327694],[110.27425959721639,2.809788736599442],[107.95320447327722,5.7617448175673145],[107.26213818712276,7.806878264206475],[108.44658415967254,8.693401446500248],[110.07396639858125,11.021809880631187],[110.90017584295029,13.225035065615302],[109.69841665114078,15.428260250599415],[107.99592446274401,17.531338836266087]]),a=new B.a({wrapX:!1}),n=new I.e({stroke:new I.d({color:[170,141,198,1],lineDash:[2,7]})});var s=new h.a({geometry:i,finished:!1,dashOffset:-8});function r(){return[n,new I.e({stroke:new I.d({color:[170,141,198,1],widht:5,lineDash:[2,7],lineDashOffset:s.get("dashOffset")})})]}s.setStyle(r()),a.addFeature(s);var o=new j.b({source:a,style:e});t.addLayer(o),setInterval(function(){var t=s.get("dashOffset");t=0==t?-8:t+1,s.set("dashOffset",t),s.setStyle(r())},100)},changeImgSrc:function(t,e,i){this.building=0,this.imgSrc=e,this.isActives=t,this.imgMsg=i},editFeature:function(t,e){this.menu_overlay=e,this.editData.building=t.values_.building,this.editDataBuilding=t.values_.building,this.editData.src=t.values_.src,this.editData.id=t.values_.id,this.editData.lati=t.values_.lati,this.editData.longi=t.values_.longi,this.editData.buildtype=t.values_.buildtype,this.editData.projectid=t.values_.projectid,this.oldEditBUilding=t.values_.building,this.editFeatureInfo=t,this.showAllGround=t.values_.allGround,this.showAllGroundEdit=1!=t.values_.buildtype,this.edit=!0},editCancel:function(){this.edit=!1,this.oldEditBUilding=""},editTrue:function(){var t=this;if(this.editDataBuilding!=this.editData.building&&t.buildingNameList.indexOf(t.editData.building)>-1)t.$message({message:t.editData.building+"已存在",type:"warning"});else{var e={id:t.editData.id,building:t.editData.building,projectid:t.editData.projectid,buildtype:t.editData.buildtype,longi:t.editData.longi,lati:t.editData.lati,src:t.editData.src,flag:t.showAllGround};Object(d._147)(e,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code?(t.editFeatureInfo.values_.building=t.editData.building,t.editFeatureInfo.values_.src=t.editData.src,t.editFeatureInfo.values_.id=t.editData.id,t.editFeatureInfo.values_.lati=t.editData.lati,t.editFeatureInfo.values_.longi=t.editData.longi,t.editFeatureInfo.values_.projectid=t.editData.projectid,t.editFeatureInfo.values_.allGround=t.showAllGround,t.$message({message:t.$t("mapmanagement.editsuccess"),type:"success"}),t.edit=!1,t.buildingNameList=t.buildingNameList.filter(function(e){return e!=t.oldEditBUilding}),t.buildingNameList.push(t.editData.building),t.editFeatureInfo.setStyle(new v.c({image:new y.a({anchor:[.5,1],src:t.editData.src,scale:1}),text:new w.a({text:1==t.editFeatureInfo.values_.buildtype?t.editData.building:t.editData.building+"(3D)",font:"12px font-size",fill:new k.a({color:"white"}),offsetY:10})})),t.menu_overlay.setPosition(void 0),t.removeClick()):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}},delFeature:function(t,e){var i=this,a=this;if(5==this.$store.state.userInfo.prionum&&2==this.delprio||4==this.$store.state.userInfo.prionum&&2==this.delprio)this.$message({message:this.$t("warning.permissiondelete"),type:"warning"});else if(this.removeClick(),t.values_.id){var n={buildid:t.values_.id};Object(d._58)(n,a.tenantkey_A,a.tenantid_A,a.userName).then(function(n){if(1001==n.code)if(0==n.data.length){var s={buildid:t.values_.id,projectid:a.intoProjectid};Object(d.F)(s,a.tenantkey_A,a.tenantid_A,a.userName).then(function(n){1001==n.code?function(){for(var n=a.map.getLayers().getArray(),s=function(i){t.values_.longi==n[i].getSource().getFeatures()[0].values_.longi&&t.values_.lati==n[i].getSource().getFeatures()[0].values_.lati&&(a.buildingNameList=a.buildingNameList.filter(function(e){return e!=t.values_.building}),n[i].getSource().getFeatures().forEach(function(t){n[i].getSource().removeFeature(t)}),e&&e.setPosition(void 0),a.removeClick(),a.map.removeLayer(n[i]))},r=1;r<n.length;r++)s(r);a.buildingIdList.forEach(function(e,i){e==t.values_.id&&a.buildingIdList.splice(i,1)}),a.$message({message:i.$t("beacon.deletesuccess"),type:"success"})}():a.$message({message:"zh"==a.$store.state.i18n?n.msg:n.enMsg,type:"error"})})}else a.$message({message:i.$t("Building.buildingfirst"),type:"warning"});else a.$message({message:"zh"==a.$store.state.i18n?n.msg:n.enMsg,type:"error"})})}else!function(){for(var i=a.map.getLayers().getArray(),n=function(n){t.values_.longi==i[n].getSource().getFeatures()[0].values_.longi&&t.values_.lati==i[n].getSource().getFeatures()[0].values_.lati&&(a.buildingNameList=a.buildingNameList.filter(function(e){return e!=t.values_.building}),i[n].getSource().getFeatures().forEach(function(t){i[n].getSource().removeFeature(t)}),e&&e.setPosition(void 0),a.removeClick(),a.map.removeLayer(i[n]))},s=1;s<i.length;s++)n(s)}()},getAllFeatures:function(){var t=this.map.getLayers().getArray();this.arrs=[];for(var e=void 0,i=1;i<t.length;i++)t[i].getSource().getFeatures()[0].values_.building&&(e={building:t[i].getSource().getFeatures()[0].values_.building,longi:t[i].getSource().getFeatures()[0].values_.longi,lati:t[i].getSource().getFeatures()[0].values_.lati,src:t[i].getSource().getFeatures()[0].values_.src,id:t[i].getSource().getFeatures()[0].values_.id},this.arrs.push(e))},getBuildingByProjectids:function(){var t=this,e={projectid:this.intoProjectid};Object(d._27)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code){t.mapInfo=e.data;for(var i=0;i<t.mapInfo.length;i++)t.buildingNameList.push(t.mapInfo[i].building),t.buildingIdList.push(t.mapInfo[i].id);t.initMap()}})}},beforeMount:function(){switch(this.$store.state.longis&&this.$store.state.latis?this.mapCenter=[this.$store.state.longis,this.$store.state.latis]:"zh"==this.$store.state.i18n?this.mapCenter=[118,32]:this.mapCenter=[.1,51.3],"zh"==this.$store.state.i18n?this.openlayersSource=new m.b({url:"https://www.edwei.cn:8443/osm/{z}/{x}/{y}.png",crossOrigin:""}):this.openlayersSource=new m.b,Number(this.$store.state.intoProjectprojectType)){case 1:this.imgBtnInfo=this.schoolImgInfo;break;case 2:this.imgBtnInfo=this.hospitalImgInfo;break;case 3:this.imgBtnInfo=this.officesImgInfo;break;case 4:this.imgBtnInfo=this.residenceImgInfo;break;case 5:this.imgBtnInfo=this.workshopImgInfo;break;case 6:this.imgBtnInfo=this.warehouseImgInfo;break;case 7:break;case 8:this.imgBtnInfo=this.marketImgInfo}this.getBuildingByProjectids()},beforeDestroy:function(){var t=this,e={projectid:this.intoProjectid,longi:this.map.getView().getCenter()[0],lati:this.map.getView().getCenter()[1],zoom:this.map.getView().getZoom()};Object(d._182)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(i){1001==i.code&&(t.$store.commit("changeMapZoom",e.zoom),t.$store.commit("changeMapLongi",e.longi),t.$store.commit("changeMapLati",e.lati))})},watch:{"$i18n.locale":function(){this.i8n=this.$store.state.i18n,n()(this.$data.schoolImgInfo,this.$options.data.call(this).schoolImgInfo),n()(this.$data.imgBtnInfo,this.$options.data.call(this).imgBtnInfo),n()(this.$data.residenceImgInfo,this.$options.data.call(this).residenceImgInfo),n()(this.$data.hospitalImgInfo,this.$options.data.call(this).hospitalImgInfo),n()(this.$data.marketImgInfo,this.$options.data.call(this).marketImgInfo),n()(this.$data.officesImgInfo,this.$options.data.call(this).officesImgInfo),n()(this.$data.warehouseImgInfo,this.$options.data.call(this).warehouseImgInfo),n()(this.$data.workshopImgInfo,this.$options.data.call(this).workshopImgInfo)}}}}).call(e,i("7t+N"))},PKWo:function(t,e,i){t.exports=i.p+"static/media/楼栋管理~2.63a1d7d.mp4"},ZFw2:function(t,e){},aw9x:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("CCrk"),n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:5!=t.contrForPrionum?"home":"",staticStyle:{height:"100%"}},[5!=t.contrForPrionum?a("div",{staticClass:"menu_header"},[a("Menu")],1):t._e(),t._v(" "),a("div",{staticClass:"content"},[a("el-container",{class:5==t.contrForPrionum?"user":"asi"},[5!=t.contrForPrionum?a("el-aside",{class:{user:5==t.contrForPrionum}},[a("Project")],1):t._e(),t._v(" "),a("el-main",{staticClass:"main"},[a("div",{staticClass:"inputContent",staticStyle:{display:"flex"}},[3==t.contrForPrionum||4==t.contrForPrionum?a("el-breadcrumb",{staticStyle:{"margin-left":"0"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/projectmanagement"}}},[t._v(t._s(t.$t("index.projectmanagement")))]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.intoProjectName))]),t._v(" "),a("el-breadcrumb-item",[t._v(t._s(t.$t("Breadcrumb.Buildingmanagement")))])],1):t._e()],1),t._v(" "),a("div",{staticClass:"exportContent",staticStyle:{display:"flex"}},[a("input",{staticClass:"x_file",attrs:{id:"articleImage",name:"excelFile",type:"file",accept:".xls,.xlsx"},on:{change:t.importExcels}})]),t._v(" "),a("div",{staticClass:"mapConent"},[a("div",{staticStyle:{width:"100%",position:"relative","z-index":"1"}},[a("div",{staticStyle:{width:"100%"},attrs:{id:"map"}}),t._v(" "),a("p",{staticStyle:{position:"absolute",bottom:"-4%",left:"0"}},[t._v("\n              "+t._s(t.$t("Building.title"))+"\n              "),a("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.showVideo()}}},[t._v(t._s(t.$t("Building.title1")))])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.rightMenu,expression:"rightMenu"}],staticClass:"contextmenu",attrs:{id:"contextmenu_container"}},[a("ul",{attrs:{id:"popup-content"}},[a("li",[a("a",{staticClass:"ol-popup-closer",attrs:{href:"#",id:"popup-closer"}},[a("img",{attrs:{src:i("YcdQ"),width:"11",height:"11",alt:""}})])]),t._v(" "),a("li",[a("el-button",{attrs:{id:"del",size:"mini"}},[t._v(t._s(t.$t("beacon.delete")))])],1),t._v(" "),a("li",[a("el-button",{attrs:{id:"edit",size:"mini"}},[t._v(t._s(t.$t("beacon.edit")))])],1),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:t.mapType2,expression:"mapType2"}]},[a("el-button",{attrs:{id:"maptype2",size:"mini"}},[t._v(t._s(t.$t("build.Set2D")))])],1),t._v(" "),a("li",{directives:[{name:"show",rawName:"v-show",value:t.mapType3,expression:"mapType3"}]},[a("el-button",{attrs:{id:"maptype3",size:"mini"}},[t._v(t._s(t.$t("build.Set3D")))])],1)])]),t._v(" "),a("div",{staticClass:"imgBtn"},[t._l(t.imgBtnInfo,function(e,i){return a("p",{key:i,class:{activeClass:t.isActives===i},on:{click:function(a){return t.changeImgSrc(i,e.src,e.msg)}}},[a("img",{attrs:{src:e.src}}),a("span",[t._v(t._s(e.msg))])])}),t._v(" "),a("el-button",{staticClass:"reset",staticStyle:{"margin-left":"0%"},attrs:{type:"primary"},on:{click:function(e){return t.importExcel()}}},[t._v(t._s(t.$t("terminal.import")))]),t._v(" "),a("el-button",{staticClass:"reset",staticStyle:{"margin-left":"0%"},attrs:{type:"primary"},on:{click:function(e){return t.exportExcelAll()}}},[t._v(t._s(t.$t("terminal.exportAll")))])],2)]),t._v(" "),a("el-dialog",{staticClass:"edit",staticStyle:{"text-align":"center"},attrs:{title:t.$t("Building.Editinformation"),visible:t.edit,width:"50%"},on:{"update:visible":function(e){t.edit=e}}},[a("el-form",{ref:"editData",staticStyle:{"text-align":"left"},attrs:{model:t.editData,"label-width":"120px"}},[a("el-form-item",{attrs:{label:t.$t("Building.Building")}},[a("el-input",{attrs:{placeholder:t.$t("Building.text")},model:{value:t.editData.building,callback:function(e){t.$set(t.editData,"building",e)},expression:"editData.building"}})],1),t._v(" "),t.showAllGroundEdit?a("el-form-item",{attrs:{label:"楼层显示："}},[a("el-select",{attrs:{clearable:"",filterable:""},model:{value:t.showAllGround,callback:function(e){t.showAllGround=e},expression:"showAllGround"}},t._l(t.showGroundList,function(t){return a("el-option",{key:t.index,attrs:{label:t.label,value:t.value}})}),1)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:t.$t("Building.Icon")}},t._l(t.imgBtnInfo,function(e,i){return a("el-radio",{key:i,attrs:{label:e.src},model:{value:t.editData.src,callback:function(e){t.$set(t.editData,"src",e)},expression:"editData.src"}},[a("img",{attrs:{src:e.src}})])}),1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){return t.editCancel()}}},[t._v(t._s(t.$t("change.cancle")))]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editTrue()}}},[t._v(t._s(t.$t("change.sure")))])],1)],1),t._v(" "),a("el-dialog",{attrs:{visible:t.vedio},on:{"update:visible":function(e){t.vedio=e},close:t.closeVedio}},[a("video",{attrs:{width:"100%",controls:"",autoplay:"",id:"video"}},["zh"!=t.i8n?a("source",{attrs:{src:i("jZPX"),type:"video/mp4"}}):t._e(),t._v(" "),"zh"==t.i8n?a("source",{attrs:{src:i("PKWo"),type:"video/mp4"}}):t._e()])])],1)],1)],1)])},staticRenderFns:[]};var s=function(t){i("ZFw2")},r=i("VU/8")(a.a,n,!1,s,"data-v-442bb426",null);e.default=r.exports},jZPX:function(t,e,i){t.exports=i.p+"static/media/楼栋管理En.12c5765.mp4"}});
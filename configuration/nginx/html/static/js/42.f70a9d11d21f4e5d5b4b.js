webpackJsonp([42],{BADC:function(t,e){},"BtF+":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("woOf"),s=i.n(a),n=i("PO8r"),o=i("CTnB"),r=i("LjvF"),l=i("c2Ch"),c={components:{Menu:n.a,Project:o.a,Trajectory:r.a},name:"LocationIndoorHis",data:function(){var t=null;return{trajectory:!1,contrForPrionum:this.$store.state.userInfo.prionum,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,delprio:this.$store.state.userInfo.delprio,intoProjectName:this.$store.state.intoProjectName,tableData:[],multipleSelection:[],currentPage1:1,total:0,tenantidData:[],pickerOptions:{onPick:function(e){e.minDate&&!e.maxDate&&(t=e.minDate),e.maxDate&&(t="")},disabledDate:function(e){var i=t;if(i)return e.getTime()>i.getTime()+864e5||e.getTime()<i.getTime()-864e5},shortcuts:[{text:this.$t("staffmanagement.Lasthour1"),onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-36e5),t.$emit("pick",[i,e])}},{text:this.$t("staffmanagement.Lasthour3"),onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-108e5),t.$emit("pick",[i,e])}},{text:this.$t("staffmanagement.Lasthour6"),onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-216e5),t.$emit("pick",[i,e])}},{text:this.$t("terminal.pickeroptions4"),onClick:function(t){var e=new Date,i=new Date;i.setTime(i.getTime()-864e5),t.$emit("pick",[i,e])}}]},tasktime:[(new Date).getTime()-(108e5-1),new Date],begingTime:"",endTime:"",searchList:{projectid:this.$store.state.intoProjectid,devtype:"",postype:1,groundid:"",buildid:"",begintime:"",endtime:"",page:1,count:20},pageCount:20,del:!1,loading:!1,deleteData:[],buildingList:[],groundList:[],userList:[],tboxList:[],allList:[],userLoading:!1,allOptions:[]}},methods:{datetimecut:function(t){if(!t)return"-";function e(t){return t>9?t:"0"+t}var i=new Date(t);return i.getFullYear()+"-"+e(i.getMonth()+1)+"-"+e(i.getDate())+" "+(i.getHours()<10?"0"+i.getHours():i.getHours())+":"+e(i.getMinutes())+":"+e(i.getSeconds())},formatDateGpstime:function(t){if(null==t.gpstime||0==t.gpstime)return"";var e=new Date(1e3*parseInt(t.gpstime)).toUTCString();return this.datetimecut(e)},handleCurrentChange:function(t){this.searchList.page=t,this.searchList.count=this.pageCount,this.getDevGpsLists()},handleSizeChange:function(t){this.pageCount=t,this.searchList.count=t,this.searchList.page=1,this.currentPage1=1,this.getDevGpsLists()},searchInfo:function(){var t=this;this.searchList.page=1,this.currentPage1=1,this.tasktime&&this.tasktime.length>0?(this.searchList.begintime=Date.parse(new Date(this.tasktime[0]))/1e3,this.searchList.endtime=Date.parse(new Date(this.tasktime[1]))/1e3):(this.searchList.begintime="",this.searchList.endtime=""),Object(l._42)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?e.data.list.length>0?(t.tableData=e.data.list,t.total=e.data.size,t.$message({message:t.$t("buildingmanagement.searchsuccess"),type:"success"})):(t.tableData=[],t.total=0,t.$message({message:t.$t("buildingmanagement.nodata"),type:"warning"})):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})},clearBtn:function(){this.currentPage1=1,this.tasktime=[],this.searchList={projectid:this.$store.state.intoProjectid,devtype:"",postype:1,groundid:"",buildid:"",begintime:"",endtime:"",page:1,count:20},this.getDevGpsLists(),this.getMemberNames()},getDevGpsLists:function(){var t=this;Object(l._42)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&(t.tableData=e.data.list,t.total=e.data.size)})},getBuildingByProjectids:function(){var t=this,e={tenantid:this.$store.state.intoProjectTenantid,projectid:this.$store.state.intoProjectid};Object(l._26)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&(t.buildingList=e.data)})},getGroundLists:function(t){var e=this,i={buildid:t};Object(l._57)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){1001==t.code&&(e.groundList=t.data)})},getMemberNames:function(){var t=this,e=this,i={projectid:this.$store.state.projectid};Object(l._68)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(i){if(1001==i.code){e.userList=i.data.map(function(t){return{value:""+t.maplabel,maplabel:""+t.maplabel,username:""+t.username}});for(var a=e.userList.length-1;a>-1;a--)""!=e.userList[a].maplabel&&null!=e.userList[a].maplabel&&void 0!=e.userList[a].maplabel||e.userList.splice(a,1);t.getTboxSnIds()}})},getTboxSnIds:function(){var t=this,e={projectid:this.$store.state.projectid};Object(l._95)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&(t.tboxList=e.data.filter(function(t){return t.maplabel}).map(function(t){return{value:""+t.maplabel,maplabel:""+t.maplabel,username:""+t.sn}}),t.allList=t.userList.concat(t.tboxList))})},remoteUserMethod:function(t){var e=this;""!==t?(this.userLoading=!0,setTimeout(function(){e.userLoading=!1,e.allOptions=e.allList.filter(function(e){return e.value.toLowerCase().indexOf(t.toLowerCase())>-1?e.value.toLowerCase().indexOf(t.toLowerCase())>-1:e.username.toLowerCase().indexOf(t.toLowerCase())>-1?e.username.toLowerCase().indexOf(t.toLowerCase())>-1:void 0})},200)):this.allOptions=[]}},beforeMount:function(){this.getDevGpsLists(),this.getBuildingByProjectids(),this.getMemberNames()},watch:{"$i18n.locale":function(){s()(this.$data.pickerOptions,this.$options.data.call(this).pickerOptions)}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"content"},[i("div",{staticClass:"project_input"},[i("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap","margin-left":"1%"},attrs:{model:t.searchList}},[i("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("inspection.Building")}},[i("el-select",{staticStyle:{float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("LocationIndoorHis.text1")},on:{change:t.getGroundLists},model:{value:t.searchList.buildid,callback:function(e){t.$set(t.searchList,"buildid",e)},expression:"searchList.buildid"}},t._l(t.buildingList,function(t){return i("el-option",{key:t.id,attrs:{label:t.building,value:t.id}})}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("LocationIndoorHis.floor")}},[i("el-select",{staticStyle:{width:"80%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("LocationIndoorHis.text1")},model:{value:t.searchList.groundid,callback:function(e){t.$set(t.searchList,"groundid",e)},expression:"searchList.groundid"}},t._l(t.groundList,function(t){return i("el-option",{key:t.id,attrs:{label:t.ground,value:t.id}})}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex","margin-left":"0%","margin-right":"0"},attrs:{label:t.$t("LocationIndoorHis.time")}},[i("el-date-picker",{staticStyle:{width:"85%","margin-left":"-15%"},attrs:{type:"datetimerange","picker-options":t.pickerOptions,"range-separator":t.$t("LocationIndoorHis.to"),"start-placeholder":t.$t("LocationIndoorHis.starttime"),"end-placeholder":t.$t("LocationIndoorHis.endtime")},model:{value:t.tasktime,callback:function(e){t.tasktime=e},expression:"tasktime"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n              "+t._s(t.$t("LocationIndoorHis.text3"))+" "),i("br"),t._v("\n              "+t._s(t.$t("LocationIndoorHis.text4"))+"\n            ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-left":"0%"}},[i("el-button",{staticClass:"querry",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("terminal.search")))]),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("terminal.reset")))])],1)],1)],1),t._v(" "),i("div",[i("el-table",{staticClass:"tableData",staticStyle:{width:"97%","text-align":"center"},attrs:{data:t.tableData,border:"","max-height":"660","highlight-current-row":""}},[i("el-table-column",{attrs:{property:"username",label:t.$t("LocationIndoorHis.Name"),"show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{property:"deveui",label:t.$t("LocationIndoorHis.deveui"),"show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{property:"building",label:t.$t("LocationIndoorHis.building"),"min-width":"50","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{property:"ground",label:t.$t("LocationIndoorHis.Floor"),"min-width":"30","show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{property:"tranche",label:t.$t("LocationIndoorHis.area"),"show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{property:"devtypestr",label:t.$t("LocationIndoorHis.DeviceType"),"show-overflow-tooltip":""}}),t._v(" "),i("el-table-column",{attrs:{property:"gpstime",label:t.$t("LocationIndoorHis.Positioningtime"),"show-overflow-tooltip":"",formatter:t.formatDateGpstime}})],1),t._v(" "),i("div",{staticClass:"block",staticStyle:{"text-align":"center",width:"100%","margin-top":"1%"}},[i("el-pagination",{attrs:{"current-page":t.currentPage1,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-size":20},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})],1)],1)])},staticRenderFns:[]};var d=i("VU/8")(c,u,!1,function(t){i("BADC")},"data-v-4006e480",null);e.default=d.exports}});
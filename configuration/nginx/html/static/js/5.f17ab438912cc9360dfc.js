webpackJsonp([5],{"/Wqo":function(t,e,n){var i;i=function(){return e=[function(t,e,n){"use strict";n.r(e);for(var i=[],r=0;r<256;r++)i[r]=(r<16?"0":"")+r.toString(16);var o={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(i[255&t]+i[t>>8&255]+i[t>>16&255]+i[t>>24&255]+"-"+i[255&e]+i[e>>8&255]+"-"+i[e>>16&15|64]+i[e>>24&255]+"-"+i[63&n|128]+i[n>>8&255]+"-"+i[n>>16&255]+i[n>>24&255]+i[255&r]+i[r>>8&255]+i[r>>16&255]+i[r>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*o.DEG2RAD},radToDeg:function(t){return t*o.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var o=Math.cos,s=Math.sin,a=o(n/2),A=(n=s(n/2),o((e+i)/2)),l=s((e+i)/2),u=o((e-i)/2),h=s((e-i)/2);o=o((i-e)/2),s=s((i-e)/2);"XYX"===r?t.set(a*l,n*u,n*h,a*A):"YZY"===r?t.set(n*h,a*l,n*u,a*A):"ZXZ"===r?t.set(n*u,n*h,a*l,a*A):"XZX"===r?t.set(a*l,n*s,n*o,a*A):"YXY"===r?t.set(n*o,a*l,n*s,a*A):"ZYZ"===r&&t.set(n*s,n*o,a*l,a*A)}};function s(t,e,n,i){this.u=t||0,this.v=e||0,this.M=n||0,this.A=void 0!==i?i:1}Object.assign(s,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,s){var a,A,l,u=n[i+0],h=n[i+1],c=n[i+2],f=(n=n[i+3],i=r[o+0],r[o+1]),p=r[o+2];n===(r=r[o+3])&&u===i&&h===f&&c===p||(o=1-s,a=0<=(A=u*i+h*f+c*p+n*r)?1:-1,(l=1-A*A)>Number.EPSILON&&(l=Math.sqrt(l),A=Math.atan2(l,A*a),o=Math.sin(o*A)/l,s=Math.sin(s*A)/l),u=u*o+i*(A=s*a),h=h*o+f*A,c=c*o+p*A,n=n*o+r*A,o===1-s&&(u*=l=1/Math.sqrt(u*u+h*h+c*c+n*n),h*=l,c*=l,n*=l)),t[e]=u,t[e+1]=h,t[e+2]=c,t[e+3]=n}}),Object.defineProperties(s.prototype,{x:{get:function(){return this.u},set:function(t){this.u=t,this.S()}},y:{get:function(){return this.v},set:function(t){this.v=t,this.S()}},z:{get:function(){return this.M},set:function(t){this.M=t,this.S()}},w:{get:function(){return this.A},set:function(t){this.A=t,this.S()}}}),Object.assign(s.prototype,{isQuaternion:!0,set:function(t,e,n,i){return this.u=t,this.v=e,this.M=n,this.A=i,this.S(),this},clone:function(){return new this.constructor(this.u,this.v,this.M,this.A)},copy:function(t){return this.u=t.x,this.v=t.y,this.M=t.z,this.A=t.w,this.S(),this},setFromEuler:function(t,e){var n,i,r,o,s,a,A;if(t&&t.isEuler)return s=t.u,a=t.v,n=t.M,t=t.order,o=Math.cos,A=Math.sin,i=o(s/2),r=o(a/2),o=o(n/2),s=A(s/2),a=A(a/2),A=A(n/2),"XYZ"===t?(this.u=s*r*o+i*a*A,this.v=i*a*o-s*r*A,this.M=i*r*A+s*a*o,this.A=i*r*o-s*a*A):"YXZ"===t?(this.u=s*r*o+i*a*A,this.v=i*a*o-s*r*A,this.M=i*r*A-s*a*o,this.A=i*r*o+s*a*A):"ZXY"===t?(this.u=s*r*o-i*a*A,this.v=i*a*o+s*r*A,this.M=i*r*A+s*a*o,this.A=i*r*o-s*a*A):"ZYX"===t?(this.u=s*r*o-i*a*A,this.v=i*a*o+s*r*A,this.M=i*r*A-s*a*o,this.A=i*r*o+s*a*A):"YZX"===t?(this.u=s*r*o+i*a*A,this.v=i*a*o+s*r*A,this.M=i*r*A-s*a*o,this.A=i*r*o-s*a*A):"XZY"===t&&(this.u=s*r*o-i*a*A,this.v=i*a*o-s*r*A,this.M=i*r*A+s*a*o,this.A=i*r*o+s*a*A),!1!==e&&this.S(),this;throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")},setFromAxisAngle:function(t,e){e/=2;var n=Math.sin(e);return this.u=t.x*n,this.v=t.y*n,this.M=t.z*n,this.A=Math.cos(e),this.S(),this},setFromRotationMatrix:function(t){var e,n=(t=t.elements)[0],i=t[4],r=t[8],o=t[1],s=t[5],a=t[9],A=t[2],l=t[6],u=n+s+(t=t[10]);return 0<u?(e=.5/Math.sqrt(u+1),this.A=.25/e,this.u=(l-a)*e,this.v=(r-A)*e,this.M=(o-i)*e):s<n&&t<n?(e=2*Math.sqrt(1+n-s-t),this.A=(l-a)/e,this.u=.25*e,this.v=(i+o)/e,this.M=(r+A)/e):t<s?(e=2*Math.sqrt(1+s-n-t),this.A=(r-A)/e,this.u=(i+o)/e,this.v=.25*e,this.M=(a+l)/e):(e=2*Math.sqrt(1+t-n-s),this.A=(o-i)/e,this.u=(r+A)/e,this.v=(a+l)/e,this.M=.25*e),this.S(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.u=-t.y,this.v=t.x,this.M=0):(this.u=0,this.v=-t.z,this.M=t.y)):(this.u=t.y*e.z-t.z*e.y,this.v=t.z*e.x-t.x*e.z,this.M=t.x*e.y-t.y*e.x),this.A=n,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(o.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);return 0!==n&&(e=Math.min(1,e/n),this.slerp(t,e)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.u*=-1,this.v*=-1,this.M*=-1,this.S(),this},dot:function(t){return this.u*t.u+this.v*t.v+this.M*t.M+this.A*t.A},lengthSq:function(){return this.u*this.u+this.v*this.v+this.M*this.M+this.A*this.A},length:function(){return Math.sqrt(this.u*this.u+this.v*this.v+this.M*this.M+this.A*this.A)},normalize:function(){var t=this.length();return 0===t?(this.u=0,this.v=0,this.M=0,this.A=1):(this.u=this.u*(t=1/t),this.v=this.v*t,this.M=this.M*t,this.A=this.A*t),this.S(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t.u,i=t.v,r=t.M,o=(t=t.A,e.u),s=e.v,a=e.M;e=e.A;return this.u=n*e+t*o+i*a-r*s,this.v=i*e+t*s+r*o-n*a,this.M=r*e+t*a+n*s-i*o,this.A=t*e-n*o-i*s-r*a,this.S(),this},slerp:function(t,e){if(0!==e){if(1===e)return this.copy(t);var n,i=this.u,r=this.v,o=this.M,s=this.A,a=s*t.A+i*t.u+r*t.v+o*t.M;a<0?(this.A=-t.A,this.u=-t.u,this.v=-t.v,this.M=-t.M,a=-a):this.copy(t),1<=a?(this.A=s,this.u=i,this.v=r,this.M=o):((t=1-a*a)<=Number.EPSILON?(this.A=(n=1-e)*s+e*this.A,this.u=n*i+e*this.u,this.v=n*r+e*this.v,this.M=n*o+e*this.M,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,a),a=Math.sin((1-e)*t)/n,e=Math.sin(e*t)/n,this.A=s*a+this.A*e,this.u=i*a+this.u*e,this.v=r*a+this.v*e,this.M=o*a+this.M*e),this.S())}return this},equals:function(t){return t.u===this.u&&t.v===this.v&&t.M===this.M&&t.A===this.A},fromArray:function(t,e){return this.u=t[e=void 0===e?0:e],this.v=t[e+1],this.M=t[e+2],this.A=t[e+3],this.S(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.u,t[e+1]=this.v,t[e+2]=this.M,t[e+3]=this.A,t},fromBufferAttribute:function(t,e){return this.u=t.getX(e),this.v=t.getY(e),this.M=t.getZ(e),this.A=t.getW(e),this},R:function(t){return this.S=t,this},S:function(){}});var a=new l,A=new s;function l(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(l.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler,this.applyQuaternion(A.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(A.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=1/((t=t.elements)[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=(t=t.w)*e+o*i-s*n,A=t*n+s*e-r*i,l=t*i+r*n-o*e;e=-r*e-o*n-s*i;return this.x=a*t+e*-r+A*-s-l*-o,this.y=A*t+e*-o+l*-r-a*-s,this.z=l*t+e*-s+a*-o-A*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y,r=(t=t.z,e.x),o=e.y;e=e.z;return this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this},projectOnVector:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))},projectOnPlane:function(t){return a.copy(this).projectOnVector(t),this.sub(a)},reflect:function(t){return this.sub(a.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(o.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var u=new l,h=new m,c=new l(0,0,0),f=new l(1,1,1),p=new l,d=new l,y=new l;function m(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length}function g(){this.type="Curve",this.arcLengthDivisions=200}function v(t,e){this.x=t||0,this.y=e||0}function b(t,e,n,i,r,o,s,a){g.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}Object.assign(m.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,s,a,A,l,u,h,c,f,p,d){var y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=i,y[1]=r,y[5]=o,y[9]=s,y[13]=a,y[2]=A,y[6]=l,y[10]=u,y[14]=h,y[3]=c,y[7]=f,y[11]=p,y[15]=d,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new m).fromArray(this.elements)},copy:function(t){var e=this.elements;t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,i=1/u.setFromMatrixColumn(t,0).length(),r=1/u.setFromMatrixColumn(t,1).length();t=1/u.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler;var e,n,i,r,o,s,a,A,l,u,h,c,f=this.elements,p=t.x,d=t.y,y=t.z,m=Math.cos(p),g=(p=Math.sin(p),Math.cos(d)),v=(d=Math.sin(d),Math.cos(y));y=Math.sin(y);return"XYZ"===t.order?(o=m*v,s=m*y,a=p*v,A=p*y,f[0]=g*v,f[4]=-g*y,f[8]=d,f[1]=s+a*d,f[5]=o-A*d,f[9]=-p*g,f[2]=A-o*d,f[6]=a+s*d,f[10]=m*g):"YXZ"===t.order?(n=g*y,i=d*v,f[0]=(e=g*v)+(r=d*y)*p,f[4]=i*p-n,f[8]=m*d,f[1]=m*y,f[5]=m*v,f[9]=-p,f[2]=n*p-i,f[6]=r+e*p,f[10]=m*g):"ZXY"===t.order?(n=g*y,i=d*v,f[0]=(e=g*v)-(r=d*y)*p,f[4]=-m*y,f[8]=i+n*p,f[1]=n+i*p,f[5]=m*v,f[9]=r-e*p,f[2]=-m*d,f[6]=p,f[10]=m*g):"ZYX"===t.order?(o=m*v,s=m*y,a=p*v,A=p*y,f[0]=g*v,f[4]=a*d-s,f[8]=o*d+A,f[1]=g*y,f[5]=A*d+o,f[9]=s*d-a,f[2]=-d,f[6]=p*g,f[10]=m*g):"YZX"===t.order?(l=m*g,u=m*d,h=p*g,c=p*d,f[0]=g*v,f[4]=c-l*y,f[8]=h*y+u,f[1]=y,f[5]=m*v,f[9]=-p*v,f[2]=-d*v,f[6]=u*y+h,f[10]=l-c*y):"XZY"===t.order&&(l=m*g,u=m*d,h=p*g,c=p*d,f[0]=g*v,f[4]=-y,f[8]=d*v,f[1]=l*y+c,f[5]=m*v,f[9]=u*y-h,f[2]=h*y-u,f[6]=p*v,f[10]=c*y+l),f[3]=0,f[7]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(c,t,f)},lookAt:function(t,e,n){var i=this.elements;return y.subVectors(t,e),0===y.lengthSq()&&(y.z=1),y.normalize(),p.crossVectors(n,y),0===p.lengthSq()&&(1===Math.abs(n.z)?y.x+=1e-4:y.z+=1e-4,y.normalize(),p.crossVectors(n,y)),p.normalize(),d.crossVectors(y,p),i[0]=p.x,i[4]=d.x,i[8]=y.x,i[1]=p.y,i[5]=d.y,i[9]=y.y,i[2]=p.z,i[6]=d.z,i[10]=y.z,this},multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){t=t.elements,e=e.elements;var n=this.elements,i=t[0],r=t[4],o=t[8],s=t[12],a=t[1],A=t[5],l=t[9],u=t[13],h=t[2],c=t[6],f=t[10],p=t[14],d=t[3],y=t[7],m=t[11],g=(t=t[15],e[0]),v=e[4],b=e[8],x=e[12],w=e[1],B=e[5],M=e[9],S=e[13],_=e[2],E=e[6],T=e[10],C=e[14],F=e[3],O=e[7],P=e[11];e=e[15];return n[0]=i*g+r*w+o*_+s*F,n[4]=i*v+r*B+o*E+s*O,n[8]=i*b+r*M+o*T+s*P,n[12]=i*x+r*S+o*C+s*e,n[1]=a*g+A*w+l*_+u*F,n[5]=a*v+A*B+l*E+u*O,n[9]=a*b+A*M+l*T+u*P,n[13]=a*x+A*S+l*C+u*e,n[2]=h*g+c*w+f*_+p*F,n[6]=h*v+c*B+f*E+p*O,n[10]=h*b+c*M+f*T+p*P,n[14]=h*x+c*S+f*C+p*e,n[3]=d*g+y*w+m*_+t*F,n[7]=d*v+y*B+m*E+t*O,n[11]=d*b+y*M+m*T+t*P,n[15]=d*x+y*S+m*C+t*e,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],s=t[5],a=t[9],A=t[13],l=t[2],u=t[6],h=t[10],c=t[14];return t[3]*(+r*a*u-i*A*u-r*s*h+n*A*h+i*s*c-n*a*c)+t[7]*(+e*a*c-e*A*h+r*o*h-i*o*c+i*A*l-r*a*l)+t[11]*(+e*A*u-e*s*c-r*o*u+n*o*c+r*s*l-n*A*l)+t[15]*(-i*s*l-e*a*u+e*s*h+i*o*u-n*o*h+n*a*l)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this},getInverse:function(t,e){e=this.elements;var n=(t=t.elements)[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],A=t[6],l=t[7],u=t[8],h=t[9],c=t[10],f=t[11],p=t[12],d=t[13],y=t[14],m=h*y*l-d*c*l+d*A*f-a*y*f-h*A*(t=t[15])+a*c*t,g=p*c*l-u*y*l-p*A*f+s*y*f+u*A*t-s*c*t,v=u*d*l-p*h*l+p*a*f-s*d*f-u*a*t+s*h*t,b=p*h*A-u*d*A-p*a*c+s*d*c+u*a*y-s*h*y,x=n*m+i*g+r*v+o*b;return 0==x?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(e[0]=m*(m=1/x),e[1]=(d*c*o-h*y*o-d*r*f+i*y*f+h*r*t-i*c*t)*m,e[2]=(a*y*o-d*A*o+d*r*l-i*y*l-a*r*t+i*A*t)*m,e[3]=(h*A*o-a*c*o-h*r*l+i*c*l+a*r*f-i*A*f)*m,e[4]=g*m,e[5]=(u*y*o-p*c*o+p*r*f-n*y*f-u*r*t+n*c*t)*m,e[6]=(p*A*o-s*y*o-p*r*l+n*y*l+s*r*t-n*A*t)*m,e[7]=(s*c*o-u*A*o+u*r*l-n*c*l-s*r*f+n*A*f)*m,e[8]=v*m,e[9]=(p*h*o-u*d*o-p*i*f+n*d*f+u*i*t-n*h*t)*m,e[10]=(s*d*o-p*a*o+p*i*l-n*d*l-s*i*t+n*a*t)*m,e[11]=(u*a*o-s*h*o-u*i*l+n*h*l+s*i*f-n*a*f)*m,e[12]=b*m,e[13]=(u*d*r-p*h*r+p*i*c-n*d*c-u*i*y+n*h*y)*m,e[14]=(p*a*r-s*d*r-p*i*A+n*d*A+s*i*y-n*a*y)*m,e[15]=(s*h*r-u*a*r+u*i*A-n*h*A-s*i*c+n*a*c)*m,this)},invert:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7],l=t[8],u=t[9],h=t[10],c=t[11],f=t[12],p=t[13],d=t[14],y=t[15],m=u*d*A-p*h*A+p*a*c-s*d*c-u*a*y+s*h*y,g=f*h*A-l*d*A-f*a*c+o*d*c+l*a*y-o*h*y,v=l*p*A-f*u*A+f*s*c-o*p*c-l*s*y+o*u*y,b=f*u*a-l*p*a-f*s*h+o*p*h+l*s*d-o*u*d,x=e*m+n*g+i*v+r*b;return 0==x?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(t[0]=m*(m=1/x),t[1]=(p*h*r-u*d*r-p*i*c+n*d*c+u*i*y-n*h*y)*m,t[2]=(s*d*r-p*a*r+p*i*A-n*d*A-s*i*y+n*a*y)*m,t[3]=(u*a*r-s*h*r-u*i*A+n*h*A+s*i*c-n*a*c)*m,t[4]=g*m,t[5]=(l*d*r-f*h*r+f*i*c-e*d*c-l*i*y+e*h*y)*m,t[6]=(f*a*r-o*d*r-f*i*A+e*d*A+o*i*y-e*a*y)*m,t[7]=(o*h*r-l*a*r+l*i*A-e*h*A-o*i*c+e*a*c)*m,t[8]=v*m,t[9]=(f*u*r-l*p*r-f*n*c+e*p*c+l*n*y-e*u*y)*m,t[10]=(o*p*r-f*s*r+f*n*A-e*p*A-o*n*y+e*s*y)*m,t[11]=(l*s*r-o*u*r-l*n*A+e*u*A+o*n*c-e*s*c)*m,t[12]=b*m,t[13]=(l*p*i-f*u*i+f*n*h-e*p*h-l*n*d+e*u*d)*m,t[14]=(f*s*i-o*p*i-f*n*a+e*p*a+o*n*d-e*s*d)*m,t[15]=(o*u*i-l*s*i+l*n*a-e*u*a-o*n*h+e*s*h)*m,this)},scale:function(t){var e=this.elements,n=t.x,i=t.y;t=t.z;return e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],e=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(t,e,n))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),1-n),r=t.x,o=t.y,s=(t=t.z,i*r),a=i*o;return this.set(s*r+n,s*o-e*t,s*t+e*o,0,s*o+e*t,a*o+n,a*t-e*r,0,s*t-e*o,a*t+e*r,i*t*t+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var i=this.elements,r=e.u,o=e.v,s=e.M,a=(e=e.A,r*(u=r+r)),A=r*(h=o+o),l=(r=r*(c=s+s),o*h),u=(o=o*c,s=s*c,e*u),h=e*h,c=(e=e*c,n.x),f=n.y;n=n.z;return i[0]=(1-(l+s))*c,i[1]=(A+e)*c,i[2]=(r-h)*c,i[3]=0,i[4]=(A-e)*f,i[5]=(1-(a+s))*f,i[6]=(o+u)*f,i[7]=0,i[8]=(r+h)*n,i[9]=(o-u)*n,i[10]=(1-(a+l))*n,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:function(t,e,n){var i=this.elements,r=u.set(i[0],i[1],i[2]).length(),o=u.set(i[4],i[5],i[6]).length(),s=u.set(i[8],i[9],i[10]).length(),a=(t=(this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],h.copy(this),1/r),i=1/o,1/s);return h.elements[0]*=t,h.elements[1]*=t,h.elements[2]*=t,h.elements[4]*=i,h.elements[5]*=i,h.elements[6]*=i,h.elements[8]*=a,h.elements[9]*=a,h.elements[10]*=a,e.setFromRotationMatrix(h),n.x=r,n.y=o,n.z=s,this},makePerspective:function(t,e,n,i,r,o){var s=this.elements,a=2*r/(n-i),A=(e+t)/(e-t);n=(n+i)/(n-i),i=-(o+r)/(o-r),o=-2*o*r/(o-r);return s[0]=2*r/(e-t),s[4]=0,s[8]=A,s[12]=0,s[1]=0,s[5]=a,s[9]=n,s[13]=0,s[2]=0,s[6]=0,s[10]=i,s[14]=o,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var s=this.elements,a=1/(e-t),A=1/(n-i),l=1/(o-r);e=(e+t)*a,t=(n+i)*A,n=(o+r)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-e,s[1]=0,s[5]=2*A,s[9]=0,s[13]=-t,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-n,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){var n=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(g.prototype,{getPoint:function(){return null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){for(var n,i=this.getLengths(),r=0,o=i.length,s=e||t*i[o-1],a=0,A=o-1;a<=A;)if((n=i[r=Math.floor(a+(A-a)/2)]-s)<0)a=r+1;else{if(!(0<n)){A=r;break}A=r-1}return i[r=A]===s?r/(o-1):(r+(s-(e=i[r]))/(i[r+1]-e))/(o-1)},getTangent:function(t){var e=t-1e-4;1<(t=t+1e-4)&&(t=1),e=this.getPoint(e=e<0?0:e);return this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){for(var n,i=new l,r=[],s=[],a=[],A=new l,u=new m,h=0;h<=t;h++)r[h]=this.getTangentAt(h/t),r[h].normalize();s[0]=new l,a[0]=new l;var c=Number.MAX_VALUE,f=Math.abs(r[0].x),p=Math.abs(r[0].y),d=Math.abs(r[0].z);for(f<=c&&(c=f,i.set(1,0,0)),p<=c&&(c=p,i.set(0,1,0)),d<=c&&i.set(0,0,1),A.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],A),a[0].crossVectors(r[0],s[0]),h=1;h<=t;h++)s[h]=s[h-1].clone(),a[h]=a[h-1].clone(),A.crossVectors(r[h-1],r[h]),A.length()>Number.EPSILON&&(A.normalize(),n=Math.acos(o.clamp(r[h-1].dot(r[h]),-1,1)),s[h].applyMatrix4(u.makeRotationAxis(A,n))),a[h].crossVectors(r[h],s[h]);if(!0===e)for(n=Math.acos(o.clamp(s[0].dot(s[t]),-1,1)),n/=t,0<r[0].dot(A.crossVectors(s[0],s[t]))&&(n=-n),h=1;h<=t;h++)s[h].applyMatrix4(u.makeRotationAxis(r[h],n*h)),a[h].crossVectors(r[h],s[h]);return{tangents:r,normals:s,binormals:a}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Object.defineProperties(v.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(v.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6],this.y=t[1]*e+t[4]*n+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),this.x-t.x),r=this.y-t.y;return this.x=i*n-r*e+t.x,this.y=i*e+r*n+t.y,this}}),((b.prototype=Object.create(g.prototype)).constructor=b).prototype.isEllipseCurve=!0,b.prototype.getPoint=function(t,e){e=e||new v;for(var n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,r=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;n<i;)i-=n;i<Number.EPSILON&&(i=r?0:n),!0!==this.aClockwise||r||(i===n?i=-n:i-=n);var o,s,a,A;r=this.aStartAngle+t*i,t=this.aX+this.xRadius*Math.cos(r),r=this.aY+this.yRadius*Math.sin(r);return 0!==this.aRotation&&(o=Math.cos(this.aRotation),s=Math.sin(this.aRotation),t=(a=t-this.aX)*o-(A=r-this.aY)*s+this.aX,r=a*s+A*o+this.aY),e.set(t,r)},b.prototype.copy=function(t){return g.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this};var x={FULL:0,DOTTED:2,DOT_DASH:4,CENTER:8,DASH:16,DOUBLE_DOT_DASH:32,TRI_DOT_DASH:64,FMARROW:128,ARROW:256},w=new l,B=new l,M=new l,S=new l,_=new l,E=new l,T=new l;function C(t,e){this.origin=void 0!==t?t:new l,this.direction=void 0!==e?e:new l(0,0,-1)}function F(){this.mask=1}function O(t,e,n,i){this.ray=new C(t,e),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new F,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})}function P(t,e){return t.distance-e.distance}function U(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i)for(var r=t.children,o=0,s=r.length;o<s;o++)U(r[o],e,n,!0)}Object.assign(C.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(e=new l),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,w)),this},closestPointToPoint:function(t,e){return void 0===e&&(e=new l),e.subVectors(t,this.origin),(t=e.dot(this.direction))<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=w.subVectors(t,this.origin).dot(this.direction);return(e<0?this.origin:(w.copy(this.direction).multiplyScalar(e).add(this.origin),w)).distanceToSquared(t)},distanceSqToSegment:function(t,e,n,i){B.copy(t).add(e).multiplyScalar(.5),M.copy(e).sub(t).normalize(),S.copy(this.origin).sub(B);t=.5*t.distanceTo(e),e=-this.direction.dot(M);var r,o,s,a=S.dot(this.direction),A=-S.dot(M),l=S.lengthSq(),u=Math.abs(1-e*e);return u=0<u?(o=e*a-A,s=t*u,0<=(r=e*A-a)?-s<=o?o<=s?(r*=u=1/u)*(r+e*(o*=u)+2*a)+o*(e*r+o+2*A)+l:(o=t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l):(o=-t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l):o<=-s?-(r=Math.max(0,-(-e*t+a)))*r+(o=0<r?-t:Math.min(Math.max(-t,-A),t))*(o+2*A)+l:o<=s?(r=0,(o=Math.min(Math.max(-t,-A),t))*(o+2*A)+l):-(r=Math.max(0,-(e*t+a)))*r+(o=0<r?t:Math.min(Math.max(-t,-A),t))*(o+2*A)+l):(o=0<e?-t:t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l),n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(M).multiplyScalar(o).add(B),u},intersectSphere:function(t,e){w.subVectors(t.center,this.origin);var n=w.dot(this.direction),i=w.dot(w)-n*n;return(t=t.radius*t.radius)<i||(i=n+(t=Math.sqrt(t-i)),(n-=t)<0&&i<0)?null:n<0?this.at(i,e):this.at(n,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,i,r,o=1/this.direction.x,s=1/this.direction.y,a=1/this.direction.z,A=this.origin;o=0<=o?(n=(t.min.x-A.x)*o,(t.max.x-A.x)*o):(n=(t.max.x-A.x)*o,(t.min.x-A.x)*o);return(s=0<=s?(r=(t.min.y-A.y)*s,(t.max.y-A.y)*s):(r=(t.max.y-A.y)*s,(t.min.y-A.y)*s))<n||o<r||((n<r||n!=n)&&(n=r),(s<o||o!=o)&&(o=s),(r=0<=a?(i=(t.min.z-A.z)*a,(t.max.z-A.z)*a):(i=(t.max.z-A.z)*a,(t.min.z-A.z)*a))<n)||o<i||((n<i||n!=n)&&(n=i),(o=r<o||o!=o?r:o)<0)?null:this.at(0<=n?n:o,e)},intersectsBox:function(t){return null!==this.intersectBox(t,w)},intersectTriangle:function(t,e,n,i,r){var o;if(_.subVectors(e,t),E.subVectors(n,t),T.crossVectors(_,E),0<(e=this.direction.dot(T))){if(i)return null;o=1}else{if(!(e<0))return null;o=-1,e=-e}return S.subVectors(this.origin,t),(n=o*this.direction.dot(E.crossVectors(S,E)))<0||(i=o*this.direction.dot(_.cross(S)))<0||e<n+i||(t=-o*S.dot(T))<0?null:this.at(t/e,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(F.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(O.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)},intersectObject:function(t,e,n){return U(t,this,n=n||[],e),n.sort(P),n},intersectObjects:function(t,e,n){var i=n||[];if(!1===Array.isArray(t));else{for(var r=0,o=t.length;r<o;r++)U(t[r],this,i,e);i.sort(P)}return i}});var R={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},I={h:0,s:0,l:0},L={h:0,s:0,l:0};function D(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function Q(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function k(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function N(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}Object.assign(D.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){return t=o.euclideanModulo(t,1),e=o.clamp(e,0,1),n=o.clamp(n,0,1),0===e?this.r=this.g=this.b=n:(this.r=Q(e=2*n-(n=n<=.5?n*(1+e):n+e-n*e),n,t+1/3),this.g=Q(e,n,t),this.b=Q(e,n,t-1/3)),this},setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}if(A=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,i,r,o,s=A[1],a=A[2];switch(s){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return i=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100,e(n[5]),this.setHSL(i,r,o)}}else if(A=/^\#([A-Fa-f0-9]+)$/.exec(t)){var A=(s=A[1]).length;if(3===A)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===A)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var e=R[t];return void 0!==e&&this.setHex(e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return e=0<(e=void 0===e?2:e)?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=k(t.r),this.g=k(t.g),this.b=k(t.b),this},copyLinearToSRGB:function(t){return this.r=N(t.r),this.g=N(t.g),this.b=N(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var e,n=this.r,i=this.g,r=this.b,o=Math.max(n,i,r),s=Math.min(n,i,r),a=(s+o)/2;if(s===o)l=e=0;else{var A=o-s,l=a<=.5?A/(o+s):A/(2-o-s);switch(o){case n:e=(i-r)/A+(i<r?6:0);break;case i:e=(r-n)/A+2;break;case r:e=(n-i)/A+4}e/=6}return t.h=e,t.s=l,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(I),I.h+=t,I.s+=e,I.l+=n,this.setHSL(I.h,I.s,I.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(I),t.getHSL(L);t=o.lerp(I.h,L.h,e);var n=o.lerp(I.s,L.s,e);e=o.lerp(I.l,L.l,e);return this.setHSL(t,n,e),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return this.r=t[e=void 0===e?0:e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}}),D.NAMES=R;var j=[new l,new l,new l,new l,new l,new l,new l,new l],H=new l,z=new tt,V=new l,G=new l,Y=new l,K=new l,X=new l,W=new l,Z=new l,q=new l,J=new l,$=new l;function tt(t,e){this.min=void 0!==t?t:new l(1/0,1/0,1/0),this.max=void 0!==e?e:new l(-1/0,-1/0,-1/0)}function et(t,e,n,i,r){for(var o=0,s=t.length-3;o<=s;o+=3){$.fromArray(t,o);var a=r.x*Math.abs($.x)+r.y*Math.abs($.y)+r.z*Math.abs($.z),A=e.dot($),l=n.dot($),u=i.dot($);if(Math.max(-Math.max(A,l,u),Math.min(A,l,u))>a)return!1}return!0}function nt(){}function it(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}Object.assign(tt.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,A=t.length;a<A;a+=3){var l=t[a],u=t[a+1],h=t[a+2];l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),s<h&&(s=h)}return this.min.set(e,n,i),this.max.set(r,o,s),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,A=t.count;a<A;a++){var l=t.getX(a),u=t.getY(a),h=t.getZ(a);l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),s<h&&(s=h)}return this.min.set(e,n,i),this.max.set(r,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=H.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(t=new l),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new l),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);for(var e=t.geometry,n=(void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),z.copy(e.boundingBox),z.applyMatrix4(t.matrixWorld),this.union(z)),t.children),i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(e=new l),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,H),H.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(Z),q.subVectors(this.max,Z),V.subVectors(t.a,Z),G.subVectors(t.b,Z),Y.subVectors(t.c,Z),K.subVectors(G,V),X.subVectors(Y,G),W.subVectors(V,Y),!!et([0,-K.z,K.y,0,-X.z,X.y,0,-W.z,W.y,K.z,0,-K.x,X.z,0,-X.x,W.z,0,-W.x,-K.y,K.x,0,-X.y,X.x,0,-W.y,W.x,0],V,G,Y,q))&&!!et([1,0,0,0,1,0,0,0,1],V,G,Y,q)&&(J.crossVectors(K,X),et([J.x,J.y,J.z],V,G,Y,q))},clampPoint:function(t,e){return void 0===e&&(e=new l),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return H.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return this.getCenter(t.center),t.radius=.5*this.getSize(H).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(j[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),j[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),j[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),j[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),j[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),j[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),j[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),j[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(j)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(nt.prototype,{addEventListener:function(t,e){void 0===this.j&&(this.j={});var n=this.j;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){var n;return void 0!==this.j&&void 0!==(n=this.j)[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){var n;void 0!==this.j&&void 0!==(t=this.j[t])&&-1!==(n=t.indexOf(e))&&t.splice(n,1)},dispatchEvent:function(t){if(void 0!==this.j){var e=this.j[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t)}}}}),Object.defineProperties(it.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(it.prototype,{isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i+t[12]*r,this.y=t[1]*e+t[5]*n+t[9]*i+t[13]*r,this.z=t[2]*e+t[6]*n+t[10]*i+t[14]*r,this.w=t[3]*e+t[7]*n+t[11]*i+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o,s,a,A,l,u,h=(t=t.elements)[0],c=t[4],f=t[8],p=t[1],d=t[5],y=t[9],m=t[2],g=t[6];t=t[10];return Math.abs(c-p)<.01&&Math.abs(f-m)<.01&&Math.abs(y-g)<.01?Math.abs(c+p)<.1&&Math.abs(f+m)<.1&&Math.abs(y+g)<.1&&Math.abs(h+d+t-3)<.1?this.set(1,0,0,0):(r=Math.PI,s=(t+1)/2,a=(c+p)/4,A=(f+m)/4,l=(y+g)/4,(o=(d+1)/2)<(u=(h+1)/2)&&s<u?i=u<.01?(e=0,n=.707106781):(n=a/(e=Math.sqrt(u)),A/e):s<o?i=o<.01?(n=0,e=.707106781):(e=a/(n=Math.sqrt(o)),l/n):s<.01?(n=e=.707106781,i=0):(e=A/(i=Math.sqrt(s)),n=l/i),this.set(e,n,i,r)):(u=Math.sqrt((g-y)*(g-y)+(f-m)*(f-m)+(p-c)*(p-c)),Math.abs(u)<.001&&(u=1),this.x=(g-y)/u,this.y=(f-m)/u,this.z=(p-c)/u,this.w=Math.acos((h+d+t-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}});var rt=new l;function ot(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function st(t,e,n){ot.call(this,new Int8Array(t),e,n)}function at(t,e,n){ot.call(this,new Uint8Array(t),e,n)}function At(t,e,n){ot.call(this,new Uint8ClampedArray(t),e,n)}function lt(t,e,n){ot.call(this,new Int16Array(t),e,n)}function ut(t,e,n){ot.call(this,new Uint16Array(t),e,n)}function ht(t,e,n){ot.call(this,new Int32Array(t),e,n)}function ct(t,e,n){ot.call(this,new Uint32Array(t),e,n)}function ft(t,e,n){ot.call(this,new Float32Array(t),e,n)}function pt(t,e,n){ot.call(this,new Float64Array(t),e,n)}Object.defineProperty(ot.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ot.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new D),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new v),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new l),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new it),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)rt.x=this.getX(e),rt.y=this.getY(e),rt.z=this.getZ(e),rt.applyMatrix3(t),this.setXYZ(e,rt.x,rt.y,rt.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)rt.x=this.getX(e),rt.y=this.getY(e),rt.z=this.getZ(e),rt.applyMatrix4(t),this.setXYZ(e,rt.x,rt.y,rt.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)rt.x=this.getX(e),rt.y=this.getY(e),rt.z=this.getZ(e),rt.applyNormalMatrix(t),this.setXYZ(e,rt.x,rt.y,rt.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)rt.x=this.getX(e),rt.y=this.getY(e),rt.z=this.getZ(e),rt.transformDirection(t),this.setXYZ(e,rt.x,rt.y,rt.z);return this},set:function(t,e){return this.array.set(t,e=void 0===e?0:e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(st.prototype=Object.create(ot.prototype)).constructor=st,(at.prototype=Object.create(ot.prototype)).constructor=at,(At.prototype=Object.create(ot.prototype)).constructor=At,(lt.prototype=Object.create(ot.prototype)).constructor=lt,ut.prototype=Object.create(ot.prototype),ut.prototype.constructor=ut,(ht.prototype=Object.create(ot.prototype)).constructor=ht,ct.prototype=Object.create(ot.prototype),ct.prototype.constructor=ct,(ft.prototype=Object.create(ot.prototype)).constructor=ft,(pt.prototype=Object.create(ot.prototype)).constructor=pt;var dt=new tt;function yt(t,e){this.center=void 0!==t?t:new l,this.radius=void 0!==e?e:0}function mt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(yt.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){for(var n=this.center,i=(void 0!==e?n.copy(e):dt.setFromPoints(t).getCenter(n),0),r=0,o=t.length;r<o;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(e=new l),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(t=new tt),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(mt.prototype,{computeGroups:function(t){for(var e,n=[],i=void 0,r=t.faces,o=0;o<r.length;o++){var s=r[o];s.materialIndex!==i&&(i=s.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&0<i[0].length,o=i[1]&&0<i[1].length,s=t.morphTargets,a=s.length;if(0<a){for(var A=[],l=0;l<a;l++)A[l]={name:s[l].name,data:[]};this.morphTargets.position=A}var u=t.morphNormals,h=u.length;if(0<h){var c=[];for(l=0;l<h;l++)c[l]={name:u[l].name,data:[]};this.morphTargets.normal=c}var f=t.skinIndices,p=t.skinWeights,d=f.length===n.length,y=p.length===n.length;for(0<n.length&&e.length,l=0;l<e.length;l++){var m,g,b=e[l];3===(g=(3===(g=(this.vertices.push(n[b.a],n[b.b],n[b.c]),b.vertexNormals)).length?this.normals.push(g[0],g[1],g[2]):(g=b.normal,this.normals.push(g,g,g)),b.vertexColors)).length?this.colors.push(g[0],g[1],g[2]):(g=b.color,this.colors.push(g,g,g)),!0===r&&(void 0!==(m=i[0][l])?this.uvs.push(m[0],m[1],m[2]):this.uvs.push(new v,new v,new v)),!0===o&&(void 0!==(m=i[1][l])?this.uvs2.push(m[0],m[1],m[2]):this.uvs2.push(new v,new v,new v));for(var x=0;x<a;x++){var w=s[x].vertices;A[x].data.push(w[b.a],w[b.b],w[b.c])}for(x=0;x<h;x++){var B=u[x].vertexNormals[l];c[x].data.push(B.a,B.b,B.c)}d&&this.skinIndices.push(f[b.a],f[b.b],f[b.c]),y&&this.skinWeights.push(p[b.a],p[b.b],p[b.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var gt=new m,vt=new s;function bt(t,e,n,i){this.u=t||0,this.v=e||0,this.M=n||0,this.O=i||bt.DefaultOrder}function xt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length}bt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],bt.DefaultOrder="XYZ",Object.defineProperties(bt.prototype,{x:{get:function(){return this.u},set:function(t){this.u=t,this.S()}},y:{get:function(){return this.v},set:function(t){this.v=t,this.S()}},z:{get:function(){return this.M},set:function(t){this.M=t,this.S()}},order:{get:function(){return this.O},set:function(t){this.O=t,this.S()}}}),Object.assign(bt.prototype,{isEuler:!0,set:function(t,e,n,i){return this.u=t,this.v=e,this.M=n,this.O=i||this.O,this.S(),this},clone:function(){return new this.constructor(this.u,this.v,this.M,this.O)},copy:function(t){return this.u=t.u,this.v=t.v,this.M=t.M,this.O=t.O,this.S(),this},setFromRotationMatrix:function(t,e,n){var i=o.clamp,r=(t=t.elements)[0],s=t[4],a=t[8],A=t[1],l=t[5],u=t[9],h=t[2],c=t[6];t=t[10];return"XYZ"===(e=e||this.O)?(this.v=Math.asin(i(a,-1,1)),Math.abs(a)<.9999999?(this.u=Math.atan2(-u,t),this.M=Math.atan2(-s,r)):(this.u=Math.atan2(c,l),this.M=0)):"YXZ"===e?(this.u=Math.asin(-i(u,-1,1)),Math.abs(u)<.9999999?(this.v=Math.atan2(a,t),this.M=Math.atan2(A,l)):(this.v=Math.atan2(-h,r),this.M=0)):"ZXY"===e?(this.u=Math.asin(i(c,-1,1)),Math.abs(c)<.9999999?(this.v=Math.atan2(-h,t),this.M=Math.atan2(-s,l)):(this.v=0,this.M=Math.atan2(A,r))):"ZYX"===e?(this.v=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this.u=Math.atan2(c,t),this.M=Math.atan2(A,r)):(this.u=0,this.M=Math.atan2(-s,l))):"YZX"===e?(this.M=Math.asin(i(A,-1,1)),Math.abs(A)<.9999999?(this.u=Math.atan2(-u,l),this.v=Math.atan2(-h,r)):(this.u=0,this.v=Math.atan2(a,t))):"XZY"===e&&(this.M=Math.asin(-i(s,-1,1)),Math.abs(s)<.9999999?(this.u=Math.atan2(c,l),this.v=Math.atan2(a,r)):(this.u=Math.atan2(-u,t),this.v=0)),this.O=e,!1!==n&&this.S(),this},setFromQuaternion:function(t,e,n){return gt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(gt,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this.O)},reorder:function(t){return vt.setFromEuler(this),this.setFromQuaternion(vt,t)},equals:function(t){return t.u===this.u&&t.v===this.v&&t.M===this.M&&t.O===this.O},fromArray:function(t){return this.u=t[0],this.v=t[1],this.M=t[2],void 0!==t[3]&&(this.O=t[3]),this.S(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.u,t[e+1]=this.v,t[e+2]=this.M,t[e+3]=this.O,t},toVector3:function(t){return t?t.set(this.u,this.v,this.M):new l(this.u,this.v,this.M)},R:function(t){return this.S=t,this},S:function(){}}),Object.assign(xt.prototype,{isMatrix3:!0,set:function(t,e,n,i,r,o,s,a,A){var l=this.elements;return l[0]=t,l[1]=i,l[2]=s,l[3]=e,l[4]=r,l[5]=a,l[6]=n,l[7]=o,l[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){t=t.elements,e=e.elements;var n=this.elements,i=t[0],r=t[3],o=t[6],s=t[1],a=t[4],A=t[7],l=t[2],u=t[5],h=(t=t[8],e[0]),c=e[3],f=e[6],p=e[1],d=e[4],y=e[7],m=e[2],g=e[5];e=e[8];return n[0]=i*h+r*p+o*m,n[3]=i*c+r*d+o*g,n[6]=i*f+r*y+o*e,n[1]=s*h+a*p+A*m,n[4]=s*c+a*d+A*g,n[7]=s*f+a*y+A*e,n[2]=l*h+u*p+t*m,n[5]=l*c+u*d+t*g,n[8]=l*f+u*y+t*e,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t,e=(t=this.elements)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7];return e*o*(t=t[8])-e*s*A-n*r*t+n*s*a+i*r*A-i*o*a},getInverse:function(t,e){e=t.elements,t=this.elements;var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],A=e[6],l=e[7],u=(e=e[8])*s-a*l,h=a*A-e*o,c=l*o-s*A,f=n*u+i*h+r*c;return 0==f?this.set(0,0,0,0,0,0,0,0,0):(t[0]=u*(u=1/f),t[1]=(r*l-e*i)*u,t[2]=(a*i-r*s)*u,t[3]=h*u,t[4]=(e*n-r*A)*u,t[5]=(r*o-a*n)*u,t[6]=c*u,t[7]=(i*A-l*n)*u,t[8]=(s*n-i*o)*u,this)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,i,r,o,s){var a=Math.cos(r);r=Math.sin(r);this.set(n*a,n*r,-n*(a*o+r*s)+o+t,-i*r,i*a,-i*(-r*o+a*s)+s+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=(t=Math.sin(t),this.elements),i=n[0],r=n[3],o=n[6],s=n[1],a=n[4],A=n[7];return n[0]=e*i+t*s,n[3]=e*r+t*a,n[6]=e*o+t*A,n[1]=-t*i+e*s,n[4]=-t*r+e*a,n[7]=-t*o+e*A,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){var n=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var wt=0,Bt=new l,Mt=new s,St=new m,_t=new l,Et=new l,Tt=new l,Ct=new s,Ft=new l(1,0,0),Ot=new l(0,1,0),Pt=new l(0,0,1),Ut={type:"added"},Rt={type:"removed"};function It(){Object.defineProperty(this,"id",{value:wt++}),this.uuid=o.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=It.DefaultUp.clone();var t=new l,e=new bt,n=new s,i=new l(1,1,1);e.R(function(){n.setFromEuler(e,!1)}),n.R(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new m},normalMatrix:{value:new xt}}),this.matrix=new m,this.matrixWorld=new m,this.matrixAutoUpdate=It.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new F,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}It.DefaultUp=new l(0,1,0),It.DefaultMatrixAutoUpdate=!0,It.prototype=Object.assign(Object.create(nt.prototype),{constructor:It,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Mt.setFromAxisAngle(t,e),this.quaternion.multiply(Mt),this},rotateOnWorldAxis:function(t,e){return Mt.setFromAxisAngle(t,e),this.quaternion.premultiply(Mt),this},rotateX:function(t){return this.rotateOnAxis(Ft,t)},rotateY:function(t){return this.rotateOnAxis(Ot,t)},rotateZ:function(t){return this.rotateOnAxis(Pt,t)},translateOnAxis:function(t,e){return Bt.copy(t).applyQuaternion(this.quaternion),this.position.add(Bt.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(Ft,t)},translateY:function(t){return this.translateOnAxis(Ot,t)},translateZ:function(t){return this.translateOnAxis(Pt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(St.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?_t.copy(t):_t.set(t,e,n),t=this.parent,this.updateWorldMatrix(!0,!1),Et.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?St.lookAt(Et,_t,this.up):St.lookAt(_t,Et,this.up),this.quaternion.setFromRotationMatrix(St),t&&(St.extractRotation(t.matrixWorld),Mt.setFromRotationMatrix(St),this.quaternion.premultiply(Mt.inverse()))},add:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.add(arguments[e]);else t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(Ut));return this},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);else{var n=this.children.indexOf(t);-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Rt))}return this},attach:function(t){return this.updateWorldMatrix(!0,!1),St.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),St.multiply(t.parent.matrixWorld)),t.applyMatrix4(St),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(t=new l),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(t=new s),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Et,t,Tt),t},getWorldScale:function(t){return void 0===t&&(t=new l),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Et,Ct,t),t},getWorldDirection:function(t){void 0===t&&(t=new l),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var i=this.children,r=0,o=i.length;r<o;r++)i[r].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}});var Lt=1,Dt=new m,Qt=new It,kt=new l,Nt=new tt,jt=new tt,Ht=new l;function zt(){Object.defineProperty(this,"id",{value:Lt+=2}),this.uuid=o.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}zt.prototype=Object.assign(Object.create(nt.prototype),{constructor:zt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<function(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}(t)?ct:ut)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e,n=(void 0!==(e=(void 0!==(e=this.attributes.position)&&(e.applyMatrix4(t),e.needsUpdate=!0),this.attributes.normal))&&(n=(new xt).getNormalMatrix(t),e.applyNormalMatrix(n),e.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Dt.makeRotationX(t),this.applyMatrix4(Dt),this},rotateY:function(t){return Dt.makeRotationY(t),this.applyMatrix4(Dt),this},rotateZ:function(t){return Dt.makeRotationZ(t),this.applyMatrix4(Dt),this},translate:function(t,e,n){return Dt.makeTranslation(t,e,n),this.applyMatrix4(Dt),this},scale:function(t,e,n){return Dt.makeScale(t,e,n),this.applyMatrix4(Dt),this},lookAt:function(t){return Qt.lookAt(t),Qt.updateMatrix(),this.applyMatrix4(Qt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(kt).negate(),this.translate(kt.x,kt.y,kt.z),this},setFromObject:function(t){var e,n,i=t.geometry;return t.isPoints||t.isLine?(n=new ft(3*i.vertices.length,3),e=new ft(3*i.colors.length,3),this.setAttribute("position",n.copyVector3sArray(i.vertices)),this.setAttribute("color",e.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length&&(n=new ft(i.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(i.lineDistances))),null!==i.boundingSphere&&(this.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(this.boundingBox=i.boundingBox.clone())):t.isMesh&&i&&i.isGeometry&&this.fromGeometry(i),this},setFromPoints:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new ft(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var i=n.T;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.T=(new mt).fromGeometry(t),this.fromDirectGeometry(t.T)},fromDirectGeometry:function(t){var e,n=new Float32Array(3*t.vertices.length);for(e in this.setAttribute("position",new ot(n,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(n=new Float32Array(3*t.normals.length),this.setAttribute("normal",new ot(n,3).copyVector3sArray(t.normals))),0<t.colors.length&&(n=new Float32Array(3*t.colors.length),this.setAttribute("color",new ot(n,3).copyColorsArray(t.colors))),0<t.uvs.length&&(n=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new ot(n,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(n=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new ot(n,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var i=[],r=t.morphTargets[e],o=0,s=r.length;o<s;o++){var a=r[o],A=new ft(3*a.data.length,3);A.name=a.name,i.push(A.copyVector3sArray(a.data))}this.morphAttributes[e]=i}return 0<t.skinIndices.length&&(n=new ft(4*t.skinIndices.length,4),this.setAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new ft(4*t.skinWeights.length,4),this.setAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new tt);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var r=e[n];Nt.setFromBufferAttribute(r),this.morphTargetsRelative?(Ht.addVectors(this.boundingBox.min,Nt.min),this.boundingBox.expandByPoint(Ht),Ht.addVectors(this.boundingBox.max,Nt.max),this.boundingBox.expandByPoint(Ht)):(this.boundingBox.expandByPoint(Nt.min),this.boundingBox.expandByPoint(Nt.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new yt);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(Nt.setFromBufferAttribute(t),e)for(var i=0,r=e.length;i<r;i++){var o=e[i];jt.setFromBufferAttribute(o),this.morphTargetsRelative?(Ht.addVectors(Nt.min,jt.min),Nt.expandByPoint(Ht),Ht.addVectors(Nt.max,jt.max),Nt.expandByPoint(Ht)):(Nt.expandByPoint(jt.min),Nt.expandByPoint(jt.max))}Nt.getCenter(n);var s=0;for(i=0,r=t.count;i<r;i++)Ht.fromBufferAttribute(t,i),s=Math.max(s,n.distanceToSquared(Ht));if(e)for(i=0,r=e.length;i<r;i++){o=e[i];for(var a=this.morphTargetsRelative,A=0,l=o.count;A<l;A++)Ht.fromBufferAttribute(o,A),a&&(kt.fromBufferAttribute(t,A),Ht.add(kt)),s=Math.max(s,n.distanceToSquared(Ht))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new ot(new Float32Array(n.length),3));else for(var i=e.normal.array,r=0,o=i.length;r<o;r++)i[r]=0;var s,a,A,u=e.normal.array,h=new l,c=new l,f=new l,p=new l,d=new l;if(t){var y=t.array;for(r=0,o=t.count;r<o;r+=3)s=3*y[r+0],a=3*y[r+1],A=3*y[r+2],h.fromArray(n,s),c.fromArray(n,a),f.fromArray(n,A),p.subVectors(f,c),d.subVectors(h,c),p.cross(d),u[s]+=p.x,u[1+s]+=p.y,u[2+s]+=p.z,u[a]+=p.x,u[1+a]+=p.y,u[2+a]+=p.z,u[A]+=p.x,u[1+A]+=p.y,u[2+A]+=p.z}else for(r=0,o=n.length;r<o;r+=9)h.fromArray(n,r),c.fromArray(n,r+3),f.fromArray(n,r+6),p.subVectors(f,c),d.subVectors(h,c),p.cross(d),u[r]=p.x,u[r+1]=p.y,u[r+2]=p.z,u[r+3]=p.x,u[r+4]=p.y,u[r+5]=p.z,u[r+6]=p.x,u[r+7]=p.y,u[r+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Ht.x=t.getX(e),Ht.y=t.getY(e),Ht.z=t.getZ(e),Ht.normalize(),t.setXYZ(e,Ht.x,Ht.y,Ht.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Vt=0;function Gt(){Object.defineProperty(this,"id",{value:Vt++}),this.uuid=o.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Yt(t){Gt.call(this),this.type="LineBasicMaterial",this.color=new D(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}Gt.prototype=Object.assign(Object.create(nt.prototype),{constructor:Gt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n,i=t[e];void 0===i||("shading"===e?this.flatShading=1===i:void 0===(n=this[e])||(n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i))}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e)for(var i=e.length,r=(n=new Array(i),0);r!==i;++r)n[r]=e[r].clone();return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Gt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((Yt.prototype=Object.create(Gt.prototype)).constructor=Yt).prototype.isLineBasicMaterial=!0,Yt.prototype.copy=function(t){return Gt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this};var Kt=new l,Xt=new l,Wt=new m,Zt=new C,qt=new yt;function Jt(t,e,n){It.call(this),this.type="Line",this.geometry=void 0!==t?t:new zt,this.material=void 0!==e?e:new Yt}function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function te(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===$t(t=function(t,e){if("object"!==$t(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==$t(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Jt.prototype=Object.assign(Object.create(It.prototype),{constructor:Jt,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var e=t.attributes.position,n=[0],i=1,r=e.count;i<r;i++)Kt.fromBufferAttribute(e,i-1),Xt.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=Kt.distanceTo(Xt);t.setAttribute("lineDistance",new ft(n,1))}}else if(t.isGeometry){var o=t.vertices;for((n=t.lineDistances)[0]=0,i=1,r=o.length;i<r;i++)n[i]=n[i-1],n[i]+=o[i-1].distanceTo(o[i])}return this},raycast:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),qt.copy(n.boundingSphere),qt.applyMatrix4(i),qt.radius+=r,!1!==t.ray.intersectsSphere(qt)){Wt.getInverse(i),Zt.copy(t.ray).applyMatrix4(Wt);var o=(i=r/((this.scale.x+this.scale.y+this.scale.z)/3))*i,s=new l,a=new l,A=new l,u=new l,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){r=n.index;var c=n.attributes.position.array;if(null!==r)for(var f=r.array,p=0,d=f.length-1;p<d;p+=h){var y=f[p],m=f[p+1];s.fromArray(c,3*y),a.fromArray(c,3*m),o<Zt.distanceSqToSegment(s,a,u,A)||(u.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(u))<t.near)||g>t.far||e.push({distance:g,point:A.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}else for(p=0,d=c.length/3-1;p<d;p+=h)s.fromArray(c,3*p),a.fromArray(c,3*p+3),o<Zt.distanceSqToSegment(s,a,u,A)||(u.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(u))<t.near)||g>t.far||e.push({distance:g,point:A.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}else if(n.isGeometry){var g,v=n.vertices,b=v.length;for(p=0;p<b-1;p+=h)o<Zt.distanceSqToSegment(v[p],v[p+1],u,A)||(u.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(u))<t.near)||g>t.far||e.push({distance:g,point:A.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});n=function(t,e,n){return e&&te(t.prototype,e),n&&te(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.j={}});var ee=(Object.assign(n.prototype,{k:function(t,e){this.B(t,e)||(void 0===this.j[t]&&(this.j[t]=[]),this.j[t].push(e))},B:function(t,e){return e?void 0!==this.j[t]&&-1!==this.j[t].indexOf(e):void 0!==this.j[t]&&0<this.j[t].length},I:function(t,e){void 0!==this.j[t]&&-1!==(e=this.j[t].indexOf(e))&&this.j[t].splice(e,1)},_:function(t){if(void 0!==this.j[t.type])for(var e=this.j[t.type].slice(0),n=0,i=e.length;n<i;n++)e[n].call(this,t)}}),n);function ne(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],A=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;A=!1}else for(;!(A=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);A=!0);}catch(t){l=!0,r=t}finally{try{if(!A&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(t,e)||ie(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(t,e){var n;if(t)return"string"==typeof t?re(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?re(t,e):void 0}function re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function oe(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function se(t){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ae(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Ae(i.key),i)}}function Ae(t){return"symbol"===se(t=function(t,e){if("object"!==se(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==se(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.P=e,this.C="none",this.currentobj=null,this.V={url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QoOAiAd1TTTFgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABfElEQVRYw81XO26EMBB9poAIrBwh2hPgMt1WS7cSN+AonAXtIahSpfLWVNtFewXLkG7SeCVIbH5rBZ40jYGZ8fjxPMOwDAcARwAnAO8A3sz6HcAVwAeATwBf8IgIQAGgA0AzrTPfRM8GPy8I6rLz2l1fPAR/2GVJNV4B3DwGf9jN+J7cuTM4Y4yEEFSWJUkpSWtNWmuSUlJZliSEIMbYVBKjlXCWPcsyUkrRFJRSlGXZ1HHMJ1wYhlRVFS1FVVUUhuFsYkau4FJKWgsp5VgSg6MobC+t2bmtEo4Ein4Cne3MfcHBia4vr3/YPodwc6GUcv0dh8Bo+wBpmoJz7k3LOedI09T26BiYi2WAPM/hGw6fJ9iE5xnmj/0RNmFihgwv/bS01ojj2GsF2rZFkiS/l78DbIzANBMDNE3jPZDD5z0wncwAdV17T8Dh82pVQSGEdxIKIZxquKkQ7UKKd3EZbX4db96Q7KIl20VTunlbvovBZBej2b8Np2zr8fwHFGE/6k/Mu0oAAAAASUVORK5CYII=",size:32,height:1,collision:!1},this.L={width:5,type:x.FULL,color:"#FF0000",height:3},this.F={color:"#FF0000",borderWidth:3,borderColor:"#0000FF",opacity:.5,height:3},this.D="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QocCDgHXcqo9wAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAEQ0lEQVRYw71XTWhcVRg9584kVGzHZKYlTFpsJ/PeKBaKMjN05aYIKgguupASqaKCC1cFVxaSaQW7dSW4KRFBEETEje5qtWK1SdP409L0zZgpJrEtvqY/qebNe/e46KSZDMkkmSR9mwdz35zv3O8737nfJdbxuG7xdQp7EfCj8au//NkORqzd4Lls8S0SgzR8UTHbm0qlr/r+9ORDIZDLFt6B4SDJXQBAci/AbHeyd8L3p6qbSsB1C++SLJHc0fg7yQyFbFd37z83b05d3hQCrls8SrBEcutS6yR3k8wnU713fH9qbEMJuG7hPYIDAAyAGsl447qk6wDmACQIPJVMpWd8f/r3lXDjqwne07PvUQmXBfUbKQS5U8AAyZ568LNW0RGJAalOyRgTRbN1srYVNtsR4Z49hSc6O3iKZBoArPTjzMzsCzduXLy7VizTDgGSAqCGXdDaqK3NmI0S6PYVSrgmAq6bP+S6+cKyzGI2WlxbsRWDbds6D7hu/vCqCOScwquAGaSNpZcDrNXCCEDYWJQoeowtSpYizIDrFl9rScBxiv0gBwn2yWhZwI4OGy4ioNZilhAA2G2AweZMxBvs9RVQA6RxJNQAPJ3LFW8jVCeoTruo77mjqYUTgD3oOIXbS6dZ++9LlRnKDDhOMfS8c589aEPHKRw0xDHS7G0wlrsADSBTz5RpSmuzEYUrdE584Vt7EVZHx8sjXzGXzb8sY44bch8e4mOlc5I9akA+u1xwafG7YWXdBAxZNOBLcYvwpLEdvTQ8tCiE1Q8wGJMQSYoEhhRrov6jkAD1Jsnk/Dkg4AsCNUgEDAFRBAGQQo6GzzWV7DsLfFnXQD5rYAZoeHh+h7I6Mu4Nf7gU+76+/ONxY07RsK9O9ufQ2ucrlZFbS33vOMV+Q3xCMvYguFTyvOHTBgA8b6Q8VwsGZe3QfHrZIs9RZAIRwarTfb+rVK/9mcja4543fHqRD1SrYxNBGJUEDa0IaMyaRGCpCKBk7RgjfVAuj5xa0ogmJkarsVhUkrVDUYtTlPxXBKM1HF5WUhnCifHK8DctrfjSpdFqENpSLDTfLgcYBGEIaG61BKRoGrTHx8vDn69qIJmYGG05WG7ZsjUEtGoNeN75cwDOtj0RAUAms79nYUfBNjIeNQnzkXQ6XwMAa2sEgGvXfp2dX17XROQ4ToLsehvgGw1/dObtVcI9wf5kAAokYI3A74Hax1eujE2ueyj1fX8ukeiZjMXMk4Y8QHI7SbMgMnSQ6AOZIZERUJEw5Hmjv23YVDwz8/etVGJXBUZZktkmVwPJusfbr62N3i+Xz5/Z8HuBPzN5rTvZe5VAhuSehjabD/4pYEued2F0025Gvj9VTXalrwvMk9y+cHbYoaAWliqVC96m3w39m9NXUqn0HYDPkOiywslaGB2rVi9U14rV9u3Y96fHkqmd92T1x1ygE9Xq+b/awfkfmzntCAO/rwcAAAAASUVORK5CYII=",this.H="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QoOAiAd1TTTFgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABfElEQVRYw81XO26EMBB9poAIrBwh2hPgMt1WS7cSN+AonAXtIahSpfLWVNtFewXLkG7SeCVIbH5rBZ40jYGZ8fjxPMOwDAcARwAnAO8A3sz6HcAVwAeATwBf8IgIQAGgA0AzrTPfRM8GPy8I6rLz2l1fPAR/2GVJNV4B3DwGf9jN+J7cuTM4Y4yEEFSWJUkpSWtNWmuSUlJZliSEIMbYVBKjlXCWPcsyUkrRFJRSlGXZ1HHMJ1wYhlRVFS1FVVUUhuFsYkau4FJKWgsp5VgSg6MobC+t2bmtEo4Ein4Cne3MfcHBia4vr3/YPodwc6GUcv0dh8Bo+wBpmoJz7k3LOedI09T26BiYi2WAPM/hGw6fJ9iE5xnmj/0RNmFihgwv/bS01ojj2GsF2rZFkiS/l78DbIzANBMDNE3jPZDD5z0wncwAdV17T8Dh82pVQSGEdxIKIZxquKkQ7UKKd3EZbX4db96Q7KIl20VTunlbvovBZBej2b8Np2zr8fwHFGE/6k/Mu0oAAAAASUVORK5CYII=",this.objectArray=[],this.Y=[],this.N=[],this.X=[],this.U=[],this.Z=null,this.G=null,this.q=null,this.W=null,this.K=void 0,this.J="#FF0000",this.$=this.P.getRenderManager().renderer.domElement,this.tt=this.tt.bind(this),this.it=this.it.bind(this),this.nt=this.nt.bind(this),this.st=new O,this.rt=new ee,this.et=null,this.ht=null,this.ot()}var e,n;return e=t,(n=[{key:"editUrl",get:function(){return this.H},set:function(t){this.H=t}},{key:"centerUrl",get:function(){return this.D},set:function(t){this.D=t}},{key:"PointStyle",get:function(){return this.V},set:function(t){this.V=t}},{key:"operate",get:function(){return this.K},set:function(t){this.K=t;for(var e=0;e<this.X.length;e++)this.X[e].visible=!1,"move"===t?"center"===this.X[e]._opetype&&(this.X[e].visible=!0):"center"!==this.X[e]._opetype&&(this.X[e].visible=!0)}},{key:"LineStyle",get:function(){return this.L},set:function(t){this.L=t}},{key:"PolygonStyle",get:function(){return this.F},set:function(t){this.F=t}},{key:"DrawTool",get:function(){return this.C},set:function(t){if(this.C=t,"edit"!==this.C){for(var e=0;e<this.X.length;e++)this.X[e].remove();null!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.P.enableUpdateRender()),this.Y.length=0,this.N.length=0,this.X.length=0,this.G=null,this.Z=null}}},{key:"edit",value:function(t,e){if("none"===this.DrawTool||"edit"===this.DrawTool)if(t&&t.shapetype){if(!(0<this.X.length||null!==this.ht)&&(e||null==this.G||this.G.id!==t.id)&&(!t.opetype||"no"===t.opetype.type)){for(var n=0;n<this.X.length;n++)this.X[n].remove();null!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.P.enableUpdateRender()),this.X.length=0,this.Z=null,this.G=t,e||(this.W=t.id),t.type===fengmap.FMType.POLYGON_MARKER?(this.ut(t),this.DrawTool="edit"):t.type===fengmap.FMType.LINE_MARKER?(this.ct(t),this.DrawTool="edit"):t.type===fengmap.FMType.IMAGE_MARKER&&(this.DrawTool="edit",this.q=null,this.ft(t))}}else{for(var i=0;i<this.X.length;i++)this.X[i].remove();this.X.length=0,(this.G=null)!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.P.enableUpdateRender())}}},{key:"on",value:function(t,e){this.rt.k(t,e)}},{key:"dispose",value:function(){this.$.removeEventListener("mousedown",this.tt,!1),this.$.removeEventListener("mousemove",this.it,!1),this.$.removeEventListener("mouseup",this.nt,!1)}},{key:"createMarkerByInfo",value:function(t){var e;if("circle"===t.shapetype||"ellipse"===t.shapetype||"rect"===t.shapetype||"polygon"===t.shapetype)return e=new fengmap.FMPolygonMarkerEdit(t),r=this.P.getFloor(t.level),e.addTo(r),e.mapEdit=this,t.id&&(e.id=t.id),e;if("line"!==t.shapetype)return r=this.P.getFloor(t.level),(e=new fengmap.FMImageMarkerEdit(t)).addTo(r),e.mapEdit=this,t.id&&(e.id=t.id),e;var n=new fengmap.FMSegment;n.points=[];for(var i=0;i<t.points.length;i++)n.points.push({x:t.points[i].x,y:t.points[i].y,z:t.points[i].z});n.level=t.level,t.segments=[n];var r=new fengmap.FMLineMarkerEdit(t);return r.addTo(this.P),r.mapEdit=this,t.id&&(r.id=t.id),r}}])&&ae(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var le=((De=(Object.assign(n.prototype,{ot:function(){this.$.addEventListener("mousedown",this.tt,!1),this.$.addEventListener("mousemove",this.it,!1),this.$.addEventListener("mouseup",this.nt,!1)},lt:function(t,e){if(("none"===this.DrawTool||"edit"===this.DrawTool)&&(null!==this.ht&&(this.ht.parent.remove(this.ht),this.ht=null,this.P.enableUpdateRender()),t)&&(e||null==this.G||this.G.id!==t.id)&&(!t.opetype||"no"===t.opetype.type)){for(var n=0;n<this.X.length;n++)this.X[n].remove();this.X.length=0,this.Z=null,this.G=t,e||(this.W=t.id),t.type===fengmap.FMType.POLYGON_MARKER?(this.ut(t),this.DrawTool="edit"):t.type===fengmap.FMType.LINE_MARKER?(this.ct(t),this.DrawTool="edit"):t.type===fengmap.FMType.IMAGE_MARKER&&(this.DrawTool="edit",this.q=null,this.ft(t))}},vt:function(t){return(t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(n),!0).forEach(function(e){var i,r;i=t,r=n[e=e],(e=Ae(e))in i?Object.defineProperty(i,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t)).buildingID===this.P.getMapOptions().mapID&&(t.buildingID=null),t},dt:function(t,e){var n=new v;if(n.x=t/this.$.getBoundingClientRect().width*2-1,n.y=-e/this.$.getBoundingClientRect().height*2+1,"point"===this.G.shapetype)return t=[this.G.getRenderNode()],this.st.setFromCamera(n,this.P.camera),0<(e=this.st.intersectObjects(t,!0)).length?e[0].object:null;for(var i=[],r=0;r<this.X.length;r++)this.X[r].opetype.node.visible&&i.push(this.X[r].opetype.node);return this.st.setFromCamera(n,this.P.camera),0<(t=this.st.intersectObjects(i,!0)).length?t[0].object:null},yt:function(t,e){var n=t.offsetX,i=(t=t.offsetY,new l);i.x=n/this.$.clientWidth*2-1,i.y=-t/this.$.clientHeight*2+1,i.z=.5,this.st.setFromCamera(i,this.P.camera);var r,o=null,s=function(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=ie(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.P.getRenderManager().getRenderList());try{for(s.s();!(r=s.n()).done;)for(var a=ne(r.value,2),A=(a[0],a[1]),u=this.st.intersectObject(A,!0),h=0;h<u.length;h++)u[h].object.mapNode&&(o=u[h].object)}catch(t){s.e(t)}finally{s.f()}null!==o&&o.mapNode?o.mapNode.type!==fengmap.FMType.LINE_MARKER?this.et={buildingID:o.mapNode.parent.parent.parent.buildingID,level:o.mapNode.level}:(n=o.mapNode.segments[0],this.et={buildingID:n.buildingID,level:n.level}):this.et={buildingID:this.P.getMapOptions().mapID,level:this.P.getLevel()},e&&e()},tt:function(t){var e=this;this.yt(t,function(){if("none"!==e.DrawTool)if(2===t.button)"edit"!==e.DrawTool?e.Mt():(null!==e.Z||null!==e.G&&"point"===e.G.shapetype)&&e.bt(),e.Z=null;else{var n=t.clientX-e.$.getBoundingClientRect().left,i=t.clientY-e.$.getBoundingClientRect().top;if("edit"===e.DrawTool){if(null===e.Z){if(null===e.G)return;var r=e.dt(n,i);"point"!==e.G.shapetype?null!==r&&(e.Z=r.mapNode,e.wt(!1)):null!==r&&(e.q={x:e.G.x,y:e.G.y},e.wt(!1))}}else(r=fengmap.FMUtil.coordsScreenToMap(e.P,{x:n,y:i})).buildingID=e.et.buildingID,r.level=e.et.level,"point"===e.DrawTool?(e.gt(r),e.rt._({type:"drawend",info:e.vt(e.currentobj.info),object:e.currentobj}),e.currentobj=null,e.et=null):"line"===e.DrawTool?e.Y.push(r):"circle"===e.DrawTool?0===e.N.length?e.N.push(r):(e.At(r),e.rt._({type:"drawend",info:e.vt(e.currentobj.info),object:e.currentobj}),e.N.length=0,e.currentobj=null,e.et=null):"rect"===e.DrawTool?0===e.N.length?e.N.push(r):(e.Et(r),e.rt._({type:"drawend",info:e.vt(e.currentobj.info),object:e.currentobj}),e.N.length=0,e.currentobj=null,e.et=null):"polygon"===e.DrawTool?e.N.push(r):"ellipse"===e.DrawTool&&(0===e.N.length?e.N.push(r):(e.St(r),e.rt._({type:"drawend",info:e.vt(e.currentobj.info),object:e.currentobj}),e.N.length=0,e.currentobj=null,e.et=null))}})},it:function(t){if("none"!==this.DrawTool){var e=t.clientX-this.$.getBoundingClientRect().left;t=t.clientY-this.$.getBoundingClientRect().top,e=fengmap.FMUtil.coordsScreenToMap(this.P,{x:e,y:t});if("edit"===this.DrawTool)return null!==this.G&&"point"===this.G.shapetype&&null!==this.q?(this.G.moveTo({animate:!1,x:e.x,y:e.y}),void this.rt._({type:"drawing",info:this.vt(this.G.info),object:this.G})):void(null!==this.G&&null!==this.Z&&(this.Rt(e),this.G.id=this.W,this.rt._({type:"drawing",info:this.vt(this.G.info),object:this.G})));"line"===this.DrawTool?this.xt(e):"circle"===this.DrawTool?this.At(e):"rect"===this.DrawTool?this.Et(e):"polygon"===this.DrawTool?this.jt(e):"ellipse"===this.DrawTool&&this.St(e),this.P.enableUpdateRender(),null!==this.currentobj&&this.rt._({type:"drawing",info:this.vt(this.currentobj.info),object:this.currentobj})}},nt:function(t){if(2!==t.button&&"edit"===this.DrawTool&&null!==this.G&&("point"===this.G.shapetype||null!==this.Z)){if("point"===this.G.shapetype)this.lt(this.G,!0);else if("center"!==this.Z.opetype.type){if("ellipse"===this.G.shapetype||"circle"===this.G.shapetype)this.q=this.Ot(this.G.points);else if("rect"===this.G.shapetype){this.q=this.G.points;var e=((t=this.Tt("center")).visible=!0,void 0!==this.K&&"edit"===this.K&&(t.visible=!1),this.Tt("point",!0));t.position.x=(e[0].position.x+e[1].position.x)/2,t.position.z=(e[0].position.z+e[1].position.z)/2,this.U.length=0,this.U.push({x:Math.abs(e[0].position.x-e[1].position.x)/2,y:Math.abs(e[0].position.z-e[1].position.z)/2})}else if("polygon"===this.G.shapetype){this.q=this.G.points;for(var n=this.Ot(this.q).center,i=this.U.length=0;i<this.q.length;i++)this.U.push({x:this.q[i].x-n.x,y:this.q[i].y-n.y});(t=this.Tt("center")).position.x=n.x-this.P.x,t.position.z=this.P.y-n.y}else if("line"===this.G.shapetype){this.q=this.G.points;for(var r=this.Ot(this.q).center,o=this.U.length=0;o<this.q.length;o++)this.U.push({x:this.q[o].x-r.x,y:this.q[o].y-r.y});(e=this.Tt("center")).position.x=r.x-this.P.x,e.position.z=this.P.y-r.y}}else this.lt(this.G,!0);this.wt(!0),this.Z=null,this.G.id=this.W,this.rt._({type:"editend",info:this.vt(this.G.info),object:this.G})}},ft:function(t){t.getRenderNode().position;var e=[new l(-.5,0,.5),new l(-.5,0,-.5),new l(.5,0,-.5),new l(.5,0,.5),new l(-.5,0,.5)],n=(e=(new zt).setFromPoints(e),new Yt({color:new D(this.J)}));(e=(n.depthTest=!1,n.depthWrite=!1,new Jt(e,n))).scale.set(1.1,1.1,1.1),t.getRenderNode().add(e),this.ht=e,this.P.enableUpdateRender()},Rt:function(t){if(null!==this.Z){var e=this;if("ellipse"!==this.G.shapetype?(this.Z.opetype.node.position.x=t.x-this.P.x,this.Z.opetype.node.position.z=this.P.y-t.y):"xradius"===this.Z.opetype.type?this.Z.opetype.node.position.x=t.x-this.P.x:("yradius"!==this.Z.opetype.type&&(this.Z.opetype.node.position.x=t.x-this.P.x),this.Z.opetype.node.position.z=this.P.y-t.y),"circle"===this.G.shapetype)"yradius"===this.Z.opetype.type?(o=w("center"),this.N.length=0,this.N.push({x:this.P.x+o.position.x,y:this.P.y-o.position.z}),this.At(t,!0)):(w("yradius").visible=!1,this.N.length=0,this.N.push({x:t.x,y:t.y}),this.At({x:t.x,y:t.y+this.q.yradius},!0));else if("ellipse"===this.G.shapetype)this.N.length=0,"yradius"===this.Z.opetype.type||"xradius"===this.Z.opetype.type?(o=w("center"),o={x:this.P.x+o.position.x,y:this.P.y-o.position.z},r=null,r="yradius"===this.Z.opetype.type?this.kt(o,this.q.xradius,Math.abs(o.y-t.y)):this.kt(o,Math.abs(o.x-t.x),this.q.yradius),this.St(r,!0)):(w("xradius").visible=!1,w("yradius").visible=!1,o=this.kt(t,this.q.xradius,this.q.yradius),this.St(o,!0));else if("rect"===this.G.shapetype)if("center"===this.Z.opetype.type){for(var n=w("point",!0),i=0;i<n.length;i++)n[i].visible=!1;this.N.length=0,this.N.push({x:t.x+this.U[0].x,y:t.y-this.U[0].y}),this.Et({x:t.x-this.U[0].x,y:t.y+this.U[0].y},!0)}else{var r=w("center"),o=w("point",r.visible=!1,this.Z.opetype.node.uuid);null!==o&&(this.N.length=0,this.N.push({x:this.P.x+o.position.x,y:this.P.y-o.position.z}),this.Et(t,!0))}else if("polygon"===this.G.shapetype)if("center"===this.Z.opetype.type){for(var s=this.Tt("point",!0),a=0;a<s.length;a++)s[a].visible=!1;for(var A=this.Z.opetype.node.position.x,l=this.Z.opetype.node.position.z,u=[],h=0;h<this.U.length;h++)u.push({x:A+this.U[h].x,y:l-this.U[h].y});this.jt(u,!0)}else{for(var c=this.Tt("point",!0),f=[],p=0;p<c.length;p++)f.push({x:c[p].position.x,y:c[p].position.z});this.jt(f,!0)}else if("line"===this.G.shapetype){var d=this.Tt("point",!0),y=[];if("center"===this.Z.opetype.type){for(var m=0;m<d.length;m++)d[m].visible=!1;for(var g=this.Z.opetype.node.position.x,v=this.Z.opetype.node.position.z,b=0;b<this.U.length;b++)y.push({x:g+this.U[b].x,y:v-this.U[b].y})}else for(var x=0;x<d.length;x++)y.push({x:d[x].position.x,y:d[x].position.z});this.xt(y,!0)}}function w(t,n,i){return e.Tt(t,n,i)}},Tt:function(t,e,n){var i=this,r=null;e&&(r=[]);for(var o=0;o<i.X.length;o++)if(i.X[o].opetype.type===t)if(e)(!n||i.X[o].opetype.node.uuid!==n)&&r.push(i.X[o].opetype.node);else{if(!n){r=i.X[o].opetype.node;break}if(i.X[o].opetype.node.uuid!==n){r=i.X[o].opetype.node;break}}return r},Mt:function(){var t;"line"===this.DrawTool?this.xt():"circle"===this.DrawTool?this.At():"rect"===this.DrawTool?this.Et():"polygon"===this.DrawTool?this.jt():"ellipse"===this.DrawTool&&this.St(),"line"!==this.DrawTool&&"polygon"!==this.DrawTool||(t=!0,"line"===this.DrawTool?this.Y.length<2&&(t=!1):"polygon"===this.DrawTool&&this.N.length<3&&(t=!1),t&&(this.rt._({type:"drawend",info:this.vt(this.currentobj.info),object:this.currentobj}),this.et=null),"line"===this.DrawTool&&(this.Y.length=0,this.currentobj=null),"polygon"===this.DrawTool&&(this.N.length=0,this.currentobj=null))},bt:function(){if(this.q){if("circle"===this.G.shapetype)this.N.length=0,this.N.push({x:this.q.center.x,y:this.q.center.y}),this.At({x:this.q.center.x,y:this.q.center.y+this.q.yradius},!0);else if("ellipse"===this.G.shapetype){this.N.length=0;var t=this.kt({x:this.q.center.x,y:this.q.center.y},this.q.xradius,this.q.yradius);this.St(t,!0)}else if("rect"===this.G.shapetype)this.Et(),this.lt(this.G);else if("polygon"===this.G.shapetype){for(var e=[],n=0;n<this.q.length;n++)e.push({x:this.q[n].x-this.P.x,y:this.P.y-this.q[n].y});this.jt(e,!0)}else if("line"===this.G.shapetype){for(var i=[],r=0;r<this.q.length;r++)i.push({x:this.q[r].x-this.P.x,y:this.P.y-this.q[r].y});this.xt(i,!0)}else if("point"===this.G.shapetype)return this.G.moveTo({animate:!1,x:this.q.x,y:this.q.y}),this.rt._({type:"editend",info:this.vt(this.G.info),object:this.G}),void(this.G=null);this.G.id=this.W,this.rt._({type:"editend",info:this.vt(this.G.info),object:this.G}),this.lt(this.G,!0)}},gt:function(t){var e,n={},i=this.PointStyle;for(e in i)n[e]=i[e];n.x=t.x,n.y=t.y,n.buildingID=this.et.buildingID;t=this.P.getBuilding(this.et.buildingID).getFloor(this.et.level);var r=new fengmap.FMImageMarkerEdit(n);r.addTo(t),(r.mapEdit=this).currentobj=r},xt:function(t,e){var n,i=new fengmap.FMSegment,r=(i.points=[],{}),o=this.LineStyle;for(n in o)r[n]=o[n];if(void 0===r.height&&(r.height=3),e){null!==this.G&&this.G.remove();for(var s=0;s<t.length;s++)i.points.push({x:this.P.x+t[s].x,y:this.P.y-t[s].y,z:r.height})}else{if(0===this.Y.length)return;if(null!==this.currentobj&&(this.currentobj.remove(),!t)&&1===this.Y.length)return;for(var a=0;a<this.Y.length;a++)i.points.push({x:this.Y[a].x,y:this.Y[a].y,z:r.height});t&&i.points.push({x:t.x,y:t.y,z:r.height})}e?(i.level=this.et.level,i.buildingID=this.et.buildingID):(i.level=this.Y[0].level,i.buildingID=this.Y[0].buildingID),r.segments=[i];var A=new fengmap.FMLineMarkerEdit(r);A.addTo(this.P),A.mapEdit=this,e?this.G=A:this.currentobj=A},At:function(t,e){if(0!==this.N.length){if(e)null!==this.G&&this.G.remove();else if(null!==this.currentobj&&(this.currentobj.remove(),!t))return this.N.length=0,void(this.currentobj=null);var n,i=this.N[0],r=(t=Math.sqrt((i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y)),this.PolygonStyle),o={};for(n in r)o[n]=r[n];o.points=fengmap.FMCalculator.circleBuilder(t,this.N[0],32),o.shapetype="circle";var s;t=new fengmap.FMPolygonMarkerEdit(o);e?(s=this.P.getBuilding(this.et.buildingID).getFloor(this.et.level),t.addTo(s)):(s=this.P.getBuilding(i.buildingID).getFloor(i.level),t.addTo(s)),t.mapEdit=this,e?this.G=t:this.currentobj=t}},Et:function(t,e){var n=[];if(t||e){if(0===this.N.length)return;if(e)null!==this.G&&this.G.remove();else if(null!==this.currentobj&&(this.currentobj.remove(),!t))return this.N.length=0,void(this.currentobj=null);var i=this.N[0];n=[i,{x:t.x,y:i.y},t,{x:i.x,y:t.y}]}else if("edit"===mapdraw.DrawTool)n=this.q,null!==this.G&&this.G.remove();else if(null!==this.currentobj)return this.currentobj.remove(),this.N.length=0,void(this.currentobj=null);if(0!==n.length){var r,o=this.PolygonStyle,s={};for(r in o)s[r]=o[r];s.points=n,s.shapetype="rect",i=new fengmap.FMPolygonMarkerEdit(s),e?(n=this.P.getBuilding(this.et.buildingID).getFloor(this.et.level),i.addTo(n)):(n=this.P.getBuilding(this.N[0].buildingID).getFloor(this.N[0].level),i.addTo(n)),i.mapEdit=this,!t&&!e||e?this.G=i:this.currentobj=i}},jt:function(t,e){var n=[];if(e){null!==this.G&&this.G.remove();for(var i=0;i<t.length;i++)n.push({x:this.P.x+t[i].x,y:this.P.y-t[i].y})}else{if(0===this.N.length)return;null!==this.currentobj&&this.currentobj.remove();for(var r=0;r<this.N.length;r++)n.push({x:this.N[r].x,y:this.N[r].y});if(t)n.push({x:t.x,y:t.y});else if(2===n.length)return}var o,s=this.PolygonStyle,a={};for(o in s)a[o]=s[o];a.points=n;var A,l=new fengmap.FMPolygonMarkerEdit(a);e?(A=this.P.getBuilding(this.et.buildingID).getFloor(this.et.level),l.addTo(A)):(A=this.P.getBuilding(this.N[0].buildingID).getFloor(this.N[0].level),l.addTo(A)),l.mapEdit=this,e?this.G=l:this.currentobj=l},St:function(t,e){var n=null;if(e)null!==this.G&&this.G.remove(),n=t;else{if(0===this.N.length)return;if(null!==this.currentobj&&this.currentobj.remove(),!t)return this.N.length=0,void(this.currentobj=null);var i=this.N[0],r=Math.abs(t.x-i.x);n=(t=Math.abs(t.y-i.y))<r?this.kt(i,r,r/2):this.kt(i,t/2,t)}for(var o=[],s=0;s<n.length;s++)o.push({x:n[s].x,y:n[s].y});var a,A=this.PolygonStyle,l={};for(a in A)l[a]=A[a];l.points=o,l.shapetype="ellipse",r=new fengmap.FMPolygonMarkerEdit(l),e?(i=this.P.getBuilding(this.et.buildingID).getFloor(this.et.level),r.addTo(i)):(t=this.P.getBuilding(this.N[0].buildingID).getFloor(this.N[0].level),r.addTo(t)),r.mapEdit=this,e?this.G=r:this.currentobj=r},kt:function(t,e,n){return new b(t.x,t.y,e,n,0,2*Math.PI,!1,0).getPoints(32)},ct:function(t){for(var e=[],n=(this.q=t.points,this.Ot(t.points).center),i=this.U.length=0;i<t.points.length;i++)e.push(t.points[i]),this.U.push({x:t.points[i].x-n.x,y:t.points[i].y-n.y});e.push({x:n.x,y:n.y,optype:"center"}),this.Bt(e,t)},ut:function(t){var e,n=[];if("polygon"===t.shapetype){this.q=t.points;for(var i=this.Ot(t.points).center,r=this.U.length=0;r<t.points.length;r++)n.push(t.points[r]),this.U.push({x:t.points[r].x-i.x,y:t.points[r].y-i.y});n.push({x:i.x,y:i.y,optype:"center"})}else"rect"===t.shapetype?(this.q=t.points,n.push(t.points[0]),n.push(t.points[2]),n.push({x:(t.points[0].x+t.points[2].x)/2,y:(t.points[0].y+t.points[2].y)/2,optype:"center"}),this.U.length=0,this.U.push({x:Math.abs(t.points[0].x-t.points[2].x)/2,y:Math.abs(t.points[0].y-t.points[2].y)/2})):"circle"!==t.shapetype&&"ellipse"!==t.shapetype||(e=this.Ot(t.points),this.q=e,n.push({x:e.center.x,y:e.center.y,optype:"center"}),n.push({x:e.center.x,y:e.center.y+e.yradius,optype:"yradius"}),"ellipse"===t.shapetype&&n.push({x:e.center.x+e.xradius,y:e.center.y,optype:"xradius"}));this.Bt(n,t)},Bt:function(t,e){for(var n=this,i=(n.P.getFloor(n.P.getLevel()),0);i<t.length;i++){var r=(r=t[i].optype)||"point",o=n.editUrl,s=(o=("center"===r&&(o=n.centerUrl),new fengmap.FMImageMarkerEdit({url:o,size:16,height:e.height+1,x:t[i].x,y:t[i].y,collision:!1,opetype:r})),this.P.getBuilding(e.info.buildingID).getFloor(e.info.level));o.addTo(s),void 0!==this.K&&("move"===this.K?"center"!==r&&(o.visible=!1):"edit"===this.K&&"center"===r&&(o.visible=!1)),n.X.push(o)}},Ot:function(t){for(var e=null,n=null,i=null,r=null,o=0;o<t.length;o++)0===o?(e=t[o].x,n=t[o].y,i=t[o].x,r=t[o].y):(e>t[o].x&&(e=t[o].x),n>t[o].y&&(n=t[o].y),i<t[o].x&&(i=t[o].x),r<t[o].y&&(r=t[o].y));return{center:{x:(e+i)/2,y:(n+r)/2},xradius:Math.abs(i-e)/2,yradius:Math.abs(r-n)/2}},It:function(t){var e=t.buildingID;t=t.level;null===e&&(e=this.P.getMapOptions().mapID,t=this.P.getLevel()),null===this.currentobj&&(this.et={buildingID:e,level:t})},wt:function(t){var e=this.P.getInteracations();e.enableDrag=t,e.enableRotate=t,e.enableTilt=t,e.enableZoom=t},_t:function(t){if(this.G&&this.G.id===t){for(var e=0;e<this.X.length;e++)this.X[e].remove();this.X.length=0}}}),{NONE:0,EXTRUDE_MARKER:2,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30})).LAYER_NODE_TYPE=new Map,De.LAYER_NODE_TYPE.set(De.EXTENT_LAYER,De.EXTENT),De.LAYER_NODE_TYPE.set(De.EXTERNAL_MODEL_LAYER,De.EXTERNAL_MODEL),De.LAYER_NODE_TYPE.set(De.MODEL_LAYER,De.MODEL),De.LAYER_NODE_TYPE.set(De.FACILITY_LAYER,De.FACILITY),De.LAYER_NODE_TYPE.set(De.LABEL_LAYER,De.LABEL),De.LAYER_NODE_TYPE.set(De.DOM_MARKER,De.DOM_MARKER),De.LAYER_NODE_TYPE.set(De.DYNAMIC_MODEL_MARKER,De.DYNAMIC_MODEL_MARKER),De.LAYER_NODE_TYPE.set(De.EXTRUDE_MARKER,De.EXTRUDE_MARKER),De.LAYER_NODE_TYPE.set(De.HEAT_MAP_MARKER,De.HEAT_MAP_MARKER),De.LAYER_NODE_TYPE.set(De.LINE_MARKER,De.LINE_MARKER),De.LAYER_NODE_TYPE.set(De.LOCATION_MARKER,De.LOCATION_MARKER),De.LAYER_NODE_TYPE.set(De.POLYGON_MARKER,De.POLYGON_MARKER),De.LAYER_NODE_TYPE.set(De.TEXT_MARKER,De.TEXT_MARKER),De.LAYER_NODE_TYPE.set(De.IMAGE_MARKER,De.IMAGE_MARKER),De.LAYER_NODE_TYPE.set(De.FLOW_LINE_LAYER,De.FLOW_LINE_MARKER),De.LAYER_NODE_TYPE.set(De.FIRE_MARKER,De.FIRE_MARKER),De.LAYER_NODE_TYPE.set(De.WALL_MARKER,De.WALL_MARKER),De.LAYER_NODE_TYPE.set(De.TUBE_MARKER,De.TUBE_MARKER),De.LAYER_NODE_TYPE.set(De.LINE3D_MARKER,De.LINE3D_MARKER),De.LAYER_NODE_TYPE.set(De.SPHERE_MARKER,De.SPHERE_MARKER),De),ue=function(t,e,n){n=n||2;var i,r,o,s,a,A=e&&e.length,l=A?e[0]*n:t.length,u=he(t,0,l,n,!0),h=[];if(u&&u.next!==u.prev){if(A&&(u=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=he(t,s=e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(function(t){for(var e=t,n=t;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),(e=e.next)!==t;);return n}(s));for(a.sort(fe),r=0;r<a.length;r++)!function(t,e){(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}}while((i=i.next)!==e);if(!n)return null;if(r!==s){var A,l=n,u=n.x,h=n.y,c=1/0;for(i=n;r>=i.x&&i.x>=u&&r!==i.x&&de(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&(A=Math.abs(o-i.y)/(r-i.x),xe(i,t))&&(A<c||A===c&&(i.x>n.x||i.x===n.x&&function(t,e){return ye(t.prev,t,e.prev)<0&&ye(e.next,t,t.next)<0}(n,i)))&&(n=i,c=A),(i=i.next)!==l;);}return n}(t,e))&&(t=we(e,t),ce(e,e.next),ce(t,t.next))}(a[r],n),n=ce(n,n.next);return n}(t,e,u,n)),t.length>80*n){for(var c=i=t[0],f=r=t[1],p=n;p<l;p+=n)(o=t[p])<c&&(c=o),(s=t[p+1])<f&&(f=s),i<o&&(i=o),r<s&&(r=s);a=0!==(a=Math.max(i-c,r-f))?1/a:0}!function t(e,n,i,r,o,s,a){if(e){if(!a&&s){for(var A=e,l=r,u=o,h=s,c=A;null===c.z&&(c.z=pe(c.x,c.y,l,u,h)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==A;);c.prevZ.nextZ=null,c.prevZ=null;var f,p,d,y,m,g,v,b,x=c,w=1;do{for(p=x,m=x=null,g=0;p;){for(g++,d=p,f=v=0;f<w&&(v++,d=d.nextZ);f++);for(b=w;0<v||0<b&&d;)0!==v&&(0===b||!d||p.z<=d.z)?(p=(y=p).nextZ,v--):(d=(y=d).nextZ,b--),m?m.nextZ=y:x=y,y.prevZ=m,m=y;p=d}}while(m.nextZ=null,w*=2,1<g)}for(var B,M,S=e;e.prev!==e.next;)if(B=e.prev,M=e.next,s?function(t,e,n,i){var r=t.prev,o=t,s=t.next;if(!(0<=ye(r,o,s))){for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,A=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,u=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,h=pe(a,A,e,n,i),c=pe(l,u,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=c;){if(f!==t.prev&&f!==t.next&&de(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=ye(f.prev,f,f.next))return;if(f=f.prevZ,p!==t.prev&&p!==t.next&&de(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=ye(p.prev,p,p.next))return;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&de(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=ye(f.prev,f,f.next))return;f=f.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&de(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=ye(p.prev,p,p.next))return;p=p.nextZ}return 1}}(e,r,o,s):function(t){var e=t.prev,n=t,i=t.next;if(!(0<=ye(e,n,i))){for(var r=t.next.next;r!==t.prev;){if(de(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=ye(r.prev,r,r.next))return;r=r.next}return 1}}(e))n.push(B.i/i),n.push(e.i/i),n.push(M.i/i),Me(e),e=M.next,S=M.next;else if((e=M)===S){a?1===a?t(e=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next}while(!me(r,o)&&ge(r,i,i.next,o)&&xe(r,o)&&xe(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Me(i),Me(i.next),i=t=o),(i=i.next)!==t);return ce(i)}(ce(e),n,i),n,i,r,o,s,2):2===a&&function(e,n,i,r,o,s){var a=e;do{for(var A,l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&ge(n,n.next,t,e))return 1}while((n=n.next)!==t)}(t,e)&&(xe(t,e)&&xe(e,t)&&function(t,e){for(var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!==t;);return i}(t,e)&&(ye(t.prev,t,e.prev)||ye(t,e.prev,e))||me(t,e)&&0<ye(t.prev,t,t.next)&&0<ye(e.prev,e,e.next))}(a,l))return A=we(a,l),a=ce(a,a.next),A=ce(A,A.next),t(a,n,i,r,o,s),t(A,n,i,r,o,s);l=l.next}}while((a=a.next)!==e)}(e,n,i,r,o,s):t(ce(e),n,i,r,o,s,1);break}}}(u,h,n,c,f,a)}return h};function he(t,e,n,i,r){var o,s;if(r===0<function(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}(t,e,n,i))for(o=e;o<n;o+=i)s=Be(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=Be(o,t[o],t[o+1],s);return s&&me(s,s.next)&&(Me(s),s=s.next),s}function ce(t,e){if(!t)return t;e=e||t;var n,i=t;do{if(n=!1,i.steiner||!me(i,i.next)&&0!==ye(i.prev,i,i.next))i=i.next;else{if(Me(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function fe(t,e){return t.x-e.x}function pe(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function de(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function ye(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function me(t,e){return t.x===e.x&&t.y===e.y}function ge(t,e,n,i){var r=be(ye(t,e,n)),o=be(ye(t,e,i)),s=be(ye(n,i,t)),a=be(ye(n,i,e));return r!==o&&s!==a||0===r&&ve(t,n,e)||0===o&&ve(t,i,e)||0===s&&ve(n,t,i)||!(0!==a||!ve(n,e,i))}function ve(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function be(t){return 0<t?1:t<0?-1:0}function xe(t,e){return ye(t.prev,t,t.next)<0?0<=ye(t,e,t.next)&&0<=ye(t,t.prev,e):ye(t,e,t.prev)<0||ye(t,t.next,e)<0}function we(t,e){var n=new Se(t.i,t.x,t.y),i=new Se(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function Be(t,e,n,i){return t=new Se(t,e,n),i?(t.next=i.next,(t.prev=i).next.prev=t,i.next=t):(t.prev=t).next=t,t}function Me(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Se(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _e(t){return function(t){if(Array.isArray(t))return Ee(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?Ee(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ee(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var Te={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return Te.area(t)<0},triangulateShape:function(t,e){var n=[],i=[],r=[],o=(Ce(t),Fe(n,t),t.length);e.forEach(Ce);for(var s=0;s<e.length;s++)i.push(o),o+=e[s].length,Fe(n,e[s]);for(var a=ue(n,i),A=0;A<a.length;A+=3)r.push(a.slice(A,A+3));return r},triangulate:function(t){(r=[]).push.apply(r,_e(t[0]));for(var e=[],n=1;n<t.length;n++){var i=[];i.push.apply(i,_e(t[n])),e.push(i)}if(!Te.isClockWise(r))for(var r=r.reverse(),o=0,s=e.length;o<s;o++){var a=e[o];Te.isClockWise(a)&&(e[o]=a.reverse())}return Te.triangulateShape(r,e)}};function Ce(t){var e,n=t.length;2<n&&(n=t[n-1],e=t[0],n.x===e.x)&&n.y===e.y&&t.pop()}function Fe(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Oe(t){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Oe(t=function(t,e){if("object"!==Oe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Oe(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var Ue=1e-5,Re=.001,Ie=Math.PI/180,Le=180/Math.PI,De=function(t,e,n){return e&&Pe(t.prototype,e),n&&Pe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(De.prototype,{Pt:function(){return Ue},Ct:function(){return Ie},Vt:function(){return Le},Lt:function(t){return t<Ue&&-Ue<t},Ft:function(t){return Ue<t},Dt:function(t){return t<-Ue},Ht:function(t,e,n){return e=(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y),Math.abs(e)<Ue?0:e},distanceOfTwoPoints:function(t,e){return t&&e?Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)):Number.NaN},distance:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},isPolygonContainPoint:function(t,e){for(var n=0,i=0;i<t.length;i++){var r=t[i].x,o=t[i].y,s=0,a=(i<t.length-1?(s=t[i+1].x,t[i+1]):(s=t[0].x,t[0])).y;if(r===e.x&&o===e.y||s===e.x&&a===e.y)return!0;if(a!==o){var A=r+(e.y-o)*(s-r)/(a-o);if(A===e.x)return!0;r!==s?A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&A!==r&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++):A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++)}}return 0<n%2},Yt:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y))},Nt:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y)||0===this.Ht(n,e,t)&&0===this.Ht(e,i,t)||this.Ht(n,e,t)*this.Ht(e,i,t)<0||this.Ht(t,i,n)*this.Ht(i,e,n)<0)},Xt:function(t,e,n){return!(t.x<e.x||t.y<e.y||t.x>n.x||t.y>n.y)},Ut:function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y);e=Math.max(e.y,n.y);return!(t.x<i||t.x>r||t.y<o||t.y>e)},Zt:function(t,e,n){var i=Math.min(n.x,e.x),r=Math.max(n.x,e.x),o=Math.min(n.y,e.y);n=Math.max(n.y,e.y);return!(t.x<i||t.x>r||t.y<o||t.y>n)},Gt:function(t,e,n){for(var i,r,o=!1,s=0;s<n;s++)i=e[s],r=e[(s+1)%n],(i.y<t.y&&r.y>=t.y||r.y<t.y&&i.y>=t.y)&&(i.x<=t.x||r.x<=t.x)&&i.x+(t.y-i.y)/(r.y-i.y)*(r.x-i.x)<t.x&&(o=!o);return o},qt:function(t,e,n){return(t.x-e.x)*(n.y-e.y)==(n.x-e.x)*(t.y-e.y)&&Math.min(e.x,n.x)<=t.x&&t.x<=Math.max(e.x,n.x)&&Math.min(e.y,n.y)<=t.y&&t.y<=Math.max(e.y,n.y)},zt:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},Qt:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)},Wt:function(t,e,n){var i=e.x,r=(e=e.y,n.x),o=(n=n.y,t.x),s=r-i,a=n-e,A=s*s+a*a,l=o-i,u=(t=t.y)-e,h=l*l+u*u;return this.Lt(A)?this.Lt(h)?0:h:(A=Math.sqrt(A),u=this.Ft(a=(s/=A)*l+(l=a/A)*u)?this.Dt(a-A)?(u=o-(i+a*s))*u+(A=t-(e+a*l))*A:(i=o-r)*i+(s=t-n)*s:h,this.Lt(u)?0:u)},Kt:function(t,e,n,i){var r,o=e.x,s=e.y,a=n.x,A=n.y,l=t.x,u=(t=t.y,a-o),h=A-s,c=Math.sqrt(u*u+h*h),f=l-o,p=t-s,d=Math.sqrt(f*f+p*p);return this.Lt(c)?(i.x=e.x,i.y=e.y,this.Lt(r=d)?0:r):(r=this.Ft(h=(u/=c)*f+(f=h/c)*p)?this.Dt(h-c)?(c=l-(p=o+h*u),u=t-(o=s+h*f),s=Math.sqrt(c*c+u*u),i.x=p,i.y=o,s):(h=l-a,f=t-A,c=Math.sqrt(h*h+f*f),i.x=n.x,i.y=n.y,c):(i.x=e.x,i.y=e.y,d),this.Lt(r)?0:r)},Jt:function(t,e){for(var n=0,i=0,r=0,o=0;o<e;o++){var s=t[o],a=t[(o+1)%e],A=(s.x*a.y-s.y*a.x)/2;n+=A,i+=A*(s.x+a.x)/3,r+=A*(s.y+a.y)/3}return{x:i/=n,y:r/=n}},$t:function(t){for(var e=Te.triangulate([t]),n=0,i=0,r=0,o=0;o<e.length;o++){var s=t[e[o][0]],a=t[e[o][1]],A=t[e[o][2]],l=a.x-s.x,u=a.y-s.y,h=A.x-s.x;n+=l=(l*(A.y-s.y)-h*u)/2,i+=(s.x+a.x+A.x)/3*l,r+=(s.y+a.y+A.y)/3*l}return{x:i/n,y:r/n}},ti:function(t,e){if(e<3)return 0;for(var n=0,i=0;i<e;++i){var r=t[i],o=t[(i+1)%e];n+=r.x*o.y-r.y*o.x}return Math.abs(n/2)},ii:function(t,e,n,i,r){var o,s;return this.Nt(t,e,n,i)?(o=(i.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-i.y),s=(t.y-n.y)*(e.x-t.x)*(i.x-n.x)+n.x*(i.y-n.y)*(e.x-t.x)-t.x*(e.y-t.y)*(i.x-n.x),r.x=s/o,o=(t.x-e.x)*(i.y-n.y)-(e.y-t.y)*(n.x-i.x),s=e.y*(t.x-e.x)*(i.y-n.y)+(i.x-e.x)*(i.y-n.y)*(t.y-e.y)-i.y*(n.x-i.x)*(e.y-t.y),r.y=s/o,1):0},ni:function(t,e,n,i,r){var o=Math.min(n.x,i.x),s=Math.max(n.x,i.x),a=Math.min(n.y,i.y),A=Math.max(n.y,i.y),l=t.x,u=t.y,h=n.x,c=n.y,f=i.x,p=i.y;if(90==e)return!(t.x<o||t.x>s||(Math.abs(s-o<Re)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.x<c?(r.x=h,r.y=c,0):!(p<c&&t.x<p)||(r.x=f,r.y=p,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,d<u||!this.Zt(r,n,i))));if(270==e)return!(t.x<o||t.x>s||(Math.abs(s-o<Re)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.y>p?(r.x=f,r.y=p,0):!(p<c&&t.y>c)||(r.x=h,r.y=c,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,u<d||!this.Zt(r,n,i))));if(270!=e&&90!=e&&Math.abs(s-o<Re)){t=o;var d=Math.tan(e/180*Math.PI)*(t-l)+u;if(r.y=d,r.x=t,this.Zt(r,n,i))return s=d-u,0<(o=t-l)/Math.sqrt(o*o+s*s)*Math.cos(e/180*Math.PI)}return Math.abs(A-a<=Re)?(d=a,t=1/Math.tan(e/180*Math.PI)*(d-u)+l,r.x=t,r.y=d,!!this.Zt(r,n,i)&&(o=d-u,0<(s=t-l)/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI))):(t=u+(A=Math.tan(e/180*Math.PI))*((d=(c-u-((a=(p-c)/(f-h))*h-A*l))/(A-a))-l),r.x=d,r.y=t,!!this.Zt(r,n,i)&&(s=d-l,o=t-u,Math.abs(s)<=Re&&Math.abs(o)<=Re||0<s/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI)))},si:function(t,e){return Math.abs(t.x-e.x)<Ue&&Math.abs(t.y-e.y)<Ue},ri:function(t,e,n,i){var r,o,s,a,A=t.x,l=t.y,u=e.x,h=e.y,c=n.x,f=n.y;return this.si(t,e)||this.si(t,n)?(i.x=A,i.y=l,!0):(s=Math.min(e.x,n.x),a=Math.max(e.x,n.x),r=Math.min(e.y,n.y),o=Math.max(e.y,n.y),Math.abs(u-c)<1e-5?(i.x=u,r<=(i.y=l)&&l<=o):Math.abs(h-f)<1e-5?(i.x=A,i.y=h,s<=A&&A<=a):(a=l+(r=-1/((f-h)/(c-u)))*((s=(h-l-((o=(f-h)/(c-u))*u-r*A))/(r-o))-A),i.x=s,i.y=a,!!this.Zt(i,e,n)||!(!this.si(t,e)&&!this.si(t,n))))},ei:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}},hi:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},oi:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},ui:function(t,e){return t.x*e.x+t.y*e.y},ai:function(t,e){return t.x*e.y-t.y*e.x},ci:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},fi:function(t,e){var n,i;return 0==t.x&&0==t.y||0==e.x&&0==e.y?0:(n={x:t.x,y:t.y,z:0},i={x:e.x,y:e.y,z:0},n=this.ei(n,i),i=this.ui(t,e),i=Math.acos(i/(this.ci(t)*this.ci(e))),0<n.z?i/Math.PI*180:360-i/Math.PI*180)},li:function(t,e,n,i){for(var r=0;r<n.length;r++){var o=n[r],s=n[(r+1)%n.length];if(1==this.ii(t,e,o,s,i))return!0}return!1},vi:function(t,e,n,i,r){var o=Math.min(t.x,n.x,i.x),s=Math.max(t.x,n.x,i.x),a=Math.min(t.y,n.y,i.y),A=Math.max(t.y,n.y,i.y);s=Math.sqrt((s-o)*(s-o)+(A-a)*(A-a)),o=e/180*Math.PI,A=s*Math.cos(o)+t.x,a=s*Math.sin(o)+t.y;return 1==this.ii(t,{x:A,y:a},n,i,r)},di:function(t){for(var e={x:null,y:null},n=0,i=0,r=0;r<t.length;r++)n+=t[r].x,i+=t[r].y;return e.x=n/t.length,e.y=i/t.length,e},yi:function(t,e,n,i){var r=[],o=t.x-e,s=t.x+e,a=t.y-e,A=t.y+e,l=Math.min(n.x,i.x),u=Math.max(n.x,i.x),h=Math.min(n.y,i.y),c=Math.max(n.y,i.y);return u<o||s<l||c<a||A<h||(o=i.x-n.x,s=i.y-n.y,(a=(t=(o*(a=t.x-n.x)+s*(A=t.y-n.y))/(i=o*o+s*s))*t-(a*a+A*A-e*e)/i)<0)||(A=Math.sqrt(a),i={x:n.x-o*(e=-t+A),y:n.y-s*e},o={x:n.x-o*(a=-t-A),y:n.y-s*a},e!==a&&(l<=i.x&&i.x<=u&&h<=i.y&&i.y<=c&&r.push(i),l<=o.x)&&o.x<=u&&h<=o.y&&o.y<=c&&r.push(o)),r},pi:function(t,e,n){var i,r={};if(t.x!=e.x)return i=e=(e.y-t.y)/(e.x-t.x),e=t.y-e*t.x,r.x=(+n.x- -1*i*n.y-i*e)/(i*i+1),r.y=(i*i*n.y- -1*i*n.x- -1*e)/(i*i+1),r;r.x=t.x,r.y=n.y},mi:function(t,e,n,i){var r,o,s,a,A={point:null,isintersect:!1};return t==n||t==i?(A.isintersect=!0,A.point=t):e==n||e==i?(A.isintersect=!0,A.point=e):(r={x:e.x-t.x,y:e.y-t.y},o={x:i.x-n.x,y:i.y-n.y},s={x:n.x-t.x,y:n.y-t.y},i={x:i.x-t.x,y:i.y-t.y},e={x:e.x-n.x,y:e.y-n.y},n={x:-s.x,y:-s.y},a=this.ai(o,r),Math.abs(a)<=1e-5||this.ai(s,r)*this.ai(i,r)<=5e-4&&this.ai(n,o)*this.ai(e,o)<5e-4&&(i=this.ai(o,s)/a,A.point={x:t.x+r.x*i,y:t.y+r.y*i},A.isintersect=!0)),A},Mi:function(t,e,n){t.x===e.x&&(e.x=e.x+1),t.y===e.y&&(e.y=e.y+1),e.x===n.x&&(n.x=n.x+1),e.y===n.y&&(n.y=n.y+1);var i=e.x-t.x,r=(t=e.y-t.y,n.x-e.x);return!(0<i*(n.y-e.y)-t*r)},getAngle:function(t){var e=t.p1,n=(t=t.p2).x-e.x;t=t.y-e.y,e=Math.sqrt(n*n+t*t),e=Math.asin(Math.abs(t)/e);return 0<n&&0<t?e:n<0&&0<t?Math.PI-e:n<0&&t<0?Math.PI+e:0<n&&t<0?2*Math.PI-e:0==n&&0<t?e:0==n&&t<0?3*Math.PI/2:0<n&&0==t?e:n<0&&0==t?Math.PI:null},bi:function(t){var e=this.distanceOfTwoPoints(t[0],t[1]),n=this.distanceOfTwoPoints(t[1],t[2]),i=(e+n+(t=this.distanceOfTwoPoints(t[0],t[2])))/2;return Math.sqrt(i*(i-e)*(i-n)*(i-t))},wi:function(t,e){var n,i,r,o,s;return this.Kt(t,e[0],e[1],{})<1e-4||this.Kt(t,e[0],e[2],{})<1e-4||this.Kt(t,e[1],e[2],{})<1e-4||(o={x:e[1].x-e[0].x,y:e[1].y-e[0].y},n={x:e[0].x-e[2].x,y:e[0].y-e[2].y},i={x:e[2].x-e[1].x,y:e[2].y-e[1].y},s={x:t.x-e[0].x,y:t.y-e[0].y},r={x:t.x-e[1].x,y:t.y-e[1].y},t={x:t.x-e[2].x,y:t.y-e[2].y},e=this.ai(o,s),o=this.ai(i,r),s=this.ai(n,t),Ue<e*o&&Ue<o*s)},gi:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null,type:0,outer:null},o=[];if(this.wi(t,n)&&(r.start=t),this.wi(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0,r.type=1;else{for(var s=(n[1].x+n[2].x)/2,a=(n[1].y+n[2].y)/2,A=1;A<i;A++){var l,u=this.mi(t,e,n[A-1],n[A]);if(u.isintersect){if(null!=r.start)return r.end=u.point,r.isintersect=!0,r.outer="end",l=this.fi({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;if(null!=r.end)return r.start=u.point,r.isintersect=!0,r.outer="start",l=this.fi({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;o.push(u)}}var h,c=this.mi(t,e,n[0],n[i-1]);if(c.isintersect){if(null!=r.start)return r.end=c.point,r.isintersect=!0,r.outer="end",h=this.fi({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;if(null!=r.end)return r.start=c.point,r.isintersect=!0,r.outer="start",h=this.fi({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;o.push(c)}2!=o.length||this.distanceOfTwoPoints(o[0].point,o[1].point)<.01||(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?(r.start=o[0].point,r.end=o[1].point):(r.start=o[1].point,r.end=o[0].point),r.isintersect=!0,r.type=4)}return r},Ai:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null},o=[];if(this.wi(t,n)&&(r.start=t),this.wi(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0;else{for(var s=1;s<i;s++){var a=this.mi(t,e,n[s-1],n[s]);if(a.isintersect){if(null!=r.start)return r.end=a.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(a)}}var A=this.mi(t,e,n[0],n[i-1]);if(A.isintersect){if(null!=r.start)return r.end=A.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(A)}2==o.length&&(r.start=(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.end=(this.distanceOfTwoPoints(o[0].point,t)>this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.isintersect=!0)}return r},Ei:function(t,e){if(0==e.length)return[t];var n,i,r=this.Si(e),o=[],s=(r.sort(function(e,n){var i=(e.Ri.x-t.Ri.x)*(e.Ri.x-t.Ri.x)+(e.Ri.y-t.Ri.y)*(e.Ri.y-t.Ri.y),r=(n.Ri.x-t.Ri.x)*(n.Ri.x-t.Ri.x)+(n.Ri.y-t.Ri.y)*(n.Ri.y-t.Ri.y);e=(e.xi.x-t.Ri.x)*(e.xi.x-t.Ri.x)+(e.xi.y-t.Ri.y)*(e.xi.y-t.Ri.y),n=(n.xi.x-t.Ri.x)*(n.xi.x-t.Ri.x)+(n.xi.y-t.Ri.y)*(n.xi.y-t.Ri.y);return(i<e?i:e)<(r<n?r:n)}),0);for(s=0;s<r.length;s++)this.distanceOfTwoPoints(r[s].Ri,r[s].xi)<.01||(n=this.distanceOfTwoPoints(r[s].Ri,t.Ri),i=this.distanceOfTwoPoints(r[s].xi,t.Ri),n<.01?t.Ri=r[s].xi:i<.01?t.Ri=r[s].Ri:n<i?.1<this.distanceOfTwoPoints(t.Ri,r[s].Ri)&&(o.push({ji:t.ji,Ri:t.Ri,xi:r[s].Ri,zt:t.zt,Oi:t.Oi}),t.Ri=r[s].xi):.1<this.distanceOfTwoPoints(t.Ri,r[s].xi)&&(o.push({ji:t.ji,Ri:t.Ri,xi:r[s].xi,zt:t.zt,Oi:t.Oi}),t.Ri=r[s].Ri),r.splice(s,1));return.1<this.distanceOfTwoPoints(t.Ri,t.xi)&&o.push(t),o},Si:function(t){var e=[];if(1==t.length)return t;for(var n=t[0],i=1;0<t.length;){if(i>=t.length){if(e.push(n),t.splice(0,1),t.length<1)break;n=t[0],i=1}if(1===t.length){e.push(n);break}this.Ti(n.Ri,n.xi,t[i].Ri)?(this.Ti(n.Ri,n.xi,t[i].xi)||(n.xi=t[i].xi),t.splice(i,1)):this.Ti(n.Ri,n.xi,t[i].xi)?(n.Ri=t[i].Ri,t.splice(i,1)):this.Ti(t[i].Ri,t[i].xi,n.Ri)?(this.Ti(t[i].Ri,t[i].xi,n.xi)||(t[i].xi=n.xi),n=t[i],t.splice(i,1)):this.Ti(t[i].Ri,t[i].xi,n.xi)?(t[i].Ri=n.Ri,n=t[i],t.splice(i,1)):i++}return e},Ti:function(t,e,n){var i=t.x-n.x,r=t.y-n.y,o=e.x-n.x,s=e.y-n.y,a=this.distanceOfTwoPoints(t,n);n=this.distanceOfTwoPoints(e,n),t=this.distanceOfTwoPoints(t,e);return i*s-r*o<1e-5&&a+n-t<.001}});var Qe=new De;function ke(t){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ne(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ke(t=function(t,e){if("object"!==ke(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ke(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function je(t){return(je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function He(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===je(t=function(t,e){if("object"!==je(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==je(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}De=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.P=e,this.$=this.P.getContainer(),this.ki={border:"border:2px solid #0000FF",backgroundColor:null,opacity:null},this.Bi=[le.MODEL,le.FACILITY,le.LABEL,le.EXTERNAL_MODEL],this.Ii=0,this._i=!1,this.tt=this.tt.bind(this),this.it=this.it.bind(this),this.nt=this.nt.bind(this),this.Pi=null,this.Ci=null,this.rt=new ee,this.Vi=new fengmap.FMSearchAnalyser({map:this.P}),this.ot()}var e,n;return e=t,(n=[{key:"dispose",value:function(){this.$.removeEventListener("mousedown",this.tt,!1),document.removeEventListener("mousemove",this.it,!1),document.removeEventListener("mouseup",this.nt,!1),this.Vi.dispose()}},{key:"boxStyle",get:function(){return this.ki},set:function(t){this.ki=t}},{key:"enable",get:function(){return this._i},set:function(t){this._i=t}},{key:"mouseKey",get:function(){return 0===this.Ii?"left":"right"},set:function(t){this.Ii="left"===t?0:2}},{key:"types",get:function(){return this.Bi},set:function(t){this.Bi=t}},{key:"on",value:function(t,e){this.rt.k(t,e)}}])&&Ne(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(De.prototype,{ot:function(){this.P.getRenderManager().renderer.domElement.style.left="0px",this.$.addEventListener("mousedown",this.tt,!1),document.addEventListener("mousemove",this.it,!1),document.addEventListener("mouseup",this.nt,!1)},Li:function(t){return{x:t.getBoundingClientRect().left,y:t.getBoundingClientRect().top}},tt:function(t){var e,n;this._i&&t.button===this.Ii&&(this.Pi&&this.Pi.parentNode&&(this.Pi.parentNode.removeChild(this.Pi),this.Pi=null),e=this.Li(this.P.getRenderManager().renderer.domElement),n=t.clientX-e.x,t=t.clientY-e.y,this.Ci={x:n,y:t},this.wt(!1),this.Pi=document.createElement("div"),this.Pi.style.cssText="position:absolute;top:"+t+"px;left:"+n+"px;width:0px;height:0px;"+this.ki.border+";",this.$.appendChild(this.Pi),this.ki.backgroundColor&&(this.Pi.style.backgroundColor=this.ki.backgroundColor),void 0!==this.ki.opacity)&&null!==this.ki.opacity&&(this.Pi.style.opacity=this.ki.opacity)},it:function(t){var e,n;this._i&&null!==this.Ci&&(e=this.Li(this.P.getRenderManager().renderer.domElement),n=t.clientX-e.x,t=t.clientY-e.y,n<this.Ci.x&&(this.Pi.style.left=n+"px"),t<this.Ci.y&&(this.Pi.style.top=t+"px"),this.Pi.style.width=Math.abs(n-this.Ci.x)+"px",this.Pi.style.height=Math.abs(t-this.Ci.y)+"px")},nt:function(t){var e=this;if(this._i&&null!==this.Pi&&t.button===this.Ii){this.wt(!0);var n=this.Fi(),i=[],r=this.P.getMapOptions(),o=[],s=[];if(r.buildings&&0<r.buildings.length)for(var a=0;a<r.buildings.length;a++)!function(t){for(var i=(t=e.P.getBuilding(t).bound).min,r=(t=t.max,[{x:i.x,y:i.y},{x:i.x,y:t.y},{x:t.x,y:t.y},{x:t.x,y:i.y}]),o=0;o<r.length;o++)if(Qe.Gt(r[o],n,n.length))return 1;for(var s=0;s<n.length;s++)if(Qe.Gt(n[s],r,r.length))return 1;for(var a=0;a<n.length-1;a++){for(var A=n[a],l=n[a+1],u=0;u<r.length-1;u++){var h=r[u],c=r[u+1];if(Qe.Nt(A,l,h,c))return 1}var f=r[r.length-1],p=r[0];if(Qe.Nt(A,l,p,f))return 1}for(var d=n[0],y=n[n.length-1],m=0;m<r.length-1;m++){var g=r[m],v=r[m+1];if(Qe.Nt(d,y,g,v))return 1}if(t=r[r.length-1],i=r[0],Qe.Nt(d,y,i,t))return 1}(r.buildings[a].bid)||(o.push(r.buildings[a].mid),s.push(r.buildings[a].bid));for(var A=[],l=0;l<this.Bi.length;l++){for(var u=new fengmap.FMSearchRequest,h=(u.levels=[this.P.getBuilding(r.buildingID).level],u.type=this.Bi[l],u.addCondition({polygon:n}),[]),c=0;c<s.length;c++)h.push({buildingID:s[c],levels:[this.P.getBuilding(s[c]).level]});0<h.length&&(u.buildings=h),A.push(u)}this.Ci=null,this.Pi.parentNode&&this.Pi.parentNode.removeChild(this.Pi),this.Pi=null;var f,p=0;f=null,function t(){var r;p<A.length?(r=A[p],e.Vi.query(r,function(e){i.push({type:r.type,children:e}),p++,f=setTimeout(t(),1)})):(null!==f&&clearTimeout(f),e.rt._({type:"boxselected",targets:i,coords:n}))}()}},wt:function(t){var e=this.P.getInteracations();e.enableDrag=t,e.enableRotate=t,e.enableTilt=t,e.enableZoom=t},Fi:function(){for(var t=[],e=this.Pi.getBoundingClientRect(),n=(i=this.Li(this.P.getRenderManager().renderer.domElement)).x,i=i.y,r=(t.push({x:e.left-n,y:e.top-i}),t.push({x:e.right-n,y:e.top-i}),t.push({x:e.right-n,y:e.bottom-i}),t.push({x:e.left-n,y:e.bottom-i}),[]),o=0;o<t.length;o++){var s=fengmap.FMUtil.coordsScreenToMap(this.P,t[o]);r.push(s)}return r}});var ze=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var e,n;return e=t,n=[{key:"round",value:function(t){return 0<t.toFixed(2)?Math.ceil(t.toFixed(2)):Math.floor(t.toFixed(2))}},{key:"generateUUID",value:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);var n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;n=t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&o]+t[o>>8&255]+t[o>>16&255]+t[o>>24&255];return t.length=0,n.toUpperCase()}},{key:"findNearNthPowerOfTwo",value:function(t){return t-=1,(t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)<0?1:1+t}},{key:"rgbToArray",value:function(t){var e=new D;return e.setStyle(t),[e.r,e.g,e.b]}},{key:"toRgba",value:function(t){var e;return void 0===t?t:"number"!=typeof t?3<=(e=t.split(",")).length?"rgba("+parseInt(e[0])+","+parseInt(e[1])+","+parseInt(e[2])+",1)":t:"rgba("+parseInt(255*new D(t).r)+","+parseInt(255*new D(t).g)+","+parseInt(255*new D(t).b)+",1)"}},{key:"toColor",value:function(t){var e;return"number"==typeof t?t:3<=(e=t.split(",")).length?parseInt(e[0])<<16|parseInt(e[1])<<8|parseInt(e[2]):0}}],null&&He(e.prototype,null),n&&He(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ve(t){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ge(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ve(t=function(t,e){if("object"!==Ve(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ve(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ye(){return(Ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Xe(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function Ke(t,e){return(Ke=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Xe(t){return(Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var We=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ke(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Xe(t);if(n=e?(n=Xe(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ve(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this,t)).info2=t,e.id=""+ze.generateUUID(),e.shapetype2="point",e.opetype2="no",t.opetype&&(e.opetype2=t.opetype,e.shapetype2="no"),e.mapEdit=null,e;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.x=this.u,this.info2.y=this.v,this.info2.height=this._height,this.info2.shapetype=this.shapetype,this.info2.level=this.level,this.info2}},{key:"opetype",get:function(){if(this.opetype2)return{node:this.getRenderNode(),type:this.opetype2}}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){Ye(Xe(i.prototype),"remove",this).call(this)}}])&&Ge(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),i}(fengmap.FMImageMarker);function Ze(t){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ze(t=function(t,e){if("object"!==Ze(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ze(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Je(){return(Je="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tn(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function $e(t,e){return($e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tn(t){return(tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var en=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$e(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=tn(t);if(n=e?(n=tn(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ze(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this,t)).info2=t,e.shapetype2="polygon",e.id=""+ze.generateUUID(),t.shapetype&&(e.shapetype2=t.shapetype),e.mapEdit=null,e;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.shapetype=this.shapetype2,this.info2.level=this.level,this.info2.buildingID=this.parent.parent.parent.buildingID,this.info2}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){Je(tn(i.prototype),"remove",this).call(this),null!==this.mapEdit&&this.mapEdit._t(this.id)}}])&&qe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),i}(fengmap.FMPolygonMarker);function nn(t){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===nn(t=function(t,e){if("object"!==nn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==nn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function on(){return(on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=an(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function sn(t,e){return(sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function an(t){return(an=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var An=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sn(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=an(t);if(n=e?(n=an(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===nn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this,t)).shapetype2="line",e.info2=t,e.id=""+ze.generateUUID(),e.mapEdit=null,e;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.points=this.points,this.info2.shapetype=this.shapetype,this.info2.level=this.segments[0].level,this.info2.buildingID=this.segments[0].buildingID,this.info2}},{key:"points",get:function(){return 0===this.segments.length?[]:this.segments[0].points}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){on(an(i.prototype),"remove",this).call(this),null!==this.mapEdit&&this.mapEdit._t(this.id)}}])&&rn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),i}(fengmap.FMLineMarker);function ln(t){return(ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function un(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ln(t=function(t,e){if("object"!==ln(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ln(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var hn=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.P=e.map,this.$=this.P.getContainer(),this.Di=e.highlightColor,void 0===this.Di&&(this.Di="#FF0000"),this.Hi=e.radius,void 0===this.Hi&&(this.Hi=1),this.it=this.it.bind(this),this.st=new O,this.st.params.Line.threshold=this.Hi,this.rt=new ee,this.Yi=[],this.Ni={},this.ot()}var e,n;return e=t,(n=[{key:"removeTargets",value:function(){for(var t=0;t<this.Yi.length;t++)this.Yi[t].parent.remove(this.Yi[t]);this.Ni={},this.Yi.length=0}},{key:"addTargets",value:function(t){this.removeTargets();for(var e=0;e<t.length;e++)if(t[e].type===fengmap.FMType.LINE_MARKER){for(var n=t[e].segments[0].points,i=[],r=0;r<n.length;r++)i.push(new l(n[r].x-this.P.x,n[r].z,-n[r].y+this.P.y));var o=new Yt({visible:!1});(o=new Jt((new zt).setFromPoints(i),o)).myobject=t[e],o.mapNode=t[e],t[e].parent.scene.add(o),this.Yi.push(o)}else if(t[e].type===fengmap.FMType.POLYGON_MARKER&&t[e].getRenderNode()){this.Ni[""+t[e].id]={borderColor:t[e].borderColor,color:t[e].color};for(var s=t[e].points,a=[],A=0;A<s.length;A++)a.push(new l(s[A].x-this.P.x,t[e].height,-s[A].y+this.P.y));o=new Yt({visible:!1});var u=new Jt((new zt).setFromPoints(a),o);u.myobject=t[e],u.mapNode=t[e],t[e].getRenderNode().parent.add(u),this.Yi.push(u)}}},{key:"dispose",value:function(){this.removeTargets(),this.Yi.length=0,this.$.removeEventListener("mousemove",this.it,!1)}},{key:"radius",get:function(){return this.Hi},set:function(t){this.Hi=t,this.st.params.Line.threshold=this.Hi}},{key:"on",value:function(t,e){this.rt.k(t,e)}}])&&un(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],A=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;A=!1}else for(;!(A=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);A=!0);}catch(t){l=!0,r=t}finally{try{if(!A&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(t,e)||dn(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pn(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=dn(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dn(t,e){var n;if(t)return"string"==typeof t?yn(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yn(t,e):void 0}function yn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function mn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===cn(t=function(t,e){if("object"!==cn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==cn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(hn.prototype,{ot:function(){this.$.addEventListener("mousemove",this.it,!1)},it:function(t){if(0!==this.Yi.length){for(var e=this,n=new v,i=this.$.getBoundingClientRect(),r=(n=(n.x=(t.clientX-i.left)/i.width*2-1,n.y=-(t.clientY-i.top)/i.height*2+1,this.st.setFromCamera(n,this.P.camera),t.clientX-i.left),t=t.clientY-i.top,i=fengmap.FMUtil.coordsScreenToMap(this.P,{x:n,y:t}),this.st.intersectObjects(function(){for(var t=[],n=0;n<e.Yi.length;n++)e.Yi[n].mapNode&&e.Yi[n].mapNode.level&&e.Yi[n].mapNode.level===e.P.getLevel()&&t.push(e.Yi[n]);return t}(this.Yi),!0)),o=[],s=[],a=0;a<r.length;a++)!function(t,e){for(var n=!0,i=0;i<t.length;i++)if(t[i].uuid===e.uuid){n=!1;break}return n}(o,r[a].object)||(o.push(r[a].object),s.push(r[a].point));var A=[],l=[];if(0<o.length){for(var u=0;u<o.length;u++){A.push(o[u].myobject);var h=s[u];l.push({x:h.x+this.P.x,y:this.P.y-h.z})}for(var c=i,f=A,p=l,d=0;d<f.length-1;d++)for(var y=0;y<f.length-1-d;y++){var m=Math.sqrt((f[y].x-c.x)*(f[y].x-c.x)+(f[y].y-c.y)*(f[y].y-c.y));Math.sqrt((f[y+1].x-c.x)*(f[y+1].x-c.x)+(f[y+1].y-c.y)*(f[y+1].y-c.y))<m&&(m=f[y],f[y]=f[y+1],f[y+1]=m,m=p[y],p[y]=p[y+1],p[y+1]=m)}}0===A.length&&(l=A=null);for(var g=0;g<this.Yi.length;g++){var b=this.Ni[""+this.Yi[g].myobject.id];b&&(this.Yi[g].myobject.color=b.color,this.Yi[g].myobject.borderColor=b.borderColor)}null!==A&&A[0].type===fengmap.FMType.POLYGON_MARKER&&(A[0].color=this.Di,A[0].borderColor=this.Di),this.rt._({type:"snap",coords:i,targets:A,targetsCoords:l,level:this.P.getLevel()})}}});var gn=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.P=e.map,this.Xi=e.defaultStyle,this.Ui=e.isdirect,this.Zi=new Map,this.Gi=new Map,this.qi=new Map,this.zi=this.zi.bind(this),this.P.on("beforeRender",this.zi)}var e,n;return e=t,(n=[{key:"add",value:function(t){var e=this;if(void 0===t.buildingID&&(t.buildingID=this.P.getMapOptions().mapID),void 0===t.type&&(t.type=1),void 0===t.levels){t.levels=[];for(var n=this.P.getBuilding(t.buildingID).getFloorInfos(),i=0;i<n.length;i++)t.levels.push(n[i].level)}for(var r=t.result,o=t.levels,s=t.roadRanks,a=0;a<o.length;a++)for(var A=0;A<s.length;A++)for(var l=function(t,e,n){for(var i=[],r=0;r<t.length;r++)if(""+t[r].level==""+e)for(var o=t[r].roadVector,s=0;s<o.length;s++)""+o[s].roadRank==""+n&&i.push(o[s]);return i}(r,o[a],s[A]),u=(m=p=u=void 0,t.type),h=o[a],c=t.height,f=s[A],p=l,d=t.zoomRange,y=e.Qi(f),m=0;m<p.length;m++)p[m].buildingID||(p[m].buildingID=e.P.getMapOptions().mapID),""+u=="1"?(e.Wi(y,h,c,f,p[m].startPoint,p[m].startId,d,p[m].buildingID),e.Wi(y,h,c,f,p[m].endPoint,p[m].endId,d,p[m].buildingID),e.Ki(y,h,c,f,p[m].startPoint,p[m].endPoint,d,p[m].buildingID,p[m].roadEntry)):""+u=="2"?e.Ki(y,h,c,f,p[m].startPoint,p[m].endPoint,d,p[m].buildingID,p[m].roadEntry):""+u=="3"&&(e.Wi(y,h,c,f,p[m].startPoint,p[m].startId,d,p[m].buildingID),e.Wi(y,h,c,f,p[m].endPoint,p[m].endId,d,p[m].buildingID))}},{key:"getNaviLineByRanks",value:function(t){return this.Ji(t,this.Gi)}},{key:"getNaviNodeByRanks",value:function(t){return this.Ji(t,this.Zi)}},{key:"remove",value:function(t){for(var e=this,n=(void 0===t.buildingID&&(t.buildingID=this.P.getMapOptions().mapID),t.type),i=(void 0===n&&(n=1),t.levels),r=t.roadRanks,o=0;o<i.length;o++)for(var s=0;s<r.length;s++)""+n=="1"?(a(i[o],r[s]),A(i[o],r[s])):""+n=="2"?a(i[o],r[s]):""+n=="3"&&A(i[o],r[s]);function a(n,i){for(var r=e.Gi.get(t.buildingID+""+n),o=l(r,i);-1!==o;)r[o].object.remove(),r.splice(o,1),o=l(r,i);var s=e.qi.get(t.buildingID+""+n);if(s)for(o=l(s,i);-1!==o;)s[o].object.remove(),s.splice(o,1),o=l(s,i)}function A(n,i){for(var r=e.Zi.get(t.buildingID+""+n),o=l(r,i);-1!==o;)r[o].object.remove(),r.splice(o,1),o=l(r,i)}function l(t,e){for(var n=-1,i=0;i<t.length;i++)if(""+t[i].roadRank==""+e){n=i;break}return n}}},{key:"changeVisible",value:function(t){}},{key:"dispose",value:function(){var t,e=pn(this.Zi);try{for(e.s();!(t=e.n()).done;){for(var n=fn(t.value,2),i=(n[0],n[1]),r=0;r<i.length;r++)i[r].object.remove();i.length=0}}catch(t){e.e(t)}finally{e.f()}var o,s=pn(this.Gi);try{for(s.s();!(o=s.n()).done;){for(var a=fn(o.value,2),A=(a[0],a[1]),l=0;l<A.length;l++)A[l].object.remove();A.length=0}}catch(t){s.e(t)}finally{s.f()}var u,h=pn(this.qi);try{for(h.s();!(u=h.n()).done;){for(var c=fn(u.value,2),f=(c[0],c[1]),p=0;p<f.length;p++)f[p].object.remove();f.length=0}}catch(t){h.e(t)}finally{h.f()}this.qi.clear(),this.Gi.clear(),this.Zi.clear(),this.P.on("beforeRender",this.zi)}}])&&mn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),vn=(Object.assign(gn.prototype,{Qi:function(t){for(var e=null,n=0;n<this.Xi.length;n++)if(""+this.Xi[n].roadRank==""+t){e=this.Xi[n];break}return e},Ki:function(t,e,n,i,r,o,s,a,A){var l,u=this,h=((l=((l=new fengmap.FMSegment).points=[{x:r.x,y:r.y,z:n},{x:o.x,y:o.y,z:n}],l.level=e,l.buildingID=a,new fengmap.FMLineMarker({segments:[l],width:t.lineWidth,color:t.lineColor,type:fengmap.FMLineType.FULL}))).addTo(this.P),this.Gi.get(a+""+e));function c(r,o){var s=new fengmap.FMSegment;(r=((o=(s.points=[{x:r.p1.x,y:r.p1.y,z:n},{x:o.x,y:o.y,z:n},{x:r.p2.x,y:r.p2.y,z:n}],s.level=e,s.buildingID=a,new fengmap.FMLineMarker({segments:[s],width:t.lineWidth,color:t.lineColor,type:fengmap.FMLineType.FULL,smooth:!1}))).addTo(u.P),u.qi.get(a+""+e)))?r.push({roadRank:i,object:o}):u.qi.set(a+""+e,[{roadRank:i,object:o}])}function f(t,e){var n=(t.x+e.x)/2,i=(t=(t.y+e.y)/2,Math.PI/4);return{p1:{x:(n-e.x)*Math.cos(i)-(t-e.y)*Math.sin(i)+e.x,y:(t-e.y)*Math.cos(i)+(n-e.x)*Math.sin(i)+e.y},p2:{x:(n-e.x)*Math.cos(2*Math.PI-i)-(t-e.y)*Math.sin(2*Math.PI-i)+e.x,y:(t-e.y)*Math.cos(2*Math.PI-i)+(n-e.x)*Math.sin(2*Math.PI-i)+e.y}}}h?h.push({roadRank:i,object:l,zoomRange:s}):this.Gi.set(a+""+e,[{roadRank:i,object:l,zoomRange:s}]),this.Ui&&(h={x:(r.x+o.x)/2,y:(r.y+o.y)/2},l={x:(r.x+h.x)/2,y:(r.y+h.y)/2},s={x:(o.x+h.x)/2,y:(o.y+h.y)/2},""+A=="1"?c(f(l,h),h):""+A=="2"?c(f(s,h),h):""+A=="3"&&(c(f(l,h),h),c(f(s,h),h)))},Wi:function(t,e,n,i,r,o,s,a){var A;this.$i(a+""+e,o)&&(A={x:r.x,y:r.y},A={points:fengmap.FMCalculator.rectangleBuilder(t.pointSize,t.pointSize,A),x:r.x,y:r.y,height:n,color:t.pointColor,borderWidth:0,opacity:1},r=this.P.getBuilding(a).getFloor(e),(n=new fengmap.FMPolygonMarker(A)).addTo(r),n.id=o,(t=this.Zi.get(a+""+e))?t.push({roadRank:i,object:n,zoomRange:s}):this.Zi.set(a+""+e,[{roadRank:i,object:n,zoomRange:s}]))},$i:function(t,e){var n,i=!0,r=pn(this.Zi);try{for(r.s();!(n=r.n()).done;){var o=fn(n.value,2),s=o[0],a=o[1];if(""+s==""+t)for(var A=0;A<a.length;A++)if(""+a[A].object.id==""+e){i=!1;break}if(!i)break}}catch(t){r.e(t)}finally{r.f()}return i},tn:function(t,e){for(var n=!1,i=0;i<e.length;i++)if(""+e[i]==""+t){n=!0;break}return n},zi:function(){for(var t=this.P.camera,e=this.P.getVisibleLevels(),n=this.P.getZoom(),i=0;i<e.length;i++){var r=this.P.getFloor(e[i]),o=this.Gi.get(""+e[i]);if(o)for(var s,a,A=0;A<o.length;A++)n<o[A].zoomRange[0]||n>o[A].zoomRange[1]?o[A].object.parent&&o[A].object.remove():(s=new l((a=o[A].object.segments[0].points)[0].x-this.P.x,a[0].z+r.height,-a[0].y+this.P.y),a=new l(a[1].x-this.P.x,a[1].z+r.height,-a[1].y+this.P.y),s=s.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix),a=a.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix),(1<Math.abs(s.x)||1<Math.abs(s.y)||1<Math.abs(s.z))&&(1<Math.abs(a.x)||1<Math.abs(a.y)||1<Math.abs(a.z))?o[A].object.parent&&o[A].object.remove():o[A].object.parent||o[A].object.addTo(this.P));var u=this.Zi.get(""+e[i]);if(u)for(var h=0;h<u.length;h++){var c,f=u[h].object;n<u[h].zoomRange[0]||n>u[h].zoomRange[1]?f.parent&&f.remove():(c=new l(f.x-this.P.x,f.height+r.height,-f.y+this.P.y).applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix),1<Math.abs(c.x)||1<Math.abs(c.y)||1<Math.abs(c.z)?f.parent&&f.remove():f.parent||f.addTo(r))}}this.P.enableUpdateRender()},Ji:function(t,e){var n=t.roadRanks,i=t.levels;if(void 0===t.buildingID&&(t.buildingID=this.P.getMapOptions().mapID),void 0===i){i=[];for(var r=this.P.getBuilding(t.buildingID).getFloorInfos(),o=0;o<r.length;o++)i.push(r[o].level)}for(var s=[],a=0;a<i.length;a++){var A=e.get(t.buildingID+""+i[a]);if(A)for(var l=0;l<A.length;l++)this.tn(A[l].roadRank,n)&&s.push(A[l].object)}return s}}),"v3.1.4"),bn=window.fengmap||{};bn.VERSION=vn,bn.BUILD=70,bn.FMMapEditor=n,bn.FMBoxSelectTool=De,bn.FMImageMarkerEdit=We,bn.FMPolygonMarkerEdit=en,bn.FMLineMarkerEdit=An,bn.FMSnapCtrl=hn,bn.FMNaviPathLineTool=gn,e.default=bn}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"nn",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.nn)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.nn?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=0).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()},"8qUe":function(t,e,n){var i;i=function(){return e=[function(t,e,n){"use strict";n.r(e);var i={};function r(){}n.r(i),n.d(i,"ShadowMaterial",function(){return Ae}),n.d(i,"SpriteMaterial",function(){return le}),n.d(i,"RawShaderMaterial",function(){return be}),n.d(i,"ShaderMaterial",function(){return ve}),n.d(i,"PointsMaterial",function(){return N}),n.d(i,"MeshPhysicalMaterial",function(){return we}),n.d(i,"MeshStandardMaterial",function(){return xe}),n.d(i,"MeshPhongMaterial",function(){return Be}),n.d(i,"MeshToonMaterial",function(){return Me}),n.d(i,"MeshNormalMaterial",function(){return Se}),n.d(i,"MeshLambertMaterial",function(){return _e}),n.d(i,"MeshDepthMaterial",function(){return Ee}),n.d(i,"MeshDistanceMaterial",function(){return Te}),n.d(i,"MeshBasicMaterial",function(){return Ce}),n.d(i,"MeshMatcapMaterial",function(){return Fe}),n.d(i,"LineDashedMaterial",function(){return Pe}),n.d(i,"LineBasicMaterial",function(){return Oe}),n.d(i,"Material",function(){return P}),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this.u&&(this.u={});var n=this.u;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){var n;return void 0!==this.u&&void 0!==(n=this.u)[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){var n;void 0!==this.u&&void 0!==(t=this.u[t])&&-1!==(n=t.indexOf(e))&&t.splice(n,1)},dispatchEvent:function(t){if(void 0!==this.u){var e=this.u[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t)}}}});for(var o=0,s=1,a=2,A=0,l=1,u=100,h=204,c=205,f=3,p=0,d=306,y=1e3,m=1001,g=1003,v=1006,b=1009,x=1022,w=1023,B=3e3,M=3200,S=0,_=7680,E=519,T=[],C=0;C<256;C++)T[C]=(C<16?"0":"")+C.toString(16);var F={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(T[255&t]+T[t>>8&255]+T[t>>16&255]+T[t>>24&255]+"-"+T[255&e]+T[e>>8&255]+"-"+T[e>>16&15|64]+T[e>>24&255]+"-"+T[63&n|128]+T[n>>8&255]+"-"+T[n>>16&255]+T[n>>24&255]+T[255&i]+T[i>>8&255]+T[i>>16&255]+T[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*F.DEG2RAD},radToDeg:function(t){return t*F.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var o=Math.cos,s=Math.sin,a=o(n/2),A=(n=s(n/2),o((e+i)/2)),l=s((e+i)/2),u=o((e-i)/2),h=s((e-i)/2);o=o((i-e)/2),s=s((i-e)/2);"XYX"===r?t.set(a*l,n*u,n*h,a*A):"YZY"===r?t.set(n*h,a*l,n*u,a*A):"ZXZ"===r?t.set(n*u,n*h,a*l,a*A):"XZX"===r?t.set(a*l,n*s,n*o,a*A):"YXY"===r?t.set(n*o,a*l,n*s,a*A):"ZYZ"===r&&t.set(n*s,n*o,a*l,a*A)}},O=0;function P(){Object.defineProperty(this,"id",{value:O++}),this.uuid=F.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=l,this.side=o,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=h,this.blendDst=c,this.blendEquation=u,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=f,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=E,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=_,this.stencilZFail=_,this.stencilZPass=_,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}P.prototype=Object.assign(Object.create(r.prototype),{constructor:P,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n,i=t[e];void 0===i||("shading"===e?this.flatShading=1===i:void 0===(n=this[e])||(n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i))}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e)for(var i=e.length,r=(n=new Array(i),0);r!==i;++r)n[r]=e[r].clone();return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(P.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}});var U={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},R={h:0,s:0,l:0},I={h:0,s:0,l:0};function L(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function D(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Q(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function k(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function N(t){P.call(this),this.type="PointsMaterial",this.color=new L(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function j(t,e,n,i){this.v=t||0,this._=e||0,this.A=n||0,this.S=void 0!==i?i:1}Object.assign(L.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){return t=F.euclideanModulo(t,1),e=F.clamp(e,0,1),n=F.clamp(n,0,1),0===e?this.r=this.g=this.b=n:(this.r=D(e=2*n-(n=n<=.5?n*(1+e):n+e-n*e),n,t+1/3),this.g=D(e,n,t),this.b=D(e,n,t-1/3)),this},setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}if(A=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,i,r,o,s=A[1],a=A[2];switch(s){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return i=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100,e(n[5]),this.setHSL(i,r,o)}}else if(A=/^\#([A-Fa-f0-9]+)$/.exec(t)){var A=(s=A[1]).length;if(3===A)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===A)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var e=U[t];return void 0!==e&&this.setHex(e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return e=0<(e=void 0===e?2:e)?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Q(t.r),this.g=Q(t.g),this.b=Q(t.b),this},copyLinearToSRGB:function(t){return this.r=k(t.r),this.g=k(t.g),this.b=k(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var e,n=this.r,i=this.g,r=this.b,o=Math.max(n,i,r),s=Math.min(n,i,r),a=(s+o)/2;if(s===o)l=e=0;else{var A=o-s,l=a<=.5?A/(o+s):A/(2-o-s);switch(o){case n:e=(i-r)/A+(i<r?6:0);break;case i:e=(r-n)/A+2;break;case r:e=(n-i)/A+4}e/=6}return t.h=e,t.s=l,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(R),R.h+=t,R.s+=e,R.l+=n,this.setHSL(R.h,R.s,R.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(R),t.getHSL(I);t=F.lerp(R.h,I.h,e);var n=F.lerp(R.s,I.s,e);e=F.lerp(R.l,I.l,e);return this.setHSL(t,n,e),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return this.r=t[e=void 0===e?0:e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}}),L.NAMES=U,((N.prototype=Object.create(P.prototype)).constructor=N).prototype.isPointsMaterial=!0,N.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},Object.assign(j,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,s){var a,A,l,u=n[i+0],h=n[i+1],c=n[i+2],f=(n=n[i+3],i=r[o+0],r[o+1]),p=r[o+2];n===(r=r[o+3])&&u===i&&h===f&&c===p||(o=1-s,a=0<=(A=u*i+h*f+c*p+n*r)?1:-1,(l=1-A*A)>Number.EPSILON&&(l=Math.sqrt(l),A=Math.atan2(l,A*a),o=Math.sin(o*A)/l,s=Math.sin(s*A)/l),u=u*o+i*(A=s*a),h=h*o+f*A,c=c*o+p*A,n=n*o+r*A,o===1-s&&(u*=l=1/Math.sqrt(u*u+h*h+c*c+n*n),h*=l,c*=l,n*=l)),t[e]=u,t[e+1]=h,t[e+2]=c,t[e+3]=n}}),Object.defineProperties(j.prototype,{x:{get:function(){return this.v},set:function(t){this.v=t,this.T()}},y:{get:function(){return this._},set:function(t){this._=t,this.T()}},z:{get:function(){return this.A},set:function(t){this.A=t,this.T()}},w:{get:function(){return this.S},set:function(t){this.S=t,this.T()}}}),Object.assign(j.prototype,{isQuaternion:!0,set:function(t,e,n,i){return this.v=t,this._=e,this.A=n,this.S=i,this.T(),this},clone:function(){return new this.constructor(this.v,this._,this.A,this.S)},copy:function(t){return this.v=t.x,this._=t.y,this.A=t.z,this.S=t.w,this.T(),this},setFromEuler:function(t,e){var n,i,r,o,s,a,A;if(t&&t.isEuler)return s=t.v,a=t._,n=t.A,t=t.order,o=Math.cos,A=Math.sin,i=o(s/2),r=o(a/2),o=o(n/2),s=A(s/2),a=A(a/2),A=A(n/2),"XYZ"===t?(this.v=s*r*o+i*a*A,this._=i*a*o-s*r*A,this.A=i*r*A+s*a*o,this.S=i*r*o-s*a*A):"YXZ"===t?(this.v=s*r*o+i*a*A,this._=i*a*o-s*r*A,this.A=i*r*A-s*a*o,this.S=i*r*o+s*a*A):"ZXY"===t?(this.v=s*r*o-i*a*A,this._=i*a*o+s*r*A,this.A=i*r*A+s*a*o,this.S=i*r*o-s*a*A):"ZYX"===t?(this.v=s*r*o-i*a*A,this._=i*a*o+s*r*A,this.A=i*r*A-s*a*o,this.S=i*r*o+s*a*A):"YZX"===t?(this.v=s*r*o+i*a*A,this._=i*a*o+s*r*A,this.A=i*r*A-s*a*o,this.S=i*r*o-s*a*A):"XZY"===t&&(this.v=s*r*o-i*a*A,this._=i*a*o-s*r*A,this.A=i*r*A+s*a*o,this.S=i*r*o+s*a*A),!1!==e&&this.T(),this;throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")},setFromAxisAngle:function(t,e){e/=2;var n=Math.sin(e);return this.v=t.x*n,this._=t.y*n,this.A=t.z*n,this.S=Math.cos(e),this.T(),this},setFromRotationMatrix:function(t){var e,n=(t=t.elements)[0],i=t[4],r=t[8],o=t[1],s=t[5],a=t[9],A=t[2],l=t[6],u=n+s+(t=t[10]);return 0<u?(e=.5/Math.sqrt(u+1),this.S=.25/e,this.v=(l-a)*e,this._=(r-A)*e,this.A=(o-i)*e):s<n&&t<n?(e=2*Math.sqrt(1+n-s-t),this.S=(l-a)/e,this.v=.25*e,this._=(i+o)/e,this.A=(r+A)/e):t<s?(e=2*Math.sqrt(1+s-n-t),this.S=(r-A)/e,this.v=(i+o)/e,this._=.25*e,this.A=(a+l)/e):(e=2*Math.sqrt(1+t-n-s),this.S=(o-i)/e,this.v=(r+A)/e,this._=(a+l)/e,this.A=.25*e),this.T(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.v=-t.y,this._=t.x,this.A=0):(this.v=0,this._=-t.z,this.A=t.y)):(this.v=t.y*e.z-t.z*e.y,this._=t.z*e.x-t.x*e.z,this.A=t.x*e.y-t.y*e.x),this.S=n,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(F.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);return 0!==n&&(e=Math.min(1,e/n),this.slerp(t,e)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.v*=-1,this._*=-1,this.A*=-1,this.T(),this},dot:function(t){return this.v*t.v+this._*t._+this.A*t.A+this.S*t.S},lengthSq:function(){return this.v*this.v+this._*this._+this.A*this.A+this.S*this.S},length:function(){return Math.sqrt(this.v*this.v+this._*this._+this.A*this.A+this.S*this.S)},normalize:function(){var t=this.length();return 0===t?(this.v=0,this._=0,this.A=0,this.S=1):(this.v=this.v*(t=1/t),this._=this._*t,this.A=this.A*t,this.S=this.S*t),this.T(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t.v,i=t._,r=t.A,o=(t=t.S,e.v),s=e._,a=e.A;e=e.S;return this.v=n*e+t*o+i*a-r*s,this._=i*e+t*s+r*o-n*a,this.A=r*e+t*a+n*s-i*o,this.S=t*e-n*o-i*s-r*a,this.T(),this},slerp:function(t,e){if(0!==e){if(1===e)return this.copy(t);var n,i=this.v,r=this._,o=this.A,s=this.S,a=s*t.S+i*t.v+r*t._+o*t.A;a<0?(this.S=-t.S,this.v=-t.v,this._=-t._,this.A=-t.A,a=-a):this.copy(t),1<=a?(this.S=s,this.v=i,this._=r,this.A=o):((t=1-a*a)<=Number.EPSILON?(this.S=(n=1-e)*s+e*this.S,this.v=n*i+e*this.v,this._=n*r+e*this._,this.A=n*o+e*this.A,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,a),a=Math.sin((1-e)*t)/n,e=Math.sin(e*t)/n,this.S=s*a+this.S*e,this.v=i*a+this.v*e,this._=r*a+this._*e,this.A=o*a+this.A*e),this.T())}return this},equals:function(t){return t.v===this.v&&t._===this._&&t.A===this.A&&t.S===this.S},fromArray:function(t,e){return this.v=t[e=void 0===e?0:e],this._=t[e+1],this.A=t[e+2],this.S=t[e+3],this.T(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.v,t[e+1]=this._,t[e+2]=this.A,t[e+3]=this.S,t},fromBufferAttribute:function(t,e){return this.v=t.getX(e),this._=t.getY(e),this.A=t.getZ(e),this.S=t.getW(e),this},M:function(t){return this.T=t,this},T:function(){}});var H=new V,z=new j;function V(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(V.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler,this.applyQuaternion(z.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(z.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=1/((t=t.elements)[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=(t=t.w)*e+o*i-s*n,A=t*n+s*e-r*i,l=t*i+r*n-o*e;e=-r*e-o*n-s*i;return this.x=a*t+e*-r+A*-s-l*-o,this.y=A*t+e*-o+l*-r-a*-s,this.z=l*t+e*-s+a*-o-A*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y,r=(t=t.z,e.x),o=e.y;e=e.z;return this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this},projectOnVector:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))},projectOnPlane:function(t){return H.copy(this).projectOnVector(t),this.sub(H)},reflect:function(t){return this.sub(H.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(F.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var G=[new V,new V,new V,new V,new V,new V,new V,new V],Y=new V,K=new rt,X=new V,W=new V,Z=new V,q=new V,J=new V,$=new V,tt=new V,et=new V,nt=new V,it=new V;function rt(t,e){this.min=void 0!==t?t:new V(1/0,1/0,1/0),this.max=void 0!==e?e:new V(-1/0,-1/0,-1/0)}function ot(t,e,n,i,r){for(var o=0,s=t.length-3;o<=s;o+=3){it.fromArray(t,o);var a=r.x*Math.abs(it.x)+r.y*Math.abs(it.y)+r.z*Math.abs(it.z),A=e.dot(it),l=n.dot(it),u=i.dot(it);if(Math.max(-Math.max(A,l,u),Math.min(A,l,u))>a)return!1}return!0}function st(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function at(t,e){this.x=t||0,this.y=e||0}Object.assign(rt.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,A=t.length;a<A;a+=3){var l=t[a],u=t[a+1],h=t[a+2];l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),s<h&&(s=h)}return this.min.set(e,n,i),this.max.set(r,o,s),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,A=t.count;a<A;a++){var l=t.getX(a),u=t.getY(a),h=t.getZ(a);l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),s<h&&(s=h)}return this.min.set(e,n,i),this.max.set(r,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=Y.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(t=new V),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new V),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);for(var e=t.geometry,n=(void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),K.copy(e.boundingBox),K.applyMatrix4(t.matrixWorld),this.union(K)),t.children),i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(e=new V),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Y),Y.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(tt),et.subVectors(this.max,tt),X.subVectors(t.a,tt),W.subVectors(t.b,tt),Z.subVectors(t.c,tt),q.subVectors(W,X),J.subVectors(Z,W),$.subVectors(X,Z),!!ot([0,-q.z,q.y,0,-J.z,J.y,0,-$.z,$.y,q.z,0,-q.x,J.z,0,-J.x,$.z,0,-$.x,-q.y,q.x,0,-J.y,J.x,0,-$.y,$.x,0],X,W,Z,et))&&!!ot([1,0,0,0,1,0,0,0,1],X,W,Z,et)&&(nt.crossVectors(q,J),ot([nt.x,nt.y,nt.z],X,W,Z,et))},clampPoint:function(t,e){return void 0===e&&(e=new V),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Y.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Y).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(G[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),G[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),G[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),G[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),G[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),G[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),G[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),G[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(G)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.defineProperties(st.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(st.prototype,{isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i+t[12]*r,this.y=t[1]*e+t[5]*n+t[9]*i+t[13]*r,this.z=t[2]*e+t[6]*n+t[10]*i+t[14]*r,this.w=t[3]*e+t[7]*n+t[11]*i+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o,s,a,A,l,u,h=(t=t.elements)[0],c=t[4],f=t[8],p=t[1],d=t[5],y=t[9],m=t[2],g=t[6];t=t[10];return Math.abs(c-p)<.01&&Math.abs(f-m)<.01&&Math.abs(y-g)<.01?Math.abs(c+p)<.1&&Math.abs(f+m)<.1&&Math.abs(y+g)<.1&&Math.abs(h+d+t-3)<.1?this.set(1,0,0,0):(r=Math.PI,s=(t+1)/2,a=(c+p)/4,A=(f+m)/4,l=(y+g)/4,(o=(d+1)/2)<(u=(h+1)/2)&&s<u?i=u<.01?(e=0,n=.707106781):(n=a/(e=Math.sqrt(u)),A/e):s<o?i=o<.01?(n=0,e=.707106781):(e=a/(n=Math.sqrt(o)),l/n):s<.01?(n=e=.707106781,i=0):(e=A/(i=Math.sqrt(s)),n=l/i),this.set(e,n,i,r)):(u=Math.sqrt((g-y)*(g-y)+(f-m)*(f-m)+(p-c)*(p-c)),Math.abs(u)<.001&&(u=1),this.x=(g-y)/u,this.y=(f-m)/u,this.z=(p-c)/u,this.w=Math.acos((h+d+t-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Object.defineProperties(at.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(at.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6],this.y=t[1]*e+t[4]*n+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),this.x-t.x),r=this.y-t.y;return this.x=i*n-r*e+t.x,this.y=i*e+r*n+t.y,this}});var At=new V;function lt(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function ut(t,e,n){lt.call(this,new Int8Array(t),e,n)}function ht(t,e,n){lt.call(this,new Uint8Array(t),e,n)}function ct(t,e,n){lt.call(this,new Uint8ClampedArray(t),e,n)}function ft(t,e,n){lt.call(this,new Int16Array(t),e,n)}function pt(t,e,n){lt.call(this,new Uint16Array(t),e,n)}function dt(t,e,n){lt.call(this,new Int32Array(t),e,n)}function yt(t,e,n){lt.call(this,new Uint32Array(t),e,n)}function mt(t,e,n){lt.call(this,new Float32Array(t),e,n)}function gt(t,e,n){lt.call(this,new Float64Array(t),e,n)}Object.defineProperty(lt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(lt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new L),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new at),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new V),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new st),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)At.x=this.getX(e),At.y=this.getY(e),At.z=this.getZ(e),At.applyMatrix3(t),this.setXYZ(e,At.x,At.y,At.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)At.x=this.getX(e),At.y=this.getY(e),At.z=this.getZ(e),At.applyMatrix4(t),this.setXYZ(e,At.x,At.y,At.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)At.x=this.getX(e),At.y=this.getY(e),At.z=this.getZ(e),At.applyNormalMatrix(t),this.setXYZ(e,At.x,At.y,At.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)At.x=this.getX(e),At.y=this.getY(e),At.z=this.getZ(e),At.transformDirection(t),this.setXYZ(e,At.x,At.y,At.z);return this},set:function(t,e){return this.array.set(t,e=void 0===e?0:e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(ut.prototype=Object.create(lt.prototype)).constructor=ut,(ht.prototype=Object.create(lt.prototype)).constructor=ht,(ct.prototype=Object.create(lt.prototype)).constructor=ct,(ft.prototype=Object.create(lt.prototype)).constructor=ft,pt.prototype=Object.create(lt.prototype),pt.prototype.constructor=pt,(dt.prototype=Object.create(lt.prototype)).constructor=dt,yt.prototype=Object.create(lt.prototype),yt.prototype.constructor=yt,(mt.prototype=Object.create(lt.prototype)).constructor=mt,(gt.prototype=Object.create(lt.prototype)).constructor=gt;var vt=new rt;function bt(t,e){this.center=void 0!==t?t:new V,this.radius=void 0!==e?e:0}function xt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(bt.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){for(var n=this.center,i=(void 0!==e?n.copy(e):vt.setFromPoints(t).getCenter(n),0),r=0,o=t.length;r<o;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(e=new V),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(t=new rt),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(xt.prototype,{computeGroups:function(t){for(var e,n=[],i=void 0,r=t.faces,o=0;o<r.length;o++){var s=r[o];s.materialIndex!==i&&(i=s.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&0<i[0].length,o=i[1]&&0<i[1].length,s=t.morphTargets,a=s.length;if(0<a){for(var A=[],l=0;l<a;l++)A[l]={name:s[l].name,data:[]};this.morphTargets.position=A}var u=t.morphNormals,h=u.length;if(0<h){var c=[];for(l=0;l<h;l++)c[l]={name:u[l].name,data:[]};this.morphTargets.normal=c}var f=t.skinIndices,p=t.skinWeights,d=f.length===n.length,y=p.length===n.length;for(0<n.length&&e.length,l=0;l<e.length;l++){var m,g,v=e[l];3===(g=(3===(g=(this.vertices.push(n[v.a],n[v.b],n[v.c]),v.vertexNormals)).length?this.normals.push(g[0],g[1],g[2]):(g=v.normal,this.normals.push(g,g,g)),v.vertexColors)).length?this.colors.push(g[0],g[1],g[2]):(g=v.color,this.colors.push(g,g,g)),!0===r&&(void 0!==(m=i[0][l])?this.uvs.push(m[0],m[1],m[2]):this.uvs.push(new at,new at,new at)),!0===o&&(void 0!==(m=i[1][l])?this.uvs2.push(m[0],m[1],m[2]):this.uvs2.push(new at,new at,new at));for(var b=0;b<a;b++){var x=s[b].vertices;A[b].data.push(x[v.a],x[v.b],x[v.c])}for(b=0;b<h;b++){var w=u[b].vertexNormals[l];c[b].data.push(w.a,w.b,w.c)}d&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),y&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var wt=new V,Bt=new Ct,Mt=new V(0,0,0),St=new V(1,1,1),_t=new V,Et=new V,Tt=new V;function Ct(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length}Object.assign(Ct.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,s,a,A,l,u,h,c,f,p,d){var y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=i,y[1]=r,y[5]=o,y[9]=s,y[13]=a,y[2]=A,y[6]=l,y[10]=u,y[14]=h,y[3]=c,y[7]=f,y[11]=p,y[15]=d,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ct).fromArray(this.elements)},copy:function(t){var e=this.elements;t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,i=1/wt.setFromMatrixColumn(t,0).length(),r=1/wt.setFromMatrixColumn(t,1).length();t=1/wt.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler;var e,n,i,r,o,s,a,A,l,u,h,c,f=this.elements,p=t.x,d=t.y,y=t.z,m=Math.cos(p),g=(p=Math.sin(p),Math.cos(d)),v=(d=Math.sin(d),Math.cos(y));y=Math.sin(y);return"XYZ"===t.order?(o=m*v,s=m*y,a=p*v,A=p*y,f[0]=g*v,f[4]=-g*y,f[8]=d,f[1]=s+a*d,f[5]=o-A*d,f[9]=-p*g,f[2]=A-o*d,f[6]=a+s*d,f[10]=m*g):"YXZ"===t.order?(n=g*y,i=d*v,f[0]=(e=g*v)+(r=d*y)*p,f[4]=i*p-n,f[8]=m*d,f[1]=m*y,f[5]=m*v,f[9]=-p,f[2]=n*p-i,f[6]=r+e*p,f[10]=m*g):"ZXY"===t.order?(n=g*y,i=d*v,f[0]=(e=g*v)-(r=d*y)*p,f[4]=-m*y,f[8]=i+n*p,f[1]=n+i*p,f[5]=m*v,f[9]=r-e*p,f[2]=-m*d,f[6]=p,f[10]=m*g):"ZYX"===t.order?(o=m*v,s=m*y,a=p*v,A=p*y,f[0]=g*v,f[4]=a*d-s,f[8]=o*d+A,f[1]=g*y,f[5]=A*d+o,f[9]=s*d-a,f[2]=-d,f[6]=p*g,f[10]=m*g):"YZX"===t.order?(l=m*g,u=m*d,h=p*g,c=p*d,f[0]=g*v,f[4]=c-l*y,f[8]=h*y+u,f[1]=y,f[5]=m*v,f[9]=-p*v,f[2]=-d*v,f[6]=u*y+h,f[10]=l-c*y):"XZY"===t.order&&(l=m*g,u=m*d,h=p*g,c=p*d,f[0]=g*v,f[4]=-y,f[8]=d*v,f[1]=l*y+c,f[5]=m*v,f[9]=u*y-h,f[2]=h*y-u,f[6]=p*v,f[10]=c*y+l),f[3]=0,f[7]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Mt,t,St)},lookAt:function(t,e,n){var i=this.elements;return Tt.subVectors(t,e),0===Tt.lengthSq()&&(Tt.z=1),Tt.normalize(),_t.crossVectors(n,Tt),0===_t.lengthSq()&&(1===Math.abs(n.z)?Tt.x+=1e-4:Tt.z+=1e-4,Tt.normalize(),_t.crossVectors(n,Tt)),_t.normalize(),Et.crossVectors(Tt,_t),i[0]=_t.x,i[4]=Et.x,i[8]=Tt.x,i[1]=_t.y,i[5]=Et.y,i[9]=Tt.y,i[2]=_t.z,i[6]=Et.z,i[10]=Tt.z,this},multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){t=t.elements,e=e.elements;var n=this.elements,i=t[0],r=t[4],o=t[8],s=t[12],a=t[1],A=t[5],l=t[9],u=t[13],h=t[2],c=t[6],f=t[10],p=t[14],d=t[3],y=t[7],m=t[11],g=(t=t[15],e[0]),v=e[4],b=e[8],x=e[12],w=e[1],B=e[5],M=e[9],S=e[13],_=e[2],E=e[6],T=e[10],C=e[14],F=e[3],O=e[7],P=e[11];e=e[15];return n[0]=i*g+r*w+o*_+s*F,n[4]=i*v+r*B+o*E+s*O,n[8]=i*b+r*M+o*T+s*P,n[12]=i*x+r*S+o*C+s*e,n[1]=a*g+A*w+l*_+u*F,n[5]=a*v+A*B+l*E+u*O,n[9]=a*b+A*M+l*T+u*P,n[13]=a*x+A*S+l*C+u*e,n[2]=h*g+c*w+f*_+p*F,n[6]=h*v+c*B+f*E+p*O,n[10]=h*b+c*M+f*T+p*P,n[14]=h*x+c*S+f*C+p*e,n[3]=d*g+y*w+m*_+t*F,n[7]=d*v+y*B+m*E+t*O,n[11]=d*b+y*M+m*T+t*P,n[15]=d*x+y*S+m*C+t*e,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],s=t[5],a=t[9],A=t[13],l=t[2],u=t[6],h=t[10],c=t[14];return t[3]*(+r*a*u-i*A*u-r*s*h+n*A*h+i*s*c-n*a*c)+t[7]*(+e*a*c-e*A*h+r*o*h-i*o*c+i*A*l-r*a*l)+t[11]*(+e*A*u-e*s*c-r*o*u+n*o*c+r*s*l-n*A*l)+t[15]*(-i*s*l-e*a*u+e*s*h+i*o*u-n*o*h+n*a*l)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this},getInverse:function(t,e){e=this.elements;var n=(t=t.elements)[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],A=t[6],l=t[7],u=t[8],h=t[9],c=t[10],f=t[11],p=t[12],d=t[13],y=t[14],m=h*y*l-d*c*l+d*A*f-a*y*f-h*A*(t=t[15])+a*c*t,g=p*c*l-u*y*l-p*A*f+s*y*f+u*A*t-s*c*t,v=u*d*l-p*h*l+p*a*f-s*d*f-u*a*t+s*h*t,b=p*h*A-u*d*A-p*a*c+s*d*c+u*a*y-s*h*y,x=n*m+i*g+r*v+o*b;return 0==x?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(e[0]=m*(m=1/x),e[1]=(d*c*o-h*y*o-d*r*f+i*y*f+h*r*t-i*c*t)*m,e[2]=(a*y*o-d*A*o+d*r*l-i*y*l-a*r*t+i*A*t)*m,e[3]=(h*A*o-a*c*o-h*r*l+i*c*l+a*r*f-i*A*f)*m,e[4]=g*m,e[5]=(u*y*o-p*c*o+p*r*f-n*y*f-u*r*t+n*c*t)*m,e[6]=(p*A*o-s*y*o-p*r*l+n*y*l+s*r*t-n*A*t)*m,e[7]=(s*c*o-u*A*o+u*r*l-n*c*l-s*r*f+n*A*f)*m,e[8]=v*m,e[9]=(p*h*o-u*d*o-p*i*f+n*d*f+u*i*t-n*h*t)*m,e[10]=(s*d*o-p*a*o+p*i*l-n*d*l-s*i*t+n*a*t)*m,e[11]=(u*a*o-s*h*o-u*i*l+n*h*l+s*i*f-n*a*f)*m,e[12]=b*m,e[13]=(u*d*r-p*h*r+p*i*c-n*d*c-u*i*y+n*h*y)*m,e[14]=(p*a*r-s*d*r-p*i*A+n*d*A+s*i*y-n*a*y)*m,e[15]=(s*h*r-u*a*r+u*i*A-n*h*A-s*i*c+n*a*c)*m,this)},invert:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7],l=t[8],u=t[9],h=t[10],c=t[11],f=t[12],p=t[13],d=t[14],y=t[15],m=u*d*A-p*h*A+p*a*c-s*d*c-u*a*y+s*h*y,g=f*h*A-l*d*A-f*a*c+o*d*c+l*a*y-o*h*y,v=l*p*A-f*u*A+f*s*c-o*p*c-l*s*y+o*u*y,b=f*u*a-l*p*a-f*s*h+o*p*h+l*s*d-o*u*d,x=e*m+n*g+i*v+r*b;return 0==x?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(t[0]=m*(m=1/x),t[1]=(p*h*r-u*d*r-p*i*c+n*d*c+u*i*y-n*h*y)*m,t[2]=(s*d*r-p*a*r+p*i*A-n*d*A-s*i*y+n*a*y)*m,t[3]=(u*a*r-s*h*r-u*i*A+n*h*A+s*i*c-n*a*c)*m,t[4]=g*m,t[5]=(l*d*r-f*h*r+f*i*c-e*d*c-l*i*y+e*h*y)*m,t[6]=(f*a*r-o*d*r-f*i*A+e*d*A+o*i*y-e*a*y)*m,t[7]=(o*h*r-l*a*r+l*i*A-e*h*A-o*i*c+e*a*c)*m,t[8]=v*m,t[9]=(f*u*r-l*p*r-f*n*c+e*p*c+l*n*y-e*u*y)*m,t[10]=(o*p*r-f*s*r+f*n*A-e*p*A-o*n*y+e*s*y)*m,t[11]=(l*s*r-o*u*r-l*n*A+e*u*A+o*n*c-e*s*c)*m,t[12]=b*m,t[13]=(l*p*i-f*u*i+f*n*h-e*p*h-l*n*d+e*u*d)*m,t[14]=(f*s*i-o*p*i-f*n*a+e*p*a+o*n*d-e*s*d)*m,t[15]=(o*u*i-l*s*i+l*n*a-e*u*a-o*n*h+e*s*h)*m,this)},scale:function(t){var e=this.elements,n=t.x,i=t.y;t=t.z;return e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],e=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(t,e,n))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),1-n),r=t.x,o=t.y,s=(t=t.z,i*r),a=i*o;return this.set(s*r+n,s*o-e*t,s*t+e*o,0,s*o+e*t,a*o+n,a*t-e*r,0,s*t-e*o,a*t+e*r,i*t*t+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var i=this.elements,r=e.v,o=e._,s=e.A,a=(e=e.S,r*(u=r+r)),A=r*(h=o+o),l=(r=r*(c=s+s),o*h),u=(o=o*c,s=s*c,e*u),h=e*h,c=(e=e*c,n.x),f=n.y;n=n.z;return i[0]=(1-(l+s))*c,i[1]=(A+e)*c,i[2]=(r-h)*c,i[3]=0,i[4]=(A-e)*f,i[5]=(1-(a+s))*f,i[6]=(o+u)*f,i[7]=0,i[8]=(r+h)*n,i[9]=(o-u)*n,i[10]=(1-(a+l))*n,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:function(t,e,n){var i=this.elements,r=wt.set(i[0],i[1],i[2]).length(),o=wt.set(i[4],i[5],i[6]).length(),s=wt.set(i[8],i[9],i[10]).length(),a=(t=(this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Bt.copy(this),1/r),i=1/o,1/s);return Bt.elements[0]*=t,Bt.elements[1]*=t,Bt.elements[2]*=t,Bt.elements[4]*=i,Bt.elements[5]*=i,Bt.elements[6]*=i,Bt.elements[8]*=a,Bt.elements[9]*=a,Bt.elements[10]*=a,e.setFromRotationMatrix(Bt),n.x=r,n.y=o,n.z=s,this},makePerspective:function(t,e,n,i,r,o){var s=this.elements,a=2*r/(n-i),A=(e+t)/(e-t);n=(n+i)/(n-i),i=-(o+r)/(o-r),o=-2*o*r/(o-r);return s[0]=2*r/(e-t),s[4]=0,s[8]=A,s[12]=0,s[1]=0,s[5]=a,s[9]=n,s[13]=0,s[2]=0,s[6]=0,s[10]=i,s[14]=o,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var s=this.elements,a=1/(e-t),A=1/(n-i),l=1/(o-r);e=(e+t)*a,t=(n+i)*A,n=(o+r)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-e,s[1]=0,s[5]=2*A,s[9]=0,s[13]=-t,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-n,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){var n=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}});var Ft=new Ct,Ot=new j;function Pt(t,e,n,i){this.v=t||0,this._=e||0,this.A=n||0,this.P=i||Pt.DefaultOrder}function Ut(){this.mask=1}function Rt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length}Pt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Pt.DefaultOrder="XYZ",Object.defineProperties(Pt.prototype,{x:{get:function(){return this.v},set:function(t){this.v=t,this.T()}},y:{get:function(){return this._},set:function(t){this._=t,this.T()}},z:{get:function(){return this.A},set:function(t){this.A=t,this.T()}},order:{get:function(){return this.P},set:function(t){this.P=t,this.T()}}}),Object.assign(Pt.prototype,{isEuler:!0,set:function(t,e,n,i){return this.v=t,this._=e,this.A=n,this.P=i||this.P,this.T(),this},clone:function(){return new this.constructor(this.v,this._,this.A,this.P)},copy:function(t){return this.v=t.v,this._=t._,this.A=t.A,this.P=t.P,this.T(),this},setFromRotationMatrix:function(t,e,n){var i=F.clamp,r=(t=t.elements)[0],o=t[4],s=t[8],a=t[1],A=t[5],l=t[9],u=t[2],h=t[6];t=t[10];return"XYZ"===(e=e||this.P)?(this._=Math.asin(i(s,-1,1)),Math.abs(s)<.9999999?(this.v=Math.atan2(-l,t),this.A=Math.atan2(-o,r)):(this.v=Math.atan2(h,A),this.A=0)):"YXZ"===e?(this.v=Math.asin(-i(l,-1,1)),Math.abs(l)<.9999999?(this._=Math.atan2(s,t),this.A=Math.atan2(a,A)):(this._=Math.atan2(-u,r),this.A=0)):"ZXY"===e?(this.v=Math.asin(i(h,-1,1)),Math.abs(h)<.9999999?(this._=Math.atan2(-u,t),this.A=Math.atan2(-o,A)):(this._=0,this.A=Math.atan2(a,r))):"ZYX"===e?(this._=Math.asin(-i(u,-1,1)),Math.abs(u)<.9999999?(this.v=Math.atan2(h,t),this.A=Math.atan2(a,r)):(this.v=0,this.A=Math.atan2(-o,A))):"YZX"===e?(this.A=Math.asin(i(a,-1,1)),Math.abs(a)<.9999999?(this.v=Math.atan2(-l,A),this._=Math.atan2(-u,r)):(this.v=0,this._=Math.atan2(s,t))):"XZY"===e&&(this.A=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this.v=Math.atan2(h,A),this._=Math.atan2(s,r)):(this.v=Math.atan2(-l,t),this._=0)),this.P=e,!1!==n&&this.T(),this},setFromQuaternion:function(t,e,n){return Ft.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Ft,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this.P)},reorder:function(t){return Ot.setFromEuler(this),this.setFromQuaternion(Ot,t)},equals:function(t){return t.v===this.v&&t._===this._&&t.A===this.A&&t.P===this.P},fromArray:function(t){return this.v=t[0],this._=t[1],this.A=t[2],void 0!==t[3]&&(this.P=t[3]),this.T(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.v,t[e+1]=this._,t[e+2]=this.A,t[e+3]=this.P,t},toVector3:function(t){return t?t.set(this.v,this._,this.A):new V(this.v,this._,this.A)},M:function(t){return this.T=t,this},T:function(){}}),Object.assign(Ut.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(Rt.prototype,{isMatrix3:!0,set:function(t,e,n,i,r,o,s,a,A){var l=this.elements;return l[0]=t,l[1]=i,l[2]=s,l[3]=e,l[4]=r,l[5]=a,l[6]=n,l[7]=o,l[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){t=t.elements,e=e.elements;var n=this.elements,i=t[0],r=t[3],o=t[6],s=t[1],a=t[4],A=t[7],l=t[2],u=t[5],h=(t=t[8],e[0]),c=e[3],f=e[6],p=e[1],d=e[4],y=e[7],m=e[2],g=e[5];e=e[8];return n[0]=i*h+r*p+o*m,n[3]=i*c+r*d+o*g,n[6]=i*f+r*y+o*e,n[1]=s*h+a*p+A*m,n[4]=s*c+a*d+A*g,n[7]=s*f+a*y+A*e,n[2]=l*h+u*p+t*m,n[5]=l*c+u*d+t*g,n[8]=l*f+u*y+t*e,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t,e=(t=this.elements)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7];return e*o*(t=t[8])-e*s*A-n*r*t+n*s*a+i*r*A-i*o*a},getInverse:function(t,e){e=t.elements,t=this.elements;var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],A=e[6],l=e[7],u=(e=e[8])*s-a*l,h=a*A-e*o,c=l*o-s*A,f=n*u+i*h+r*c;return 0==f?this.set(0,0,0,0,0,0,0,0,0):(t[0]=u*(u=1/f),t[1]=(r*l-e*i)*u,t[2]=(a*i-r*s)*u,t[3]=h*u,t[4]=(e*n-r*A)*u,t[5]=(r*o-a*n)*u,t[6]=c*u,t[7]=(i*A-l*n)*u,t[8]=(s*n-i*o)*u,this)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,i,r,o,s){var a=Math.cos(r);r=Math.sin(r);this.set(n*a,n*r,-n*(a*o+r*s)+o+t,-i*r,i*a,-i*(-r*o+a*s)+s+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=(t=Math.sin(t),this.elements),i=n[0],r=n[3],o=n[6],s=n[1],a=n[4],A=n[7];return n[0]=e*i+t*s,n[3]=e*r+t*a,n[6]=e*o+t*A,n[1]=-t*i+e*s,n[4]=-t*r+e*a,n[7]=-t*o+e*A,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){var n=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var It=0,Lt=new V,Dt=new j,Qt=new Ct,kt=new V,Nt=new V,jt=new V,Ht=new j,zt=new V(1,0,0),Vt=new V(0,1,0),Gt=new V(0,0,1),Yt={type:"added"},Kt={type:"removed"};function Xt(){Object.defineProperty(this,"id",{value:It++}),this.uuid=F.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xt.DefaultUp.clone();var t=new V,e=new Pt,n=new j,i=new V(1,1,1);e.M(function(){n.setFromEuler(e,!1)}),n.M(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ct},normalMatrix:{value:new Rt}}),this.matrix=new Ct,this.matrixWorld=new Ct,this.matrixAutoUpdate=Xt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ut,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Xt.DefaultUp=new V(0,1,0),Xt.DefaultMatrixAutoUpdate=!0,Xt.prototype=Object.assign(Object.create(r.prototype),{constructor:Xt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return Dt.setFromAxisAngle(t,e),this.quaternion.multiply(Dt),this},rotateOnWorldAxis:function(t,e){return Dt.setFromAxisAngle(t,e),this.quaternion.premultiply(Dt),this},rotateX:function(t){return this.rotateOnAxis(zt,t)},rotateY:function(t){return this.rotateOnAxis(Vt,t)},rotateZ:function(t){return this.rotateOnAxis(Gt,t)},translateOnAxis:function(t,e){return Lt.copy(t).applyQuaternion(this.quaternion),this.position.add(Lt.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(zt,t)},translateY:function(t){return this.translateOnAxis(Vt,t)},translateZ:function(t){return this.translateOnAxis(Gt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Qt.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?kt.copy(t):kt.set(t,e,n),t=this.parent,this.updateWorldMatrix(!0,!1),Nt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qt.lookAt(Nt,kt,this.up):Qt.lookAt(kt,Nt,this.up),this.quaternion.setFromRotationMatrix(Qt),t&&(Qt.extractRotation(t.matrixWorld),Dt.setFromRotationMatrix(Qt),this.quaternion.premultiply(Dt.inverse()))},add:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.add(arguments[e]);else t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(Yt));return this},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);else{var n=this.children.indexOf(t);-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Kt))}return this},attach:function(t){return this.updateWorldMatrix(!0,!1),Qt.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Qt.multiply(t.parent.matrixWorld)),t.applyMatrix4(Qt),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(t=new V),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(t=new j),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Nt,t,jt),t},getWorldScale:function(t){return void 0===t&&(t=new V),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Nt,Ht,t),t},getWorldDirection:function(t){void 0===t&&(t=new V),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var i=this.children,r=0,o=i.length;r<o;r++)i[r].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}});var Wt=1,Zt=new Ct,qt=new Xt,Jt=new V,$t=new rt,te=new rt,ee=new V;function ne(){Object.defineProperty(this,"id",{value:Wt+=2}),this.uuid=F.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}ne.prototype=Object.assign(Object.create(r.prototype),{constructor:ne,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<function(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}(t)?yt:pt)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e,n=(void 0!==(e=(void 0!==(e=this.attributes.position)&&(e.applyMatrix4(t),e.needsUpdate=!0),this.attributes.normal))&&(n=(new Rt).getNormalMatrix(t),e.applyNormalMatrix(n),e.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Zt.makeRotationX(t),this.applyMatrix4(Zt),this},rotateY:function(t){return Zt.makeRotationY(t),this.applyMatrix4(Zt),this},rotateZ:function(t){return Zt.makeRotationZ(t),this.applyMatrix4(Zt),this},translate:function(t,e,n){return Zt.makeTranslation(t,e,n),this.applyMatrix4(Zt),this},scale:function(t,e,n){return Zt.makeScale(t,e,n),this.applyMatrix4(Zt),this},lookAt:function(t){return qt.lookAt(t),qt.updateMatrix(),this.applyMatrix4(qt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Jt).negate(),this.translate(Jt.x,Jt.y,Jt.z),this},setFromObject:function(t){var e,n,i=t.geometry;return t.isPoints||t.isLine?(n=new mt(3*i.vertices.length,3),e=new mt(3*i.colors.length,3),this.setAttribute("position",n.copyVector3sArray(i.vertices)),this.setAttribute("color",e.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length&&(n=new mt(i.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(i.lineDistances))),null!==i.boundingSphere&&(this.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(this.boundingBox=i.boundingBox.clone())):t.isMesh&&i&&i.isGeometry&&this.fromGeometry(i),this},setFromPoints:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new mt(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var i=n.L;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.L=(new xt).fromGeometry(t),this.fromDirectGeometry(t.L)},fromDirectGeometry:function(t){var e,n=new Float32Array(3*t.vertices.length);for(e in this.setAttribute("position",new lt(n,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(n=new Float32Array(3*t.normals.length),this.setAttribute("normal",new lt(n,3).copyVector3sArray(t.normals))),0<t.colors.length&&(n=new Float32Array(3*t.colors.length),this.setAttribute("color",new lt(n,3).copyColorsArray(t.colors))),0<t.uvs.length&&(n=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new lt(n,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(n=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new lt(n,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var i=[],r=t.morphTargets[e],o=0,s=r.length;o<s;o++){var a=r[o],A=new mt(3*a.data.length,3);A.name=a.name,i.push(A.copyVector3sArray(a.data))}this.morphAttributes[e]=i}return 0<t.skinIndices.length&&(n=new mt(4*t.skinIndices.length,4),this.setAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new mt(4*t.skinWeights.length,4),this.setAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new rt);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var r=e[n];$t.setFromBufferAttribute(r),this.morphTargetsRelative?(ee.addVectors(this.boundingBox.min,$t.min),this.boundingBox.expandByPoint(ee),ee.addVectors(this.boundingBox.max,$t.max),this.boundingBox.expandByPoint(ee)):(this.boundingBox.expandByPoint($t.min),this.boundingBox.expandByPoint($t.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new bt);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if($t.setFromBufferAttribute(t),e)for(var i=0,r=e.length;i<r;i++){var o=e[i];te.setFromBufferAttribute(o),this.morphTargetsRelative?(ee.addVectors($t.min,te.min),$t.expandByPoint(ee),ee.addVectors($t.max,te.max),$t.expandByPoint(ee)):($t.expandByPoint(te.min),$t.expandByPoint(te.max))}$t.getCenter(n);var s=0;for(i=0,r=t.count;i<r;i++)ee.fromBufferAttribute(t,i),s=Math.max(s,n.distanceToSquared(ee));if(e)for(i=0,r=e.length;i<r;i++){o=e[i];for(var a=this.morphTargetsRelative,A=0,l=o.count;A<l;A++)ee.fromBufferAttribute(o,A),a&&(Jt.fromBufferAttribute(t,A),ee.add(Jt)),s=Math.max(s,n.distanceToSquared(ee))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new lt(new Float32Array(n.length),3));else for(var i=e.normal.array,r=0,o=i.length;r<o;r++)i[r]=0;var s,a,A,l=e.normal.array,u=new V,h=new V,c=new V,f=new V,p=new V;if(t){var d=t.array;for(r=0,o=t.count;r<o;r+=3)s=3*d[r+0],a=3*d[r+1],A=3*d[r+2],u.fromArray(n,s),h.fromArray(n,a),c.fromArray(n,A),f.subVectors(c,h),p.subVectors(u,h),f.cross(p),l[s]+=f.x,l[1+s]+=f.y,l[2+s]+=f.z,l[a]+=f.x,l[1+a]+=f.y,l[2+a]+=f.z,l[A]+=f.x,l[1+A]+=f.y,l[2+A]+=f.z}else for(r=0,o=n.length;r<o;r+=9)u.fromArray(n,r),h.fromArray(n,r+3),c.fromArray(n,r+6),f.subVectors(c,h),p.subVectors(u,h),f.cross(p),l[r]=f.x,l[r+1]=f.y,l[r+2]=f.z,l[r+3]=f.x,l[r+4]=f.y,l[r+5]=f.z,l[r+6]=f.x,l[r+7]=f.y,l[r+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)ee.x=t.getX(e),ee.y=t.getY(e),ee.z=t.getZ(e),ee.normalize(),t.setXYZ(e,ee.x,ee.y,ee.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ie={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function re(t,e,n){var i=this,r=!1,o=0,s=0,a=void 0,A=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,s),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,s),o===s&&(r=!1,void 0!==i.onLoad)&&i.onLoad()},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this},this.addHandler=function(t,e){return A.push(t,e),this},this.removeHandler=function(t){return-1!==(t=A.indexOf(t))&&A.splice(t,2),this},this.getHandler=function(t){for(var e=0,n=A.length;e<n;e+=2){var i=A[e],r=A[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return r}return null},this.isLoaded=function(){return o===s}}var oe=new re,se={};function ae(t){Re.call(this,t)}function Ae(t){P.call(this),this.type="ShadowMaterial",this.color=new L(0),this.transparent=!0,this.setValues(t)}function le(t){P.call(this),this.type="SpriteMaterial",this.color=new L(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}function ue(t){var e,n={};for(e in t)for(var i in n[e]={},t[e]){var r=t[e][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?n[e][i]=r.clone():Array.isArray(r)?n[e][i]=r.slice():n[e][i]=r}return n}function he(t){for(var e={},n=0;n<t.length;n++){var i,r=ue(t[n]);for(i in r)e[i]=r[i]}return e}ae.prototype=Object.assign(Object.create(Re.prototype),{constructor:ae,load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=ie.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;if(void 0===se[t]){var s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var a=s[1],A=!!s[2],l=s[3];l=decodeURIComponent(l);A&&(l=atob(l));try{var u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),c=0;c<l.length;c++)h[c]=l.charCodeAt(c);f="blob"===u?new Blob([h.buffer],{type:a}):h.buffer;break;case"document":var f=(new DOMParser).parseFromString(l,a);break;case"json":f=JSON.parse(l);break;default:f=l}setTimeout(function(){e&&e(f),r.manager.itemEnd(t)},0)}catch(e){setTimeout(function(){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)},0)}}else{se[t]=[],se[t].push({onLoad:e,onProgress:n,onError:i});var p,d=new XMLHttpRequest;for(p in d.open("GET",t,!0),d.addEventListener("load",function(e){var n=this.response,i=se[t];if(delete se[t],200===this.status||0===this.status){this.status,ie.add(t,n);for(var o=0,s=i.length;o<s;o++)(a=i[o]).onLoad&&a.onLoad(n)}else{var a;for(o=0,s=i.length;o<s;o++)(a=i[o]).onError&&a.onError(e);r.manager.itemError(t)}r.manager.itemEnd(t)},!1),d.addEventListener("progress",function(e){for(var n=se[t],i=0,r=n.length;i<r;i++){var o=n[i];o.onProgress&&o.onProgress(e)}},!1),d.addEventListener("error",function(e){var n=se[t];delete se[t];for(var i=0,o=n.length;i<o;i++){var s=n[i];s.onError&&s.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),d.addEventListener("abort",function(e){var n=se[t];delete se[t];for(var i=0,o=n.length;i<o;i++){var s=n[i];s.onError&&s.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),void 0!==this.responseType&&(d.responseType=this.responseType),void 0!==this.withCredentials&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)d.setRequestHeader(p,this.requestHeader[p]);d.send(null)}return r.manager.itemStart(t),d}se[t].push({onLoad:e,onProgress:n,onError:i})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),((Ae.prototype=Object.create(P.prototype)).constructor=Ae).prototype.isShadowMaterial=!0,Ae.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this},((le.prototype=Object.create(P.prototype)).constructor=le).prototype.isSpriteMaterial=!0,le.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var ce,fe,pe,de,ye={clone:ue,merge:he},me="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",ge="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n";function ve(t){P.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=me,this.fragmentShader=ge,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(t.attributes,this.setValues(t))}function be(t){ve.call(this,t),this.type="RawShaderMaterial"}function xe(t){P.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new L(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new L(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=S,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function we(t){xe.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new at(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Be(t){P.call(this),this.type="MeshPhongMaterial",this.color=new L(16777215),this.specular=new L(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new L(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=S,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Me(t){P.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new L(16777215),this.specular=new L(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new L(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=S,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Se(t){P.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=S,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function _e(t){P.call(this),this.type="MeshLambertMaterial",this.color=new L(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new L(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ee(t){P.call(this),this.type="MeshDepthMaterial",this.depthPacking=M,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Te(t){P.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new V,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Ce(t){P.call(this),this.type="MeshBasicMaterial",this.color=new L(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}function Fe(t){P.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new L(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=S,this.normalScale=new at(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Oe(t){P.call(this),this.type="LineBasicMaterial",this.color=new L(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}function Pe(t){Oe.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Ue(t){Re.call(this,t),this.textures={}}function Re(t){this.manager=void 0!==t?t:oe,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}function Ie(t){Re.call(this,t)}((ve.prototype=Object.create(P.prototype)).constructor=ve).prototype.isShaderMaterial=!0,ve.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ue(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},((be.prototype=Object.create(ve.prototype)).constructor=be).prototype.isRawShaderMaterial=!0,((xe.prototype=Object.create(P.prototype)).constructor=xe).prototype.isMeshStandardMaterial=!0,xe.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},((we.prototype=Object.create(xe.prototype)).constructor=we).prototype.isMeshPhysicalMaterial=!0,we.prototype.copy=function(t){return xe.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new L).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},((Be.prototype=Object.create(P.prototype)).constructor=Be).prototype.isMeshPhongMaterial=!0,Be.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Me.prototype=Object.create(P.prototype)).constructor=Me).prototype.isMeshToonMaterial=!0,Me.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Se.prototype=Object.create(P.prototype)).constructor=Se).prototype.isMeshNormalMaterial=!0,Se.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((_e.prototype=Object.create(P.prototype)).constructor=_e).prototype.isMeshLambertMaterial=!0,_e.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Ee.prototype=Object.create(P.prototype)).constructor=Ee).prototype.isMeshDepthMaterial=!0,Ee.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((Te.prototype=Object.create(P.prototype)).constructor=Te).prototype.isMeshDistanceMaterial=!0,Te.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},((Ce.prototype=Object.create(P.prototype)).constructor=Ce).prototype.isMeshBasicMaterial=!0,Ce.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},((Fe.prototype=Object.create(P.prototype)).constructor=Fe).prototype.isMeshMatcapMaterial=!0,Fe.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Oe.prototype=Object.create(P.prototype)).constructor=Oe).prototype.isLineBasicMaterial=!0,Oe.prototype.copy=function(t){return P.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},((Pe.prototype=Object.create(Oe.prototype)).constructor=Pe).prototype.isLineDashedMaterial=!0,Pe.prototype.copy=function(t){return Oe.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},Ue.prototype=Object.assign(Object.create(Re.prototype),{constructor:Ue,load:function(t,e,n,i){var r=this,o=new ae(r.manager);o.setPath(r.path),o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},parse:function(t){var e=this.textures;function n(t){return e[t],e[t]}var r,o=new i[t.type];if(void 0!==t.uuid&&(o.uuid=t.uuid),void 0!==t.name&&(o.name=t.name),void 0!==t.color&&o.color.setHex(t.color),void 0!==t.roughness&&(o.roughness=t.roughness),void 0!==t.metalness&&(o.metalness=t.metalness),void 0!==t.sheen&&(o.sheen=(new L).setHex(t.sheen)),void 0!==t.emissive&&o.emissive.setHex(t.emissive),void 0!==t.specular&&o.specular.setHex(t.specular),void 0!==t.shininess&&(o.shininess=t.shininess),void 0!==t.clearcoat&&(o.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(o.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(o.fog=t.fog),void 0!==t.flatShading&&(o.flatShading=t.flatShading),void 0!==t.blending&&(o.blending=t.blending),void 0!==t.combine&&(o.combine=t.combine),void 0!==t.side&&(o.side=t.side),void 0!==t.opacity&&(o.opacity=t.opacity),void 0!==t.transparent&&(o.transparent=t.transparent),void 0!==t.alphaTest&&(o.alphaTest=t.alphaTest),void 0!==t.depthTest&&(o.depthTest=t.depthTest),void 0!==t.depthWrite&&(o.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(o.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(o.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(o.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(o.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(o.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(o.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(o.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(o.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(o.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(o.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(o.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(o.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(o.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(o.rotation=t.rotation),1!==t.linewidth&&(o.linewidth=t.linewidth),void 0!==t.dashSize&&(o.dashSize=t.dashSize),void 0!==t.gapSize&&(o.gapSize=t.gapSize),void 0!==t.scale&&(o.scale=t.scale),void 0!==t.polygonOffset&&(o.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(o.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(o.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(o.skinning=t.skinning),void 0!==t.morphTargets&&(o.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(o.morphNormals=t.morphNormals),void 0!==t.dithering&&(o.dithering=t.dithering),void 0!==t.vertexTangents&&(o.vertexTangents=t.vertexTangents),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.toneMapped&&(o.toneMapped=t.toneMapped),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?o.vertexColors=0<t.vertexColors:o.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var s in t.uniforms){var a=t.uniforms[s];switch(o.uniforms[s]={},a.type){case"t":o.uniforms[s].value=n(a.value);break;case"c":o.uniforms[s].value=(new L).setHex(a.value);break;case"v2":o.uniforms[s].value=(new at).fromArray(a.value);break;case"v3":o.uniforms[s].value=(new V).fromArray(a.value);break;case"v4":o.uniforms[s].value=(new st).fromArray(a.value);break;case"m3":o.uniforms[s].value=(new Rt).fromArray(a.value);case"m4":o.uniforms[s].value=(new Ct).fromArray(a.value);break;default:o.uniforms[s].value=a.value}}if(void 0!==t.defines&&(o.defines=t.defines),void 0!==t.vertexShader&&(o.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(o.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var A in t.extensions)o.extensions[A]=t.extensions[A];return void 0!==t.shading&&(o.flatShading=1===t.shading),void 0!==t.size&&(o.size=t.size),void 0!==t.sizeAttenuation&&(o.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(o.map=n(t.map)),void 0!==t.matcap&&(o.matcap=n(t.matcap)),void 0!==t.alphaMap&&(o.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(o.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(o.bumpScale=t.bumpScale),void 0!==t.normalMap&&(o.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(o.normalMapType=t.normalMapType),void 0!==t.normalScale&&(r=t.normalScale,!1===Array.isArray(r)&&(r=[r,r]),o.normalScale=(new at).fromArray(r)),void 0!==t.displacementMap&&(o.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(o.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(o.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(o.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(o.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(o.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(o.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(o.specularMap=n(t.specularMap)),void 0!==t.envMap&&(o.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(o.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(o.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(o.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(o.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(o.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(o.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(o.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(o.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(o.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(o.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(o.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(o.clearcoatNormalScale=(new at).fromArray(t.clearcoatNormalScale)),o},setTextures:function(t){return this.textures=t,this}}),Object.assign(Re.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}}),Object.assign(Re.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:(ce={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},fe=new L,pe=new Qe,de=new Ue,function(t,e,n){var i={};function r(t,r,o,s,a){t=e+t;var A=(null!==(A=(new re).getHandler(t))?A:(pe.setCrossOrigin(n),pe)).load(t);void 0!==r&&(A.repeat.fromArray(r),1!==r[0]&&(A.wrapS=1e3),1!==r[1])&&(A.wrapT=1e3),void 0!==o&&A.offset.fromArray(o),void 0!==s&&("repeat"===s[0]&&(A.wrapS=1e3),"mirror"===s[0]&&(A.wrapS=1002),"repeat"===s[1]&&(A.wrapT=1e3),"mirror"===s[1])&&(A.wrapT=1002),void 0!==a&&(A.anisotropy=a),t=F.generateUUID();return i[t]=A,t}var o,s={uuid:F.generateUUID(),type:"MeshLambertMaterial"};for(o in t){var a=t[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":s.name=a;break;case"blending":s.blending=ce[a];break;case"colorAmbient":case"mapAmbient":break;case"colorDiffuse":s.color=fe.fromArray(a).getHex();break;case"colorSpecular":s.specular=fe.fromArray(a).getHex();break;case"colorEmissive":s.emissive=fe.fromArray(a).getHex();break;case"specularCoef":s.shininess=a;break;case"shading":"basic"===a.toLowerCase()&&(s.type="MeshBasicMaterial"),"phong"===a.toLowerCase()&&(s.type="MeshPhongMaterial"),"standard"===a.toLowerCase()&&(s.type="MeshStandardMaterial");break;case"mapDiffuse":s.map=r(a,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":s.emissiveMap=r(a,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":s.lightMap=r(a,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":s.aoMap=r(a,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":s.bumpMap=r(a,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":s.bumpScale=a;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":s.normalMap=r(a,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":s.normalScale=a;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":s.specularMap=r(a,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":s.metalnessMap=r(a,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":s.roughnessMap=r(a,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":s.alphaMap=r(a,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":s.side=1;break;case"doubleSided":s.side=2;break;case"transparency":s.opacity=a;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":s[o]=a;break;case"vertexColors":!0===a&&(s.vertexColors=2),"face"===a&&(s.vertexColors=1)}}return"MeshBasicMaterial"===s.type&&delete s.emissive,"MeshPhongMaterial"!==s.type&&delete s.specular,s.opacity<1&&(s.transparent=!0),de.setTextures(i),de.parse(s)})}),Ie.prototype=Object.assign(Object.create(Re.prototype),{constructor:Ie,load:function(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r,o=this,s=ie.get(t);return void 0!==s?(o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s):((r=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",a,!1),r.addEventListener("error",A,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(r.crossOrigin=this.crossOrigin),o.manager.itemStart(t),r.src=t,r);function a(){r.removeEventListener("load",a,!1),r.removeEventListener("error",A,!1),ie.add(t,this),e&&e(this),o.manager.itemEnd(t)}function A(e){r.removeEventListener("load",a,!1),r.removeEventListener("error",A,!1),i&&i(e),o.manager.itemError(t),o.manager.itemEnd(t)}}});var Le=0;function De(t,e,n,i,r,o,s,a,A,l){Object.defineProperty(this,"id",{value:Le++}),this.uuid=F.generateUUID(),this.name="",this.image=void 0!==t?t:De.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:De.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:m,this.wrapT=void 0!==i?i:m,this.magFilter=void 0!==r?r:v,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==A?A:1,this.format=void 0!==s?s:w,this.internalFormat=null,this.type=void 0!==a?a:b,this.offset=new at(0,0),this.repeat=new at(1,1),this.center=new at(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Rt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:B,this.version=0,this.onUpdate=null}function Qe(t){Re.call(this,t)}De.DEFAULT_IMAGE=void 0,De.DEFAULT_MAPPING=300,De.prototype=Object.assign(Object.create(r.prototype),{constructor:De,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case y:t.x=t.x-Math.floor(t.x);break;case m:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case y:t.y=t.y-Math.floor(t.y);break;case m:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}return t}}),Object.defineProperty(De.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Qe.prototype=Object.assign(Object.create(Re.prototype),{constructor:Qe,load:function(t,e,n,i){var r=new De,o=new Ie(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){r.image=n,n=0<t.search(/\.jpe?g($|\?)/i)||0===t.search(/^data\:image\/jpeg/),r.format=n?x:w,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r}});var ke=new V,Ne=new V,je=new V,He=new V,ze=new V,Ve=new V,Ge=new V;function Ye(t,e){this.origin=void 0!==t?t:new V,this.direction=void 0!==e?e:new V(0,0,-1)}Object.assign(Ye.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(e=new V),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,ke)),this},closestPointToPoint:function(t,e){return void 0===e&&(e=new V),e.subVectors(t,this.origin),(t=e.dot(this.direction))<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=ke.subVectors(t,this.origin).dot(this.direction);return(e<0?this.origin:(ke.copy(this.direction).multiplyScalar(e).add(this.origin),ke)).distanceToSquared(t)},distanceSqToSegment:function(t,e,n,i){Ne.copy(t).add(e).multiplyScalar(.5),je.copy(e).sub(t).normalize(),He.copy(this.origin).sub(Ne);t=.5*t.distanceTo(e),e=-this.direction.dot(je);var r,o,s,a=He.dot(this.direction),A=-He.dot(je),l=He.lengthSq(),u=Math.abs(1-e*e);return u=0<u?(o=e*a-A,s=t*u,0<=(r=e*A-a)?-s<=o?o<=s?(r*=u=1/u)*(r+e*(o*=u)+2*a)+o*(e*r+o+2*A)+l:(o=t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l):(o=-t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l):o<=-s?-(r=Math.max(0,-(-e*t+a)))*r+(o=0<r?-t:Math.min(Math.max(-t,-A),t))*(o+2*A)+l:o<=s?(r=0,(o=Math.min(Math.max(-t,-A),t))*(o+2*A)+l):-(r=Math.max(0,-(e*t+a)))*r+(o=0<r?t:Math.min(Math.max(-t,-A),t))*(o+2*A)+l):(o=0<e?-t:t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l),n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(je).multiplyScalar(o).add(Ne),u},intersectSphere:function(t,e){ke.subVectors(t.center,this.origin);var n=ke.dot(this.direction),i=ke.dot(ke)-n*n;return(t=t.radius*t.radius)<i||(i=n+(t=Math.sqrt(t-i)),(n-=t)<0&&i<0)?null:n<0?this.at(i,e):this.at(n,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,i,r,o=1/this.direction.x,s=1/this.direction.y,a=1/this.direction.z,A=this.origin;o=0<=o?(n=(t.min.x-A.x)*o,(t.max.x-A.x)*o):(n=(t.max.x-A.x)*o,(t.min.x-A.x)*o);return(s=0<=s?(r=(t.min.y-A.y)*s,(t.max.y-A.y)*s):(r=(t.max.y-A.y)*s,(t.min.y-A.y)*s))<n||o<r||((n<r||n!=n)&&(n=r),(s<o||o!=o)&&(o=s),(r=0<=a?(i=(t.min.z-A.z)*a,(t.max.z-A.z)*a):(i=(t.max.z-A.z)*a,(t.min.z-A.z)*a))<n)||o<i||((n<i||n!=n)&&(n=i),(o=r<o||o!=o?r:o)<0)?null:this.at(0<=n?n:o,e)},intersectsBox:function(t){return null!==this.intersectBox(t,ke)},intersectTriangle:function(t,e,n,i,r){var o;if(ze.subVectors(e,t),Ve.subVectors(n,t),Ge.crossVectors(ze,Ve),0<(e=this.direction.dot(Ge))){if(i)return null;o=1}else{if(!(e<0))return null;o=-1,e=-e}return He.subVectors(this.origin,t),(n=o*this.direction.dot(Ve.crossVectors(He,Ve)))<0||(i=o*this.direction.dot(ze.cross(He)))<0||e<n+i||(t=-o*He.dot(Ge))<0?null:this.at(t/e,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var Ke=new Ct,Xe=new Ye,We=new bt,Ze=new V;function qe(t,e){Xt.call(this),this.type="Points",this.geometry=void 0!==t?t:new ne,this.material=void 0!==e?e:new N,this.updateMorphTargets()}function Je(t,e,n,i,r,o,s){var a=Xe.distanceSqToPoint(t);a<n&&(n=new V,Xe.closestPointToPoint(t,n),n.applyMatrix4(i),(t=r.ray.origin.distanceTo(n))<r.near||t>r.far||o.push({distance:t,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:s}))}function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===$e(t=function(t,e){if("object"!==$e(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==$e(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}qe.prototype=Object.assign(Object.create(Xt.prototype),{constructor:qe,isPoints:!0,raycast:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),We.copy(n.boundingSphere),We.applyMatrix4(i),We.radius+=r,!1!==t.ray.intersectsSphere(We)){Ke.getInverse(i),Xe.copy(t.ray).applyMatrix4(Ke);var o=(r=r/((this.scale.x+this.scale.y+this.scale.z)/3))*r;if(n.isBufferGeometry){r=n.index;var s=n.attributes.position.array;if(null!==r)for(var a=r.array,A=0,l=a.length;A<l;A++){var u=a[A];Ze.fromArray(s,3*u),Je(Ze,u,o,i,t,e,this)}else{A=0;for(var h=s.length/3;A<h;A++)Ze.fromArray(s,3*A),Je(Ze,A,o,i,t,e,this)}}else{var c=n.vertices;for(A=0,h=c.length;A<h;A++)Je(c[A],A,o,i,t,e,this)}}},updateMorphTargets:function(){var t,e,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(0<o.length){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else void 0!==(r=i.morphTargets)&&r.length},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var en=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var i=new N({opacity:1,transparent:!0,depthTest:!1,size:5});this.material=i,this.geo=new ne,n=(new Qe).load(n);i.map=n,i.needsUpdate=!0,this.pointsArrayLength=e.length,this.pointsArray=e,this.geo.setFromPoints(e),this.plength=e.length,this.points=new qe(this.geo,i)}var e,n;return e=t,(n=[{key:"updatePoints",value:function(t){this.geo.setFromPoints(t)}},{key:"changePositions",value:function(t,e,n,i,r){for(var o=this.geo.attributes.position,s=0;s<this.plength;s++){var a=o.getX(s)+t*this.runstatus[s].x.sign*this.runstatus[s].x.weight,A=o.getY(s)+e*this.runstatus[s].y.sign*this.runstatus[s].y.weight,l=o.getZ(s)+n*this.runstatus[s].z.sign*this.runstatus[s].z.weight;i(a,A,l)?o.setXYZ(s,a,A,l):(a=r(),o.setXYZ(s,a.x,a.y,a.z))}o.needsUpdate=!0}},{key:"setRunStatus",value:function(t){this.runstatus=t}},{key:"setParticleCount",value:function(t){this.pointsArray.length=this.pointsArrayLength*t,this.geo.setFromPoints(this.pointsArray),this.points=new qe(this.geo,this.material)}}])&&tn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),nn=((n={NONE:0,EXTRUDE_MARKER:2,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30}).LAYER_NODE_TYPE=new Map,n.LAYER_NODE_TYPE.set(n.EXTENT_LAYER,n.EXTENT),n.LAYER_NODE_TYPE.set(n.EXTERNAL_MODEL_LAYER,n.EXTERNAL_MODEL),n.LAYER_NODE_TYPE.set(n.MODEL_LAYER,n.MODEL),n.LAYER_NODE_TYPE.set(n.FACILITY_LAYER,n.FACILITY),n.LAYER_NODE_TYPE.set(n.LABEL_LAYER,n.LABEL),n.LAYER_NODE_TYPE.set(n.DOM_MARKER,n.DOM_MARKER),n.LAYER_NODE_TYPE.set(n.DYNAMIC_MODEL_MARKER,n.DYNAMIC_MODEL_MARKER),n.LAYER_NODE_TYPE.set(n.EXTRUDE_MARKER,n.EXTRUDE_MARKER),n.LAYER_NODE_TYPE.set(n.HEAT_MAP_MARKER,n.HEAT_MAP_MARKER),n.LAYER_NODE_TYPE.set(n.LINE_MARKER,n.LINE_MARKER),n.LAYER_NODE_TYPE.set(n.LOCATION_MARKER,n.LOCATION_MARKER),n.LAYER_NODE_TYPE.set(n.POLYGON_MARKER,n.POLYGON_MARKER),n.LAYER_NODE_TYPE.set(n.TEXT_MARKER,n.TEXT_MARKER),n.LAYER_NODE_TYPE.set(n.IMAGE_MARKER,n.IMAGE_MARKER),n.LAYER_NODE_TYPE.set(n.FLOW_LINE_LAYER,n.FLOW_LINE_MARKER),n.LAYER_NODE_TYPE.set(n.FIRE_MARKER,n.FIRE_MARKER),n.LAYER_NODE_TYPE.set(n.WALL_MARKER,n.WALL_MARKER),n.LAYER_NODE_TYPE.set(n.TUBE_MARKER,n.TUBE_MARKER),n.LAYER_NODE_TYPE.set(n.LINE3D_MARKER,n.LINE3D_MARKER),n.LAYER_NODE_TYPE.set(n.SPHERE_MARKER,n.SPHERE_MARKER),n);function rn(t,e){this.name="",this.color=new L(t),this.density=void 0!==e?e:25e-5}function on(){Xt.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function sn(t){return(sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function an(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function An(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===sn(t=function(t,e){if("object"!==sn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==sn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(rn.prototype,{isFogExp2:!0,clone:function(){return new rn(this.color,this.density)}}),on.prototype=Object.assign(Object.create(Xt.prototype),{constructor:on,isScene:!0,copy:function(t,e){return Xt.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var ln=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.type="effect",this.waterLayers=new Map,this.bloom=null,this.outLine=null,this.particle=null,this.sky=null,this.rain=null,this.flowlines=new Map,this.sweep=null,this.sao=null,this.fogEffect=null,this.fristRenderScene=new on}var e,n;return e=t,(n=[{key:"render",value:function(){for(var t=this,e=(this.renderer.clear(),this.resize(),this.renderer.render(this.fristRenderScene,this.parent.camera),this.skyNeedTexture&&this.skyNeedTexture.render(),this.sky&&this.sky.render(),this.getTileLayScene()),n=(e&&this.renderer.render(e,this.parent.camera),this.getGroundLayerScene()),i=(n&&this.renderer.render(n,this.parent.camera),this.get3DTilesLayerSceneArr()),r=0;r<i.length;r++)this.renderer.render(i[r],this.parent.camera);this.parent.getInteracations().autoCameraNearFar.reset(),this.parent.getInteracations().autoCameraNearFar.update(this.getRenderList()),this.parent.getInteracations().autoCameraNearFar.update([e,n].concat(function(t){return function(t){if(Array.isArray(t))return an(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?an(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?an(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(i))),this.sao&&this.sao.render(),this.outLine&&this.outLine.F(this.renderer);for(var o=Array.from(this.getRenderList()),s=0;s<o.length;s++){var a,A,l=o[s][0].split("%A%B%C%D"),u=(parseInt(l[1]),parseInt(l[2]));this.sweep&&this.sweep.render(o[s][1]),this.sao&&this.sao.add(o[s][1]),this.bloom||this.outLine||this.renderer.render(o[s][1],this.parent.camera),this.bloom&&(this.outLine||this.renderer.render(o[s][1],this.parent.camera),(A=this.bloom.N.get(l[0]+"_"+l[1]))&&(a=this.getLayerType(u),A=A.get(a))&&(h(A.scene),this.bloom.updateCamera(),this.bloom.D.add(A.scene),this.bloom.C.render(),this.bloom.D.remove(A.scene)),a=this.bloom.singleSceneList.get(l[0]+"_"+l[1]))&&(A=this.getLayerType(u),A=a.get(A))&&(h(A),this.renderer.render(A,this.parent.camera),this.bloom.updateCamera(),this.bloom.D.add(A),this.bloom.C.render(),this.bloom.D.remove(A),this.outLine)&&this.outLine.R(A),this.outLine&&(u===fengmap.FMType.EXTERNAL_MODEL_LAYER||u===fengmap.FMType.MODEL_LAYER||u===fengmap.FMType.DYNAMIC_MODEL_MARKER?this.outLine.R(o[s][1]):this.renderer.render(o[s][1],this.parent.camera)),A=l[0]+"_"+l[1],l=u,0<t.waterLayers.size&&(A=t.waterLayers.get(A))&&""+A.I==""+l&&(t.bloom||t.outLine?(null!==t.fogEffect?null===A.O.fog&&(A.O.fog=new rn(new L(t.fogEffect.U),t.fogEffect.j)):null!==A.O.fog&&(A.O.fog=null),l=t.renderer.getRenderTarget(),A.traverse(function(e){e.k.material.uniforms.time.value+=1/60,null!==t.fogEffect?e.k.material.fog||(e.k.material.fog=!0):e.k.material.fog&&(e.k.material.fog=!1),!1===t.renderer.autoClear&&(t.renderer.setRenderTarget(e.k.renderTarget),t.renderer.clear())}),t.renderer.setRenderTarget(l),t.renderer.render(A.O,t.parent.camera),t.renderer.render(A.H,t.parent.camera)):A.traverse(function(t){t.k.material.uniforms.time.value+=1/60}))}function h(t){for(var e=0;e<t.children.length;e++)"DirectionalLight"!==t.children[e].type&&"AmbientLight"!==t.children[e].type||(t.children[e].visible=!0)}this.parent.getMarkerGroup()&&this.renderer.render(this.parent.getMarkerGroup().scene,this.parent.camera),this.particle&&this.particle.render(),this.rain&&this.rain.render(),this.needLogo&&this.xx45f6&&this.renderer.render(this.xx45f6,this.parent.camera)}},{key:"getLayerType",value:function(t){switch(t){case nn.EXTENT:return nn.EXTENT_LAYER;case nn.EXTERNAL_MODEL:return nn.EXTERNAL_MODEL_LAYER;case nn.MODEL:return nn.MODEL_LAYER;case nn.FACILITY:return nn.FACILITY_LAYER;case nn.LABEL:return nn.LABEL_LAYER;default:return t}}}])&&An(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===un(t=function(t,e){if("object"!==un(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==un(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function cn(){Xt.call(this),this.type="Camera",this.matrixWorldInverse=new Ct,this.projectionMatrix=new Ct,this.projectionMatrixInverse=new Ct}function fn(t,e,n,i,r,o){cn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==i?i:-1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function pn(t,e,n,i){ne.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};for(var r=(t=t||1)/2,o=(e=e||1)/2,s=Math.floor(n)||1,a=Math.floor(i)||1,A=s+1,l=a+1,u=t/s,h=e/a,c=[],f=[],p=[],d=[],y=0;y<l;y++)for(var m=y*h-o,g=0;g<A;g++)f.push(g*u-r,-m,0),p.push(0,0,1),d.push(g/s),d.push(1-y/a);for(y=0;y<a;y++)for(g=0;g<s;g++){var v=g+A*(y+1),b=g+1+A*(y+1),x=g+1+A*y;c.push(g+A*y,v,x),c.push(v,b,x)}this.setIndex(c),this.setAttribute("position",new mt(f,3)),this.setAttribute("normal",new mt(p,3)),this.setAttribute("uv",new mt(d,2))}n=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.O=new on,this.X=null,this.G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS0UqDnYQ6ZChOlkQK8VRqlgEC6Wt0KqDyaVf0MSQpLg4Cq4FBz8Wqw4uzro6uAqC4AeIk6OToouU+L+k0CLGg+N+vLv3uHsHCK06U82+SUDVLCObSoqF4ooYfEUAEfiRQFxipp7OLeThOb7u4ePrXYxneZ/7cwwqJZMBPpF4lumGRbxOnNi0dM77xGFWlRTic+IJgy5I/Mh12eU3zhWHBZ4ZNvLZOeIwsVjpYbmHWdVQiaeJo4qqUb5QcFnhvMVZrTdY5578haGStpzjOs0IUlhEGhmIkNFADXVYiNGqkWIiS/tJD/+o48+QSyZXDYwc89iACsnxg//B727NcnzKTQolgcCLbX+MAcFdoN207e9j226fAP5n4Err+jdawMwn6c2uFj0ChraBi+uuJu8BlzvAyJMuGZIj+WkK5TLwfkbfVASGb4GBVbe3zj5OH4A8dbV0AxwcAuMVyl7zeHd/b2//nun09wPqUXLXvsrewQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+QFHAQMLuREfnwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAA9UlEQVQY002Pu0oDQRRA7517d0ISFwKaIKLgphPSqGltxEYk/2AnBNILdhba2PkBNv6BJn8QxLR2KVwEH6xBEk1G3ezMXBsDOeWpzgGYoxPbZvsxa807BgC4ibNSYhy9TdwGAvjzrglrK5oaUTDCTmx3p06O343rhzl1azK/hwC9coEOCeGMHVN38JlerZb4WxNeLCHZl6HdekjS9mZUvFdifhEJlpMvd6QUsngIKgt0WWR8IgRk1kG9zFJLJv46/phuF7S6G6d+J1rM1f2Pf8ZZZO8182uhOhUR7cGerId53q/ygAEAGlEw+t/siwgdVPPD2eYf14pkaPQAZiEAAAAASUVORK5CYII=",this.points=[],this.pointsStatus=[],this.S=e.getBound().size.x,this.V=e.getBound().size.y,this.Y=1e5,this.W=0,this.q=this.q.bind(this),this.Z(this.Y),this.K()}var e,n;return e=t,(n=[{key:"enable",value:function(){(this.B.getRenderManager().particle=this).B.on("beforeRender",this.q)}},{key:"disable",value:function(){this.B.getRenderManager().particle=null,this.B.off("beforeRender",this.q),this.q()}},{key:"dispose",value:function(){this.disable(),this.G=null,this.O.dispose(),this.O=null,this.points=null,this.pointsStatus=null}},{key:"setUrl",value:function(t){this.O.children[0].material.map=(new Qe).load(t),this.G=t}},{key:"setAmount",value:function(t){this.O.remove(this.X.points),this.points=[],this.pointsStatus=[],t=this.Y*t,this.Z(t)}},{key:"render",value:function(){var t=this;null!==this.X&&this.X.changePositions(.1,-.32,.1,function(t,e){return 0<=e},function(){return new V((Math.random()-.5)*t.S,1e3*Math.random(),(Math.random()-.5)*t.V)}),this.B.getRenderManager().renderer.render(this.O,this.B.camera)}}])&&hn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(n.prototype,{q:function(){this.B.enableUpdateRender()},J:function(t,e,n){for(var i=0;i<t;i++){var r=(Math.random()-.5)*this.S,o=1e3*Math.random(),s=(Math.random()-.5)*this.V,a=(a=Math.random()-.5)/Math.abs(a),A=3*Math.random(),l=(l=Math.random()-.5)/Math.abs(l);e.push(new V(r,o,s)),n.push({x:{sign:a,weight:A},y:{sign:1,weight:1},z:{sign:l,weight:3*Math.random()}})}},Z:function(t){this.J(t,this.points,this.pointsStatus),this.X=new en(this.points,this.G),this.X.setRunStatus(this.pointsStatus),this.O.add(this.X.points)},K:function(){"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln)}}),cn.prototype=Object.assign(Object.create(Xt.prototype),{constructor:cn,isCamera:!0,copy:function(t,e){return Xt.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(t=new V),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Xt.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Xt.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),fn.prototype=Object.assign(Object.create(cn.prototype),{constructor:fn,isOrthographicCamera:!0,copy:function(t,e){return cn.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(r=(this.right+this.left)/2)-e,r=r+e,o=(e=(o=(this.top+this.bottom)/2)+n,o-n);null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom,r=(i+=n*this.view.offsetX)+n*this.view.width,o=(e-=t*this.view.offsetY)-t*this.view.height),this.projectionMatrix.makeOrthographic(i,r,e,o,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}),(pn.prototype=Object.create(ne.prototype)).constructor=pn;var dn=new V,yn=new V,mn=new Rt;function gn(t,e){this.normal=void 0!==t?t:new V(1,0,0),this.constant=void 0!==e?e:0}Object.assign(gn.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){return n=dn.subVectors(n,e).cross(yn.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(n,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(e=new V),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(e=new V);var n=t.delta(dn),i=this.normal.dot(n);return 0===i?0===this.distanceToPoint(t.start)?e.copy(t.start):void 0:(i=-(t.start.dot(this.normal)+this.constant)/i)<0||1<i?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start);t=this.distanceToPoint(t.end);return e<0&&0<t||t<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(t=new V),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){return e=e||mn.getNormalMatrix(t),t=this.coplanarPoint(dn).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize(),this.constant=-t.dot(e),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var vn=new V,bn=new V,xn=new V,wn=new V,Bn=new V,Mn=new V,Sn=new V,_n=new V,En=new V,Tn=new V;function Cn(t,e,n){this.a=void 0!==t?t:new V,this.b=void 0!==e?e:new V,this.c=void 0!==n?n:new V}function Fn(t,e,n,i,r,o){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new V,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new L,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}Object.assign(Cn,{getNormal:function(t,e,n,i){return void 0===i&&(i=new V),i.subVectors(n,e),vn.subVectors(t,e),i.cross(vn),0<(n=i.lengthSq())?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)},getBarycoord:function(t,e,n,i,r){vn.subVectors(i,e),bn.subVectors(n,e),xn.subVectors(t,e);i=vn.dot(vn),n=vn.dot(bn),t=vn.dot(xn),e=bn.dot(bn);var o=bn.dot(xn),s=i*e-n*n;return void 0===r&&(r=new V),0==s?r.set(-2,-1,-1):r.set(1-(e=(e*t-n*o)*(r=1/s))-(s=(i*o-n*t)*r),s,e)},containsPoint:function(t,e,n,i){return Cn.getBarycoord(t,e,n,i,wn),0<=wn.x&&0<=wn.y&&wn.x+wn.y<=1},getUV:function(t,e,n,i,r,o,s,a){return this.getBarycoord(t,e,n,i,wn),a.set(0,0),a.addScaledVector(r,wn.x),a.addScaledVector(o,wn.y),a.addScaledVector(s,wn.z),a},isFrontFacing:function(t,e,n,i){return vn.subVectors(n,e),bn.subVectors(t,e),vn.cross(bn).dot(i)<0}}),Object.assign(Cn.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return vn.subVectors(this.c,this.b),bn.subVectors(this.a,this.b),.5*vn.cross(bn).length()},getMidpoint:function(t){return void 0===t&&(t=new V),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Cn.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(t=new gn),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Cn.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,i,r){return Cn.getUV(t,this.a,this.b,this.c,e,n,i,r)},containsPoint:function(t){return Cn.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Cn.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(e=new V);var n=this.a,i=this.b,r=this.c,o=(Bn.subVectors(i,n),Mn.subVectors(r,n),_n.subVectors(t,n),Bn.dot(_n)),s=Mn.dot(_n);if(o<=0&&s<=0)return e.copy(n);En.subVectors(t,i);var a=Bn.dot(En),A=Mn.dot(En);if(0<=a&&A<=a)return e.copy(i);var l=o*A-a*s;if(l<=0&&0<=o&&a<=0)return u=o/(o-a),e.copy(n).addScaledVector(Bn,u);Tn.subVectors(t,r);t=Bn.dot(Tn);var u,h,c=Mn.dot(Tn);return 0<=c&&t<=c?e.copy(r):(o=t*s-o*c)<=0&&0<=s&&c<=0?(h=s/(s-c),e.copy(n).addScaledVector(Mn,h)):(s=a*c-t*A)<=0&&0<=A-a&&0<=t-c?(Sn.subVectors(r,i),h=(A-a)/(A-a+(t-c)),e.copy(i).addScaledVector(Sn,h)):(u=o*(r=1/(s+o+l)),h=l*r,e.copy(n).addScaledVector(Bn,u).addScaledVector(Mn,h))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Object.assign(Fn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var On=new Ct,Pn=new Ye,Un=new bt,Rn=new V,In=new V,Ln=new V,Dn=new V,Qn=new V,kn=new V,Nn=new V,jn=new V,Hn=new V,zn=new at,Vn=new at,Gn=new at,Yn=new V,Kn=new V;function Xn(t,e){Xt.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new ne,this.material=void 0!==e?e:new Ce,this.updateMorphTargets()}function Wn(t,e,n,i,r,o,A,l){return null===(i=e.side===s?i.intersectTriangle(A,o,r,!0,l):i.intersectTriangle(r,o,A,e.side!==a,l))?null:(Kn.copy(l),Kn.applyMatrix4(t.matrixWorld),(r=n.ray.origin.distanceTo(Kn))<n.near||r>n.far?null:{distance:r,point:Kn.clone(),object:t})}function Zn(t,e,n,i,r,o,s,a,A,l,u,h){Rn.fromBufferAttribute(r,l),In.fromBufferAttribute(r,u),Ln.fromBufferAttribute(r,h);var c=t.morphTargetInfluences;if(e.morphTargets&&o&&c){Nn.set(0,0,0),jn.set(0,0,0),Hn.set(0,0,0);for(var f=0,p=o.length;f<p;f++){var d=c[f],y=o[f];0!==d&&(Dn.fromBufferAttribute(y,l),Qn.fromBufferAttribute(y,u),kn.fromBufferAttribute(y,h),s?(Nn.addScaledVector(Dn,d),jn.addScaledVector(Qn,d),Hn.addScaledVector(kn,d)):(Nn.addScaledVector(Dn.sub(Rn),d),jn.addScaledVector(Qn.sub(In),d),Hn.addScaledVector(kn.sub(Ln),d)))}Rn.add(Nn),In.add(jn),Ln.add(Hn)}return(r=Wn(t,e,n,i,Rn,In,Ln,Yn))&&(a&&(zn.fromBufferAttribute(a,l),Vn.fromBufferAttribute(a,u),Gn.fromBufferAttribute(a,h),r.uv=Cn.getUV(Yn,Rn,In,Ln,zn,Vn,Gn,new at)),A&&(zn.fromBufferAttribute(A,l),Vn.fromBufferAttribute(A,u),Gn.fromBufferAttribute(A,h),r.uv2=Cn.getUV(Yn,Rn,In,Ln,zn,Vn,Gn,new at)),t=new Fn(l,u,h),Cn.getNormal(Rn,In,Ln,t.normal),r.face=t),r}function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Jn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===qn(t=function(t,e){if("object"!==qn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==qn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function $n(t,e,n){return e&&Jn(t.prototype,e),n&&Jn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ti(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Xn.prototype=Object.assign(Object.create(Xt.prototype),{constructor:Xn,isMesh:!0,copy:function(t){return Xt.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(0<o.length){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else void 0!==(r=i.morphTargets)&&r.length},raycast:function(t,e){var n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i&&(null===n.boundingSphere&&n.computeBoundingSphere(),Un.copy(n.boundingSphere),Un.applyMatrix4(r),!1!==t.ray.intersectsSphere(Un)&&(On.getInverse(r),Pn.copy(t.ray).applyMatrix4(On),null===n.boundingBox||!1!==Pn.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var o,s,a,A,l,u,h,c,f,p=n.index,d=n.attributes.position,y=n.morphAttributes.position,m=n.morphTargetsRelative,g=n.attributes.uv,v=n.attributes.uv2,b=n.groups,x=n.drawRange;if(null!==p)if(Array.isArray(i))for(A=0,u=b.length;A<u;A++)for(f=i[(c=b[A]).materialIndex],l=Math.max(c.start,x.start),h=Math.min(c.start+c.count,x.start+x.count);l<h;l+=3)o=p.getX(l),s=p.getX(l+1),a=p.getX(l+2),(O=Zn(this,f,t,Pn,d,y,m,g,v,o,s,a))&&(O.faceIndex=Math.floor(l/3),O.face.materialIndex=c.materialIndex,e.push(O));else for(A=Math.max(0,x.start),u=Math.min(p.count,x.start+x.count);A<u;A+=3)o=p.getX(A),s=p.getX(A+1),a=p.getX(A+2),(O=Zn(this,i,t,Pn,d,y,m,g,v,o,s,a))&&(O.faceIndex=Math.floor(A/3),e.push(O));else if(void 0!==d)if(Array.isArray(i))for(A=0,u=b.length;A<u;A++)for(f=i[(c=b[A]).materialIndex],l=Math.max(c.start,x.start),h=Math.min(c.start+c.count,x.start+x.count);l<h;l+=3)(O=Zn(this,f,t,Pn,d,y,m,g,v,o=l,s=l+1,a=l+2))&&(O.faceIndex=Math.floor(l/3),O.face.materialIndex=c.materialIndex,e.push(O));else for(A=Math.max(0,x.start),u=Math.min(d.count,x.start+x.count);A<u;A+=3)(O=Zn(this,i,t,Pn,d,y,m,g,v,o=A,s=A+1,a=A+2))&&(O.faceIndex=Math.floor(A/3),e.push(O))}else if(n.isGeometry){var w,B=Array.isArray(i),M=n.vertices,S=n.faces;0<(r=n.faceVertexUvs[0]).length&&(w=r);for(var _=0,E=S.length;_<E;_++){var T,C,F,O,P=S[_],U=B?i[P.materialIndex]:i;void 0!==U&&(T=M[P.a],C=M[P.b],F=M[P.c],O=Wn(this,U,t,Pn,T,C,F,Yn))&&(w&&w[_]&&(U=w[_],zn.copy(U[0]),Vn.copy(U[1]),Gn.copy(U[2]),O.uv=Cn.getUV(Yn,T,C,F,zn,Vn,Gn,new at)),O.face=P,O.faceIndex=_,e.push(O))}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var ei,ni,ii=$n(function t(){ti(this,t),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}),ri=(Object.assign(ii.prototype,{setSize:function(){},render:function(){}}),ii.FullScreenQuad=(ei=new fn(-1,1,1,-1,0,1),ni=new pn(2,2),Qi=$n(function t(e){ti(this,t),this.$=new Xn(ni,e)}),Object.defineProperty(Qi.prototype,"material",{get:function(){return this.$.material},set:function(t){this.$.material=t}}),Object.assign(Qi.prototype,{render:function(t){t.render(this.$,ei)}}),Qi),{uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")});function oi(t,e,n){this.width=t,this.height=e,this.scissor=new st(0,0,t,e),this.scissorTest=!1,this.viewport=new st(0,0,t,e),this.texture=new De(void 0,(n=n||{}).mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:v,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function si(t){return(si="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ai(t,e){return(ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ai(t){return(Ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}oi.prototype=Object.assign(Object.create(r.prototype),{constructor:oi,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.texture.image.width=t,this.texture.image.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var li=function(){var t=i,e=ii;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ai(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ai(t);if(n=e?(n=Ai(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===si(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(t=n.call(this)).renderTarget=new oi(1,1,{minFilter:v,magFilter:v,format:w}),t.compositeMaterial=t.getCompositeMaterial(t.nMips);var e=ri;return t.copyUniforms=ye.clone(e.uniforms),t.copyUniforms.opacity.value=1,t.materialCopy=new ve({uniforms:t.copyUniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),t.clearColor=new L(0,0,0),t.oldClearColor=new L,t.oldClearAlpha=1,t.basic=new Ce,t.basic.transparent=!0,t.fsQuad=new ii.FullScreenQuad(null),t}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){return(hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ci(t){return(ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.assign(li.prototype,{dispose:function(){this.renderTarget.dispose()},setSize:function(t,e){t=Math.round(t/2),e=Math.round(e/2),this.renderTarget.setSize(t,e)},render:function(t,e,n,i,r){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();var o=t.autoClear;t.autoClear=!1,t.setClearColor(this.clearColor,0),r&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=n.texture,t.setRenderTarget(null),this.fsQuad.render(t)),this.fsQuad.material=this.compositeMaterial,t.setRenderTarget(this.renderTarget),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTarget.texture,r&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?t.setRenderTarget(null):t.setRenderTarget(n),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o},getCompositeMaterial:function(){return new ve({uniforms:{iTime:{value:0},rainSize:{value:.1},iResolution:{value:new at(300,200)},iChannel3:{value:null}},vertexShader:"\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"\n                varying vec2 vUv;\n                uniform float iTime;\n                uniform float rainSize;\n                uniform vec2 iResolution;\n                uniform vec2 iMouse;\n                uniform sampler2D iChannel3;\n                uniform sampler2D tDiffuse;\n\n                void main() {\n                  float speed = fract(iTime);\n                  vec3 col = vec3(0.0, 0.0, 0.0);\n                  float aspect = iResolution.x / iResolution.y;\n\n                  // uv 0~1\n                  vec2 q = gl_FragCoord.xy / iResolution.xy;\n                  q.x *= aspect;\n\n                  // , 1: ; -1:\n                  float rainDir = 1.;\n                  // \n                  float tiltIntensity = 0.2;\n                  float offsetX = speed + q.y * rainDir * tiltIntensity;\n\n                  // uv\n                  vec2 p = -1.0 + 2.0 * q;\n                  vec2 st = p * vec2(.5, 0.01) + vec2(offsetX, speed);\n\n                  // \n                  float opacity = .655;\n                  // \n                  float f = texture2D(iChannel3, st).y;\n                  // \n                  f *= texture2D(iChannel3, st * 0.775).y;\n                  f *= opacity;\n\n                  col += f;\n                  col *= min(rainSize, 1.0);\n                  gl_FragColor = vec4(clamp(col, 0.0, 1.0), 1.0);\n                }\n                "})}});var fi=function(){var t=i,e=ii;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hi(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ci(t);if(n=e?(n=ci(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===ui(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r,o,s){var a;if(this instanceof i)return(a=n.call(this)).scene=t,a.camera=e,a.overrideMaterial=r,a.clearColor=o,a.clearAlpha=void 0!==s?s:0,a.clear=!0,a.clearDepth=!1,a.needsSwap=!1,a;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t,e){return(di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yi(t){return(yi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.assign(fi.prototype,{setPass:function(t,e){this.scene=t,this.camera=e},render:function(t,e,n){var i,r,o=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,void 0!==this.clearColor&&(i=t.getClearColor().getHex(),r=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:n),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),void 0!==this.clearColor&&t.setClearColor(i,r),this.scene.overrideMaterial=null,t.autoClear=o}});var mi=function(){var t=i,e=ii;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&di(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=yi(t);if(n=e?(n=yi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===pi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){var r;if(this instanceof i)return(r=n.call(this)).textureID=void 0!==e?e:"tDiffuse",t instanceof ve?(r.uniforms=t.uniforms,r.material=t):t&&(r.uniforms=ye.clone(t.uniforms),r.material=new ve({defines:Object.assign({},t.defines),uniforms:r.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),r.fsQuad=new ii.FullScreenQuad(r.material),r;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function gi(t){return(gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===gi(t=function(t,e){if("object"!==gi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==gi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function bi(t,e,n){return e&&vi(t.prototype,e),n&&vi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function xi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Bi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Mi(t);n=e?(n=Mi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this;if(n&&("object"===gi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Mi(t){return(Mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.assign(mi.prototype,{render:function(t,e,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(e),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil)),this.fsQuad.render(t)}});var Si=function(){wi(e,ii);var t=Bi(e);function e(n,i){var r;return xi(this,e),(r=t.call(this)).scene=n,r.camera=i,r.clear=!0,r.needsSwap=!1,r.inverse=!1,r}return bi(e)}(),_i=(Object.assign(Si.prototype,{render:function(t,e,n){var i,r,o=t.getContext(),s=t.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0),r=this.inverse?(i=0,1):(i=1,0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),s.buffers.stencil.setFunc(o.ALWAYS,i,4294967295),s.buffers.stencil.setClear(r),t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(e),this.clear&&t.clear(),t.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.stencil.setFunc(o.EQUAL,1,4294967295),s.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP)}}),function(){wi(e,ii);var t=Bi(e);function e(){var n;return xi(this,e),(n=t.call(this)).needsSwap=!1,n}return bi(e)}());function Ei(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ti(t){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ci(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ti(t=function(t,e){if("object"!==Ti(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ti(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Fi(t,e,n){return e&&Ci(t.prototype,e),n&&Ci(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Oi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.assign(_i.prototype,{render:function(t){t.state.buffers.stencil.setTest(!1)}}),Object.assign(Ei.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=("undefined"==typeof performance?Date:performance).now())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}});var Pi,Ui,Ri=Fi(function t(e,n){var i,r;Oi(this,t),this.renderer=e,void 0===n?(i={minFilter:v,magFilter:v,format:w,stencilBuffer:!1},r=e.getSize(new at),this.tt=e.getPixelRatio(),this.nt=r.width,this.et=r.height,(n=new oi(this.nt*this.tt,this.et*this.tt,i)).texture.name="EffectComposer.rt1"):(this.tt=1,this.nt=n.width,this.et=n.height),this.renderTarget1=n,this.renderTarget2=n.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new mi(ri),this.clock=new Ei}),Ii=(Object.assign(Ri.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},clearPass:function(){for(var t=0;t<this.passes.length;t++)this.passes[t].scene=null,this.passes[t].camera=null},addPass:function(t){this.passes.push(t),t.setSize(this.nt*this.tt,this.et*this.tt)},insertPass:function(t,e){this.passes.splice(e,0,t)},isLastEnabledPass:function(t){for(var e=t+1;e<this.passes.length;e++)if(this.passes[e].enabled)return!1;return!0},render:function(t){void 0===t&&(t=this.clock.getDelta());for(var e,n,i,r=this.renderer.getRenderTarget(),o=!1,s=this.passes.length,a=0;a<s;a++)!1!==(i=this.passes[a]).enabled&&(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(a),i.render(this.renderer,this.writeBuffer,this.readBuffer,t,o),i.needsSwap&&(o&&(e=this.renderer.getContext(),(n=this.renderer.state.buffers.stencil).setFunc(e.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),n.setFunc(e.EQUAL,1,4294967295)),this.swapBuffers()),void 0!==Si)&&(i instanceof Si?o=!0:i instanceof _i&&(o=!1));this.renderer.setRenderTarget(r)},reset:function(t){var e;void 0===t&&(e=this.renderer.getSize(new at),this.tt=this.renderer.getPixelRatio(),this.nt=e.width,this.et=e.height,(t=this.renderTarget1.clone()).setSize(this.nt*this.tt,this.et*this.tt)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this.nt=t,this.et=e;var n=this.nt*this.tt,i=this.et*this.tt;this.renderTarget1.setSize(n,i),this.renderTarget2.setSize(n,i);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(n,i)},setPixelRatio:function(t){this.tt=t,this.setSize(this.nt,this.et)}}),Fi(function t(){Oi(this,t),this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}));function Li(t){return(Li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Di(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Li(t=function(t,e){if("object"!==Li(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Li(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(Ii.prototype,{setSize:function(){},render:function(){}}),Ii.FullScreenQuad=(Pi=new fn(-1,1,1,-1,0,1),Ui=new pn(2,2),Qi=Fi(function t(e){Oi(this,t),this.$=new Xn(Ui,e)}),Object.defineProperty(Qi.prototype,"material",{get:function(){return this.$.material},set:function(t){this.$.material=t}}),Object.assign(Qi.prototype,{dispose:function(){this.$.geometry.dispose()},render:function(t){t.render(this.$,Pi)}}),Qi);var Qi=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.it=-1,this.rt=-1,this.ot=this.st(),this.q=this.q.bind(this),this.Z(n)}var e,n;return e=t,(n=[{key:"getRaindrops",value:function(){return this.ht}},{key:"setRaindrops",value:function(t){this.ht=t}},{key:"getUrl",value:function(){return this.G}},{key:"setUrl",value:function(t){this.G=t,this.lt.compositeMaterial.uniforms.iChannel3.value=(new Qe).load(t,function(t){t.wrapS=y,t.wrapT=y,t.anisotropy=16,t.repeat.set(4,4)})}},{key:"enable",value:function(){(this.B.getRenderManager().rain=this).B.on("beforeRender",this.q)}},{key:"disable",value:function(){this.B.getRenderManager().rain=null,this.B.off("beforeRender",this.q),this.q()}},{key:"dispose",value:function(){this.disable(),this.lt.dispose(),this.O.dispose(),this.lt=null,this.O=null,this.ut=null,this.ct=null}},{key:"render",value:function(){this.ft(),this.dt+=.05,this.lt.compositeMaterial.uniforms.iTime.value=this.dt,this.lt.compositeMaterial.uniforms.rainSize.value=this.ht,this.ut.render()}}])&&Di(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ki=(Object.assign(Qi.prototype,{q:function(){this.B.enableUpdateRender()},st:function(){return"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln),this.B.getRenderManager()},Z:function(t){this.G=t.url,this.lt=new li,this.O=new on,this.ct=new fi(this.O,this.B.camera),this.ct.clear=!1,this.ut=new Ri(this.ot.renderer),this.ut.addPass(this.ct),this.ut.addPass(this.lt),this.setUrl(this.G),this.lt.compositeMaterial.uniforms.iTime.value=.2,this.lt.compositeMaterial.uniforms.iResolution.value=new at(60,60),this.dt=.6,this.ht=t.raindrops},ft:function(){var t,e,n;this.ut&&(t=(e=this.ut.renderer.domElement).clientWidth,e=e.clientHeight,n=!1,this.it!=t&&(n=!0,this.it=t),this.rt!=e&&(n=!0,this.rt=e),n)&&this.lt&&this.ut.setSize(this.it,this.rt)}}),0),Ni=new Ct,ji=new Xt,Hi=new V;function zi(){Object.defineProperty(this,"id",{value:ki+=2}),this.uuid=F.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Vi(t=function(t,e){if("object"!==Vi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Vi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Yi(t,e,n){return e&&Gi(t.prototype,e),n&&Gi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ki(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Wi(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=qi(t);n=e?(n=qi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this;if(n&&("object"===Vi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Zi(i)}}function Zi(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ji(){var t=new ve({fragmentShader:(t=Ji.SkyShader).fragmentShader,vertexShader:t.vertexShader,uniforms:ye.clone(t.uniforms),side:s});Xn.call(this,new tr(1,1,1),t)}zi.prototype=Object.assign(Object.create(r.prototype),{constructor:zi,isGeometry:!0,applyMatrix4:function(t){for(var e=(new Rt).getNormalMatrix(t),n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(n=0,i=this.faces.length;n<i;n++){var r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(var o=0,s=r.vertexNormals.length;o<s;o++)r.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return Ni.makeRotationX(t),this.applyMatrix4(Ni),this},rotateY:function(t){return Ni.makeRotationY(t),this.applyMatrix4(Ni),this},rotateZ:function(t){return Ni.makeRotationZ(t),this.applyMatrix4(Ni),this},translate:function(t,e,n){return Ni.makeTranslation(t,e,n),this.applyMatrix4(Ni),this},scale:function(t,e,n){return Ni.makeScale(t,e,n),this.applyMatrix4(Ni),this},lookAt:function(t){return ji.lookAt(t),ji.updateMatrix(),this.applyMatrix4(ji.matrix),this},fromBufferGeometry:function(t){var e=this,n=null!==t.index?t.index.array:void 0,i=t.attributes;if(void 0===i.position);else{var r=i.position.array,o=void 0!==i.normal?i.normal.array:void 0,s=void 0!==i.color?i.color.array:void 0,a=void 0!==i.uv?i.uv.array:void 0,A=void 0!==i.uv2?i.uv2.array:void 0;void 0!==A&&(this.faceVertexUvs[1]=[]);for(var l=0;l<r.length;l+=3)e.vertices.push((new V).fromArray(r,l)),void 0!==s&&e.colors.push((new L).fromArray(s,l));var u=t.groups;if(0<u.length)for(l=0;l<u.length;l++)for(var h=u[l],c=h.start,f=c,p=c+h.count;f<p;f+=3)void 0!==n?d(n[f],n[f+1],n[f+2],h.materialIndex):d(f,f+1,f+2,h.materialIndex);else if(void 0!==n)for(l=0;l<n.length;l+=3)d(n[l],n[l+1],n[l+2]);else for(l=0;l<r.length/3;l+=3)d(l,l+1,l+2);this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone())}return this;function d(t,n,i,r){var l=void 0===s?[]:[e.colors[t].clone(),e.colors[n].clone(),e.colors[i].clone()];l=new Fn(t,n,i,void 0===o?[]:[(new V).fromArray(o,3*t),(new V).fromArray(o,3*n),(new V).fromArray(o,3*i)],l,r);e.faces.push(l),void 0!==a&&e.faceVertexUvs[0].push([(new at).fromArray(a,2*t),(new at).fromArray(a,2*n),(new at).fromArray(a,2*i)]),void 0!==A&&e.faceVertexUvs[1].push([(new at).fromArray(A,2*t),(new at).fromArray(A,2*n),(new at).fromArray(A,2*i)])}},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hi).negate(),this.translate(Hi.x,Hi.y,Hi.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=0===(e=this.boundingSphere.radius)?1:1/e,n=new Ct;return n.set(e,0,0,-e*t.x,0,e,0,-e*t.y,0,0,e,-e*t.z,0,0,0,1),this.applyMatrix4(n),this},computeFaceNormals:function(){for(var t=new V,e=new V,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],o=this.vertices[r.a],s=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,s),e.subVectors(o,s),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,n,i;for(void 0===t&&(t=!0),i=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)i[e]=new V;if(t)for(var r,o,s,a=new V,A=new V,l=0,u=this.faces.length;l<u;l++)h=this.faces[l],r=this.vertices[h.a],o=this.vertices[h.b],s=this.vertices[h.c],a.subVectors(s,o),A.subVectors(r,o),a.cross(A),i[h.a].add(a),i[h.b].add(a),i[h.c].add(a);else for(this.computeFaceNormals(),l=0,u=this.faces.length;l<u;l++)i[(h=this.faces[l]).a].add(h.normal),i[h.b].add(h.normal),i[h.c].add(h.normal);for(e=0,n=this.vertices.length;e<n;e++)i[e].normalize();for(l=0,u=this.faces.length;l<u;l++){var h,c=(h=this.faces[l]).vertexNormals;3===c.length?(c[0].copy(i[h.a]),c[1].copy(i[h.b]),c[2].copy(i[h.c])):(c[0]=i[h.a].clone(),c[1]=i[h.b].clone(),c[2]=i[h.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var n,i=(n=this.faces[t]).vertexNormals;3===i.length?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n;for(s=0,a=this.faces.length;s<a;s++)for((n=this.faces[s]).vt?n.vt.copy(n.normal):n.vt=n.normal.clone(),n.gt||(n.gt=[]),t=0,e=n.vertexNormals.length;t<e;t++)n.gt[t]?n.gt[t].copy(n.vertexNormals[t]):n.gt[t]=n.vertexNormals[t].clone();var i=new zi;for(i.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];for(var r=this.morphNormals[t].faceNormals,o=this.morphNormals[t].vertexNormals,s=0,a=this.faces.length;s<a;s++)A=new V,l={a:new V,b:new V,c:new V},r.push(A),o.push(l)}var A,l,u=this.morphNormals[t];for(i.vertices=this.morphTargets[t].vertices,i.computeFaceNormals(),i.computeVertexNormals(),s=0,a=this.faces.length;s<a;s++)n=this.faces[s],A=u.faceNormals[s],l=u.vertexNormals[s],A.copy(n.normal),l.a.copy(n.vertexNormals[0]),l.b.copy(n.vertexNormals[1]),l.c.copy(n.vertexNormals[2])}for(s=0,a=this.faces.length;s<a;s++)(n=this.faces[s]).normal=n.vt,n.vertexNormals=n.gt},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new rt),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new bt),this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){for(var t,e,n,i,r={},o=[],s=[],a=Math.pow(10,4),A=0,l=this.vertices.length;A<l;A++)t=this.vertices[A],void 0===r[t=Math.round(t.x*a)+"_"+Math.round(t.y*a)+"_"+Math.round(t.z*a)]?(r[t]=A,o.push(this.vertices[A]),s[A]=o.length-1):s[A]=s[r[t]];var u=[];for(A=0,l=this.faces.length;A<l;A++){(e=this.faces[A]).a=s[e.a],e.b=s[e.b],e.c=s[e.c];for(var h=[e.a,e.b,e.c],c=0;c<3;c++)if(h[c]===h[(c+1)%3]){u.push(A);break}}for(A=u.length-1;0<=A;A--){var f=u[A];for(this.faces.splice(f,1),n=0,i=this.faceVertexUvs.length;n<i;n++)this.faceVertexUvs[n].splice(f,1)}var p=this.vertices.length-o.length;return this.vertices=o,p},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var i=t[e];this.vertices.push(new V(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,n=0;n<e;n++)t[n]._t=n;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var i,r,o=this.faceVertexUvs[0],s=this.faceVertexUvs[1];for(o&&o.length===e&&(i=[]),s&&s.length===e&&(r=[]),n=0;n<e;n++){var a=t[n]._t;i&&i.push(o[a]),r&&r.push(s[a])}i&&(this.faceVertexUvs[0]=i),r&&(this.faceVertexUvs[1]=r)},dispose:function(){this.dispatchEvent({type:"dispose"})}});var $i=function(){Xi(e,zi);var t=Wi(e);function e(n,i,r,o,s,a){var A;return Ki(this,e),(A=t.call(this)).type="BoxGeometry",A.parameters={width:n,height:i,depth:r,widthSegments:o,heightSegments:s,depthSegments:a},A.fromBufferGeometry(new tr(n,i,r,o,s,a)),A.mergeVertices(),A}return Yi(e)}(),tr=function(){Xi(e,ne);var t=Wi(e);function e(n,i,r,o,s,a){Ki(this,e),(A=t.call(this)).type="BoxBufferGeometry",A.parameters={width:n,height:i,depth:r,widthSegments:o,heightSegments:s,depthSegments:a};var A,l=Zi(A),u=(n=n||1,i=i||1,r=r||1,o=Math.floor(o)||1,s=Math.floor(s)||1,a=Math.floor(a)||1,[]),h=[],c=[],f=[],p=0,d=0;function y(t,e,n,i,r,o,s,a,A,y,m){for(var g=o/A,v=s/y,b=o/2,x=s/2,w=a/2,B=A+1,M=y+1,S=0,_=0,E=new V,T=0;T<M;T++)for(var C=T*v-x,F=0;F<B;F++)E[t]=(F*g-b)*i,E[e]=C*r,E[n]=w,h.push(E.x,E.y,E.z),E[t]=0,E[e]=0,E[n]=0<a?1:-1,c.push(E.x,E.y,E.z),f.push(F/A),f.push(1-T/y),S+=1;for(T=0;T<y;T++)for(F=0;F<A;F++){var O=p+F+B*T,P=p+F+B*(T+1),U=p+(F+1)+B*(T+1),R=p+(F+1)+B*T;u.push(O,P,R),u.push(P,U,R),_+=6}l.addGroup(d,_,m),d+=_,p+=S}return y("z","y","x",-1,-1,r,i,n,a,s,0),y("z","y","x",1,-1,r,i,-n,a,s,1),y("x","z","y",1,1,n,r,i,o,a,2),y("x","z","y",1,-1,n,r,-i,o,a,3),y("x","y","z",1,-1,n,i,r,o,s,4),y("x","y","z",-1,-1,n,i,-r,o,s,5),A.setIndex(u),A.setAttribute("position",new mt(h,3)),A.setAttribute("normal",new mt(c,3)),A.setAttribute("uv",new mt(f,2)),A}return Yi(e)}();function er(t,e,n,i,r,o,s){zi.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new nr(t,e,n,i,r,o,s)),this.mergeVertices()}function nr(t,e,n,i,r,o,s){ne.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:o,thetaLength:s},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),i=void 0!==i?i:0,r=void 0!==r?r:2*Math.PI,o=void 0!==o?o:0,s=void 0!==s?s:Math.PI;for(var a,A=Math.min(o+s,Math.PI),l=0,u=[],h=new V,c=new V,f=[],p=[],d=[],y=[],m=0;m<=n;m++){var g=[],v=m/n,b=0;for(0==m&&0==o?b=.5/e:m==n&&A==Math.PI&&(b=-.5/e),a=0;a<=e;a++){var x=a/e;h.x=-t*Math.cos(i+x*r)*Math.sin(o+v*s),h.y=t*Math.cos(o+v*s),h.z=t*Math.sin(i+x*r)*Math.sin(o+v*s),p.push(h.x,h.y,h.z),c.copy(h).normalize(),d.push(c.x,c.y,c.z),y.push(x+b,1-v),g.push(l++)}u.push(g)}for(m=0;m<n;m++)for(a=0;a<e;a++){var w=u[m][a+1],B=u[m][a],M=u[m+1][a],S=u[m+1][a+1];(0!==m||0<o)&&f.push(w,B,S),(m!==n-1||A<Math.PI)&&f.push(B,M,S)}this.setIndex(f),this.setAttribute("position",new mt(p,3)),this.setAttribute("normal",new mt(d,3)),this.setAttribute("uv",new mt(y,2))}function ir(t){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ir(t=function(t,e){if("object"!==ir(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ir(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Ji.prototype=Object.create(Xn.prototype),Ji.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new V},up:{value:new V(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunFade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunFade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunFade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunFade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunFade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")},(er.prototype=Object.create(zi.prototype)).constructor=er,(nr.prototype=Object.create(ne.prototype)).constructor=nr;var or=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.O=new on,this.yt=null,this.xt=null,this.xt={turbidity:10,rayleigh:3,mieCoefficient:.005,mieDirectionalG:.7,luminance:1,inclination:.49,azimuth:.25,scale:500},this.bt=4e5,this.wt=0,this.At=1,this.Z(),this.K()}var e,n;return e=t,(n=[{key:"getState",value:function(){var t=this.sky.material.uniforms;return{turbidity:t.turbidity.value,rayleigh:t.rayleigh.value,luminance:t.luminance.value,scale:this.sky.scale.x}}},{key:"setState",value:function(t){t.scale&&this.sky.scale.setScalar(t.scale);var e=this.sky.material.uniforms;e.turbidity.value=("number"==typeof t.turbidity?t:this.xt).turbidity,e.rayleigh.value=("number"==typeof t.rayleigh?t:this.xt).rayleigh,e.luminance.value=("number"==typeof t.luminance?t:this.xt).luminance,this.St(this.xt.inclination)}},{key:"enable",value:function(){(this.B.getRenderManager().sky=this).B.enableUpdateNode()}},{key:"disable",value:function(){this.B.getRenderManager().sky=null,this.B.enableUpdateNode()}},{key:"setTime",value:function(t){1<(t=(t-6)/12)&&(t-=2),this.St(t)}},{key:"autoTime",value:function(){}},{key:"render",value:function(){this.B.getRenderManager().renderer.render(this.O,this.B.camera)}}])&&rr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),sr=(Object.assign(or.prototype,{Z:function(){this.sky=new Ji,this.sky.scale.setScalar(this.xt.scale),this.O.add(this.sky),this.yt=new Xn(new nr(2e4,16,8),new Ce({color:16777215})),this.yt.position.y=-7e5,this.yt.visible=!0,this.O.add(this.yt),this.setState(this.xt)},K:function(){"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln)},St:function(t){var e=this.sky.material.uniforms,n=(t=Math.PI*(t+1),2*Math.PI*(this.xt.azimuth-.5));this.yt.position.z=this.bt*Math.cos(n),this.yt.position.y=this.bt*Math.sin(n)*Math.sin(t),this.yt.position.x=this.bt*Math.sin(n)*Math.cos(t),e.sunPosition.value=this.yt.position,this.B.enableUpdateRender()}}),{common:{diffuse:{value:new L(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Rt},uv2Transform:{value:new Rt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new at(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new L(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new L(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Rt}},sprite:{diffuse:{value:new L(15658734)},opacity:{value:1},center:{value:new at(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Rt}}}),ar={alphamap_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",alphatest_fragment:"\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",aomap_fragment:"\n#ifdef USE_AOMAP\n\n\t// reads channel R, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",aomap_pars_fragment:"\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent = vec3( tangent.xyz );\n\n#endif\n",bsdfs:'\n\n// Analytical approximation of the DFG LUT, one half of the\n// split-sum approximation used in indirect specular lighting.\n// via \'environmentBRDF\' from "Physically Based Shading on Mobile"\n// https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n}\n\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\n\t// based upon Frostbite 3 Moving to Physically-based Rendering\n\t// page 32, equation 26: E[window1]\n\t// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n\t// this is intended to be used on spot and point lights who are represented as luminous intensity\n\t// but who must be converted to luminous irradiance for surface lighting calculation\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance > 0.0 ) {\n\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} // validated\n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\n\t// Original approximation by Christophe Schlick \'94\n\t// float fresnel = pow( 1.0 - dotLH, 5.0 );\n\n\t// Optimized variant (presented by Epic at SIGGRAPH \'13)\n\t// https://cdn2.unrealengine.com/Resources/files/2013SiggraphPresentationsNotes-26915738.pdf\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} // validated\n\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\n\t// See F_Schlick\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\n\treturn Fr * fresnel + F0;\n\n}\n\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (34)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disneys reparameterization\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\t// geometry term (normalized) = G(l)G(v) / 4(nl)(nv)\n\t// also see #12151\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} // validated\n\n// Moving Frostbite to Physically Based Rendering 3.0 - page 12, listing 2\n// https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\n\t// dotNL and dotNV are explicitly swapped. This is not a mistake.\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\n\n// Microfacet Models for Refraction through Rough Surfaces - equation (33)\n// http://graphicrants.blogspot.com/2013/08/specular-brdf-reference.html\n// alpha is "roughness squared" in Disneys reparameterization\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; // avoid alpha = 0 with dotNH = 1\n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\n\n// GGX Distribution, Schlick Fresnel, GGX-Smith Visibility\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); // UE4\'s roughness\n\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// Rect Area Light\n\n// Real-Time Polygonal-Light Shading with Linearly Transformed Cosines\n// by Eric Heitz, Jonathan Dupuy, Stephen Hill and David Neubelt\n// code: https://github.com/selfshadow/ltc_code/\n\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\n\t// texture parameterized by sqrt( GGX alpha ) and sqrt( 1 - cos( theta ) )\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\n\t// Real-Time Area Lighting: a Journey from Research to Production (p.102)\n\t// An approximation of the form factor of a horizon-clipped rectangle.\n\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\n\t// rational polynomial approximation to theta / sin( theta ) / 2PI\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\n\t// bail if point is on back side of plane of light\n\t// assumes ccw winding order of light vertices\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\n\t// construct orthonormal basis around N\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); // negated from paper; possibly due to a different handedness of world coordinate system\n\n\t// compute transform\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\n\t// transform rect\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\n\t// project rect onto sphere\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\n\t// calculate vector form factor\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\n\t// adjust for horizon clipping\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\n/*\n\t// alternate method of adjusting for horizon clipping (see referece)\n\t// refactoring required\n\tfloat len = length( vectorFormFactor );\n\tfloat z = vectorFormFactor.z / len;\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\t// tabulated horizon-clipped sphere, apparently...\n\tvec2 uv = vec2( z * 0.5 + 0.5, len );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\tfloat scale = texture2D( ltc_2, uv ).w;\n\n\tfloat result = len * scale;\n*/\n\n\treturn vec3( result );\n\n}\n\n// End Rect Area Light\n\n// ref: https://www.unrealengine.com/blog/physically-based-shading-on-mobile - environmentBRDF for GGX on mobile\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\n\treturn specularColor * brdf.x + brdf.y;\n\n} // validated\n\n// Fdez-Agera\'s "Multiple-Scattering Microfacet Model for Real-Time Image Based Lighting"\n// Approximates multiscattering in order to preserve energy.\n// http://www.jcgt.org/published/0008/01/03/\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; // 1/21\n\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n\n}\n\nfloat G_BlinnPhong_Implicit( /* const in float dotNL, const in float dotNV */ ) {\n\n\t// geometry term is (n dot l)(n dot v) / 4(n dot l)(n dot v)\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\n\t//float dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\t//float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit( /* dotNL, dotNV */ );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} // validated\n\n// source: http://simonstechblog.blogspot.ca/2011/12/microfacet-brdf.html\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n\n#if defined( USE_SHEEN )\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L94\nfloat D_Charlie(float roughness, float NoH) {\n\t// Estevez and Kulla 2017, "Production Friendly Microfacet Sheen BRDF"\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125); // 2^(-14/2), so sin2h^2 > 0 in fp16\n\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\n\n// https://github.com/google/filament/blob/master/shaders/src/brdf.fs#L136\nfloat V_Neubelt(float NoV, float NoL) {\n\t// Neubelt and Pettineo 2013, "Crafting a Next-gen Material Pipeline for The Order: 1886"\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\n\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n\n}\n\n#endif\n',bumpmap_pars_fragment:"\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t// Bump Mapping Unparametrized Surfaces on the GPU by Morten S. Mikkelsen\n\t// http://api.unrealengine.com/attachments/Engine/Rendering/LightingAndShadows/BumpMappingWithoutTangentSpace/mm_sfgrad_bump.pdf\n\n\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",clipping_planes_fragment:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",clipping_planes_pars_fragment:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvarying vec3 vClipPosition;\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",clipping_planes_pars_vertex:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvarying vec3 vClipPosition;\n\n#endif\n",clipping_planes_vertex:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvClipPosition = - mvPosition.xyz;\n\n#endif\n",color_fragment:"\n#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n",color_pars_fragment:"\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_pars_vertex:"\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex:"\n#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif\n",common:"\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#ifndef saturate\n// <tonemapping_pars_fragment> may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t// dir can be either a direction vector or a normal vector\n\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n  return m[ 2 ][ 3 ] == - 1.0;\n\n}\n",cube_uv_reflection_fragment:"\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\n\n// These shader functions convert between the UV coordinates of a single face of\n// a cubemap, the 0-5 integer index of a cube face, and the direction vector for\n// sampling a textureCube (not generally normalized).\n\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\n\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\n\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n\n// These defines must match with PMREMGenerator\n\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\n\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n  }\n  return mip;\n}\n\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif\n",defaultnormal_vertex:"\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n\n\t// this is in lieu of a per-instance normal-matrix\n\t// shear transforms in the instance matrix are not supported\n\n\tmat3 m = mat3( instanceMatrix );\n\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\n\ttransformedNormal = m * transformedNormal;\n\n#endif\n\ntransformedNormal = normalMatrix * transformedNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent = - transformedTangent;\n\n\t#endif\n\n#endif\n",displacementmap_pars_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",displacementmap_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n\n#endif\n",emissivemap_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n",emissivemap_pars_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",encodings_fragment:"\ngl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\n// For a discussion of what this is, please read this: http://lousodrome.net/blog/light/2013/05/26/gamma-correct-and-hdr-rendering-in-a-32-bits-buffer/\n\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n//  return vec4( value.brg, ( 3.0 + 128.0 ) / 256.0 );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\n\n// reference: http://iwasbeingirony.blogspot.ca/2010/06/difference-between-rgbm-and-rgbd.html\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\t// NOTE: The implementation with min causes the shader to not compile on\n\t// a common Alcatel A502DL in Chrome 78/Android 8.1. Some research suggests \n\t// that the chipset is Mediatek MT6739 w/ IMG PowerVR GE8100 GPU.\n\t// D = min( floor( D ) / 255.0, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\n\n// LogLuv reference: http://graphicrants.blogspot.ca/2009/04/rgbm-color-encoding.html\n\n// M matrix, for encoding\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\n\n// Inverse M matrix, for decoding\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t}  else {\n\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\n\t\t}\n\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\tvec2 sampleUV;\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\n\t\tenvColor = envMapTexelToLinear( envColor );\n\n\t#endif\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",envmap_common_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif\n",envmap_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",envmap_pars_vertex:"\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",envmap_physical_pars_fragment:"\n#if defined( USE_ENVMAP )\n\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\n\tvec3 getLightProbeIndirectIrradiance( /*const in SpecularLightProbe specularLightProbe,*/ const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\n\t\t\t// TODO: replace with properly filtered cubemaps and access the irradiance LOD level, be it the last LOD level\n\t\t\t// of a specular cubemap, or just the default level of a specially created irradiance cubemap.\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\n\t\t\t\t// force the bias high to get the last LOD level as it is the most blurred.\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\n\t// Trowbridge-Reitz distribution to Mip level, following the logic of http://casual-effects.blogspot.ca/2011/08/plausible-environment-lighting-in-two.html\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\n\t\t// clamp to allowable LOD ranges.\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance( /*const in SpecularLightProbe specularLightProbe,*/ const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\n\t\t  // Mixing the reflection with the normal is more accurate and keeps rough objects from gathering light from behind their tangent plane.\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\n\t\t#else\n\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",envmap_vertex:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex;\n\n\t\tif ( isOrthographic ) { \n\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\t}\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\n\n\tfogDepth = -mvPosition.z;\n\n#endif\n",fog_pars_vertex:"\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",fog_fragment:"\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",fog_pars_fragment:"\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",gradientmap_pars_fragment:"\n\n#ifdef USE_GRADIENTMAP\n\n\tuniform sampler2D gradientMap;\n\n#endif\n\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\n\t// dotNL will be from -1.0 to 1.0\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t#ifdef USE_GRADIENTMAP\n\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t#else\n\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t#endif\n\n}\n\n",lightmap_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity; // factor of PI should not be present; included here to prevent breakage\n\n#endif\n",lightmap_pars_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",lights_lambert_vertex:"\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n/*\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\t// TODO (abelnation): implement\n\n\t}\n\n#endif\n*/\n\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n",lights_pars_begin:"\nuniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\n\n// get the irradiance (radiance convolved with cosine lobe) at the point 'normal' on the unit sphere\n// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\n\t// normal is assumed to have unit length\n\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\n\t// band 0\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\n\t// band 1\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\n\t// band 2\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\n\treturn result;\n\n}\n\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\n\treturn irradiance;\n\n}\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n\n\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n\n\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t// directLight is an out parameter as having it as a return value caused compiler errors on some devices\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\n\t// Pre-computed values of LinearTransformedCosine approximation of BRDF\n\t// BRDF approximation Texture is 64x64\n\tuniform sampler2D ltc_1; // RGBA Float\n\tuniform sampler2D ltc_2; // RGBA Float\n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n\n\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",lights_toon_fragment:"\nToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_toon_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct ToonMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_phong_fragment:"\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n\nstruct BlinnPhongMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n\n#ifdef REFLECTIVITY\n\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\n#else\n\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\n#endif\n\n#ifdef CLEARCOAT\n\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\n\t#ifdef USE_CLEARCOATMAP\n\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\n\t#endif\n\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\n\t#endif\n\n\tmaterial.clearcoat = saturate( material.clearcoat ); // Burley clearcoat model\n\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n\n#endif\n\n#ifdef USE_SHEEN\n\n\tmaterial.sheenColor = sheen;\n\n#endif\n",lights_physical_pars_fragment:"\nstruct PhysicalMaterial {\n\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\n\n// Clear coat directional hemishperical reflectance (this approximation should be improved)\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight; // counterclockwise; light shines in local neg z direction\n\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\n\t\t// LTC Fresnel Approximation by Stephen Hill\n\t\t// http://blog.selfshadow.com/publications/s2016-advances/s2016_ltc_fresnel.pdf\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; // punctual light\n\n\t#endif\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tccIrradiance *= PI; // punctual light\n\n\t\t#endif\n\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\n\t// Both indirect specular and indirect diffuse light accumulate here\n\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n\n// ref: https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",lights_fragment_begin:"\n/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n",lights_fragment_maps:"\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( /*lightProbe,*/ geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\n\t#ifdef CLEARCOAT\n\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( /*specularLightProbe,*/ geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\n\t#endif\n\n#endif\n",lights_fragment_end:"\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",logdepthbuf_fragment:"\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\t// Doing a strict comparison with == 1.0 can cause noise artifacts\n\t// on some platforms. See issue #17623.\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",logdepthbuf_pars_fragment:"\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n\n#endif\n",logdepthbuf_pars_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",logdepthbuf_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\n\t#else\n\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\t\tgl_Position.z *= gl_Position.w;\n\n\t\t}\n\n\t#endif\n\n#endif\n",map_fragment:"\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n",map_fragment_1:"\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\t\n\tif(mapMixColor){\n\t    diffuseColor = texelColor*texelColor.a + diffuseColor*(1.0-texelColor.a);\n\t}else {\n\t    diffuseColor *= texelColor;\n\t}\n\n#endif\n",map_pars_fragment:"\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",map_particle_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\n#endif\n\n#ifdef USE_MAP\n\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n\n#endif\n",map_particle_pars_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tuniform mat3 uvTransform;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",metalnessmap_fragment:"\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\n\t// reads channel B, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n",metalnessmap_pars_fragment:"\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",morphnormal_vertex:"\n#ifdef USE_MORPHNORMALS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in normal = sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\n#endif\n",morphtarget_pars_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\tuniform float morphTargetBaseInfluence;\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",morphtarget_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\t// morphTargetBaseInfluence is set based on BufferGeometry.morphTargetsRelative value:\n\t// When morphTargetsRelative is false, this is set to 1 - sum(influences); this results in position = sum((target - base) * influence)\n\t// When morphTargetsRelative is true, this is set to 1; as a result, all morph targets are simply added to the base after weighting\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",normal_fragment_begin:"\n#ifdef FLAT_SHADED\n\n\t// Workaround for Adreno/Nexus5 not able able to do dFdx( vViewPosition ) ...\n\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n\n// non perturbed normal for clearcoat among others\n\nvec3 geometryNormal = normal;\n\n",normal_fragment_maps:"\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; // overrides both flatShading and attribute normals\n\n\t#ifdef FLIP_SIDED\n\n\t\tnormal = - normal;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\tnormal = normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tnormal = normalize( vTBN * mapN );\n\n\t#else\n\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n",normalmap_pars_fragment:"\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n#endif\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tuniform mat3 normalMatrix;\n\n#endif\n\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\n\t// Per-Pixel Tangent Space Normal Mapping\n\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tmat3 tsn = mat3( S, T, N );\n\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",clearcoat_normal_fragment_begin:"\n#ifdef CLEARCOAT\n\n\tvec3 clearcoatNormal = geometryNormal;\n\n#endif\n",clearcoat_normal_fragment_maps:"\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\n\t#else\n\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\n\t#endif\n\n#endif\n",clearcoat_pars_fragment:"\n\n#ifdef USE_CLEARCOATMAP\n\n\tuniform sampler2D clearcoatMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\n\tuniform sampler2D clearcoatRoughnessMap;\n\n#endif\n\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n\n#endif\n",packing:"\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; // fraction -> 0..1 (including 1)\nconst float UnpackDownscale = 255. / 256.; // 0..1 -> fraction (excluding 1)\n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; // tidy overflow\n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\n\n// NOTE: viewZ/eyeZ is < 0 when in front of the camera per OpenGL conventions\n\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"\n#ifdef PREMULTIPLIED_ALPHA\n\n\t// Get get normal blending with premultipled, use with CustomBlending, OneFactor, OneMinusSrcAlphaFactor, AddEquation.\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n",project_vertex:"\nvec4 mvPosition = vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\n\tmvPosition = instanceMatrix * mvPosition;\n\n#endif\n\nmvPosition = modelViewMatrix * mvPosition;\n\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"\n#ifdef DITHERING\n\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n",dithering_pars_fragment:"\n#ifdef DITHERING\n\n\t// based on https://www.shadertoy.com/view/MslGR8\n\tvec3 dithering( vec3 color ) {\n\t\t//Calculate grid position\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\n\t\t//Shift the individual colors differently, thus making it even harder to see the dithering pattern\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\n\t\t//modify shift acording to grid position.\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\n\t\t//shift the color by dither_shift\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",roughnessmap_fragment:"\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\n\t// reads channel G, compatible with a combined OcclusionRoughnessMetallic (RGB) texture\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n",roughnessmap_pars_fragment:"\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",shadowmap_pars_fragment:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): create uniforms for area light shadows\n\n\t#endif\n\t*/\n\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n\t}\n\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n\t\tfloat occlusion = 1.0;\n\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\n\t\tfloat hard_shadow = step( compare , distribution.x ); // Hard Shadow\n\n\t\tif (hard_shadow != 1.0 ) {\n\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality\n\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed\n\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n\t\t}\n\t\treturn occlusion;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\n\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#else // no percentage-closer filtering:\n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\n\t// cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D\n\t// vector suitable for 2D texture mapping. This code uses the following layout for the\n\t// 2D texture:\n\t//\n\t// xzXZ\n\t//  y Y\n\t//\n\t// Y - Positive y direction\n\t// y - Negative y direction\n\t// X - Positive x direction\n\t// x - Negative x direction\n\t// Z - Positive z direction\n\t// z - Negative z direction\n\t//\n\t// Source and test bed:\n\t// https://gist.github.com/tschw/da10c43c467ce8afd0c4\n\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\n\t\t// Number of texels to avoid at the edge of each square\n\n\t\tvec3 absV = abs( v );\n\n\t\t// Intersect unit cube\n\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\n\t\t// Apply scale to avoid seams\n\n\t\t// two texels less per square (one texel will do for NEAREST)\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\n\t\t// Unwrap\n\n\t\t// space: -1 ... 1 range for each square\n\t\t//\n\t\t// #X##\t\tdim    := ( 4 , 2 )\n\t\t//  # #\t\tcenter := ( 1 , 1 )\n\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\n\t\t// Transform to UV space\n\n\t\t// scale := 0.5 / dim\n\t\t// translate := ( center + 0.5 ) / dim\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\n\t\t// for point lights, the uniform @vShadowCoord is re-purposed to hold\n\t\t// the vector from the light to the world-space position of the fragment.\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\n\t\t// dp = normalized distance from light to fragment position\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?\n\t\tdp += shadowBias;\n\n\t\t// bd3D = base direction 3D\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else // no percentage-closer filtering\n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",shadowmap_pars_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): uniforms for area light shadows\n\n\t#endif\n\t*/\n\n#endif\n",shadowmap_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update vAreaShadowCoord with area light info\n\n\t#endif\n\t*/\n\n#endif\n",shadowmask_pars_fragment:"\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\tDirectionalLightShadow directionalLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\tSpotLightShadow spotLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\tPointLightShadow pointLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\t#pragma unroll_loop_end\n\n\t#endif\n\n\t/*\n\t#if NUM_RECT_AREA_LIGHTS > 0\n\n\t\t// TODO (abelnation): update shadow for Area light\n\n\t#endif\n\t*/\n\n\t#endif\n\n\treturn shadow;\n\n}\n",skinbase_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n",skinning_pars_vertex:"\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",skinning_vertex:"\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",skinnormal_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n",specularmap_fragment:"\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n",specularmap_pars_fragment:"\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",tonemapping_fragment:"\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n",tonemapping_pars_fragment:"\n#ifndef saturate\n// <common> may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\n\n// exposure only\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\n\n// source: https://www.cs.utah.edu/~reinhard/cdrom/\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\n\t// John Hable's filmic operator from Uncharted 2 video game\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n\n}\n\n// source: http://filmicgames.com/archives/75\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\n\t// optimized filmic operator by Jim Hejl and Richard Burgess-Dawson\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\n\n// source: https://knarkowicz.wordpress.com/2016/01/06/aces-filmic-tone-mapping-curve/\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n\n}\n",uv_pars_fragment:"\n#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\n\tvarying vec2 vUv;\n\n#endif\n",uv_pars_vertex:"\n#ifdef USE_UV\n\n\t#ifdef UVS_VERTEX_ONLY\n\n\t\tvec2 vUv;\n\n\t#else\n\n\t\tvarying vec2 vUv;\n\n\t#endif\n\n\tuniform mat3 uvTransform;\n\n#endif\n",uv_vertex:"\n#ifdef USE_UV\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",uv2_pars_fragment:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_pars_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n\tuniform mat3 uv2Transform;\n\n#endif\n",uv2_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n\n#endif\n",worldpos_vertex:"\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t#ifdef USE_INSTANCING\n\n\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t#endif\n\n\tworldPosition = modelMatrix * worldPosition;\n\n#endif\n",background_frag:"\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",background_vert:"\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",cube_frag:"\n\n#include <envmap_common_pars_fragment>\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",cube_vert:"\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; // set z to camera.far\n\n}\n",depth_frag:"\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\n\t#endif\n\n}\n",depth_vert:"\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.\n// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for\n// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvHighPrecisionZW = gl_Position.zw;\n\n}\n",distanceRGBA_frag:"\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); // clamp to [ 0, 1 ]\n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",distanceRGBA_vert:"\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",equirect_frag:"\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV;\n\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",equirect_vert:"\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",linedashed_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; // simple shader\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",linedashed_vert:"\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\tvLineDistance = scale * lineDistance;\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",meshbasic_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",meshbasic_vert:"\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshlambert_frag:"\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag:"\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",meshmatcap_vert:"\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",meshtoon_frag:"\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshtoon_vert:"\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphong_frag:"\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphong_vert:"\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphysical_frag:"\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// this is a stub for the transparency model\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphysical_vert:"\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",normal_frag:"\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",normal_vert:"\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",points_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",points_vert:"\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",shadow_frag:"\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",shadow_vert:"\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",sprite_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",sprite_vert:"\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n"};function Ar(t,e,n,i){cn.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function lr(t){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ur(t,e){return(ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function hr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cr(t){return(cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Ar.prototype=Object.assign(Object.create(cn.prototype),{constructor:Ar,isPerspectiveCamera:!0,copy:function(t,e){return cn.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*F.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*F.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*F.RAD2DEG*Math.atan(Math.tan(.5*F.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=this.near,n=e*Math.tan(.5*F.DEG2RAD*this.fov)/this.zoom,i=2*n,r=this.aspect*i,o=-.5*r,s=this.view,a=(null!==this.view&&this.view.enabled&&(a=s.fullWidth,t=s.fullHeight,o+=s.offsetX*r/a,n-=s.offsetY*i/t,r*=s.width/a,i*=s.height/t),this.filmOffset);0!==a&&(o+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,n,n-i,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}});var fr=function(){var t=i,e=Xn;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ur(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=cr(t);if(n=e?(n=cr(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===lr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return hr(i)}}(i);function i(t,e){var r,s,a,A,l,u,h,c,f,p,d,y,m,g,b,w,B,M,S,_,E,T,C,O,P,U;if(this instanceof i)return r=hr(t=n.call(this,t)),t.parentNode=e.parentNode,P=void 0!==(e=e||{}).textureWidth?e.textureWidth:512,U=void 0!==e.textureHeight?e.textureHeight:512,s=void 0!==e.clipBias?e.clipBias:0,a=void 0!==e.alpha?e.alpha:1,A=void 0!==e.time?e.time:0,l=void 0!==e.waterNormals?e.waterNormals:null,u=void 0!==e.sunDirection?e.sunDirection:new V(.70707,.70707,0),h=new L(void 0!==e.sunColor?e.sunColor:16777215),c=new L(void 0!==e.waterColor?e.waterColor:8355711),f=void 0!==e.eye?e.eye:new V(0,0,0),p=void 0!==e.distortionScale?e.distortionScale:20,d=void 0!==e.side?e.side:o,e=void 0!==e.fog&&e.fog,y=new gn,m=new V,g=new V,b=new V,w=new Ct,B=new V(0,0,-1),M=new st,S=new V,_=new V,E=new st,T=new Ct,C=new Ar,O=new oi(P,U,{minFilter:v,magFilter:v,format:x,stencilBuffer:!1,depthBuffer:!0}),t.renderTarget=O,F.isPowerOfTwo(P)&&F.isPowerOfTwo(U)||(O.texture.generateMipmaps=!1),(U=new ve({fragmentShader:(P={uniforms:ye.merge([sr.fog,sr.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new Ct},sunColor:{value:new L(8355711)},sunDirection:{value:new V(.70707,.70707,0)},eye:{value:new V},waterColor:{value:new L(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","#include <logdepthbuf_pars_vertex>","varying vec4 mirrorCoord;","varying vec4 worldPosition;","#include <common>",ar.fog_pars_vertex,ar.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;","\t#include <logdepthbuf_vertex>",ar.fog_vertex,ar.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","#include <logdepthbuf_pars_fragment>","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",ar.common,ar.packing,ar.bsdfs,ar.fog_pars_fragment,ar.lights_pars_begin,ar.shadowmap_pars_fragment,ar.shadowmask_pars_fragment,"void main() {","\t#include <logdepthbuf_fragment>","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",ar.tonemapping_fragment,ar.fog_fragment,"}"].join("\n")}).fragmentShader,vertexShader:P.vertexShader,uniforms:ye.clone(P.uniforms),lights:!0,side:d,fog:e,transparent:!0,depthTest:!0,depthWrite:!1})).uniforms.mirrorSampler.value=O.texture,U.uniforms.textureMatrix.value=T,U.uniforms.alpha.value=a,U.uniforms.time.value=A,U.uniforms.normalSampler.value=l,U.uniforms.sunColor.value=h,U.uniforms.waterColor.value=c,U.uniforms.sunDirection.value=u,U.uniforms.distortionScale.value=p,U.uniforms.eye.value=f,r.material=U,r.onBeforeRender=function(t,e,n){if(g.setFromMatrixPosition(r.matrixWorld),b.setFromMatrixPosition(n.matrixWorld),w.extractRotation(r.matrixWorld),m.set(0,0,1),m.applyMatrix4(w),S.subVectors(g,b),!(0<S.dot(m))){S.reflect(m).negate(),S.add(g),w.extractRotation(n.matrixWorld),B.set(0,0,-1),B.applyMatrix4(w),B.add(b),_.subVectors(g,B),_.reflect(m).negate(),_.add(g),C.position.copy(S),C.up.set(0,1,0),C.up.applyMatrix4(w),C.up.reflect(m),C.lookAt(_),C.far=n.far,C.updateMatrixWorld(),C.projectionMatrix.copy(n.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(C.projectionMatrix),T.multiply(C.matrixWorldInverse),y.setFromNormalAndCoplanarPoint(m,g),y.applyMatrix4(C.matrixWorldInverse),M.set(y.normal.x,y.normal.y,y.normal.z,y.constant);var i=C.projectionMatrix,o=(i=(E.x=(Math.sign(M.x)+i.elements[8])/i.elements[0],E.y=(Math.sign(M.y)+i.elements[9])/i.elements[5],E.z=-1,E.w=(1+i.elements[10])/i.elements[14],M.multiplyScalar(2/M.dot(E)),i.elements[2]=M.x,i.elements[6]=M.y,i.elements[10]=M.z+1-s,i.elements[14]=M.w,f.setFromMatrixPosition(n.matrixWorld),t.getRenderTarget()),t.xr.enabled),a=t.shadowMap.autoUpdate;if(r.visible=!1,t.xr.enabled=!1,t.shadowMap.autoUpdate=!1,t.setRenderTarget(O),!1===t.autoClear&&t.clear(),r.parentNode&&r.parentNode.Tt&&r.parentNode.Tt.Mt)for(var A=0;A<r.parentNode.Tt.Mt.length;A++)t.render(r.parentNode.Tt.Mt[A],C);r.visible=!0,t.xr.enabled=o,t.shadowMap.autoUpdate=a,t.setRenderTarget(i),void 0!==(o=n.viewport)&&t.state.viewport(o)}},t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function pr(){this.type="Curve",this.arcLengthDivisions=200}function dr(t,e,n,i,r,o,s,a){pr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function yr(t,e,n,i,r,o){dr.call(this,t,e,n,n,i,r,o),this.type="ArcCurve"}function mr(){var t=0,e=0,n=0,i=0;function r(r,o,s,a){n=-3*(t=r)+3*o-2*(e=s)-a,i=2*r-2*o+s+a}return{initCatmullRom:function(t,e,n,i,o){r(e,n,o*(n-t),o*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,o,s,a){t=(e-t)/o-(n-t)/(o+s)+(n-e)/s,o=(n-e)/s-(i-e)/(s+a)+(i-n)/a,r(e,n,t*=s,o*=s)},calc:function(r){var o=r*r;return t+e*r+n*o+i*(o*r)}}}Object.assign(pr.prototype,{getPoint:function(){return null},getPointAt:function(t,e){return t=this.getUtoTmapping(t),this.getPoint(t,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,i=[],r=this.getPoint(0),o=0;for(i.push(0),n=1;n<=t;n++)o+=(e=this.getPoint(n/t)).distanceTo(r),i.push(o),r=e;return this.cacheArcLengths=i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){for(var n,i=this.getLengths(),r=0,o=i.length,s=e||t*i[o-1],a=0,A=o-1;a<=A;)if((n=i[r=Math.floor(a+(A-a)/2)]-s)<0)a=r+1;else{if(!(0<n)){A=r;break}A=r-1}return i[r=A]===s?r/(o-1):(r+(s-(e=i[r]))/(i[r+1]-e))/(o-1)},getTangent:function(t){var e=t-1e-4;1<(t=t+1e-4)&&(t=1),e=this.getPoint(e=e<0?0:e);return this.getPoint(t).clone().sub(e).normalize()},getTangentAt:function(t){return t=this.getUtoTmapping(t),this.getTangent(t)},computeFrenetFrames:function(t,e){for(var n,i=new V,r=[],o=[],s=[],a=new V,A=new Ct,l=0;l<=t;l++)r[l]=this.getTangentAt(l/t),r[l].normalize();o[0]=new V,s[0]=new V;var u=Number.MAX_VALUE,h=Math.abs(r[0].x),c=Math.abs(r[0].y),f=Math.abs(r[0].z);for(h<=u&&(u=h,i.set(1,0,0)),c<=u&&(u=c,i.set(0,1,0)),f<=u&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),o[0].crossVectors(r[0],a),s[0].crossVectors(r[0],o[0]),l=1;l<=t;l++)o[l]=o[l-1].clone(),s[l]=s[l-1].clone(),a.crossVectors(r[l-1],r[l]),a.length()>Number.EPSILON&&(a.normalize(),n=Math.acos(F.clamp(r[l-1].dot(r[l]),-1,1)),o[l].applyMatrix4(A.makeRotationAxis(a,n))),s[l].crossVectors(r[l],o[l]);if(!0===e)for(n=Math.acos(F.clamp(o[0].dot(o[t]),-1,1)),n/=t,0<r[0].dot(a.crossVectors(o[0],o[t]))&&(n=-n),l=1;l<=t;l++)o[l].applyMatrix4(A.makeRotationAxis(r[l],n*l)),s[l].crossVectors(r[l],o[l]);return{tangents:r,normals:o,binormals:s}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),((dr.prototype=Object.create(pr.prototype)).constructor=dr).prototype.isEllipseCurve=!0,dr.prototype.getPoint=function(t,e){e=e||new at;for(var n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,r=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;n<i;)i-=n;i<Number.EPSILON&&(i=r?0:n),!0!==this.aClockwise||r||(i===n?i=-n:i-=n);var o,s,a,A;r=this.aStartAngle+t*i,t=this.aX+this.xRadius*Math.cos(r),r=this.aY+this.yRadius*Math.sin(r);return 0!==this.aRotation&&(o=Math.cos(this.aRotation),s=Math.sin(this.aRotation),t=(a=t-this.aX)*o-(A=r-this.aY)*s+this.aX,r=a*s+A*o+this.aY),e.set(t,r)},dr.prototype.copy=function(t){return pr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},((yr.prototype=Object.create(dr.prototype)).constructor=yr).prototype.isArcCurve=!0;var gr=new V,vr=new mr,br=new mr,xr=new mr;function wr(t,e,n,i){pr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=i||.5}function Br(t,e,n,i,r){var o=t*t;return(2*n-2*i+(e=.5*(i-e))+(r=.5*(r-n)))*(t*o)+(-3*n+3*i-2*e-r)*o+e*t+n}function Mr(t,e,n,i){return(r=1-(r=t))*r*e+2*(1-t)*t*n+t*t*i;var r}function Sr(t,e,n,i,r){return(o=1-(o=t))*o*o*e+3*(o=1-t)*o*t*n+3*(1-t)*t*t*i+t*t*t*r;var o}function _r(t,e,n,i){pr.call(this),this.type="CubicBezierCurve",this.v0=t||new at,this.v1=e||new at,this.v2=n||new at,this.v3=i||new at}function Er(t,e,n,i){pr.call(this),this.type="CubicBezierCurve3",this.v0=t||new V,this.v1=e||new V,this.v2=n||new V,this.v3=i||new V}function Tr(t,e){pr.call(this),this.type="LineCurve",this.v1=t||new at,this.v2=e||new at}function Cr(t,e){pr.call(this),this.type="LineCurve3",this.v1=t||new V,this.v2=e||new V}function Fr(t,e,n){pr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new at,this.v1=e||new at,this.v2=n||new at}function Or(t){pr.call(this),this.type="SplineCurve",this.points=t||[]}function Pr(){pr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Ur(t){Pr.call(this),this.type="Path",this.currentPoint=new at,t&&this.setFromPoints(t)}function Rr(t){Ur.call(this,t),this.uuid=F.generateUUID(),this.type="Shape",this.holes=[]}((wr.prototype=Object.create(pr.prototype)).constructor=wr).prototype.isCatmullRomCurve3=!0,wr.prototype.getPoint=function(t,e){e=e||new V;var n,i,r,o,s=this.points,a=s.length,A=(t=(a-(this.closed?0:1))*t,Math.floor(t));t-=A;return this.closed?A+=0<A?0:(Math.floor(Math.abs(A)/a)+1)*a:0===t&&A===a-1&&(A=a-2,t=1),n=this.closed||0<A?s[(A-1)%a]:(gr.subVectors(s[0],s[1]).add(s[0]),gr),i=s[A%a],r=s[(A+1)%a],A=this.closed||A+2<a?s[(A+2)%a]:(gr.subVectors(s[a-1],s[a-2]).add(s[a-1]),gr),"centripetal"===this.curveType||"chordal"===this.curveType?(s="chordal"===this.curveType?.5:.25,a=Math.pow(n.distanceToSquared(i),s),(o=Math.pow(i.distanceToSquared(r),s))<1e-4&&(o=1),a<1e-4&&(a=o),(s=Math.pow(r.distanceToSquared(A),s))<1e-4&&(s=o),vr.initNonuniformCatmullRom(n.x,i.x,r.x,A.x,a,o,s),br.initNonuniformCatmullRom(n.y,i.y,r.y,A.y,a,o,s),xr.initNonuniformCatmullRom(n.z,i.z,r.z,A.z,a,o,s)):"catmullrom"===this.curveType&&(vr.initCatmullRom(n.x,i.x,r.x,A.x,this.tension),br.initCatmullRom(n.y,i.y,r.y,A.y,this.tension),xr.initCatmullRom(n.z,i.z,r.z,A.z,this.tension)),e.set(vr.calc(t),br.calc(t),xr.calc(t)),e},wr.prototype.copy=function(t){pr.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},((_r.prototype=Object.create(pr.prototype)).constructor=_r).prototype.isCubicBezierCurve=!0,_r.prototype.getPoint=function(t,e){e=e||new at;var n=this.v0,i=this.v1,r=this.v2,o=this.v3;return e.set(Sr(t,n.x,i.x,r.x,o.x),Sr(t,n.y,i.y,r.y,o.y)),e},_r.prototype.copy=function(t){return pr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},((Er.prototype=Object.create(pr.prototype)).constructor=Er).prototype.isCubicBezierCurve3=!0,Er.prototype.getPoint=function(t,e){e=e||new V;var n=this.v0,i=this.v1,r=this.v2,o=this.v3;return e.set(Sr(t,n.x,i.x,r.x,o.x),Sr(t,n.y,i.y,r.y,o.y),Sr(t,n.z,i.z,r.z,o.z)),e},Er.prototype.copy=function(t){return pr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},((Tr.prototype=Object.create(pr.prototype)).constructor=Tr).prototype.isLineCurve=!0,Tr.prototype.getPoint=function(t,e){return e=e||new at,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Tr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Tr.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Tr.prototype.copy=function(t){return pr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},((Cr.prototype=Object.create(pr.prototype)).constructor=Cr).prototype.isLineCurve3=!0,Cr.prototype.getPoint=function(t,e){return e=e||new V,1===t?e.copy(this.v2):(e.copy(this.v2).sub(this.v1),e.multiplyScalar(t).add(this.v1)),e},Cr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Cr.prototype.copy=function(t){return pr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},((Fr.prototype=Object.create(pr.prototype)).constructor=Fr).prototype.isQuadraticBezierCurve=!0,Fr.prototype.getPoint=function(t,e){e=e||new at;var n=this.v0,i=this.v1,r=this.v2;return e.set(Mr(t,n.x,i.x,r.x),Mr(t,n.y,i.y,r.y)),e},Fr.prototype.copy=function(t){return pr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},((Or.prototype=Object.create(pr.prototype)).constructor=Or).prototype.isSplineCurve=!0,Or.prototype.getPoint=function(t,e){e=e||new at,t=((s=this.points).length-1)*t;var n=Math.floor(t),i=(t=t-n,s[0===n?n:n-1]),r=s[n],o=s[n>s.length-2?s.length-1:n+1],s=s[n>s.length-3?s.length-1:n+2];return e.set(Br(t,i.x,r.x,o.x,s.x),Br(t,i.y,r.y,o.y,s.y)),e},Or.prototype.copy=function(t){pr.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var i=t.points[e];this.points.push(i.clone())}return this},Pr.prototype=Object.assign(Object.create(pr.prototype),{constructor:Pr,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Tr(e,t))},getPoint:function(t){for(var e,n,i,r=t*this.getLength(),o=this.getCurveLengths(),s=0;s<o.length;){if(o[s]>=r)return e=o[s]-r,i=(n=this.curves[s]).getLength(),n.getPointAt(0===i?0:1-e/i);s++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],i=0,r=this.curves;i<r.length;i++)for(var o=r[i],s=o&&o.isEllipseCurve?2*t:o&&(o.isLineCurve||o.isLineCurve3)?1:o&&o.isSplineCurve?t*o.points.length:t,a=o.getPoints(s),A=0;A<a.length;A++){var l=a[A];e&&e.equals(l)||(n.push(l),e=l)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){pr.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}}),Ur.prototype=Object.assign(Object.create(Pr.prototype),{constructor:Ur,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this},moveTo:function(t,e){return this.currentPoint.set(t,e),this},lineTo:function(t,e){var n=new Tr(this.currentPoint.clone(),new at(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this},quadraticCurveTo:function(t,e,n,i){return t=new Fr(this.currentPoint.clone(),new at(t,e),new at(n,i)),this.curves.push(t),this.currentPoint.set(n,i),this},bezierCurveTo:function(t,e,n,i,r,o){return t=new _r(this.currentPoint.clone(),new at(t,e),new at(n,i),new at(r,o)),this.curves.push(t),this.currentPoint.set(r,o),this},splineThru:function(t){var e=new Or([this.currentPoint.clone()].concat(t));return this.curves.push(e),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,e,n,i,r,o){var s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+s,e+a,n,i,r,o),this},absarc:function(t,e,n,i,r,o){return this.absellipse(t,e,n,n,i,r,o),this},ellipse:function(t,e,n,i,r,o,s,a){var A=this.currentPoint.x,l=this.currentPoint.y;return this.absellipse(t+A,e+l,n,i,r,o,s,a),this},absellipse:function(t,e,n,i,r,o,s,a){return t=new dr(t,e,n,i,r,o,s,a),0<this.curves.length&&((e=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(e.x,e.y)),this.curves.push(t),n=t.getPoint(1),this.currentPoint.copy(n),this},copy:function(t){return Pr.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this}}),Rr.prototype=Object.assign(Object.create(Ur.prototype),{constructor:Rr,getPointsHoles:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Ur.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var i=t.holes[e];this.holes.push(i.clone())}return this}});var Ir=function(t,e,n){n=n||2;var i,r,o,s,a,A=e&&e.length,l=A?e[0]*n:t.length,u=Lr(t,0,l,n,!0),h=[];if(u&&u.next!==u.prev){if(A&&(u=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=Lr(t,s=e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(function(t){for(var e=t,n=t;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),(e=e.next)!==t;);return n}(s));for(a.sort(Qr),r=0;r<a.length;r++)!function(t,e){(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}}while((i=i.next)!==e);if(!n)return null;if(r===s)return n.prev;var A,l=n,u=n.x,h=n.y,c=1/0;for(i=n.next;i!==l;)r>=i.x&&i.x>=u&&r!==i.x&&Nr(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&((A=Math.abs(o-i.y)/(r-i.x))<c||A===c&&i.x>n.x)&&Vr(i,t)&&(n=i,c=A),i=i.next;return n}(t,e))&&Dr(e=Gr(e,t),e.next)}(a[r],n),n=Dr(n,n.next);return n}(t,e,u,n)),t.length>80*n){for(var c=i=t[0],f=r=t[1],p=n;p<l;p+=n)(o=t[p])<c&&(c=o),(s=t[p+1])<f&&(f=s),i<o&&(i=o),r<s&&(r=s);a=0!==(a=Math.max(i-c,r-f))?1/a:0}!function t(e,n,i,r,o,s,a){if(e){if(!a&&s){for(var A=e,l=r,u=o,h=s,c=A;null===c.z&&(c.z=kr(c.x,c.y,l,u,h)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==A;);c.prevZ.nextZ=null,c.prevZ=null;var f,p,d,y,m,g,v,b,x=c,w=1;do{for(p=x,m=x=null,g=0;p;){for(g++,d=p,f=v=0;f<w&&(v++,d=d.nextZ);f++);for(b=w;0<v||0<b&&d;)0!==v&&(0===b||!d||p.z<=d.z)?(p=(y=p).nextZ,v--):(d=(y=d).nextZ,b--),m?m.nextZ=y:x=y,y.prevZ=m,m=y;p=d}}while(m.nextZ=null,w*=2,1<g)}for(var B,M,S=e;e.prev!==e.next;)if(B=e.prev,M=e.next,s?function(t,e,n,i){var r=t.prev,o=t,s=t.next;if(!(0<=jr(r,o,s))){for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,A=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,u=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,h=kr(a,A,e,n,i),c=kr(l,u,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=c;){if(f!==t.prev&&f!==t.next&&Nr(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=jr(f.prev,f,f.next))return;if(f=f.prevZ,p!==t.prev&&p!==t.next&&Nr(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=jr(p.prev,p,p.next))return;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&Nr(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=jr(f.prev,f,f.next))return;f=f.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&Nr(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=jr(p.prev,p,p.next))return;p=p.nextZ}return 1}}(e,r,o,s):function(t){var e=t.prev,n=t,i=t.next;if(!(0<=jr(e,n,i))){for(var r=t.next.next;r!==t.prev;){if(Nr(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=jr(r.prev,r,r.next))return;r=r.next}return 1}}(e))n.push(B.i/i),n.push(e.i/i),n.push(M.i/i),Kr(e),e=M.next,S=M.next;else if((e=M)===S){a?1===a?t(e=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next}while(!Hr(r,o)&&zr(r,i,i.next,o)&&Vr(r,o)&&Vr(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),Kr(i),Kr(i.next),i=t=o),(i=i.next)!==t);return i}(e,n,i),n,i,r,o,s,2):2===a&&function(e,n,i,r,o,s){var a=e;do{for(var A,l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&zr(n,n.next,t,e))return 1}while((n=n.next)!==t)}(t,e)&&Vr(t,e)&&Vr(e,t)&&function(t,e){for(var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!==t;);return i}(t,e)}(a,l))return A=Gr(a,l),a=Dr(a,a.next),A=Dr(A,A.next),t(a,n,i,r,o,s),t(A,n,i,r,o,s);l=l.next}}while((a=a.next)!==e)}(e,n,i,r,o,s):t(Dr(e),n,i,r,o,s,1);break}}}(u,h,n,c,f,a)}return h};function Lr(t,e,n,i,r){var o,s;if(r===0<function(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}(t,e,n,i))for(o=e;o<n;o+=i)s=Yr(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=Yr(o,t[o],t[o+1],s);return s&&Hr(s,s.next)&&(Kr(s),s=s.next),s}function Dr(t,e){if(!t)return t;e=e||t;var n,i=t;do{if(n=!1,i.steiner||!Hr(i,i.next)&&0!==jr(i.prev,i,i.next))i=i.next;else{if(Kr(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Qr(t,e){return t.x-e.x}function kr(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Nr(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function jr(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Hr(t,e){return t.x===e.x&&t.y===e.y}function zr(t,e,n,i){return Hr(t,n)&&Hr(e,i)||Hr(t,i)&&Hr(n,e)||0<jr(t,e,n)!=0<jr(t,e,i)&&0<jr(n,i,t)!=0<jr(n,i,e)}function Vr(t,e){return jr(t.prev,t,t.next)<0?0<=jr(t,e,t.next)&&0<=jr(t,t.prev,e):jr(t,e,t.prev)<0||jr(t,t.next,e)<0}function Gr(t,e){var n=new Xr(t.i,t.x,t.y),i=new Xr(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function Yr(t,e,n,i){return t=new Xr(t,e,n),i?(t.next=i.next,(t.prev=i).next.prev=t,i.next=t):(t.prev=t).next=t,t}function Kr(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Xr(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Wr={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return Wr.area(t)<0},triangulateShape:function(t,e){var n=[],i=[],r=[],o=(Zr(t),qr(n,t),t.length);e.forEach(Zr);for(var s=0;s<e.length;s++)i.push(o),o+=e[s].length,qr(n,e[s]);var a=Ir(n,i);for(s=0;s<a.length;s+=3)r.push(a.slice(s,s+3));return r}};function Zr(t){var e=t.length;2<e&&t[e-1].equals(t[0])&&t.pop()}function qr(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $r(t,e){zi.call(this),this.type="ShapeGeometry","object"===Jr(e)&&(e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new to(t,e)),this.mergeVertices()}function to(t,e){ne.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var n=[],i=[],r=[],o=[],s=0,a=0;if(!1===Array.isArray(t))l(t);else for(var A=0;A<t.length;A++)l(t[A]),this.addGroup(s,a,A),s+=a,a=0;function l(t){var s,A=i.length/3,l=(t=t.extractPoints(e)).shape,u=t.holes;for(!1===Wr.isClockWise(l)&&(l=l.reverse()),c=0,f=u.length;c<f;c++)s=u[c],!0===Wr.isClockWise(s)&&(u[c]=s.reverse());for(var h=Wr.triangulateShape(l,u),c=0,f=u.length;c<f;c++)s=u[c],l=l.concat(s);for(c=0,f=l.length;c<f;c++){var p=l[c];i.push(p.x,p.y,0),r.push(0,0,1),o.push(p.x,p.y)}for(c=0,f=h.length;c<f;c++){var d=(m=h[c])[0]+A,y=m[1]+A,m=m[2]+A;n.push(d,y,m),a+=3}}this.setIndex(n),this.setAttribute("position",new mt(i,3)),this.setAttribute("normal",new mt(r,3)),this.setAttribute("uv",new mt(o,2))}function eo(t){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function no(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===eo(t=function(t,e){if("object"!==eo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==eo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}($r.prototype=Object.create(zi.prototype)).constructor=$r,(to.prototype=Object.create(ne.prototype)).constructor=to;var io=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.Et=[],this.Tt=null,this.Pt=fengmap.FMType.MODEL_LAYER|fengmap.FMType.EXTERNAL_MODEL_LAYER,this.I=fengmap.FMType.EXTERNAL_MODEL_LAYER,this.O=new on,this.O.name="waterScene",this.H=new on,this.H.name="sprayScene",this.Mt=[],this.Lt=!1}var e,n;return e=t,(n=[{key:"traverse",value:function(t){for(var e=0;e<this.Et.length;e++)t(this.Et[e])}},{key:"removeForm",value:function(){for(var t=this.Tt.getLayers(this.Pt),e=0;e<t.length;e++)this.O.remove(t[e].scene)}}])&&no(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ro=(Object.assign(io.prototype,{Z:function(){this.Ft(),this.Lt=!0},Ft:function(t){var e,n;!t&&this.Lt||(t=this.Tt.getLayers(fengmap.FMType.EXTERNAL_MODEL_LAYER)[0],e=this.Tt.getLayers(fengmap.FMType.MODEL_LAYER)[0],this.Lt||(this.Mt.push(e.scene),this.Mt.push(t.scene)),(n=this.B.getRenderManager()).bloom||n.bloom?(this.O.parent&&this.O.parent.remove(this.O),this.H.parent&&this.H.parent.remove(this.H),this.H.position.y=this.Tt.height,this.O.position.y=this.Tt.height):(this.H.position.y=0,this.O.position.y=0,(this.I===fengmap.FMType.EXTERNAL_MODEL_LAYER?(t.scene.add(this.O),t):(e.scene.add(this.O),e)).scene.add(this.H)))},Nt:function(t){var e=(this.Tt=t).parent.buildingID;this.B.getRenderManager().waterLayers.set(e+"_"+t.level,this),this.Z()},Dt:function(){for(var t=this.Tt.parent.buildingID,e=(this.B.getRenderManager().waterLayers.delete(t+"_"+this.Tt.level),this.Tt.getLayers(this.Pt)),n=0;n<e.length;n++)this.O.remove(e[n].scene);this.Tt=null},Ct:function(t){t.Tt=this,(t.Rt||t.Z())&&this.It(t),this.O.add(t.k)},It:function(t){this.Et.push(t)},Ot:function(t){this.Ut(t),t.k.parent&&t.k.parent.remove(t.k),t.jt(),-1<(t=this.Et.indexOf(t))&&this.Et.splice(t,1),0===this.Et.length&&this.Dt()},Ut:function(t){t.Tt=void 0,this.O.remove(t.k)}}),io);function oo(t,e,n,i,r,o,s,a,A){De.call(this,t,e,n,i,r,o,s,a,A),this.needsUpdate=!0}function so(t){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ao(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===so(t=function(t,e){if("object"!==so(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==so(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}((oo.prototype=Object.create(De.prototype)).constructor=oo).prototype.isCanvasTexture=!0;io=function(t,e,n){return e&&ao(t.prototype,e),n&&ao(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.kt=e.kt,this.Ht=this.kt.speed,void 0===this.Ht&&(this.Ht=1),this.Tt=e,this.k=null,this.zt=null,this.Bt=null,this.Xt=0,this.Gt=null,this.Vt=null,this.Yt=5,this.Qt=this.Qt.bind(this),this.Wt=1});var Ao=(Object.assign(io.prototype,{Z:function(t){var e=this,n=this.Tt.B.getBuilding(this.Tt.B.getMapOptions().buildingID),i=new Rr;i.moveTo(this.Tt.qt[0].x-n.x,this.Tt.qt[0].y-n.y);for(var r=1;r<this.Tt.qt.length;r++)i.lineTo(this.Tt.qt[r].x-n.x,this.Tt.qt[r].y-n.y);for(var o=this.Tt.B.getBuilding(this.Tt.B.getMapOptions().buildingID),s=new $r(i),a=o.bound.min.x,A=o.bound.min.y,l=o.bound.max.x-a,u=o.bound.max.y-A,h=s.faces,c=h.length,f=0;f<c;f++){var p=s.vertices[h[f].a],d=s.vertices[h[f].b],y=s.vertices[h[f].c];s.faceVertexUvs[0][f][0].x=(p.x+n.x-a)/l,s.faceVertexUvs[0][f][0].y=(p.y+n.y-A)/u,s.faceVertexUvs[0][f][1].x=(d.x+n.x-a)/l,s.faceVertexUvs[0][f][1].y=(d.y+n.y-A)/u,s.faceVertexUvs[0][f][2].x=(y.x+n.x-a)/l,s.faceVertexUvs[0][f][2].y=(y.y+n.y-A)/u}this.Zt(function(n){(n=new Ce({transparent:!0,map:n})).map.needsUpdate=!0,n.polygonOffset=!0,n.polygonOffsetFactor=1,n.polygonOffsetUnits=4,e.k=new Xn(s,n),e.k.isNoPick=!0,e.k.rotation.x=-Math.PI/2,e.k.position.y=e.Tt.et,e.Tt.B.on("update",e.Qt),t&&t(e.k)})},Zt:function(t){var e=this,n=this.Tt.B.getBuilding(this.Tt.B.getMapOptions().buildingID).bound,i=(this.Vt=n,new Image);i.crossOrigin="Anonymous",i.onload=function(){e.Gt=i,e.Bt=document.createElement("canvas"),e.Bt.width=i.width,e.Bt.height=i.height,e.Bt.getContext("2d").drawImage(i,0,e.Xt,i.width,i.height);for(var r=document.createElement("canvas"),o=(r.width=n.size.x*e.Yt,r.height=n.size.y*e.Yt,r.getContext("2d")),s=e.kt.pointsInfo,a=0;a<s.length;a++){var A=(s[a].x-n.min.x)*e.Yt,l=(n.max.y-s[a].y)*e.Yt,u=document.createElement("canvas"),h=2*e.Yt*Math.sqrt(s[a].width/2*(s[a].width/2)+s[a].height/2*(s[a].height/2)),c=(u.width=h,u.height=h,u.getContext("2d"));c.save(),c.translate(u.width/2,u.height/2),c.rotate(-s[a].angle*Math.PI/180),c.drawImage(e.Bt,-s[a].width/2*e.Yt,-s[a].height/2*e.Yt,e.Yt*s[a].width,e.Yt*s[a].height),c.translate(0,0),o.drawImage(u,A-e.Yt*s[a].width/2,l-e.Yt*s[a].height/2,h,h)}e.zt=r;var f=document.createElement("canvas");f.width=4096,f.height=4096,f.getContext("2d").drawImage(r,0,0,f.width,f.height),r=new oo(f),t&&t(r)},i.src=this.kt.sprayUrl},Qt:function(){this.Xt>.3*this.Bt.height?this.Wt=-1:this.Xt<0&&(this.Wt=1),this.Xt=this.Xt+this.Ht*this.Wt;for(var t=this.Bt.getContext("2d"),e=(t.clearRect(0,0,this.Bt.width,this.Bt.height),t.drawImage(this.Gt,0,this.Xt,this.Gt.width,this.Gt.height),this.zt.getContext("2d")),n=(e.clearRect(0,0,this.zt.width,this.zt.height),this.kt.pointsInfo),i=0;i<n.length;i++){var r=this.Yt*(n[i].x-this.Vt.min.x),o=this.Yt*(this.Vt.max.y-n[i].y),s=document.createElement("canvas"),a=2*this.Yt*Math.sqrt(n[i].width/2*(n[i].width/2)+n[i].height/2*(n[i].height/2)),A=(s.width=a,s.height=a,s.getContext("2d"));A.save(),A.translate(s.width/2,s.height/2),A.rotate(-n[i].angle*Math.PI/180),A.drawImage(this.Bt,this.Yt*(-n[i].width/2),this.Yt*(-n[i].height/2),this.Yt*n[i].width,this.Yt*n[i].height),A.translate(0,0),e.drawImage(s,r-this.Yt*n[i].width/2,o-this.Yt*n[i].height/2,a,a)}(t=document.createElement("canvas")).width=4096,t.height=4096,t.getContext("2d").drawImage(this.zt,0,0,t.width,t.height),t=new oo(t),this.k.material.map.dispose(),this.k.material.map=t,this.k.material.map.needsUpdate=!0},jt:function(){this.k.parent.remove(this.k),this.k.geometry.dispose(),this.k.material.dispose(),this.k=void 0,this.Tt.B.off("update",this.Qt)}}),io);function lo(t){return(lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===lo(t=function(t,e){if("object"!==lo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==lo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}io=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.Kt=n.color,this.Jt=n.alpha,this.et="number"==typeof n.height?n.height:0,this.qt=n.points,this.G=n.url,this.kt=n.sprayInfos,this.I=n.intoLayerType,this.Tt=null,this.k=null,this.$t=null,this.Rt=!1,this.q=this.q.bind(this)}var e,n;return e=t,(n=[{key:"color",get:function(){return this.Kt},set:function(t){this.Kt=t,this.k&&(this.k.material.uniforms.waterColor.value=new L(t))}},{key:"alpha",get:function(){return this.Jt},set:function(t){isNaN(""+t)&&(t=1),this.Jt=t,this.k&&(this.k.material.uniforms.alpha.value=t)}},{key:"height",get:function(){return this.et},set:function(t){this.et=t,this.k&&(this.k.position.y=t)}},{key:"addTo",value:function(t){var e,n=((e=this.B.getRenderManager()).waterLayers||"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln),t.parent.buildingID);(e=e.waterLayers.get(n+"_"+t.level))||(e=new ro(this.B),void 0!==this.I&&(e.I=this.I),e.Nt(t)),e.Ct(this),this.tn(e.H),this.B.on("beforeRender",this.q)}},{key:"remove",value:function(){this.$t&&this.$t.jt(),this.Tt.Ot(this)}}])&&uo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var ho=(Object.assign(io.prototype,{Z:function(){var t=this.B.getBuilding(this.B.getMapOptions().buildingID),e=new Rr;e.moveTo(this.qt[0].x-t.x,this.qt[0].y-t.y);for(var n=1;n<this.qt.length;n++)e.lineTo(this.qt[n].x-t.x,this.qt[n].y-t.y);var i=new to(e);return this.k=new fr(i,{textureWidth:512,textureHeight:512,waterNormals:(new Qe).load(this.G,function(t){t.wrapS=t.wrapT=y}),alpha:this.Jt,waterColor:this.Kt,distortionScale:5.7,parentNode:this}),this.k.isNoPick=!0,this.k.rotation.x=-Math.PI/2,this.k.position.y=this.et,this.k.renderOrder=-1,this.Rt=!0,this.Rt},tn:function(t){void 0!==this.kt&&void 0!==this.kt.sprayUrl&&void 0!==this.kt.pointsInfo&&0!==this.kt.pointsInfo.length&&(this.$t=new Ao(this),this.$t.Z(function(e){t.add(e)}))},q:function(){this.B.enableUpdateRender()},jt:function(){this.k.geometry.dispose(),this.k.geometry=null,this.k.material.dispose(),this.k.material=null,this.k=null,this.Rt=!1}}),{shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new L(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")});function co(t){return(co="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fo(t,e){return(fo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function po(t){return(po=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var yo=function(){var t=i,e=ii;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fo(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=po(t);if(n=e?(n=po(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===co(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r,o){var s;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(s=n.call(this)).strength=void 0!==e?e:1,s.radius=r,s.threshold=o,s.resolution=void 0!==t?new at(t.x,t.y):new at(256,256),s.clearColor=new L(0,0,0);var a={minFilter:v,magFilter:v,format:w},A=(s.renderTargetsHorizontal=[],s.renderTargetsVertical=[],s.nMips=5,Math.round(s.resolution.x/2)),l=Math.round(s.resolution.y/2);s.renderTargetBright=new oi(A,l,a),s.renderTargetBright.texture.name="UnrealBloomPass.bright",s.renderTargetBright.texture.generateMipmaps=!1;for(var u=0;u<s.nMips;u++){var h;(h=((h=new oi(A,l,a)).texture.name="UnrealBloomPass.h"+u,h.texture.generateMipmaps=!1,s.renderTargetsHorizontal.push(h),new oi(A,l,a))).texture.name="UnrealBloomPass.v"+u,h.texture.generateMipmaps=!1,s.renderTargetsVertical.push(h),A=Math.round(A/2),l=Math.round(l/2)}r=ho;var c=(s.highPassUniforms=ye.clone(r.uniforms),s.highPassUniforms.luminosityThreshold.value=o,s.highPassUniforms.smoothWidth.value=.01,s.materialHighPassFilter=new ve({uniforms:s.highPassUniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,defines:{}}),s.separableBlurMaterials=[],[3,5,7,9,11]);for(A=Math.round(s.resolution.x/2),l=Math.round(s.resolution.y/2),u=0;u<s.nMips;u++)s.separableBlurMaterials.push(s.getSeperableBlurMaterial(c[u])),s.separableBlurMaterials[u].uniforms.texSize.value=new at(A,l),A=Math.round(A/2),l=Math.round(l/2);return s.compositeMaterial=s.getCompositeMaterial(s.nMips),s.compositeMaterial.uniforms.blurTexture1.value=s.renderTargetsVertical[0].texture,s.compositeMaterial.uniforms.blurTexture2.value=s.renderTargetsVertical[1].texture,s.compositeMaterial.uniforms.blurTexture3.value=s.renderTargetsVertical[2].texture,s.compositeMaterial.uniforms.blurTexture4.value=s.renderTargetsVertical[3].texture,s.compositeMaterial.uniforms.blurTexture5.value=s.renderTargetsVertical[4].texture,s.compositeMaterial.uniforms.bloomStrength.value=e,s.compositeMaterial.uniforms.bloomRadius.value=.1,s.compositeMaterial.needsUpdate=!0,s.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],s.bloomTintColors=[new V(1,1,1),new V(1,1,1),new V(1,1,1),new V(1,1,1),new V(1,1,1)],s.compositeMaterial.uniforms.bloomTintColors.value=s.bloomTintColors,t=ri,s.copyUniforms=ye.clone(t.uniforms),s.copyUniforms.opacity.value=1,s.materialCopy=new ve({uniforms:s.copyUniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),s.enabled=!0,s.needsSwap=!1,s.oldClearColor=new L,s.oldClearAlpha=1,s.basic=new Ce,s.fsQuad=new ii.FullScreenQuad(null),s}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function mo(t){return(mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function go(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],A=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;A=!1}else for(;!(A=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);A=!0);}catch(t){l=!0,r=t}finally{try{if(!A&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(t,e)||bo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vo(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=bo(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function bo(t,e){var n;if(t)return"string"==typeof t?xo(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xo(t,e):void 0}function xo(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function wo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===mo(t=function(t,e){if("object"!==mo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==mo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Bo(t,e,n,i){this.renderScene=e,this.renderCamera=n,this.selectedObjects=void 0!==i?i:[],this.visibleEdgeColor=new L(1,1,1),this.hiddenEdgeColor=new L(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,ii.call(this),this.resolution=void 0!==t?new at(t.x,t.y):new at(256,256),e={minFilter:v,magFilter:v,format:w},n=Math.round(this.resolution.x/this.downSampleRatio),i=Math.round(this.resolution.y/this.downSampleRatio),this.maskBufferMaterial=new Ce({color:16777215}),this.maskBufferMaterial.side=a,this.renderTargetMaskBuffer=new oi(this.resolution.x,this.resolution.y,e),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new Ee,this.depthMaterial.side=a,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=A,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=a,this.prepareMaskMaterial.fragmentShader=function(t,e){return e=e.isPerspectiveCamera?"perspective":"orthographic",t.replace(/DEPTH_TO_VIEW_Z/g,e+"DepthToViewZ")}(this.prepareMaskMaterial.fragmentShader,this.renderCamera),this.renderTargetDepthBuffer=new oi(this.resolution.x,this.resolution.y,e),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new oi(n,i,e),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new oi(n,i,e),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new oi(Math.round(n/2),Math.round(i/2),e),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new oi(n,i,e),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new oi(Math.round(n/2),Math.round(i/2),e),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(n,i),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(n/2),Math.round(i/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),t=ri,this.copyUniforms=ye.clone(t.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ve({uniforms:this.copyUniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,blending:A,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new L,this.oldClearAlpha=1,this.fsQuad=new ii.FullScreenQuad(null),this.tempPulseColor1=new L,this.tempPulseColor2=new L,this.textureMatrix=new Ct}function Mo(t,e,n,i){Ii.call(this),this.scene=t,this.camera=e,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==n?n:0,this.clearAlpha=void 0!==i?i:0,t=ri,this.copyUniforms=ye.clone(t.uniforms),this.copyMaterial=new ve({uniforms:this.copyUniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:2,depthTest:!1,depthWrite:!1}),this.fsQuad=new Ii.FullScreenQuad(this.copyMaterial)}function So(t,e,n,i){Mo.call(this,t,e,n,i),this.sampleLevel=0,this.accumulate=!1}Object.assign(yo.prototype,{dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,e){var n=Math.round(t/2),i=Math.round(e/2);this.renderTargetBright.setSize(n,i);for(var r=0;r<this.nMips;r++)this.renderTargetsHorizontal[r].setSize(n,i),this.renderTargetsVertical[r].setSize(n,i),this.separableBlurMaterials[r].uniforms.texSize.value=new at(n,i),n=Math.round(n/2),i=Math.round(i/2)},render:function(t,e,n,i,r){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha();for(var o=t.autoClear,s=(t.autoClear=!1,t.setClearColor(this.clearColor,1),r&&t.state.buffers.stencil.setTest(!1),this.highPassUniforms.tDiffuse.value=n.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t),this.renderTargetBright),a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.enableAlpha.value=1!==this.oldClearAlpha,this.separableBlurMaterials[a].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[a].uniforms.direction.value=yo.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[a]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[a].uniforms.enableAlpha.value=1!==this.oldClearAlpha,this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=yo.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[a]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,r&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?t.setRenderTarget(null):t.setRenderTarget(n),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o},getSeperableBlurMaterial:function(t){return new ve({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{enableAlpha:{value:!1},colorTexture:{value:null},texSize:{value:new at(.5,.5)},direction:{value:new at(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"\n                varying vec2 vUv;\n                uniform sampler2D colorTexture;\n                uniform vec2 texSize;\n                uniform vec2 direction;\n                uniform bool enableAlpha;\n         \n                float gaussianPdf( in float x, in float sigma) {\n                    return 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n                }\n                \n                void main() {\n                    vec2 invSize = 1.0 / texSize; \n                    float fSigma = float(SIGMA);\n                    float weightSum = gaussianPdf(0.0, fSigma);\n                    float alphaSum = 0.0;\n                    vec3 diffuseSum = texture2D(colorTexture, vUv).rgb * weightSum;\n                    \n                    for (int i = 1; i < KERNEL_RADIUS; i++) {\n                    \n                        float x = float(i);\n                        float w = gaussianPdf(x, fSigma);\n                        \n                        vec2 uvOffset = direction * invSize * x;\n                        vec4 sample1 = texture2D(colorTexture, vUv + uvOffset);\n                        vec4 sample2 = texture2D(colorTexture, vUv - uvOffset);\n                        \n                        diffuseSum += (sample1.rgb + sample2.rgb) * w;\n                        alphaSum += (sample1.a + sample2.a) * w;\n                        weightSum += 2.0 * w;\n                    }\n                    \n                    if(enableAlpha){\n                        gl_FragColor = vec4(diffuseSum / weightSum, alphaSum / weightSum);\n                    } else{\n                        gl_FragColor = vec4(diffuseSum / weightSum, 1.0);\n                    }\n                    \n                }"})},getCompositeMaterial:function(t){return new ve({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;            uniform sampler2D blurTexture1;            uniform sampler2D blurTexture2;            uniform sampler2D blurTexture3;            uniform sampler2D blurTexture4;            uniform sampler2D blurTexture5;            uniform sampler2D dirtTexture;            uniform float bloomStrength;            uniform float bloomRadius;            uniform float bloomFactors[NUM_MIPS];            uniform vec3 bloomTintColors[NUM_MIPS];                        float lerpBloomFactor(const in float factor) {                float mirrorFactor = 1.2 - factor;                return mix(factor, mirrorFactor, bloomRadius);            }                        void main() {                gl_FragColor = bloomStrength * (                    lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +                    lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +                    lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +                    lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +                    lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );            }"})}}),yo.BlurDirectionX=new at(1,0),yo.BlurDirectionY=new at(0,1);var _o=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.nn="number"==typeof(n=n||{}).strength?n.strength:.62,this.en="number"==typeof n.radius?n.radius:.6,this.rn="number"==typeof n.threshold?n.threshold:.4,this.ot=null,this.D=new on,this.N=new Map,this.on=null,this.singleSceneList=new Map,this.Wt=1,this.an=!1,this.sn=1,this.hn=1,this.ln=1,this.un=1,this.cn=[],this.fn=[],this.Z()}var e,n;return e=t,(n=[{key:"getThreshold",value:function(){return this.on.threshold}},{key:"setThreshold",value:function(t){this.on.threshold=t,this.rn=t,this.B.enableUpdateRender()}},{key:"getStrength",value:function(){return this.on.strength}},{key:"setStrength",value:function(t){this.on.strength=t,this.nn=t,this.B.enableUpdateRender()}},{key:"getRadius",value:function(){return this.on.radius}},{key:"setRadius",value:function(t){this.on.radius=t,this.en=t,this.B.enableUpdateRender()}},{key:"enable",value:function(){this.ot.bloom=this;for(var t=0;t<this.fn.length;t++)this.dn(this.fn[t]);for(var e=0;e<this.cn.length;e++)this.dn(this.cn[e]);this.vn(),this.B.on("update",this.mn),this.B.enableUpdateRender()}},{key:"disable",value:function(){this.ot.bloom=null;var t,e=vo(this.singleSceneList);try{for(e.s();!(t=e.n()).done;){var n,i=go(t.value,2),r=(i[0],i[1]),o=vo(r);try{for(o.s();!(n=o.n()).done;)for(var s=go(n.value,2),a=(s[0],s[1]);0<a.children.length;){var A=a.children[0];A.parent.remove(A),A.mapNode&&A.mapNode.parent.scene.add(A)}}catch(t){o.e(t)}finally{o.f()}r.clear()}}catch(t){e.e(t)}finally{e.f()}this.vn(),this.B.off("update",this.mn),this.singleSceneList.clear(),this.B.enableUpdateRender()}},{key:"add",value:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.dn(t[e]);else this.dn(t);this.B.enableUpdateRender()}},{key:"remove",value:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.pn(t[e]);else this.pn(t);this.B.enableUpdateRender()}},{key:"clear",value:function(){this.N.forEach(function(t,e,n){t.clear()}),this.N.clear();var t,e=vo(this.singleSceneList);try{for(e.s();!(t=e.n()).done;){var n,i=go(t.value,2),r=(i[0],i[1]),o=vo(r);try{for(o.s();!(n=o.n()).done;)for(var s=go(n.value,2),a=(s[0],s[1]);0<a.children.length;){var A=a.children[0];A.parent.remove(A),A.mapNode&&A.mapNode.parent.scene.add(A)}}catch(t){o.e(t)}finally{o.f()}r.clear()}}catch(t){e.e(t)}finally{e.f()}this.singleSceneList.clear(),this.cn.length=0,this.fn.length=0,this.B.enableUpdateRender()}},{key:"updateCamera",value:function(){for(var t=0;t<this.C.passes.length;t++)this.C.passes[t].constructor===fi&&this.C.passes[t].setPass(this.D,this.B.camera)}},{key:"breath",value:function(t){this.an||(this.an=!0,this.sn=t.size,this.hn=t.duration,this.on.threshold=0,this.ln=(this.sn-1)/(30*this.hn),this.B.on("update",this.gn))}},{key:"stopBreath",value:function(){this.an&&(this.an=!1,this.on.threshold=this.rn,this.on.radius=this.en,this.on.strength=this.nn,this.un=1,this.B.enableUpdateRender(),this.B.off("update",this.gn))}}])&&wo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Eo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],A=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;A=!1}else for(;!(A=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);A=!0);}catch(t){l=!0,r=t}finally{try{if(!A&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(t,e)||To(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function To(t,e){var n;if(t)return"string"==typeof t?Co(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Co(t,e):void 0}function Co(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Fo(t){return(Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Fo(t=function(t,e){if("object"!==Fo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Fo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(_o.prototype,{Z:function(){"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln),this.ot=this.B.getRenderManager(),this._n(),this.C=new Ri(this.ot.renderer);var t=new fi(this.D,this.B.camera,null,0,1);this.C.addPass(t),this.on=new yo(new at(this.B.getContainer().clientWidth,this.B.getContainer().clientHeight),this.nn,this.en,this.rn),this.C.addPass(this.on),this.ft=this.ft.bind(this),this.gn=this.gn.bind(this),this.mn=this.mn.bind(this),this.B.on("resize",this.ft)},ft:function(){var t,e;this.C&&(t=(e=this.B.getContainer()).clientWidth,e=e.clientHeight,this.C.setSize(t,e))},_n:function(){var t,e=vo(this.ot.waterLayers.values());try{for(e.s();!(t=e.n()).done;)t.value.removeForm()}catch(t){e.e(t)}finally{e.f()}},pn:function(t){var e,n,i;t.isLayer?(e=(i=t).parent.level,n=i.parent.parent.buildingID,(n=this.N.get(n+"_"+e))&&n.delete(i.type)):(t.isMarker?-1!==(e=this.yn(t))&&this.fn.splice(e,1):-1!==(n=this.xn(t))&&this.cn.splice(n,1),(i=t.getRenderNode())&&(t.isMarker&&(i.bloom=void 0),i.parent.remove(i),t.parent.scene.add(i)))},xn:function(t){for(var e=-1,n=0;n<this.cn.length;n++)if(this.cn[n].FID===t.FID){e=n;break}return e},yn:function(t){for(var e=-1,n=0;n<this.fn.length;n++)t.getRenderNode().uuid===this.fn[n].getRenderNode().uuid&&(e=n);return e},dn:function(t){if(t.isLayer){var e=t,n=e.parent.level,i=e.parent.parent.buildingID,r=this.N.get(i+"_"+n);r||(r=new Map,this.N.set(i+"_"+n,r)),r.set(e.type,e)}else if(t.isMarker?-1===this.yn(t)&&this.fn.push(t):-1===this.xn(t)&&this.cn.push(t),null!==this.ot.bloom){if(i=t.parent.parent,n=t.parent,r=i.level,e=i.parent.buildingID,(i=this.singleSceneList.get(e+"_"+r))||(i=new Map,this.singleSceneList.set(e+"_"+r,i)),!(e=i.get(n.type))){(e=new on).position.y=n.scene.position.y;for(var o,s=e,a=[],A=null,l=n.scene,u=0;u<l.children.length;u++)l.children[u].mapNode||((o=l.children[u].clone()).visible=!0,s.add(o),"DirectionalLight"===o.type&&a.push(o),"Object3D"===o.type&&(A=o));for(var h=0;h<a.length;h++)a[h].target=A;i.set(n.type,e)}(r=t.getRenderNode())&&(r.bloom=this,r.parent.remove(r),e.add(r))}},gn:function(){this.sn<1?(this.un<=this.sn&&(this.Wt=-1),1<=this.un&&(this.Wt=1)):(this.un>=this.sn&&(this.Wt=-1),this.un<1&&(this.Wt=1)),this.un=this.un+this.Wt*this.ln,this.on.radius=this.en*this.un,this.on.strength=this.nn*this.un,this.B.enableUpdateRender()},mn:function(){for(var t=0;t<this.cn.length;t++){var e,n,i=this.cn[t].getRenderNode(),r=this.cn[t];i&&(n=r.parent.parent,r=r.parent,e=n.level,n=n.parent.buildingID,(n=this.singleSceneList.get(n+"_"+e).get(r.type)).uuid!==i.parent.uuid)&&(i.parent.remove(i),n.add(i))}},vn:function(){if(0<this.ot.waterLayers.size){var t,e=vo(this.ot.waterLayers);try{for(e.s();!(t=e.n()).done;){var n=go(t.value,2);n[0],n[1].Ft(!0)}}catch(t){e.e(t)}finally{e.f()}}}}),Bo.prototype=Object.assign(Object.create(ii.prototype),{constructor:Bo,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(t,e){this.renderTargetMaskBuffer.setSize(t,e),t=Math.round(t/this.downSampleRatio),e=Math.round(e/this.downSampleRatio),this.renderTargetMaskDownSampleBuffer.setSize(t,e),this.renderTargetBlurBuffer1.setSize(t,e),this.renderTargetEdgeBuffer1.setSize(t,e),this.separableBlurMaterial1.uniforms.texSize.value.set(t,e),t=Math.round(t/2),e=Math.round(e/2),this.renderTargetBlurBuffer2.setSize(t,e),this.renderTargetEdgeBuffer2.setSize(t,e),this.separableBlurMaterial2.uniforms.texSize.value.set(t,e)},changeVisibilityOfSelectedObjects:function(t){function e(e){e.isMesh&&(t?(e.visible=e.userData.oldVisible,delete e.userData.oldVisible):(e.userData.oldVisible=e.visible,e.visible=t))}for(var n=0;n<this.selectedObjects.length;n++)this.selectedObjects[n].traverse(e)},changeVisibilityOfNonSelectedObjects:function(t){var e=[];function n(t){t.isMesh&&e.push(t)}for(var i=0;i<this.selectedObjects.length;i++)this.selectedObjects[i].traverse(n);this.renderScene.traverse(function(n){if(n.isMesh||n.isLine||n.isSprite){for(var i,r=!1,o=0;o<e.length;o++)if(e[o].id===n.id){r=!0;break}r||(i=n.visible,t&&!n.bVisible||(n.visible=t),n.bVisible=i)}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(t,e,n,i,r){var o,s;0<this.selectedObjects.length&&(this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),o=t.autoClear,t.autoClear=!1,r&&t.state.buffers.stencil.setTest(!1),t.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1),s=this.renderScene.background,this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,t.setRenderTarget(this.renderTargetDepthBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,t.setRenderTarget(this.renderTargetMaskBuffer),t.clear(),t.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=s,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,t.setRenderTarget(this.renderTargetMaskDownSampleBuffer),t.clear(),this.fsQuad.render(t),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),0<this.pulsePeriod&&(s=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2,this.tempPulseColor1.multiplyScalar(s),this.tempPulseColor2.multiplyScalar(s)),this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Bo.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,t.setRenderTarget(this.renderTargetBlurBuffer1),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=Bo.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer1),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=Bo.BlurDirectionX,t.setRenderTarget(this.renderTargetBlurBuffer2),t.clear(),this.fsQuad.render(t),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=Bo.BlurDirectionY,t.setRenderTarget(this.renderTargetEdgeBuffer2),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,r&&t.state.buffers.stencil.setTest(!0),t.setRenderTarget(n),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=o),this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=n.texture,t.setRenderTarget(null),this.fsQuad.render(t))},getPrepareMaskMaterial:function(){return new ve({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new at(.5,.5)},textureMatrix:{value:null}},vertexShader:["#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\t#include <skinbase_vertex>","\t#include <begin_vertex>","\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\tvPosition = mvPosition;","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new ve({uniforms:{maskTexture:{value:null},texSize:{value:new at(.5,.5)},visibleEdgeColor:{value:new V(1,1,1)},hiddenEdgeColor:{value:new V(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(t){return new ve({defines:{MAX_RADIUS:t},uniforms:{colorTexture:{value:null},texSize:{value:new at(.5,.5)},direction:{value:new at(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new ve({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:2,depthTest:!1,depthWrite:!1,transparent:!0})}}),Bo.BlurDirectionX=new at(1,0),Bo.BlurDirectionY=new at(0,1),Mo.prototype=Object.assign(Object.create(Ii.prototype),{constructor:Mo,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(t,e){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(t,e)},render:function(t,e,n){this.sampleRenderTarget||(this.sampleRenderTarget=new oi(n.width,n.height,{minFilter:v,magFilter:v,format:w}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");for(var i=Mo.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],r=t.autoClear,o=(t.autoClear=!1,t.getClearColor().getHex()),s=t.getClearAlpha(),a=1/i.length,A=(this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,n.width),l=n.height,u=0;u<i.length;u++){var h=i[u];h=(this.camera.setViewOffset&&this.camera.setViewOffset(A,l,.0625*h[0],.0625*h[1],A,l),a);this.unbiased&&(h+=1/32*((u+.5)/i.length-.5)),this.copyUniforms.opacity.value=h,t.setClearColor(this.clearColor,this.clearAlpha),t.setRenderTarget(this.sampleRenderTarget),t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(this.renderToScreen?null:e),0===u&&(t.setClearColor(this.clearColor,0),t.clear()),this.fsQuad.render(t)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),t.autoClear=r,t.setClearColor(o,s)}}),So.JitterVectors=Mo.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]],So.prototype=Object.assign(Object.create(Mo.prototype),{constructor:So,render:function(t,e,n,i){if(this.accumulate){var r=So.JitterVectors[5],o=(this.sampleRenderTarget||(this.sampleRenderTarget=new oi(n.width,n.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new oi(n.width,n.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(Mo.prototype.render.call(this,t,this.holdRenderTarget,n,i),this.accumulateIndex=0),t.autoClear),s=(t.autoClear=!1,1/r.length);if(0<=this.accumulateIndex&&this.accumulateIndex<r.length){this.copyUniforms.opacity.value=s,this.copyUniforms.tDiffuse.value=e.texture;for(var a=Math.pow(2,this.sampleLevel),A=0;A<a;A++){var l=r[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(n.width,n.height,.0625*l[0],.0625*l[1],n.width,n.height),t.setRenderTarget(e),t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&t.clear(),this.fsQuad.render(t),this.accumulateIndex++,this.accumulateIndex>=r.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}0<(s=this.accumulateIndex*s)&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,t.setRenderTarget(e),t.clear(),this.fsQuad.render(t)),s<1&&(this.copyUniforms.opacity.value=1-s,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,t.setRenderTarget(e),0==s&&t.clear(),this.fsQuad.render(t)),t.autoClear=o}else Mo.prototype.render.call(this,t,e,n,i),this.accumulateIndex=-1}});var Po=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.bn=3,void 0!==n.edgeStrength&&(this.bn=n.edgeStrength),void(this.wn=0)!==n.edgeGlow&&(this.wn=n.edgeGlow),this.An=1,void 0!==n.edgeThickness&&(this.An=n.edgeThickness),void(this.Sn=0)!==n.pulsePeriod&&(this.Sn=n.pulsePeriod),this.Tn="#FFFFFF",void 0!==n.visibleEdgeColor&&(this.Tn=n.visibleEdgeColor),this.Mn="#FFFFFF",void 0!==n.hiddenEdgeColor?this.Mn=n.hiddenEdgeColor:this.Mn=this.Tn,this.ot=null,this.ct=new on,this.En=new on,this.Pn=new on,this.ct.add(this.Pn),this.N=new Map,this.Ln=null,this.Fn=null,this.Nn=[],this.Dn=null,this.C=null,this.Z()}var e,n;return e=t,(n=[{key:"updateCamera",value:function(){for(var t=0;t<this.C.passes.length;t++)this.C.passes[t].constructor===fi&&this.C.passes[t].setPass(this.En,this.B.camera)}},{key:"enable",value:function(){(this.ot.outLine=this).vn(),this.B.on("update",this.Qt),this.B.on("resize",this.ft),this.B.on("viewModeChanged",this.Cn)}},{key:"disable",value:function(){this.ot.outLine=null,this.vn();for(var t=0;t<this.Pn.children.length;t++)for(var e=this.Pn.children[t],n=0;n<e.children.length;n++)"DirectionalLight"!==e.children[n].type&&"AmbientLight"!==e.children[n].type||(e.children[n].visible=!0);this.B.off("update",this.Qt),this.B.off("resize",this.ft),this.B.off("viewModeChanged",this.Cn)}},{key:"add",value:function(t){if(this.remove(),Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e].type;n!==fengmap.FMType.MODEL&&n!==fengmap.FMType.EXTERNAL_MODEL&&n!==fengmap.FMType.DYNAMIC_MODEL_MARKER||this.Nn.push(t[e])}else{var i=t.type;i!==fengmap.FMType.MODEL&&i!==fengmap.FMType.EXTERNAL_MODEL&&i!==fengmap.FMType.DYNAMIC_MODEL_MARKER||this.Nn.push(t)}}},{key:"remove",value:function(t){var e=this;if(t){if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n].type!==fengmap.FMType.MODEL&&t[n].type!==fengmap.FMType.EXTERNAL_MODEL&&t[n].type!==fengmap.FMType.DYNAMIC_MODEL_MARKER||r(t[n]);else{var i=t.type;i!==fengmap.FMType.MODEL&&i!==fengmap.FMType.EXTERNAL_MODEL&&i!==fengmap.FMType.DYNAMIC_MODEL_MARKER||r(t)}0===this.Nn.length&&(this.Ln.selectedObjects=[])}else this.Nn.length=0,this.Ln.selectedObjects=[];function r(t){for(var n=0;n<e.Nn.length;n++)if(e.Nn[n].FID===t.FID){e.Nn.splice(n,1);break}}this.B.enableUpdateRender()}}])&&Oo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Uo(t){return(Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ro(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Uo(t=function(t,e){if("object"!==Uo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Uo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(Po.prototype,{Z:function(){"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln),this.ot=this.B.getRenderManager(),this.C=new Ri(this.ot.renderer);var t=new fi(this.En,this.B.camera),e=(t=(this.C.addPass(t),this.ot.renderer.getClearColor()),this.ot.renderer.getClearAlpha());this.Fn=new So(this.En,this.B.camera,t,e),this.Fn.unbiased=!1,this.C.addPass(this.Fn),this.Ln=new Bo(new at(this.B.getContainer().clientWidth,this.B.getContainer().clientHeight),this.En,this.B.camera),this.Ln.edgeStrength=this.bn,this.Ln.edgeGlow=this.wn,this.Ln.edgeThickness=this.An,this.Ln.pulsePeriod=this.Sn,this.Ln.visibleEdgeColor=new L(this.Tn),this.Ln.hiddenEdgeColor=new L(this.Mn),this.C.addPass(this.Ln),this.ft=this.ft.bind(this),this.Qt=this.Qt.bind(this),this.Cn=this.Cn.bind(this)},ft:function(){var t,e;this.C&&(t=(e=this.B.getContainer()).clientWidth,e=e.clientHeight,this.C.setSize(t,e))},Qt:function(){for(var t=[],e=0;e<this.Nn.length;e++)this.Nn[e].getRenderNode()&&t.push(this.Nn[e].getRenderNode());this.Ln.selectedObjects=t,0<this.Ln.selectedObjects.length&&this.B.enableUpdateRender()},Rn:function(){for(;0<this.Pn.children.length;)this.Pn.remove(this.Pn.children[0])},Cn:function(){this.Ln.renderCamera=this.B.camera,this._ssaa.camera=this.B.camera},R:function(t){var e=this,n=[],i=null;if(!this.Dn){for(var r,o=0;o<t.children.length;o++)t.children[o].mapNode||(r=t.children[o].clone(),this.ct.add(r),"DirectionalLight"===r.type&&n.push(r),"Object3D"===r.type&&(i=r));for(var s=0;s<n.length;s++)n[s].target=i;this.Dn=!0}for(var a=0;a<t.children.length;a++)"DirectionalLight"!==t.children[a].type&&"AmbientLight"!==t.children[a].type||(t.children[a].visible=!1);!function(){for(var n=!0,i=0;i<e.Pn.children.length;i++)if(e.Pn.children[i].uuid===t.uuid){n=!1;break}return n}()||this.Pn.add(t)},F:function(t){this.B.getZoom()<20?this.Fn.sampleLevel=2:20<this.B.getZoom()&&this.B.getZoom()<22?this.Fn.sampleLevel=3:this.Fn.sampleLevel=4,t.render(this.ct,this.B.camera),this.updateCamera(),this.En.add(this.ct),this.C.render(),this.En.remove(this.ct),this.Rn()},vn:function(){if(0<this.ot.waterLayers.size){var t,e=function(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=To(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.ot.waterLayers);try{for(e.s();!(t=e.n()).done;){var n=Eo(t.value,2);n[0],n[1].Ft(!0)}}catch(t){e.e(t)}finally{e.f()}}}});var Io=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.In=[],this.On={x:0,y:0,maxR:0,radius:0,minR:0,widthR:0,length:0,distance:0,width:0,height:0,color_a:0,color_r:0,point:null,endPoint:null,startPoint:null,se2N:null,speed:1,se2RN:null},this.Un=!1,this.jn=!1,this.ot=this.st(),this.kn=(new Date).getTime(),this.q=this.q.bind(this),this.Hn=!1,this.Z()}var e,n;return e=t,(n=[{key:"enable",value:function(){this.Hn=!0,(this.ot.sweep=this).B.on("beforeRender",this.q)}},{key:"disable",value:function(){this.Hn=!1;for(var t=Array.from(this.ot.getRenderList()),e=0;e<t.length;e++){var n=t[e][1];this.render(n,!0)}this.ot.sweep=null,this.B.off("beforeRender",this.q)}},{key:"annulus",value:function(t){var e=this;this.On.x=t.x,this.On.y=t.y,this.On.maxR=t.maxRadius,this.On.minR=t.minRadius,this.On.radius=t.minRadius+t.width,this.On.widthR=t.width,this.On.duration_a=1e3*t.duration,this.On.color_a=new L(t.color),this.On.sweepStrength=t.strength,void 0===this.On.sweepStrength&&(this.On.sweepStrength=1),this.On.isSweepTexture=!1,void 0!==t.url&&(new Qe).load(t.url,function(t){e.On.sweepTexture=t,e.On.isSweepTexture=!0}),this.Un=!0}},{key:"rect",value:function(t){var e=this,n=(this.On.endPoint=new at(t.endPoint.x-this.B.x,-t.endPoint.y+this.B.y),this.On.startPoint=new at(t.startPoint.x-this.B.x,-t.startPoint.y+this.B.y),this.On.point=this.On.startPoint.clone(),new at(t.endPoint.x-t.startPoint.x,-t.endPoint.y+t.startPoint.y));this.On.se2N=n.normalize(),this.On.se2RN=n.clone().rotateAround(new at(0,0),Math.PI/2).normalize(),this.On.duration_r=1e3*t.duration,this.On.width=t.width,this.On.height=t.height,this.On.distance=this.On.endPoint.distanceTo(this.On.startPoint),this.On.color_r=new L(t.color),this.jn=!0,this.On.sweepStrength=t.strength,void 0===this.On.sweepStrength&&(this.On.sweepStrength=1),this.On.isSweepTexture=!1,void 0!==t.url&&(new Qe).load(t.url,function(t){e.On.sweepTexture=t,e.On.isSweepTexture=!0})}},{key:"render",value:function(t,e){var n,i=this;this.Un&&(this.On.radius<this.On.maxR?this.On.radius+=((new Date).getTime()-this.kn)*this.On.maxR/this.On.duration_a:this.On.radius=this.On.minR),this.jn&&(n=((new Date).getTime()-this.kn)*this.On.distance/this.On.duration_r,n=this.On.se2N.clone().multiplyScalar(n),this.On.length<=this.On.distance?(this.On.point.add(n),this.On.length+=n.length()):(this.On.point=this.On.startPoint.clone(),this.On.length=0)),t.traverse(function(t){"Mesh"===t.type&&"FMMeshStandardMaterial"===t.material.type&&(i.Un&&(t.material.uniforms.isAnnulus.value||(t.material.uniforms.isAnnulus.value=!0,t.material.uniforms.circleC.value=new at(i.On.x-i.B.x,-i.On.y+i.B.y),t.material.uniforms.color_a.value=i.On.color_a),t.material.uniforms.maxR.value=i.On.radius+i.On.widthR,t.material.uniforms.minR.value=i.On.radius,t.material.uniforms.isEnable.value=i.Hn,t.material.uniforms.isSweepTexture.value=i.On.isSweepTexture,t.material.uniforms.sweepTexture.value=i.On.sweepTexture,t.material.uniforms.sweepStrength.value=i.On.sweepStrength,t.material.uniformsNeedUpdate=!0,e)&&i.B.enableUpdateRender(),i.jn)&&(t.material.uniforms.isRect.value||(t.material.uniforms.isRect.value=!0,t.material.uniforms.sweepW.value=i.On.width,t.material.uniforms.sweepH.value=i.On.height,t.material.uniforms.se2N.value=i.On.se2N,t.material.uniforms.se2RN.value=i.On.se2RN,t.material.uniforms.color_r.value=i.On.color_r),t.material.uniforms.moveP.value=i.On.point,t.material.uniforms.isEnable.value=i.Hn,t.material.uniforms.isSweepTexture.value=i.On.isSweepTexture,t.material.uniforms.sweepTexture.value=i.On.sweepTexture,t.material.uniforms.sweepStrength.value=i.On.sweepStrength,t.material.uniformsNeedUpdate=!0,e)&&i.B.enableUpdateRender()}),this.kn=(new Date).getTime()}}])&&Ro(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Lo=(Object.assign(Io.prototype,{q:function(){this.B.enableUpdateRender()},st:function(){return"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln),this.B.getRenderManager()},Z:function(){for(var t=this,e=this.B.getBuilding(this.B.getMapOptions().buildingID).getFloors(),n=0;n<e.length;n++)for(var i=e[n].getLayers(),r=0;r<i.length;r++)i[r].type===fengmap.FMType.EXTERNAL_MODEL_LAYER&&i[r].scene.traverse(function(e){e.isGltf&&"Mesh"===e.type&&t.In.push(e)})}}),{uniforms:{tDiffuse:{value:null},resolution:{value:new at(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")}),Do={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new at(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Ct},cameraInverseProjectionMatrix:{value:new Ct},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")},Qo={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new at(512,512)},sampleUvOffsets:{value:[new at(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},ko={createSampleWeights:function(t,e){for(var n,i,r=[],o=0;o<=t;o++)r.push((n=o,i=e,Math.exp(-n*n/(i*i*2))/(Math.sqrt(2*Math.PI)*i)));return r},createSampleOffsets:function(t,e){for(var n=[],i=0;i<=t;i++)n.push(e.clone().multiplyScalar(i));return n},configure:function(t,e,n,i){t.defines.KERNEL_RADIUS=e,t.uniforms.sampleUvOffsets.value=ko.createSampleOffsets(e,i),t.uniforms.sampleWeights.value=ko.createSampleWeights(e,n),t.needsUpdate=!0}},No={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","\tgl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")};function jo(t,e,n,i,r,o,s,a,A,l){if(1026!==(l=void 0!==l?l:1026)&&1027!==l)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");De.call(this,null,i,r,o,s,a,l,n=void 0===(n=void 0===n&&1026===l?1012:n)&&1027===l?1020:n,A),this.image={width:t,height:e},this.magFilter=void 0!==s?s:g,this.minFilter=void 0!==a?a:g,this.flipY=!1,this.generateMipmaps=!1}function Ho(t,e,n,i,r){ii.call(this),this.scene=t,this.camera=e,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==n&&n,this.supportsNormalTexture=void 0!==i&&i,this.originalClearColor=new L,this.oldClearColor=new L,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==r?new at(r.x,r.y):new at(256,256),this.saoRenderTarget=new oi(this.resolution.x,this.resolution.y,{minFilter:v,magFilter:v,format:w}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new oi(this.resolution.x,this.resolution.y,{minFilter:g,magFilter:g,format:w}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension&&((n=new jo).type=1012,n.minFilter=g,n.maxFilter=g,this.beautyRenderTarget.depthTexture=n,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new Ee,this.depthMaterial.depthPacking=3201,this.depthMaterial.blending=A,this.normalMaterial=new Se,this.normalMaterial.blending=A,this.saoMaterial=new ve({defines:Object.assign({},Do.defines),fragmentShader:Do.fragmentShader,vertexShader:Do.vertexShader,uniforms:ye.clone(Do.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=A,this.vBlurMaterial=new ve({uniforms:ye.clone(Qo.uniforms),defines:Object.assign({},Qo.defines),vertexShader:Qo.vertexShader,fragmentShader:Qo.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=A,this.hBlurMaterial=new ve({uniforms:ye.clone(Qo.uniforms),defines:Object.assign({},Qo.defines),vertexShader:Qo.vertexShader,fragmentShader:Qo.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?n:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=A,this.materialCopy=new ve({uniforms:ye.clone(ri.uniforms),vertexShader:ri.vertexShader,fragmentShader:ri.fragmentShader,blending:A}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=5,this.materialCopy.blendSrc=208,this.materialCopy.blendDst=200,this.materialCopy.blendEquation=u,this.materialCopy.blendSrcAlpha=206,this.materialCopy.blendDstAlpha=200,this.materialCopy.blendEquationAlpha=u,this.depthCopy=new ve({uniforms:ye.clone(No.uniforms),vertexShader:No.vertexShader,fragmentShader:No.fragmentShader,blending:A}),this.fsQuad=new ii.FullScreenQuad(null)}function zo(t){return(zo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Vo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===zo(t=function(t,e){if("object"!==zo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==zo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}((jo.prototype=Object.create(De.prototype)).constructor=jo).prototype.isDepthTexture=!0,Ho.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},Ho.prototype=Object.assign(Object.create(ii.prototype),{constructor:Ho,render:function(t,e,n){var i,r;this.renderToScreen&&(this.materialCopy.blending=A,this.materialCopy.uniforms.tDiffuse.value=n.texture,this.materialCopy.needsUpdate=!0,this.renderPass(t,this.materialCopy,null)),1!==this.params.output&&(this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),i=t.autoClear,t.autoClear=!1,t.setRenderTarget(this.depthRenderTarget),t.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far,r=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near),this.vBlurMaterial.uniforms.depthCutoff.value=r,this.hBlurMaterial.uniforms.depthCutoff.value=r,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(ko.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new at(0,1)),ko.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new at(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),t.setClearColor(0),t.setRenderTarget(this.beautyRenderTarget),t.clear(),t.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(t,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(t,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(t,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(t,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(t,this.hBlurMaterial,this.saoRenderTarget,16777215,1)),r=this.materialCopy,3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,r=this.depthCopy):(4===this.params.output?this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture:this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?r.blending=5:r.blending=A,this.renderPass(t,r,this.renderToScreen?null:n),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=i)},renderPass:function(t,e,n,i,r){this.originalClearColor.copy(t.getClearColor());var o=t.getClearAlpha(),s=t.autoClear;t.setRenderTarget(n),t.autoClear=!1,null!=i&&(t.setClearColor(i),t.setClearAlpha(r||0),t.clear()),this.fsQuad.material=e,this.fsQuad.render(t),t.autoClear=s,t.setClearColor(this.originalClearColor),t.setClearAlpha(o)},renderOverride:function(t,e,n,i,r){this.originalClearColor.copy(t.getClearColor());var o=t.getClearAlpha(),s=t.autoClear;t.setRenderTarget(n),t.autoClear=!1,i=e.clearColor||i,r=e.clearAlpha||r,null!=i&&(t.setClearColor(i),t.setClearAlpha(r||0),t.clear()),this.scene.overrideMaterial=e,t.render(this.scene,this.camera),this.scene.overrideMaterial=null,t.autoClear=s,t.setClearColor(this.originalClearColor),t.setClearAlpha(o)},setSize:function(t,e){this.beautyRenderTarget.setSize(t,e),this.saoRenderTarget.setSize(t,e),this.blurIntermediateRenderTarget.setSize(t,e),this.normalRenderTarget.setSize(t,e),this.depthRenderTarget.setSize(t,e),this.saoMaterial.uniforms.size.value.set(t,e),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(t,e),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(t,e),this.hBlurMaterial.needsUpdate=!0}});var Go=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.O=new on,this.ot=this.st(),this.Z(n)}var e,n;return e=t,(n=[{key:"getAttribute",value:function(t){for(var e in this.zn.params)if(e.toLowerCase()===("sao"+t).toLowerCase())return this.zn.params[e]}},{key:"setAttribute",value:function(t,e){for(var n in this.zn.params)n.toLowerCase()===("sao"+t).toLowerCase()&&(this.zn.params[n]=e)}},{key:"add",value:function(t){this.O.add(t)}},{key:"enable",value:function(){this.ot.sao=this}},{key:"disable",value:function(){this.ot.sao=null}},{key:"render",value:function(){this.Bn.render()}}])&&Vo(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Yo(t,e,n,i,r,o){zi.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r},o=new Ko(t,e,n,i,r),this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function Ko(t,e,n,i,r){ne.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:i,closed:r},e=e||64,n=n||1,i=i||8,r=r||!1;var o,s,a=t.computeFrenetFrames(e,r),A=(this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,new V),l=new V,u=new at,h=new V,c=[],f=[],p=[],d=[];for(o=0;o<e;o++)b(o);for(b(!1===r?e:0),o=0;o<=e;o++)for(s=0;s<=i;s++)u.x=o/e,u.y=s/i,p.push(u.x,u.y);for(s=1;s<=e;s++)for(o=1;o<=i;o++){var y=(i+1)*(s-1)+(o-1),m=(i+1)*s+(o-1),g=(i+1)*s+o,v=(i+1)*(s-1)+o;d.push(y,m,v),d.push(m,g,v)}function b(r){h=t.getPointAt(r/e,h);var o=a.normals[r],u=a.binormals[r];for(s=0;s<=i;s++){var p=s/i*Math.PI*2,d=Math.sin(p);p=-Math.cos(p);l.x=p*o.x+d*u.x,l.y=p*o.y+d*u.y,l.z=p*o.z+d*u.z,l.normalize(),f.push(l.x,l.y,l.z),A.x=h.x+n*l.x,A.y=h.y+n*l.y,A.z=h.z+n*l.z,c.push(A.x,A.y,A.z)}}this.setIndex(d),this.setAttribute("position",new mt(c,3)),this.setAttribute("normal",new mt(f,3)),this.setAttribute("uv",new mt(p,2))}function Xo(t){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wo(t,e){return(Wo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Zo(t){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.assign(Go.prototype,{st:function(){return"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln),this.B.getRenderManager()},Z:function(t){this.Bn=new Ri(this.ot.renderer),this.Xn=new mi(Lo),this.Xn.uniforms.resolution.value.set(1/this.B.getContainer().clientWidth,1/this.B.getContainer().clientHeight),this.Gn=new fi(this.O,this.B.camera),this.zn=new Ho(this.O,this.B.camera,!1,!0),this.zn.params.output=Ho.OUTPUT.Default,this.zn.params.saoBias=t.bias||-.8,this.zn.params.saoIntensity=t.intensity||12e-5,this.zn.params.saoScale=t.scale||30,this.zn.params.saoKernelRadius=t.radius||30,this.zn.params.saoMinResolution=t.minResolution||0,this.zn.params.saoBlurRadius=t.blurRadius||4.1,this.zn.params.saoBlurStdDev=t.blurStdDev||4,this.zn.params.saoBlurDepthCutoff=t.blurDepthCutoff||.01,this.Bn.addPass(this.Gn),this.Bn.addPass(this.zn),this.Bn.addPass(this.Xn)}}),(Yo.prototype=Object.create(zi.prototype)).constructor=Yo,(Ko.prototype=Object.create(ne.prototype)).constructor=Ko;var qo=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wo(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Zo(t);if(n=e?(n=Zo(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Xo(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){if(this instanceof i)return n.call(this,{type:nn.FLOW_LINE_LAYER});throw new TypeError("Cannot call a class as a function")}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(fengmap.FMMarkerLayer);function Jo(t){return(Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Jo(t=function(t,e){if("object"!==Jo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Jo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var ts=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.G=n.url,this.Kt=n.color,void 0===this.Kt&&(this.Kt="#FF0000"),this.Vn=n.backgroundColor,void 0===this.Vn&&(this.Vn="#FF0000"),this.Yn=n.points,this.Qn=n.lineWidth,void 0===this.Qn&&(this.Qn=2),this.Wn=n.lineLength,void 0===this.Wn&&(this.Wn=500),this.Ht=n.speed,void 0===this.Ht&&(this.Ht=1),this.qn=n.opacity,void 0===this.qn&&(this.qn=1),this.Zn=n.smoothparam,void 0===this.Zn&&(this.Zn=35),this.O=new on,this.Tt=null,this.Kn=null,this.Jn=null,this.$n=null,this.te=n.count,void 0===this.te&&(this.te=5),this.ne=null,this.Rt=!1,this.ft=this.ft.bind(this),this.q=this.q.bind(this),this.ee=this.ee.bind(this),this.vertexShader="\n            varying vec2 vUv;\n            void main(){\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n                    gl_Position = projectionMatrix * mvPosition;\n            }\n        ",this.fragmentShader="\n            uniform float time;\n            uniform float repeat;\n            varying vec2 vUv;\n            uniform sampler2D texture;\n            uniform sampler2D background;\n            void main( void ) {\n                vec4 backcolor=texture2D(background,vUv);\n                if(backcolor.a==0.0) discard;\n                vec4 colora = texture2D( texture, vec2(fract( vUv.x + time )*repeat, vUv.y));\n                colora.r = colora.r * colora.a * 10.0;\n                colora.g = colora.g * colora.a * 10.0;\n                colora.b = colora.b * colora.a * 10.0;\n                gl_FragColor = vec4(vec3(mix(colora,backcolor,1.0-colora.a)),1.0);   \n            }\n        "}var e,n;return e=t,(n=[{key:"parent",get:function(){return this.Tt}},{key:"getUrl",value:function(){return this.G}},{key:"setUrl",value:function(t){var e=this;this.G=t,this.ie(function(t){(t=new oo(t)).wrapS=t.wrapT=y,t.repeat.set(e.te,1),t.needsUpdate=!0,e.$n.uniforms.texture.value=t})}},{key:"getColor",value:function(){return this.Kt}},{key:"setColor",value:function(t){var e=this;this.Kt=t,this.G=void 0,this.ie(function(t){(t=new oo(t)).wrapS=t.wrapT=y,t.repeat.set(e.te,1),t.needsUpdate=!0,e.$n.uniforms.texture.value=t})}},{key:"getBackgroundColor",value:function(){return this.Vn}},{key:"setBackgroundColor",value:function(t){this.Vn=t,this.$n.uniforms.background.value=new oo(this.re())}},{key:"getLineWidth",value:function(){return this.Qn}},{key:"setLineWidth",value:function(t){this.Qn=t,this.Tt.scene.remove(this.Kn),this.oe()}},{key:"getSpeed",value:function(){return this.Ht}},{key:"setSpeed",value:function(t){this.Ht=t,this.Kn.userData.speed=t}},{key:"addTo",value:function(t){fengmap.FMMarkerFun.LAYER_CLASS.get(nn.FLOW_LINE_LAYER)||fengmap.FMMarkerFun.LAYER_CLASS.set(nn.FLOW_LINE_LAYER,qo);var e=t.parent.buildingID;this.ne=e+"_"+t.level,this.Rt||this.Z(t)}},{key:"remove",value:function(){this.jt()}},{key:"dispose",value:function(){this.remove()}}])&&$o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function es(t){return(es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ns(t,e){return(ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function is(t){return(is=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.assign(ts.prototype,{q:function(){this.$n&&(this.$n.uniforms.time.value-=this.Ht/1e3,this.B.enableUpdateNode())},Z:function(t){this.oe(t),this.Rt=!0},oe:function(t){var e=this;this.ie(function(n){n=new oo(n);for(var i=(e.Jn=n,e.ae(e.Yn,e.Qn/4)),r=(n=(n.wrapS=n.wrapT=y,n.repeat.set(e.te,1),n.needsUpdate=!0,new ve({uniforms:{time:{value:0},repeat:{value:e.te},texture:{value:n},background:{value:new oo(e.re())}},transparent:!0,depthWrite:!0,depthTest:!0,side:s,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),e.$n=n,new Pr),o=0;o<i.length-1;o++){var a=new Cr(i[o],i[o+1]);r.curves.push(a)}var A=new Yo(r,e.Zn*(i.length-1),e.Qn/2,3);e.Kn=new Xn(A,n),e.Kn.isNoPickup=!0,t?(A=t.getOrCreateLayer(nn.FLOW_LINE_LAYER),e.Tt=A,e.Tt.scene.add(e.Kn),e.B.on("update",e.q)):e.Tt.scene.add(e.Kn)})},re:function(){var t,e=document.createElement("canvas");return(t=((t=(e.width=1024,e.height=600,e.getContext("2d"))).rect(0,200,1024,200),t.fillStyle=new L(this.Vn).getStyle(),t.fill(),document.createElement("canvas"))).width=1024,t.height=1024,t.getContext("2d").drawImage(e,0,0,1024,1024),t},ie:function(t){var e,n,i=this,r=document.createElement("canvas"),o=(r.width=1024,r.height=1024,r.getContext("2d")),s=document.createElement("canvas"),a=(s.width=1024,s.height=600,s.getContext("2d"));void 0!==i.G?((e=new Image).crossOrigin="Anonymous",e.onload=function(){a.drawImage(e,0,200,1024,200),o.drawImage(s,0,0,1024,1024),t&&t(r)},e.src=i.G):(i=new L(i.Kt),(n=a.createLinearGradient(0,0,1024,0)).addColorStop(0,"rgba("+255*i.r+", "+255*i.g+","+255*i.b+", 0.2)"),n.addColorStop(.8,"rgba("+255*i.r+", "+255*i.g+","+255*i.b+", 0.3)"),n.addColorStop(1,"rgba("+255*i.r+", "+255*i.g+","+255*i.b+", 1)"),a.fillStyle=n,a.fillRect(0,200,1024,200),o.drawImage(s,0,0,1024,1024),t&&t(r))},ee:function(){this.O.position.y=this.Tt.height},ft:function(){var t=this.B.getContainer();t.clientWidth,t.clientHeight},ae:function(t,e){for(var n=[],i=t.length/3,r=0;r<i;r++){var o=new V(t[3*r]-this.B.x,t[3*r+2]+e,-t[3*r+1]+this.B.y);n.push(o)}return n},jt:function(){this.B.off("update",this.q),this.Tt.scene.remove(this.Kn),this.Kn.geometry.dispose(),this.Kn.material.dispose(),this.Kn=null,this.Rt=!1}});var rs=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ns(e,t);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=is(t);if(n=e?(n=is(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===es(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){if(this instanceof i)return n.call(this,{type:nn.FIRE_MARKER});throw new TypeError("Cannot call a class as a function")}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(fengmap.FMMarkerLayer),os={FOV:35,CAMERA_NEAR:1,CAMERA_FAR:1e5,ZOOM_UPPER_BOUND:30,TILT_UPPER_BOUND:90,THOUSAND:1e3,DEG2RAD:.0174532,RAD2DEG:57.2957795,DRAW_TIME:500,EPS:.001},ss=(Object.freeze(os),os);function as(t){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function As(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===as(t=function(t,e){if("object"!==as(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==as(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var ls=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var e,n;return e=t,n=[{key:"round",value:function(t){return 0<t.toFixed(2)?Math.ceil(t.toFixed(2)):Math.floor(t.toFixed(2))}},{key:"generateUUID",value:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);var n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;n=t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&o]+t[o>>8&255]+t[o>>16&255]+t[o>>24&255];return t.length=0,n.toUpperCase()}},{key:"findNearNthPowerOfTwo",value:function(t){return t-=1,(t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)<0?1:1+t}},{key:"rgbToArray",value:function(t){var e=new L;return e.setStyle(t),[e.r,e.g,e.b]}},{key:"toRgba",value:function(t){var e;return void 0===t?t:"number"!=typeof t?3<=(e=t.split(",")).length?"rgba("+parseInt(e[0])+","+parseInt(e[1])+","+parseInt(e[2])+",1)":t:"rgba("+parseInt(255*new L(t).r)+","+parseInt(255*new L(t).g)+","+parseInt(255*new L(t).b)+",1)"}},{key:"toColor",value:function(t){var e;return"number"==typeof t?t:3<=(e=t.split(",")).length?parseInt(e[0])<<16|parseInt(e[1])<<8|parseInt(e[2]):0}}],null&&As(e.prototype,null),n&&As(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function us(t){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===us(t=function(t,e){if("object"!==us(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==us(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}os=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.se=(e=e||{}).src,this.he=e.dest,this.Tt=null,this.le=[],this.kn=0,this.ue=0,this.ce=0,this.fe=ss.THOUSAND,this.de=!1,this.ve=!1,this.me=!0,this.Qt=null,this.pe=null,this.ge=ls.generateUUID()}var e,n;return e=t,(n=[{key:"play",value:function(){return this._e()}},{key:"pause",value:function(){return this.ve=!0,this}},{key:"resume",value:function(){return this.ve=!1,this.kn+=this.ce,this.ce=0,this}},{key:"stop",value:function(){return this.me=!0,this}},{key:"finish",value:function(){return this.me=!0,this.pe&&this.pe(),this.le=[],this}}])&&hs(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var cs=(Object.assign(os.prototype,{jt:function(){for(var t in this)this[""+t]=null,delete this[""+t]},ye:function(t){return this.se=t,this},xe:function(t){return this.he=t,this},be:function(t){return this.fe=t*ss.THOUSAND,this},we:function(t){return this.ue=t*ss.THOUSAND,this},Ae:function(t){return this.Qt=t,this},Se:function(t){return this.pe=t,this},Te:function(t){return this.de=t,this},_e:function(){return this.me=!1,this.Tt&&(this.kn=this.Tt.Me),this},Ee:function(){var t=new this.constructor({src:this.se,dest:this.he});return t.kn=this.kn,t.ue=this.ue,t.fe=this.fe,t.de=this.de,t.Qt=this.Qt,t.pe=this.pe,t},Pe:function(){var t=this.he.concat(),e=this.se.concat();return this.se=t,this.he=e,this}}),os);function fs(t){return(fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ps(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===fs(t=function(t,e){if("object"!==fs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==fs(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}os=function(t,e,n){return e&&ps(t.prototype,e),n&&ps(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Et=new Map,this.Le=[],this.Me=(new Date).getTime(),this.Fe=new Map,this.Ne=null,this.De=this.De.bind(this),this.Ce=0,this.Re()});var ds=(Object.assign(os.prototype,{Ct:function(t){if(Array.isArray(t)){this.Et.set(t[0].ge,t[0]),t[0].Tt=this;for(var e=1;e<t.length;e++)t[e].kn=t[e-1].kn+t[e-1].fe,t[e].ue=t[e-1].ue+t[e-1].fe,this.Et.set(t[e].ge,t[e]),t[e].Tt=this}else this.Et.has(t.ge)||(this.Et.set(t.ge,t),t.Tt=this,t.kn=this.Me)},Ot:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.Et.delete(t[e].ge);else this.Et.delete(t.ge)},Ie:function(t){this.Le.push(t)},Oe:function(t){-1<(t=this.Le.indexOf(t))&&this.Le.splice(t,1)},Ue:function(t){this.Fe.set(t.ge=ls.generateUUID(),t)},je:function(t){this.Fe.delete(t.ge)},Qt:function(t,e,n){for(var i=[],r=[],o=0;o<t.se.length;o++)void 0===t.le[o]&&(t.le[o]=0),1<=e?(i.push(t.he[o]),r.push(t.he[o]-t.se[o]-t.le[o])):(i.push((t.he[o]-t.se[o])*e+t.se[o]),r.push((t.he[o]-t.se[o])*n),t.le[o]+=(t.he[o]-t.se[o])*n);t.Qt({destination:i,delta:r}),r.length=i.length=0},Re:function(){var t=this,e=(this.Ce=requestAnimationFrame(this.Re.bind(this)),(new Date).getTime()),n=e-this.Me;this.Fe.forEach(function(t){return t(n)});for(var i=0;i<this.Le.length;i++)this.Le[i].update(n/1e3);this.Et.forEach(function(i){var r,o;i.me||(i.ve?i.ce+=n:(r=(e-i.kn)/i.fe,o=n/i.fe,t.Qt(i,r,o),r=e-i.kn-i.ue,i.fe<=r&&(i.le=[],i.de?(i.kn=e,i.pe&&i.pe()):(o=i.me,i.me=!0,!o&&i.pe&&i.pe()))))}),this.Me=e,this.Ne&&0===this.Et.size&&this.De()},jt:function(t){this.Ne=t},De:function(){this.Ce&&(window.cancelAnimationFrame(this.Ce),this.Ce=0),this.Et.forEach(function(t){t.jt()}),this.Et.clear(),this.Le=[],this.Fe.clear(),this.Ne&&this.Ne({name:"Animator"})}}),os),ys={defines:{ITERATIONS:"20",OCTIVES:"3"},uniforms:{fireTex:{type:"t",value:null},color:{type:"c",value:null},time:{type:"f",value:0},seed:{type:"f",value:0},invModelMatrix:{type:"m4",value:null},scale:{type:"v3",value:null},noiseScale:{type:"v4",value:new st(1,2,1,.3)},magnitude:{type:"f",value:1.3},lacunarity:{type:"f",value:2},gain:{type:"f",value:.5}},vertexShader:["varying vec3 vWorldPos;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","vWorldPos = (modelMatrix * vec4(position, 1.0)).xyz;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float time;","uniform float seed;","uniform mat4 invModelMatrix;","uniform vec3 scale;","uniform vec4 noiseScale;","uniform float magnitude;","uniform float lacunarity;","uniform float gain;","uniform sampler2D fireTex;","varying vec3 vWorldPos;","vec3 mod289(vec3 x) {","return x - floor(x * (1.0 / 289.0)) * 289.0;","}","vec4 mod289(vec4 x) {","return x - floor(x * (1.0 / 289.0)) * 289.0;","}","vec4 permute(vec4 x) {","return mod289(((x * 34.0) + 1.0) * x);","}","vec4 taylorInvSqrt(vec4 r) {","return 1.79284291400159 - 0.85373472095314 * r;","}","float snoise(vec3 v) {","const vec2 C = vec2(1.0 / 6.0, 1.0 / 3.0);","const vec4 D = vec4(0.0, 0.5, 1.0, 2.0);","vec3 i  = floor(v + dot(v, C.yyy));","vec3 x0 = v - i + dot(i, C.xxx);","vec3 g = step(x0.yzx, x0.xyz);","vec3 l = 1.0 - g;","vec3 i1 = min(g.xyz, l.zxy);","vec3 i2 = max(g.xyz, l.zxy);","vec3 x1 = x0 - i1 + C.xxx;","vec3 x2 = x0 - i2 + C.yyy;","vec3 x3 = x0 - D.yyy;","i = mod289(i); ","vec4 p = permute(permute(permute( ","i.z + vec4(0.0, i1.z, i2.z, 1.0))","+ i.y + vec4(0.0, i1.y, i2.y, 1.0)) ","+ i.x + vec4(0.0, i1.x, i2.x, 1.0));","float n_ = 0.142857142857;","vec3  ns = n_ * D.wyz - D.xzx;","vec4 j = p - 49.0 * floor(p * ns.z * ns.z);","vec4 x_ = floor(j * ns.z);","vec4 y_ = floor(j - 7.0 * x_);","vec4 x = x_ * ns.x + ns.yyyy;","vec4 y = y_ * ns.x + ns.yyyy;","vec4 h = 1.0 - abs(x) - abs(y);","vec4 b0 = vec4(x.xy, y.xy);","vec4 b1 = vec4(x.zw, y.zw);","vec4 s0 = floor(b0) * 2.0 + 1.0;","vec4 s1 = floor(b1) * 2.0 + 1.0;","vec4 sh = -step(h, vec4(0.0));","vec4 a0 = b0.xzyw + s0.xzyw * sh.xxyy;","vec4 a1 = b1.xzyw + s1.xzyw * sh.zzww;","vec3 p0 = vec3(a0.xy, h.x);","vec3 p1 = vec3(a0.zw, h.y);","vec3 p2 = vec3(a1.xy, h.z);","vec3 p3 = vec3(a1.zw, h.w);","vec4 norm = taylorInvSqrt(vec4(dot(p0, p0), dot(p1, p1), dot(p2, p2), dot(p3, p3)));","p0 *= norm.x;","p1 *= norm.y;","p2 *= norm.z;","p3 *= norm.w;","vec4 m = max(0.6 - vec4(dot(x0, x0), dot(x1, x1), dot(x2, x2), dot(x3, x3)), 0.0);","m = m * m;","return 42.0 * dot(m * m, vec4(dot(p0, x0), dot(p1, x1), dot(p2, x2), dot(p3, x3)));","}","float turbulence(vec3 p) {","float sum = 0.0;","float freq = 1.0;","float amp = 1.0;","for(int i = 0; i < OCTIVES; i++) {","sum += abs(snoise(p * freq)) * amp;","freq *= lacunarity;","amp *= gain;","}","return sum;","}","vec4 samplerFire (vec3 p, vec4 scale) {","vec2 st = vec2(sqrt(dot(p.xz, p.xz)), p.y);","if(st.x <= 0.0 || st.x >= 1.0 || st.y <= 0.0 || st.y >= 1.0) return vec4(0.0);","p.y -= (seed + time) * scale.w;","p *= scale.xyz;","st.y += sqrt(st.y) * magnitude * turbulence(p);","if(st.y <= 0.0 || st.y >= 1.0) return vec4(0.0);","return texture2D(fireTex, st);","}","vec3 localize(vec3 p) {","return (invModelMatrix * vec4(p, 1.0)).xyz;","}","void main() {","vec3 rayPos = vWorldPos;","vec3 rayDir = normalize(rayPos - cameraPosition);","float rayLen = 0.0288 * length(scale.xyz);","vec4 col = vec4(0.0);","for(int i = 0; i < ITERATIONS; i++) {","rayPos += rayDir * rayLen;","vec3 lp = localize(rayPos);","lp.y += 0.5;","lp.xz *= 2.0;","col += samplerFire(lp, noiseScale);","}","col.a = col.r;","gl_FragColor = col;","}"].join("\n")};function ms(t,e){var n=new ve({defines:ys.defines,uniforms:ye.clone(ys.uniforms),vertexShader:ys.vertexShader,fragmentShader:ys.fragmentShader,transparent:!0,depthWrite:!1,depthTest:!0});t.magFilter=t.minFilter=v,t.wrapS=t.wrapT=m,n.uniforms.fireTex.value=t,n.uniforms.color.value=new L(e),n.uniforms.invModelMatrix.value=new Ct,n.uniforms.scale.value=new V(1,1,1),n.uniforms.seed.value=19.19*Math.random(),Xn.call(this,new $i(1,1,1),n)}((ms.prototype=Object.create(Xn.prototype)).constructor=ms).prototype.update=function(t){var e=this.material.uniforms.invModelMatrix.value;this.updateMatrixWorld(),e.getInverse(this.matrixWorld),void 0!==t&&(this.material.uniforms.time.value=t),this.material.uniforms.invModelMatrix.value=e,this.material.uniforms.scale.value=this.scale};var gs=["attribute vec3  customColor;","attribute float customOpacity;","attribute float customSize;","attribute float customAngle;","attribute float customVisible;","varying vec4  vColor;","varying float vAngle;","void main()","{","if ( customVisible > 0.5 )","vColor = vec4( customColor, customOpacity );","else","vColor = vec4(0.0, 0.0, 0.0, 0.0);","vAngle = customAngle;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = customSize * ( 300.0 / length( mvPosition.xyz ) );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),vs=["uniform sampler2D texture;","varying vec4 vColor;","varying float vAngle;","void main()","{","gl_FragColor = vColor;","float c = cos(vAngle);","float s = sin(vAngle);","vec2 rotatedUV = vec2(c * (gl_PointCoord.x - 0.5) + s * (gl_PointCoord.y - 0.5) + 0.5,","c * (gl_PointCoord.y - 0.5) - s * (gl_PointCoord.x - 0.5) + 0.5);","vec4 rotatedTexture = texture2D( texture,  rotatedUV );","gl_FragColor = gl_FragColor * rotatedTexture;","}"].join("\n");function bs(t,e){this.times=t||[],this.values=e||[]}function xs(){this.position=new V,this.velocity=new V,this.acceleration=new V,this.angle=0,this.angleVelocity=0,this.angleAcceleration=0,this.size=16,this.color=new L,this.opacity=1,this.age=0,this.alive=0}bs.prototype.lerp=function(t){for(var e,n=0,i=this.times.length;n<i&&t>this.times[n];)n++;return 0==n?this.values[0]:n==i?this.values[i-1]:(e=(t-this.times[n-1])/(this.times[n]-this.times[n-1]),this.values[0]instanceof V?this.values[n-1].clone().lerp(this.values[n],e):this.values[n-1]+e*(this.values[n]-this.values[n-1]))},xs.prototype.update=function(t){this.position.add(this.velocity.clone().multiplyScalar(t)),this.velocity.add(this.acceleration.clone().multiplyScalar(t)),this.angle+=.01745329251*this.angleVelocity*t,this.angleVelocity+=.01745329251*this.angleAcceleration*t,this.age+=t,0<this.sizeTween.times.length&&(this.size=this.sizeTween.lerp(this.age)),0<this.colorTween.times.length&&(t=this.colorTween.lerp(this.age),this.color=(new L).setHSL(t.x,t.y,t.z)),0<this.opacityTween.times.length&&(this.opacity=this.opacityTween.lerp(this.age))};var ws=Object.freeze({CUBE:1,SPHERE:2});function Bs(t){this.scene=t,this.positionStyle=ws.CUBE,this.positionBase=new V,this.positionSpread=new V,this.positionRadius=0,this.velocityStyle=ws.CUBE,this.velocityBase=new V,this.velocitySpread=new V,this.speedBase=0,this.speedSpread=0,this.accelerationBase=new V,this.accelerationSpread=new V,this.angleBase=0,this.angleSpread=0,this.angleVelocityBase=0,this.angleVelocitySpread=0,this.angleAccelerationBase=0,this.angleAccelerationSpread=0,this.sizeBase=0,this.sizeSpread=0,this.sizeTween=new bs,this.colorBase=new V(0,1,.5),this.colorSpread=new V(0,0,0),this.colorTween=new bs,this.opacityBase=1,this.opacitySpread=0,this.opacityTween=new bs,this.blendStyle=l,this.particleArray=[],this.particlesPerSecond=100,this.particleDeathAge=1,this.emitterAge=0,this.emitterAlive=!0,this.emitterDeathAge=60,this.particleCount=this.particlesPerSecond*Math.min(this.particleDeathAge,this.emitterDeathAge),this.particleGeometry=new ne,this.particleTexture=null,this.particleMaterial=new ve({uniforms:{texture:{type:"t",value:this.particleTexture}},vertexShader:gs,fragmentShader:vs,blending:l,depthTest:!0,depthWrite:!1,side:a,transparent:!0,opacity:1}),this.particleMesh=new Xn}function Ms(t){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ms(t=function(t,e){if("object"!==Ms(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ms(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Bs.prototype.setValues=function(t){if(void 0!==t){for(var e in this.sizeTween=new bs,this.colorTween=new bs,this.opacityTween=new bs,t)this[e]=t[e];xs.prototype.sizeTween=this.sizeTween,xs.prototype.colorTween=this.colorTween,xs.prototype.opacityTween=this.opacityTween,this.particleArray=[],this.emitterAge=0,this.emitterAlive=!0,this.particleCount=this.particlesPerSecond*Math.min(this.particleDeathAge,this.emitterDeathAge),this.particleGeometry=new zi,this.particleMaterial=new ve({uniforms:{texture:{type:"t",value:this.particleTexture}},vertexShader:gs,fragmentShader:vs,blending:l,depthTest:!0,depthWrite:!1,side:a,transparent:!0,opacity:1}),this.particleMesh=new qe}},Bs.prototype.randomValue=function(t,e){return t+e*(Math.random()-.5)},Bs.prototype.randomVector3=function(t,e){var n=new V(Math.random()-.5,Math.random()-.5,Math.random()-.5);return(new V).addVectors(t,(new V).multiplyVectors(e,n))},Bs.prototype.createParticle=function(){var t,e,n=new xs,i=new V,r=(this.positionStyle==ws.CUBE&&(n.position=this.randomVector3(i,this.positionSpread)),this.positionStyle==ws.SPHERE&&(e=2*Math.random()-1,t=6.2832*Math.random(),r=new V((r=Math.sqrt(1-e*e))*Math.cos(t),r*Math.sin(t),e),n.position=(new V).addVectors(i,r.multiplyScalar(this.positionRadius))),this.velocityStyle==ws.CUBE&&(n.velocity=this.randomVector3(this.velocityBase,this.velocitySpread)),this.velocityStyle==ws.SPHERE&&(t=(new V).subVectors(n.position,i),e=this.randomValue(this.speedBase,this.speedSpread),n.velocity=t.normalize().multiplyScalar(e)),n.acceleration=this.randomVector3(this.accelerationBase,this.accelerationSpread),n.angle=this.randomValue(this.angleBase,this.angleSpread),n.angleVelocity=this.randomValue(this.angleVelocityBase,this.angleVelocitySpread),n.angleAcceleration=this.randomValue(this.angleAccelerationBase,this.angleAccelerationSpread),n.size=this.randomValue(this.sizeBase,this.sizeSpread),this.randomVector3(this.colorBase,this.colorSpread));return n.color=(new L).setHSL(r.x,r.y,r.z),n.opacity=this.randomValue(this.opacityBase,this.opacitySpread),n.age=0,n.alive=0,n},Bs.prototype.initialize=function(){for(var t=[],e=[],n=[],i=[],r=[],o=0;o<this.particleCount;o++)this.particleArray[o]=this.createParticle(),this.particleGeometry.vertices[o]=this.particleArray[o].position,t.push(this.particleArray[o].alive),e.push(this.particleArray[o].color),n.push(this.particleArray[o].opacity),i.push(this.particleArray[o].size),r.push(this.particleArray[o].angle);for(o=0;o<this.particleCount-2;o+=3){var s=new Fn(o,o+1,o+2);this.particleGeometry.faces.push(s)}this.bufferGeometry=new ne,this.bufferGeometry.fromGeometry(this.particleGeometry),this.bufferGeometry.setAttribute("customVisible",new lt(new Float32Array(t),1)),this.bufferGeometry.setAttribute("customColor",new lt(new Float32Array(3*e.length),3).copyColorsArray(e)),this.bufferGeometry.setAttribute("customOpacity",new lt(new Float32Array(n),1)),this.bufferGeometry.setAttribute("customSize",new lt(new Float32Array(i),1)),this.bufferGeometry.setAttribute("customAngle",new lt(new Float32Array(r),1)),this.particleMaterial.blending=this.blendStyle,this.blendStyle!=l&&(this.particleMaterial.depthTest=!0),this.particleMesh=new qe(this.bufferGeometry,this.particleMaterial),this.particleMesh.dynamic=!0,this.particleMesh.sortParticles=!0,this.particleMesh.position.set(this.positionBase.x,this.positionBase.y,this.positionBase.z),this.scene.add(this.particleMesh),this.isShow=!0},Bs.prototype.update=function(t){for(var e=[],n=[],i=[],r=[],o=[],s=[],a=0;a<this.particleCount;a++)this.particleArray[a].alive&&(this.particleArray[a].update(t),this.particleGeometry.vertices[a]=this.particleArray[a].position,this.particleArray[a].age>this.particleDeathAge&&(this.particleArray[a].alive=0,e.push(a)),n.push(this.particleArray[a].alive),i.push(this.particleArray[a].color),r.push(this.particleArray[a].opacity),o.push(this.particleArray[a].size),s.push(this.particleArray[a].angle));if(this.bufferGeometry.fromGeometry(this.particleGeometry),this.bufferGeometry.getAttribute("customVisible").copyArray(n),this.bufferGeometry.getAttribute("customColor").copyColorsArray(i),this.bufferGeometry.getAttribute("customOpacity").copyArray(r),this.bufferGeometry.getAttribute("customSize").copyArray(o),this.bufferGeometry.getAttribute("customAngle").copyArray(s),this.bufferGeometry.getAttribute("customVisible").needsUpdate=!0,this.bufferGeometry.getAttribute("customColor").needsUpdate=!0,this.bufferGeometry.getAttribute("customOpacity").needsUpdate=!0,this.bufferGeometry.getAttribute("customSize").needsUpdate=!0,this.bufferGeometry.getAttribute("customAngle").needsUpdate=!0,this.emitterAlive){if(this.emitterAge<this.particleDeathAge){var A=Math.round(this.particlesPerSecond*(this.emitterAge+0)),l=Math.round(this.particlesPerSecond*(this.emitterAge+t));for(l>this.particleCount&&(l=this.particleCount),a=A;a<l;a++)this.particleArray[a].alive=1}for(var u=0;u<e.length;u++)a=e[u],this.particleArray[a]=this.createParticle(),this.particleArray[a].alive=1,this.particleGeometry.vertices[a]=this.particleArray[a].position;this.emitterAge+=t,this.emitterAge>this.emitterDeathAge&&(this.emitterAlive=!1)}},Bs.prototype.destroy=function(){this.scene.remove(this.particleMesh),this.isShow=!1},Bs.prototype.show=function(){this.scene.add(this.particleMesh),this.isShow=!0},Bs.prototype.hide=function(){this.scene.remove(this.particleMesh),this.isShow=!1};var _s=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.ke=e,this.He=this.ke.smokeDensity,void 0===this.He&&(this.He=30),this.ze=new Ei,this.Be=new V(this.ke.x,this.ke.y,this.ke.z),this.Xe=null,this.Ge=null,this.O=null,this.Ve=null,this.Ye="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5wEMBTcTolE0kwAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAJKUlEQVRYw41XTW4bRxOtqu6eGXIoSlTiID824I29kK6QhS+Qba5D3UcXyMIL5QBeBRYQBDCMGLAQK/ohRc50d/19C1FG4jjB94DBNAYYvNfVVa+6EP4d6O5wcnKCAEA//PADdl2Hv//+O04mE2zbFgEAHj9+DKrqzOzPnj3zV69e+d3dnb948cIAwAEAENH/leRzH90dT05O8MWLF3R5eUkAEJ4/f07v378Pk8mESim0WCw+/tv3vTOzlVKs6zodhsHm87leXl7ag5B/E/GpAFwul3h8fIw3Nzf0/PnzAADxr4+qBncPs9mMEBHbtnVVtRCCppQ0xijjOEpKSfq+l6urK33z5o29fv3aT05O/iEkfkoOAAQA9M0330QRSW3bNrXWJqXUiEgTQkgxxuDuoWkaVFUXETUzZWZumqYCQK211pxzBQA+OjqSR48eGQCYu//tSOKn5IeHh+HDhw/pq6++alJKbdM0HQBMAKCLMXbu3tZaU9M0wczQ3b2UoiEERsQiIpmIMgCMMcZcay1d19XvvvuOz87O4Ozs7G8i8OHMT09P6eLiIoYQ0t7eXnt4eNi1bTtNKfUhhJ6IenfvRaRT1ZaIQtM0FGM0EVFELDHGHELYuvu2lLLdrYcQQu77vjRNw8+ePRMAsAcBEQDwxx9/pKOjozCbzeLBwUEzmUy6GOMMAPaIaF5rnccY5wAwI6JpjLETkWhmhIjWtq2klLKZDQCwMbN1jLEdxzGmlGgymQAA+DAMfnp66rtNGyJ6XC6XeHFxQfP5PBweHqa2bbsYY9913V6McaGqCwBYiMiBu+8R0Ww6nbZN0yR3pxCCpZQ4hFBEZKOqdyIyyTk3pZTAzDCOo08mE2dme/z4sf3yyy9+cnLiAODx/Pwcv//+e+r7Ps7n86Zt287MZu6+DwCLlNKXZvYlMy/MbH86nfYi0qWUEgCQuxszMwBkANgCwMrMWmYO7g4iYoho4ziKmclqtdInT57YYrEwAMB4dHSEXdeF+XyeiKh192nbtjNVPXD3L0IIX7r7I1U9VNV9EelDCB0AREQkZjYiEjPLRLRl5lZEoruDu7uIKBHxMAy11sohBPnjjz8UAGy5XHoEAAr3iETUhhAmiDiLMc5DCAtm/kJEvjCzQwCY7wS0RBTdnXYJJQBQ3L0VkTiOI4qI1VqFmTMzj2Y25pwzM5emacJ8Ppf3799DfPr0KQFACCFEd29qrZMYY+/ue4g4Tyntxxj3iWi/1rpHRNMQQrsTjH4PUdXGzIKq4s4T6niPjYhs3H3j7ltVjXd3dyGEQMfHxxj7vkcAIBFJZta0bdsy80RV+1rrLMa4F0LYc/eZu/dmNnH3VEqJTdMgALiIiKoGEUEz81IK53tscs49AEyYuXX3RkQSEdHbt28JADB2XYcAQLXWgIjR3RsAaImoM7MJM3fM3JlZa2atqjabzSaFEAjv4eM4krsjABgz8zAMXSmlE5EJInYi0jJzU0qJIYSQc6bZbIa//fYbxtvbW+z7nlJKVGsN4zhGVU0hhISISUQaZk6ImBAxAkBIKYXpdEoAgLtOiMxsZhaZObl7AoAGAFKtNQ3DkMwsqmpgZtpsNnR5eYkAAHG9XmPf98DMGEIgIqJaK9VaSVUJEcndP75TShRjRFXFWiuaGZRSsJRCqkq70iQzIzMjEaFSCjEzmRmpKm63W6i1YowR4nw+dwAAM3NEdEQ0MzN3dzPzh7W7u6o6Ebmq+mazgRCCuzuM4+hm5gDgu+bkqmru7iEETylZztmGYfBhGDylBHd3d75YLCAeHBx4ztmJyJhZ3V2JSHalxSIiiChmJgAgzBxLKSgiAAC4E6kAoO4uZialFAEAiTFy0zRSaxVE1JyzmpmVUrxt2/tekHP2cRyt73s1M2FmRsRqZtnMMgBkIspEVEQk1VqDmcFut+juTkRKRFxrrSJSHv4DgOzuuZRSa62ccxZV1RCC3d7e+rt37zxut1sHAB3HUUMI1cyKiIwiMqjq1sy2ZjZt27aJMZKqgt4jqiruupqYWc05DyKyRcRtjHELAFsRGURkLKUURKzjOKqZ6Z9//ulPnjzx2Pe9XVxc2HQ65RBCdfdRVQdm3tRa10Q0JaJGVcMuV0xVW2aOiIi73BAAKGa2VdU1AKzcfWVm61rrZr1eD8w8MnMVEWZmOzg4sNPTU4g3Nzdea30494qIIwBsRGTFzB0iNuG+PMDMNOdcc86d+72N75qREFFGxC0irojoWlWv3f3WzFallE3OeSyl1BCC5Jz1+vraAMDjYrGwpml0vV5zCKHslG5KKY27p53fwy7JSq11lnPuaq3p4T4gIgwAOaW0MbM1AFwDwJ8ppWtmXonIhpnHnHMxM6616mw2u2/Hr1+/9m+//Vavr69lPp9XZh5rrVFVw44AhmEwM6vuPuwsuttZNzGzMTMTUQ4hbAFgTUS3KaVrRLxW1dXOkkcRqU3TyGaz0VevXhkAQDg7O4M3b97Ar7/+ikQEIgLu95cWRHQRMXeXnb9XZs6llNHdN6p6V0pZ1VpXqnpTa72utV6p6jUi3gDALTOvh2HYllLGYRhKCEG+/vprPT8/v48AIvpyufTDw0MFAByGocQY0cyg6zoDAEkplV0236nqhIgaZk4AgETkMUZW1Wpm465qNma2EZFNjHEAgJGICgDIOI76008/+ceh5TNX8jgMQ1LVdm9vrwOAbrvdTt19sl6vO2buVDU9+DoRmYioiLCq5lJKDiGMKaUhxpiZORNRWa1WDADy888/P0xMfxPwcRoCAHr79m18+vRp7LourdfrxszacRzbYRgaZk4iklSVttstIqLbPXgcR1bVqqpFREpKqYYQGADkc+T/mIz+KuIhGruGFVU13d7exs1mEwEgMDON44jM7KpqqqrDMIiqyi7TZX9/X8ZxlEePHtnnyD+djD4OC8vl0o6Pj/3ly5fetq0eHh7Ku3fveLVahaZpaBxHurq6IgCA7XYLKSUbx9G22611Xafr9Vr7vlcAsPPz878S+/81nP41GsfHx/jy5Uu6ubnBDx8+0N7eHpVSsNaKl5eXAABwdXXlROQXFxcGAA+E/0n82Qh8Jhq+E+nL5RIAAD98+ICbzQYBAM7Pz/+m+ROy/yR+wP8AibG5JpmwKwsAAAAASUVORK5CYII="}var e,n;return e=t,(n=[{key:"init",value:function(t){var e=this;this.O=t,(new Qe).load(this.Ye,function(t){e.Ge=t,e.createSmoke()})}},{key:"createSmoke",value:function(){this.Xe&&this.Xe.destroy(),this.Ve=(new Date).getTime(),this.Xe=new Bs(this.O);var t=this.He;1===t&&(t=2),this.Xe.setValues({positionStyle:ws.SPHERE,positionBase:this.Be,positionRadius:3,velocityStyle:ws.CUBE,velocityBase:new V(0,20,0),velocitySpread:new V(8,15,8),accelerationBase:new V(0,-10,0),particleTexture:this.Ge,angleBase:0,angleSpread:720,angleVelocityBase:0,angleVelocitySpread:720,sizeTween:new bs([0,.8,1.5],[10,80,50]),opacityTween:new bs([0,.4,1.5],[0,.9,0]),colorTween:new bs([.3,1.2],[new V(0,0,.6),new V(0,0,.3)]),worldEffectTween:new bs([.5,1.5],[new V(0,0,0),new V(-1,0,-.2)]),particlesPerSecond:t,particleDeathAge:t,emitterDeathAge:60}),this.Xe.initialize(),this.Xe.particleMesh.renderOrder=1,this.Xe.particleMesh.isNoPickup=!0}},{key:"update",value:function(){var t=this.ze.getDelta();((new Date).getTime()-this.Ve)/1e3<60?this.Xe&&this.Xe.update(.5*t):this.O&&this.Be&&this.createSmoke()}}])&&Ss(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Es(t){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ts(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Es(t=function(t,e){if("object"!==Es(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Es(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}os=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Qe={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.We={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}var e,n;return e=t,(n=[{key:"min",get:function(){return this.Qe}},{key:"max",get:function(){return this.We}},{key:"center",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}},{key:"size",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}},{key:"copy",value:function(t){return this.We.x=t.max.x,this.We.y=t.max.y,this.Qe.x=t.min.x,this.Qe.y=t.min.y,this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"reset",value:function(){this.Qe={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.We={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}},{key:"toObject",value:function(){return{min:this.min,max:this.max,center:this.center,size:this.size}}},{key:"expand",value:function(t){this.qe(t)}},{key:"expandByCoords",value:function(t){this.Ze(t)}},{key:"valid",value:function(){return this.Ke()}},{key:"isCross",value:function(t){var e=!0;return t.max.x<this.min.x&&(e=!1),t.min.x>this.max.x&&(e=!1),t.max.y<this.min.y&&(e=!1),!(t.min.y>this.max.y)&&e}}])&&Ts(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Cs=(Object.assign(os.prototype,{Ke:function(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},qe:function(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},Ze:function(t){var e=this;t&&0!=t.length&&t.forEach(function(t){t.x<e.min.x&&(e.min.x=t.x),t.y<e.min.y&&(e.min.y=t.y),t.x>e.max.x&&(e.max.x=t.x),t.y>e.max.y&&(e.max.y=t.y)})}}),os);function Fs(t){return(Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Os(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Fs(t=function(t,e){if("object"!==Fs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Fs(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ps(t,e,n,i,r,o,s,a,A,l,u,h){De.call(this,null,o,s,a,A,l,i,r,u,h),this.image={data:t||null,width:e||1,height:n||1},this.magFilter=void 0!==A?A:g,this.minFilter=void 0!==l?l:g,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}function Us(t){Re.call(this,t)}function Rs(t){Us.call(this,t),this.type=b}function Is(t,e,n,i,r,o,s,a,A,l){De.call(this,t=void 0!==t?t:[],e=void 0!==e?e:301,n,i,r,o,s=void 0!==s?s:x,a,A,l),this.flipY=!1}function Ls(t){Re.call(this,t)}function Ds(t){Re.call(this,t),this.hdrLoader=new Rs,this.type=b}function Qs(t,e,n,i){Xt.call(this),this.type="CubeCamera";var r=new Ar(90,1,t,e),o=(r.up.set(0,-1,0),r.lookAt(new V(1,0,0)),this.add(r),new Ar(90,1,t,e)),s=(o.up.set(0,-1,0),o.lookAt(new V(-1,0,0)),this.add(o),new Ar(90,1,t,e)),a=(s.up.set(0,0,1),s.lookAt(new V(0,1,0)),this.add(s),new Ar(90,1,t,e)),A=(a.up.set(0,0,-1),a.lookAt(new V(0,-1,0)),this.add(a),new Ar(90,1,t,e)),l=(A.up.set(0,-1,0),A.lookAt(new V(0,0,1)),this.add(A),new Ar(90,1,t,e));l.up.set(0,-1,0),l.lookAt(new V(0,0,-1)),this.add(l),this.renderTarget=new ks(n,i=i||{format:x,magFilter:v,minFilter:v}),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=t.getRenderTarget(),i=this.renderTarget,u=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(e,r),t.setRenderTarget(i,1),t.render(e,o),t.setRenderTarget(i,2),t.render(e,s),t.setRenderTarget(i,3),t.render(e,a),t.setRenderTarget(i,4),t.render(e,A),i.texture.generateMipmaps=u,t.setRenderTarget(i,5),t.render(e,l),t.setRenderTarget(n)},this.clear=function(t,e,n,i){for(var r=t.getRenderTarget(),o=this.renderTarget,s=0;s<6;s++)t.setRenderTarget(o,s),t.clear(e,n,i);t.setRenderTarget(r)}}function ks(t,e,n){Number.isInteger(e)&&(e=n),oi.call(this,t,t,e)}function Ns(t){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function js(t,e,n){return(e=function(t){return"symbol"===Ns(t=function(t,e){if("object"!==Ns(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ns(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}os=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.ke=e,this.Tt=null,this.B=null,this.v=this.ke.x,this._=this.ke.y,this.et=this.ke.height,void 0===this.et&&(this.et=0),this.Je=null,this.$e=null,this.ti=null,this.ni=null,this.ei=new ds,this.ii=new Ei,this.ri=4,this.oi=9.5,this.ai=!0,this.si=null,void 0!==this.ke.flameSize&&(this.oi=this.ke.flameSize),this.hi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAgCAYAAAAbifjMAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5wEMBgInI5K8yQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAClUlEQVRIx5WVXW7bQAyEv11xJcuyY7QP7RXy0Jv3QjlEgaZJHHn/+8AV5ChNmgggYMDLITkz3DWT42cu3MYCpULlU9+dnEZuQ+bHJULIEPPnQOT7EeYET15jDgr0URD5doJLhN0MYsEawH8cRI4TjAl6B65TgFqheIjlAwDSQdeBvUrOBVKBEiD/pw3JHXSAszChySFrpAyX9P4oUioYC8aAczCNcErgI4TUAN8ZRULS2TurMTg4jgrgk3ZRAqQ32pDZQxZwoiqIgbGH0wghKkCuMMd/8yGPz5q8c9ALDI2TaYC0V4CU1aWXCNtp5P7cABrI2MNoFeQwaHIsWr0U8Bt/yONZJewbwNRDdLAXVeYwqL1jWse59oc8ebBWo+/AOwg9lEGTpYPjThUJSzdhHUV8bDICwUKMSl7JQFUu+gbyHJWHmFTaCkiuQFa0VFqbLdmgne2NcnQY4OxVkbgA1AqYRkxVtheWOqPVxSrReweja6MmPWvhJasViFUPnIOuuI/6Ry8NoHnGABajNmYDkipc8jp3LmqyoanTtRy75G4wKI2TkFT7XPSwsxrWLB288VV0xlSbEwuYqpVt69oAdiGtvgNU60ryos7S8SsSrz/TlOisHqzNzrWsoPatZIsy3Tebi9HEnNttVTYkbpOdhV0Hk8DYNrQkdWnM6xsivVEj1k3lUeCmh2MPewu2qJzzclO1BJlcW9VlOZrWhwZw46A3kJuxnqPuQV46+DqsAEv1pfW9wGB0sc4BHjw8tRcsLwW/9Fesm+Z7s7otJH25fnu4j/o7XckuYnTjzIbR5Z2cM5wjPCQ4tzXO1zfSH6+XxqJ7rasDQ7vCLgkuBXyBtPGN/Jq56+y6UC8sXHQHYtUor0139xfT44J2OsN7dwAAAABJRU5ErkJggg==",this.Qt=this.Qt.bind(this)}var e,n;return e=t,(n=[{key:"addTo",value:function(t){fengmap.FMMarkerFun.LAYER_CLASS.get(nn.FIRE_MARKER)||fengmap.FMMarkerFun.LAYER_CLASS.set(nn.FIRE_MARKER,rs),this.Z(t)}},{key:"remove",value:function(){this.Tt&&(this.stop(),this.Tt.scene.remove(this.Je),this.$e.Xe.destroy(),this.$e.Xe.particleMesh.geometry.dispose(),this.$e.Xe.particleMesh.material=void 0,this.$e.Xe.particleMesh.geometry=void 0,this.$e.Xe.particleMesh=void 0,this.Je.geometry.dispose(),this.Je.material.dispose(),this.Je.geometry=void 0,this.Je=void 0,this.B.off("update",this.Qt))}},{key:"stop",value:function(){this.ti&&(this.ei.Ot(this.ti),this.ti=null)}},{key:"moveTo",value:function(t){var e=this,n=t.duration||.5;t.animate?(this.ti||(this.ti=new cs),this.ti.ye([this.v,this._]),this.ti.xe([t.x,t.y]),this.ti.be(n).Ae(function(t){e.v=t.destination[0],e._=t.destination[1],e.li()}).Se(function(){e.v=t.x,e._=t.y,e.li(),t.finish&&t.finish()}),this.ei.Ct(this.ti._e())):(this.v=t.x,this._=t.y,this.li())}},{key:"x",get:function(){return this.v}},{key:"y",get:function(){return this._}},{key:"height",get:function(){return this.et},set:function(t){this.et=t,this.Je.position.y=this.et+2.5,this.$e.Xe.particleMesh.position.y=this.et+2.5,this.$e.Be.y=this.et+2.5,this.$e.Xe.positionBase.y=this.et+2.5,this.B.enableUpdateRender()}},{key:"flameSize",get:function(){return this.oi},set:function(t){this.oi=t,this.Je.material.uniforms.magnitude.value=10-t,this.B.enableUpdateRender()}},{key:"smokeDensity",get:function(){return void 0===this.ke.smokeDensity?30:this.ke.smokeDensity},set:function(t){this.ke.smokeDensity=t,this.$e.He=t,this.$e.createSmoke(),this.B.enableUpdateRender()}},{key:"level",get:function(){return this.ni}},{key:"type",get:function(){return nn.FIRE_MARKER}},{key:"visible",get:function(){return this.ai},set:function(t){this.ai!==t&&(this.ai=t,(this.Je.visible=t)?this.$e.createSmoke():this.$e.Xe.destroy())}},{key:"bound",get:function(){return null===this.si&&(this.si=new Cs,void 0!==this.v)&&void 0!==this._&&this.si.expandByCoords([{x:this.v,y:this._}]),this.si.clone()}}])&&Os(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(os.prototype,{Z:function(t){var e=this;this.B=t.parent.parent,this.ni=t.level,t=t.getOrCreateLayer(nn.FIRE_MARKER);this.Tt=t,(new Qe).load(this.hi,function(t){e.Je=new ms(t),e.Je.material.uniforms.magnitude.value=10-e.oi,e.Je.position.set(e.v-e.B.x,e.et+2.5,-e._+e.B.y),e.Je.scale.set(4,5,4),e.Tt.scene.add(e.Je),e.Je.isNoPickup=!0}),t={x:this.v-this.B.x,y:this.et+2.5,z:-this._+this.B.y,smokeDensity:this.ke.smokeDensity},this.$e=new _s(t),this.$e.init(this.Tt.scene),this.B.on("update",this.Qt)},Qt:function(){var t=this.ii.getElapsedTime()*this.ri;null!==this.Je&&this.Je.update(t),this.$e.update(),this.B.enableUpdateRender()},li:function(){this.Je.position.x=this.v-this.B.x,this.Je.position.z=-this._+this.B.y,this.$e.Xe.particleMesh.position.x=this.v-this.B.x,this.$e.Xe.particleMesh.position.z=-this._+this.B.y,this.$e.Be.x=this.v-this.B.x,this.$e.Be.z=-this._+this.B.y,this.$e.Xe.positionBase.x=this.v-this.B.x,this.$e.Xe.positionBase.z=-this._+this.B.y,this.B.enableUpdateRender()}}),((Ps.prototype=Object.create(De.prototype)).constructor=Ps).prototype.isDataTexture=!0,Us.prototype=Object.assign(Object.create(Re.prototype),{constructor:Us,load:function(t,e,n,i){var r=this,o=new Ps,s=new ae(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(t,function(t){(t=r.parse(t))&&(void 0!==t.image?o.image=t.image:void 0!==t.data&&(o.image.width=t.width,o.image.height=t.height,o.image.data=t.data),o.wrapS=void 0!==t.wrapS?t.wrapS:m,o.wrapT=void 0!==t.wrapT?t.wrapT:m,o.magFilter=void 0!==t.magFilter?t.magFilter:v,o.minFilter=void 0!==t.minFilter?t.minFilter:v,o.anisotropy=void 0!==t.anisotropy?t.anisotropy:1,void 0!==t.format&&(o.format=t.format),void 0!==t.type&&(o.type=t.type),void 0!==t.mipmaps&&(o.mipmaps=t.mipmaps,o.minFilter=1008),1===t.mipmapCount&&(o.minFilter=v),o.needsUpdate=!0,e)&&e(o,t)},n,i),o}}),Rs.prototype=Object.assign(Object.create(Us.prototype),{constructor:Rs,parse:function(t){var e,n,i=function(t,e,n){e=e||1024;for(var i=t.pos,r=-1,o=0,s="",a=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));(r=a.indexOf("\n"))<0&&o<e&&i<t.byteLength;)s+=a,o+=a.length,i+=128,a+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));return-1<r&&(!1!==n&&(t.pos+=o+r+1),s+a.slice(0,r))},r=(e=new Float32Array(1),n=new Int32Array(e.buffer),function(t,e,n,i){var r=t[e+3];r=Math.pow(2,r-128)/255;n[i+0]=o(t[e+0]*r),n[i+1]=o(t[e+1]*r),n[i+2]=o(t[e+2]*r)});function o(t){e[0]=t;var i=(t=n[0])>>16&32768,r=t>>12&2047,o=t>>23&255;if(!(o<103)){if(142<o)return 31744|i|((255==o?0:1)&&8388607&t);if(o<113)return i|((r|=2048)>>114-o)+(r>>113-o&1);i=(i|o-112<<10|r>>1)+(1&r)}return i}var s,a,A,l,u,h=((t=new Uint8Array(t)).pos=0,function(t){var e,n,r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,A={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(t.pos>=t.byteLength||!(e=i(t)))return-1;if(!(n=e.match(/^#\?(\S+)$/)))return-1;for(A.valid|=1,A.programtype=n[1],A.string+=e+"\n";!1!==(e=i(t));)if(A.string+=e+"\n","#"===e.charAt(0))A.comments+=e+"\n";else if((n=e.match(r))&&(A.gamma=parseFloat(n[1],10)),(n=e.match(o))&&(A.exposure=parseFloat(n[1],10)),(n=e.match(s))&&(A.valid|=2,A.format=n[1]),(n=e.match(a))&&(A.valid|=4,A.height=parseInt(n[1],10),A.width=parseInt(n[2],10)),2&A.valid&&4&A.valid)break;return 2&A.valid&&4&A.valid?A:-1}(t));if(-1!==h){var c=h.width,f=h.height,p=function(t,e,n){var i,r,o,s,a,A,l,u,h,c,f,p,d,y=e,m=n;if(y<8||32767<y||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(y!==(t[2]<<8|t[3]))return-1;if(!(i=new Uint8Array(4*e*n))||!i.length)return-1;for(o=r=0,u=4*y,d=new Uint8Array(4),A=new Uint8Array(u);0<m&&o<t.byteLength;){if(o+4>t.byteLength)return-1;if(d[0]=t[o++],d[1]=t[o++],d[2]=t[o++],d[3]=t[o++],2!=d[0]||2!=d[1]||(d[2]<<8|d[3])!=y)return-1;for(l=0;l<u&&o<t.byteLength;){if((p=128<(s=t[o++]))&&(s-=128),0===s||u<l+s)return-1;if(p)for(a=t[o++],h=0;h<s;h++)A[l++]=a;else A.set(t.subarray(o,o+s),l),l+=s,o+=s}for(c=y,h=0;h<c;h++)i[r]=A[h+(f=0)],f+=y,i[r+1]=A[h+f],f+=y,i[r+2]=A[h+f],f+=y,i[r+3]=A[h+f],r+=4;m--}return i}(t.subarray(t.pos),c,f);if(-1!==p){switch(this.type){case b:var d=p,y=1023,m=b;break;case 1015:for(var g=p.length/4*3,v=new Float32Array(g),w=0;w<g;w++)A=v,l=3*w,u=void 0,u=(s=p)[3+(a=4*w)],u=Math.pow(2,u-128)/255,A[l+0]=s[a+0]*u,A[l+1]=s[a+1]*u,A[l+2]=s[a+2]*u;d=v,y=x,m=1015;break;case 1016:g=p.length/4*3;var B=new Uint16Array(g);for(w=0;w<g;w++)r(p,4*w,B,3*w);d=B,y=x,m=1016}return{width:c,height:f,data:d,header:h.string,gamma:h.gamma,exposure:h.exposure,format:y,type:m}}}return null},setDataType:function(t){return this.type=t,this},load:function(t,e,n,i){return Us.prototype.load.call(this,t,function(t,n){switch(t.type){case b:t.encoding=3002,t.minFilter=g,t.magFilter=g,t.generateMipmaps=!1,t.flipY=!0;break;case 1015:case 1016:t.encoding=B,t.minFilter=v,t.magFilter=v,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,n)},n,i)}}),((Is.prototype=Object.create(De.prototype)).constructor=Is).prototype.isCubeTexture=!0,Object.defineProperty(Is.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),Ls.prototype=Object.assign(Object.create(Re.prototype),{constructor:Ls,load:function(t,e,n,i){for(var r=new Is,o=new Ie(this.manager),s=(o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),0),a=0;a<t.length;++a)!function(n){o.load(t[n],function(t){r.images[n]=t,6==++s&&(r.needsUpdate=!0,e)&&e(r)},void 0,i)}(a);return r}}),Ds.prototype=Object.assign(Object.create(Re.prototype),{constructor:Ds,load:function(t,e,n,i){Array.isArray(t)||(this.setDataType(t),t=e,e=n,n=i,i=arguments[4]);var r=new Is;switch(r.type=this.type,r.type){case b:r.encoding=3002,r.format=w,r.minFilter=g,r.magFilter=g,r.generateMipmaps=!1;break;case 1015:case 1016:r.encoding=B,r.format=x,r.minFilter=v,r.magFilter=v,r.generateMipmaps=!1}for(var o=this,s=0,a=0;a<t.length;a++)!function(e,n,i,a){new ae(o.manager).setPath(o.path).setResponseType("arraybuffer").load(t[e],function(t){s++,(t=o.hdrLoader.parse(t))&&(void 0!==t.data&&((t=new Ps(t.data,t.width,t.height)).type=r.type,t.encoding=r.encoding,t.format=r.format,t.minFilter=r.minFilter,t.magFilter=r.magFilter,t.generateMipmaps=r.generateMipmaps,r.images[e]=t),6===s)&&(r.needsUpdate=!0,n)&&n(r)},i,a)}(a,e,n,i);return r},setDataType:function(t){return this.type=t,this.hdrLoader.setDataType(t),this}}),(Qs.prototype=Object.create(Xt.prototype)).constructor=Qs,((ks.prototype=Object.create(oi.prototype)).constructor=ks).prototype.isWebGLCubeRenderTarget=!0,ks.prototype.fromEquirectangularTexture=function(t,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var n,i=new on;(n=new ve({type:"CubemapFromEquirect",uniforms:ue((n={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")}).uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:s,blending:A})).uniforms.tEquirect.value=e,e=new Xn(new tr(5,5,5),n);return(n=(i.add(e),new Qs(1,10,1))).renderTarget=this,n.renderTarget.texture.name="CubeCameraTexture",n.update(t,i),e.geometry.dispose(),e.material.dispose(),this};var Hs=4,zs=8,Vs=Math.pow(2,zs),Gs=[.125,.215,.35,.446,.526,.582],Ys=zs-Hs+1+Gs.length,Ks=20,Xs=js(js(js(js(js(js(js({},B,0),3001,1),3002,2),3004,3),3005,4),3006,5),3007,6),Ws=new fn,Zs=((aa=new be({defines:{n:aa=Ks},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:$s=new Float32Array(aa)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:sa=new V(0,1,0)},inputEncoding:{value:Xs[B]},outputEncoding:{value:Xs[B]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvec3 getSample(float theta, vec3 axis) {\n\tfloat cosTheta = cos(theta);\n\t// Rodrigues' axis-angle rotation\n\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\treturn bilinearCubeUV(envMap, sampleDirection, mipInt);\n}\n\nvoid main() {\n\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\tif (all(equal(axis, vec3(0.0))))\n\t\taxis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);\n\taxis = normalize(axis);\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb += weights[0] * getSample(0.0, axis);\n\tfor (int i = 1; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfloat theta = dTheta * float(i);\n\t\tgl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);\n\t\tgl_FragColor.rgb += weights[i] * getSample(theta, axis);\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:A,depthTest:!1,depthWrite:!1})).type="SphericalGaussianBlur",aa),qs=null,Js=null,$s=function(){for(var t=[],e=[],n=[],i=zs,r=0;r<Ys;r++){for(var o=Math.pow(2,i),s=(e.push(o),1/o),a=[o=-(s=(zs-Hs<r?s=Gs[r-zs+Hs-1]:0==r&&(s=0),n.push(s),1/(o-1)))/2,o,s=1+s/2,o,s,s,o,o,s,s,o,s],A=new Float32Array(108),l=new Float32Array(72),u=new Float32Array(36),h=0;h<6;h++){var c=[c=h%3*2/3-1,f=2<h?0:-1,0,c+2/3,f,0,c+2/3,1+f,0,c,f,0,c+2/3,1+f,0,c,1+f,0],f=(A.set(c,18*h),l.set(a,12*h),[h,h,h,h,h,h]);u.set(f,6*h)}(o=new ne).setAttribute("position",new lt(A,3)),o.setAttribute("uv",new lt(l,2)),o.setAttribute("faceIndex",new lt(u,1)),t.push(o),Hs<i&&i--}return{ui:t,ci:e,fi:n}}(),ta=$s.ui,ea=$s.ci,na=$s.fi,ia=null,ra=null,oa=null,sa=(1+Math.sqrt(5))/2,aa=1/sa,Aa=[new V(1,1,1),new V(-1,1,1),new V(1,1,-1),new V(-1,1,-1),new V(0,sa,aa),new V(0,sa,-aa),new V(aa,0,sa),new V(-aa,0,sa),new V(sa,aa,0),new V(-sa,aa,0)];function la(t){ra=t,ca(Zs)}function ua(t){var e={magFilter:g,minFilter:g,generateMipmaps:!1,type:t?t.type:b,format:t?t.format:1023,encoding:t?t.encoding:3002,depthBuffer:!1,stencilBuffer:!1},n=fa(e);return n.depthBuffer=!t,ia=fa(e),n}function ha(t){ia.dispose(),ra.setRenderTarget(oa),t.scissorTest=!1,t.setSize(t.width,t.height)}function ca(t){var e=new on;e.add(new Xn(ta[0],t)),ra.compile(e,Ws)}function fa(t){return(t=new oi(3*Vs,3*Vs,t)).texture.mapping=d,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function pa(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function da(t){var e=ra.autoClear;ra.autoClear=!1;for(var n=1;n<Ys;n++)ya(t,n-1,n,Math.sqrt(na[n]*na[n]-na[n-1]*na[n-1]),Aa[(n-1)%Aa.length]);ra.autoClear=e}function ya(t,e,n,i,r){ma(t,ia,e,n,i,"latitudinal",r),ma(ia,t,n,n,i,"longitudinal",r)}function ma(t,e,n,i,r,o,s){for(var a=new on,A=(a.add(new Xn(ta[i],Zs)),Zs.uniforms),l=ea[n]-1,u=r/(l=isFinite(r)?Math.PI/(2*l):2*Math.PI/(2*Ks-1)),h=isFinite(r)?1+Math.floor(3*u):Ks,c=[],f=0,p=0;p<Ks;++p){var d=p/u,y=Math.exp(-d*d/2);c.push(y),0==p?f+=y:p<h&&(f+=2*y)}for(p=0;p<c.length;p++)c[p]=c[p]/f;A.envMap.value=t.texture,A.samples.value=h,A.weights.value=c,A.latitudinal.value="latitudinal"===o,s&&(A.poleAxis.value=s),A.dTheta.value=l,A.mipInt.value=zs-n,A.inputEncoding.value=Xs[t.texture.encoding],A.outputEncoding.value=Xs[t.texture.encoding],r=ea[i],pa(e,d=3*Math.max(0,Vs-2*r),(0===i?0:2*Vs)+2*r*(zs-Hs<i?i-zs+Hs:0),3*r,2*r),ra.setRenderTarget(e),ra.render(a,Ws)}function ga(){var t=new be({uniforms:{envMap:{value:null},texelSize:{value:new at(1,1)},inputEncoding:{value:Xs[B]},outputEncoding:{value:Xs[B]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:A,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function va(){var t=new be({uniforms:{envMap:{value:null},inputEncoding:{value:Xs[B]},outputEncoding:{value:Xs[B]}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n".concat("\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t","\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t"),blending:A,depthTest:!1,depthWrite:!1});return t.type="CubemapToCubeUV",t}la.prototype={constructor:la,fromScene:function(t){var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:.1,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:100,o=(oa=ra.getRenderTarget(),ua()),s=t,a=o,A=new Ar(90,1,t=i,i=r),l=[1,1,1,1,-1,1],u=[1,1,-1,-1,-1,1],h=(t=ra.outputEncoding,i=ra.toneMapping,r=ra.toneMappingExposure,ra.getClearColor()),c=ra.getClearAlpha(),f=(ra.toneMapping=1,ra.toneMappingExposure=1,ra.outputEncoding=B,s.scale.z*=-1,s.background);f&&f.isColor&&(f.convertSRGBToLinear(),e=Math.max(f.r,f.g,f.b),e=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127),f=f.multiplyScalar(Math.pow(2,-e)),e=(e+128)/255,ra.setClearColor(f,e),s.background=null);for(var p=0;p<6;p++){var d=p%3;0==d?(A.up.set(0,l[p],0),A.lookAt(u[p],0,0)):1==d?(A.up.set(0,0,l[p]),A.lookAt(0,u[p],0)):(A.up.set(0,l[p],0),A.lookAt(0,0,u[p])),pa(a,d*Vs,2<p?Vs:0,Vs,Vs),ra.setRenderTarget(a),ra.render(s,A)}return ra.toneMapping=i,ra.toneMappingExposure=r,ra.outputEncoding=t,ra.setClearColor(h,c),s.scale.z*=-1,0<n&&ya(o,0,0,n),da(o),ha(o),o},fromEquirectangular:function(t){return t.magFilter=g,t.minFilter=g,t.generateMipmaps=!1,this.fromCubemap(t)},fromCubemap:function(t){oa=ra.getRenderTarget();var e=ua(t),n=e,i=new on,r=(t.isCubeTexture?null==Js&&(Js=va()):null==qs&&(qs=ga()),t.isCubeTexture?Js:qs);return i.add(new Xn(ta[0],r)),((r=r.uniforms).envMap.value=t).isCubeTexture||r.texelSize.value.set(1/t.image.width,1/t.image.height),r.inputEncoding.value=Xs[t.encoding],r.outputEncoding.value=Xs[t.encoding],pa(n,0,0,3*Vs,2*Vs),ra.setRenderTarget(n),ra.render(i,Ws),da(e),ha(e),e},compileCubemapShader:function(){null==Js&&ca(Js=va())},compileEquirectangularShader:function(){null==qs&&ca(qs=ga())},dispose:function(){Zs.dispose(),null!=Js&&Js.dispose(),null!=qs&&qs.dispose();for(var t=0;t<ta.length;t++)ta[t].dispose()}};var ba={basic:{uniforms:he([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.fog]),vertexShader:ar.meshbasic_vert,fragmentShader:ar.meshbasic_frag},lambert:{uniforms:he([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.fog,sr.lights,{emissive:{value:new L(0)}}]),vertexShader:ar.meshlambert_vert,fragmentShader:ar.meshlambert_frag},phong:{uniforms:he([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,sr.lights,{emissive:{value:new L(0)},specular:{value:new L(1118481)},shininess:{value:30}}]),vertexShader:ar.meshphong_vert,fragmentShader:ar.meshphong_frag},standard:{uniforms:he([sr.common,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.roughnessmap,sr.metalnessmap,sr.fog,sr.lights,{emissive:{value:new L(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ar.meshphysical_vert,fragmentShader:ar.meshphysical_frag},toon:{uniforms:he([sr.common,sr.specularmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.gradientmap,sr.fog,sr.lights,{emissive:{value:new L(0)},specular:{value:new L(1118481)},shininess:{value:30}}]),vertexShader:ar.meshtoon_vert,fragmentShader:ar.meshtoon_frag},matcap:{uniforms:he([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,{matcap:{value:null}}]),vertexShader:ar.meshmatcap_vert,fragmentShader:ar.meshmatcap_frag},points:{uniforms:he([sr.points,sr.fog]),vertexShader:ar.points_vert,fragmentShader:ar.points_frag},dashed:{uniforms:he([sr.common,sr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ar.linedashed_vert,fragmentShader:ar.linedashed_frag},depth:{uniforms:he([sr.common,sr.displacementmap]),vertexShader:ar.depth_vert,fragmentShader:ar.depth_frag},normal:{uniforms:he([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,{opacity:{value:1}}]),vertexShader:ar.normal_vert,fragmentShader:ar.normal_frag},sprite:{uniforms:he([sr.sprite,sr.fog]),vertexShader:ar.sprite_vert,fragmentShader:ar.sprite_frag},background:{uniforms:{uvTransform:{value:new Rt},t2D:{value:null}},vertexShader:ar.background_vert,fragmentShader:ar.background_frag},cube:{uniforms:he([sr.envmap,{opacity:{value:1}}]),vertexShader:ar.cube_vert,fragmentShader:ar.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ar.equirect_vert,fragmentShader:ar.equirect_frag},distanceRGBA:{uniforms:he([sr.common,sr.displacementmap,{referencePosition:{value:new V},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ar.distanceRGBA_vert,fragmentShader:ar.distanceRGBA_frag},shadow:{uniforms:he([sr.lights,sr.fog,{color:{value:new L(0)},opacity:{value:1}}]),vertexShader:ar.shadow_vert,fragmentShader:ar.shadow_frag}};function xa(t){return(xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===xa(t=function(t,e){if("object"!==xa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==xa(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ba.physical={uniforms:he([ba.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new at(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new L(0)},transparency:{value:0}}]),vertexShader:ar.meshphysical_vert,fragmentShader:ar.meshphysical_frag};var Ba=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var e=ue(ba.cube.uniforms);e.projectionMatrixFixZoom={value:[]},this.boxMesh=new Xn(new tr(1,1,1),new ve({type:"BackgroundCubeMaterial",uniforms:e,vertexShader:"varying vec3 vWorldDirection;\n    #include <common>\n    // zoom,\n    uniform mat4 projectionMatrixFixZoom;\n    void main() {\n\n      vWorldDirection = transformDirection( position, modelMatrix );\n\n      #include <begin_vertex>\n      #include <project_vertex>\n\n      if (isPerspectiveMatrix(projectionMatrix)) {\n        gl_Position = projectionMatrix * mvPosition;\n      } else {\n        gl_Position = projectionMatrixFixZoom * mvPosition;\n      }\n      gl_Position.z = gl_Position.w; // set z to camera.far\n    }",fragmentShader:"\n      #include <envmap_common_pars_fragment>\n      uniform float opacity;\n      varying vec3 vWorldDirection;\n      #include <cube_uv_reflection_fragment>\n      void main() {\n        vec3 vReflect = vWorldDirection;\n        #include <envmap_fragment>\n        gl_FragColor = envColor;\n        gl_FragColor.a *= opacity;\n\n        #include <tonemapping_fragment>\n        #include <encodings_fragment>\n      }",side:s,depthTest:!1,depthWrite:!1,fog:!1})),this.boxMesh.frustumCulled=!1,this.boxMesh.geometry.deleteAttribute("normal"),this.boxMesh.geometry.deleteAttribute("uv"),this.boxMesh.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(this.boxMesh.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),this.tempMatix=new Ct}var e,n;return e=t,(n=[{key:"setTexture",value:function(t){this.boxMesh.material.uniforms.envMap.value=t,this.boxMesh.material.uniforms.flipEnvMap.value=t.isCubeTexture?-1:1,this.boxMesh.material.needsUpdate=!0,this.Jn=t}},{key:"setOrthographicScale",value:function(t,e){var n;"OrthographicCamera"===t.type&&(n=t.zoom,t.zoom=e,t.updateProjectionMatrix(),this.tempMatix.copy(t.projectionMatrix),this.boxMesh.material.uniforms.projectionMatrixFixZoom.value=this.tempMatix,t.zoom=n,t.updateProjectionMatrix())}}])&&wa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ma(t,e,n){return(e=Ea(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sa(t){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Ea(i.key),i)}}function Ea(t){return"symbol"===Sa(t=function(t,e){if("object"!==Sa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Sa(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}function Ta(t){return(Ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ca(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ta(t=function(t,e){if("object"!==Ta(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ta(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(Ba.prototype,{jt:function(){this.tempMatix=null,this.boxMesh&&(this.boxMesh.geometry.dispose(),this.boxMesh.material.dispose(),this.Jn&&this.Jn.dispose(),this.boxMesh=null)}}),$s=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.SkyBoxType={cube6HDR:0,cube6Normal:1,cube1HDR:2,cube1Normal:3},this.B=e,this.di=!0,this.vi=1,this.mi=2e3,this.pi=!1,this.O=null,this.gi=null,this._i=[],this.yi=!1,this.xi=null,this.bi=null,this.wi=this.Ai(),this.Si=this.Ti(),"basic"===this.B.getRenderManager().type&&this.B.setRenderManager(new ln)}var e,n;return e=t,(n=[{key:"isHDR",get:function(){return this.yi}},{key:"exposure",get:function(){return this.vi},set:function(t){this.vi=t}},{key:"imagePath",get:function(){return this.gi},set:function(t){this.gi=t}},{key:"scale",get:function(){return this.mi},set:function(t){this.mi=t}},{key:"imageNames",get:function(){return this._i},set:function(t){var e=(e=t[0]).slice(e.match(/(?=\.)/).index+1).toLocaleLowerCase();this.yi="hdr"===e,this._i=t}},{key:"enable",value:function(){this.di=!0,(this.B.getRenderManager().skyNeedTexture=this).B.enableUpdateNode()}},{key:"disable",value:function(){this.di=!1,this.B.getRenderManager().skyNeedTexture=null,this.B.enableUpdateNode()}},{key:"render",value:function(){this.F(this.B.getRenderManager().renderer,this.B.camera)}},{key:"setState",value:function(t){var e=t.imagePath,n=t.imageNames,i=(t.enable,t.exposure);t=t.scale;e&&(this.imagePath=e),n&&(this.imageNames=n),(e||n)&&this.Mi(),void 0!==i&&(this.exposure=i),void 0!==t&&(this.scale=t),this.B.enableUpdateNode()}},{key:"getState",value:function(){return{exposure:this.vi,imageNames:this._i,imagePath:this.gi,scale:this.mi}}},{key:"dispose",value:function(){this.disable(),this.xi&&this.xi.jt(),this.gi=null,this._i=[],this.xi=null,this.wi=null,this.Si=null,this.pi=!1}}])&&_a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign($s.prototype,{Ai:function(){var t=this;return Ma(Ma(Ma(Ma({},this.SkyBoxType.cube6HDR,function(e){e.toneMappingExposure=t.exposure,e.toneMapping=1,e.outputEncoding=3001}),this.SkyBoxType.cube6Normal,function(t){}),this.SkyBoxType.cube1HDR,function(e){e.toneMappingExposure=t.exposure,e.toneMapping=5,e.outputEncoding=3001}),this.SkyBoxType.cube1Normal,function(t){})},Ti:function(){var t=this;return Ma(Ma(Ma(Ma({},this.SkyBoxType.cube6HDR,function(){(new Ds).setPath(t.gi).setDataType(b).load(t._i,function(e){e.magFilter=v,e.needsUpdate=!0,t.Ei(e),t.pi=!0})}),this.SkyBoxType.cube6Normal,function(){var e=[];t.imageNames.forEach(function(n){e.push(t.gi+n)}),(new Ls).load(e,function(e){e.mapping=301,t.Ei(e),t.pi=!0})}),this.SkyBoxType.cube1HDR,function(){var e=new la(t.B.getRenderManager().renderer);e.compileEquirectangularShader(),(new Rs).setPath(t.gi).load(t._i[0],function(n){var i=e.fromEquirectangular(n);n.dispose(),e.dispose(),t.Ei(i.texture),t.pi=!0})}),this.SkyBoxType.cube1Normal,function(){(new Qe).load(t.gi+t._i[0],function(e){e.mapping=300,e=new ks(1024,{generateMipmaps:!0,minFilter:1008,magFilter:v}).fromEquirectangularTexture(t.B.getRenderManager().renderer,e),t.Ei(e),t.pi=!0})})},Ei:function(t){this.xi&&this.xi.jt(),this.xi=new Ba,this.xi.setTexture(t),0<this.O.children.length&&this.O.remove(this.O.children[0]),this.O.add(this.xi.boxMesh),this.B.enableUpdateNode()},F:function(t,e){var n,i,r,o;this.di&&this.pi&&(n=t.toneMappingExposure,i=t.toneMapping,r=t.outputEncoding,this.xi&&this.xi.setOrthographicScale(e,this.mi),(o=this.wi[this.bi])&&o(t),t.render(this.O,e),t.toneMappingExposure=n,t.toneMapping=i,t.outputEncoding=r)},Mi:function(){null!==this.gi&&0!==this._i.length&&null!=this.Si&&(this.O||(this.O=new on),this.bi=null,6===this.imageNames.length&&this.isHDR&&(this.bi=this.SkyBoxType.cube6HDR),6===this.imageNames.length&&!1===this.isHDR&&(this.bi=this.SkyBoxType.cube6Normal),1===this.imageNames.length&&this.isHDR&&(this.bi=this.SkyBoxType.cube1HDR),1===this.imageNames.length&&!1===this.isHDR&&(this.bi=this.SkyBoxType.cube1Normal),null===this.bi||this.Si[this.bi]())}}),sa=$s;aa=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.url=e.url}var e,n;return e=t,(n=[{key:"load",value:function(t,e){(new Rs).setDataType(b).load(this.url,function(n){var i=((i=new la(t.getRenderManager().renderer)).compileEquirectangularShader(),i.fromEquirectangular(n).texture);e&&e(i)})}}])&&Ca(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Fa(t){return(Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Fa(t=function(t,e){if("object"!==Fa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Fa(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var Pa=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Kt=e.Kt,this.G=n.url,this.Y=n.count,this.Pi=e.Pi,this.Ht=e.Ht,null==this.Ht&&(this.Ht=0),void(this.Li=0)!==e.Li&&"y"===e.Li&&(this.Li=1),0===this.Li&&(this.Ht=this.Ht/this.Y),void 0===this.Pi&&(this.Pi=1),this.Fi=null,this.Ni=null,this.Di="\n            #include <common>\n            #include <logdepthbuf_pars_vertex>\n            varying vec2 vUv;\n            varying vec3 fNormal;\n            varying vec3 vPosition;\n            void main(){\n                    vUv = uv;\n                    vPosition = position;\n                    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n                    gl_Position = projectionMatrix * mvPosition;\n                    #include <logdepthbuf_vertex>\n            }\n        ",this.Ci="\n            uniform float time;\n            uniform float luminance;\n            uniform float repeat;\n            varying vec2 vUv;\n            uniform sampler2D flowTexturefront;\n            uniform sampler2D flowTextureback;\n            uniform sampler2D bgTexture;\n            uniform float direct;\n            uniform float isBgColor;\n            #include <logdepthbuf_pars_fragment>\n            void main( void ) {\n                #include <logdepthbuf_fragment>\n                vec2 position = vUv;\n                if(direct==1.0){\n                    vec4 colora = texture2D( flowTextureback, vec2( vUv.x*repeat, fract(vUv.y + time )));\n                    if(vUv.y>0.5){\n                        colora = texture2D( flowTexturefront, vec2( vUv.x*repeat, fract(vUv.y - time )));\n                    }\n                    if(isBgColor==1.0){\n                        vec4 colorb = texture2D( bgTexture , position.xy);\n                        colora.r = colora.r * colorb.a * luminance;\n                        colora.g = colora.g * colorb.a * luminance;\n                        colora.b = colora.b * colorb.a * luminance;\n\n                        colorb.r = colorb.r * colorb.a * luminance;\n                        colorb.g = colorb.g * colorb.a * luminance;\n                        colorb.b = colorb.b * colorb.a * luminance;\n\n                        gl_FragColor = colorb + colora;  \n                    } else {\n                        gl_FragColor = colora; \n                    }             \n                } else {\n                    vec4 colora = texture2D( flowTextureback, vec2( fract( vUv.x - time )*repeat, vUv.y));\n                    if(vUv.y>0.5){\n                        colora = texture2D( flowTexturefront, vec2( fract( vUv.x - time )*repeat, vUv.y));\n                    }\n                    if(isBgColor==1.0){\n                        vec4 colorb = texture2D( bgTexture , position.xy);\n                    \n                        colora.r = colora.r * colorb.a* luminance;\n                        colora.g = colora.g * colorb.a* luminance;\n                        colora.b = colora.b * colorb.a* luminance;\n\n                        colorb.r = colorb.r * colorb.a * luminance;\n                        colorb.g = colorb.g * colorb.a * luminance;\n                        colorb.b = colorb.b * colorb.a * luminance;\n                        gl_FragColor = colorb + colora;\n                    } else {\n                        colora.r = colora.r * colora.a * luminance;\n                        colora.g = colora.g * colora.a * luminance;\n                        colora.b = colora.b * colora.a * luminance;\n                        gl_FragColor = colora; \n                    }        \n                }\n            }\n        "}var e,n;return e=t,(n=[{key:"init",value:function(t){var e=this,n=this;function i(t){var e=document.createElement("canvas"),n=(e.width=t.width,e.height=t.height,e.getContext("2d"));return n.translate(e.width,0),n.scale(-1,1),n.drawImage(t,0,0,e.width,e.height),e}function r(t,e){if(!t){for(var i=function(t){var e=n.Kt.toLowerCase();if(e&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){for(var i="#",r=1;r<4;r+=1)i+=e.slice(r,r+1).concat(e.slice(r,r+1));e=i}var o=[];for(r=1;r<7;r+=2)o.push(parseInt("0x"+e.slice(r,r+2)));return o}return e}(),r=document.createElement("canvas"),o=(r.width=1024,r.height=2048,r.getContext("2d")),s=o.createLinearGradient(0,0,0,1024),a=.3,A=0;A<=1e3;A++)s.addColorStop(A/1e3,"rgba("+i[0]+", "+i[1]+","+i[2]+", "+a+")"),a+=7e-4;o.fillStyle=s,o.fillRect(0,0,1024,1024);s=o.createLinearGradient(0,1024,0,2048),a=1;for(var l=0;l<=1e3;l++)s.addColorStop(l/1e3,"rgba("+i[0]+", "+i[1]+","+i[2]+", "+a+")"),a-=7e-4;return o.fillStyle=s,o.fillRect(0,1024,1024,1024),r}var u=new Image;u.crossOrigin="Anonymous",u.onload=function(){var t=document.createElement("canvas"),n=(t.width=512,t.height=512,t.getContext("2d"));n.drawImage(u,0,0,512,256),n.drawImage(u,0,256,512,256),e&&e(t)},u.src=t}r(this.G,function(n){e.Fi=new oo(i(n)),e.Fi.wrapS=e.Fi.wrapT=y,e.Ni=new oo(i((n=n,(a=document.createElement("canvas")).width=512,a.height=512,(s=a.getContext("2d")).translate(256,256),s.rotate(Math.PI),s.drawImage(n,-256,-256),i(a)))),e.Ni.wrapS=e.Ni.wrapT=y;var s=null,a=(n=0,void 0!==e.Kt&&(s=new oo(r()),n=1),new ve({uniforms:{time:{value:0},luminance:{value:e.Pi},flowTexturefront:{value:e.Fi},flowTextureback:{value:e.Ni},bgTexture:{value:s},isBgColor:{value:n},direct:{value:e.Li},repeat:{value:e.Y}},transparent:!0,depthWrite:!0,depthTest:!0,side:o,vertexShader:e.Di,fragmentShader:e.Ci}));t(a)})}}])&&Oa(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ua(t){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ra(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ua(t=function(t,e){if("object"!==Ua(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ua(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var Ia=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Kt=e.Kt,this.G=n.url,this.Y=n.count,this.Pi=e.Pi,this.Ht=e.Ht,this.Ht=this.Ht/this.Y,this.Jn=null,this.Di="\n            #include <common>\n            #include <logdepthbuf_pars_vertex>\n            varying vec2 vUv;\n            void main(){\n                    vUv = uv;\n                    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n                    gl_Position = projectionMatrix * mvPosition;\n                    #include <logdepthbuf_vertex>\n            }\n        ",this.Ci="\n            uniform float time;\n            uniform float luminance;\n            uniform float repeat;\n            varying vec2 vUv;\n            uniform sampler2D texture;\n            uniform sampler2D background;\n            uniform bool isbackground;\n            #include <logdepthbuf_pars_fragment>\n            void main( void ) {\n                #include <logdepthbuf_fragment>\n                vec4 backcolor=texture2D(background,vUv);\n                vec4 colora = texture2D( texture, vec2(fract( vUv.x + time )*repeat, vUv.y));\n                colora.r = colora.r * colora.a * luminance;\n                colora.g = colora.g * colora.a * luminance;\n                colora.b = colora.b * colora.a * luminance;\n                if(isbackground){\n                    gl_FragColor = vec4(vec3(mix(colora,backcolor,1.0-colora.a)),1.0); \n                } else {\n                    gl_FragColor = colora; \n                }            \n            }\n        "}var e,n;return e=t,(n=[{key:"init",value:function(t){var e,n,i,r=this,o=this;e=this.G,n=function(e){r.Jn=new oo(e);e=null;var n=!(r.Jn.wrapS=r.Jn.wrapT=y);void 0!==r.Kt&&(e=new oo(o.getBackgroundCanvas()),n=!0),e=new ve({uniforms:{time:{value:0},luminance:{value:r.Pi},texture:{value:r.Jn},background:{value:e},isbackground:{value:n},repeat:{value:r.Y}},transparent:!0,depthWrite:!0,depthTest:!0,side:a,vertexShader:r.Di,fragmentShader:r.Ci});t(e)},(i=new Image).crossOrigin="Anonymous",i.onload=function(){var t=document.createElement("canvas"),e=(t.width=512,t.height=512,t.getContext("2d"));e.drawImage(i,0,0,i.width,i.height/2,0,256,512,256),e.drawImage(i,0,i.height/2,i.width,i.height/2,0,0,512,256),n&&n(t)},i.src=e}},{key:"getBackgroundCanvas",value:function(){var t=document.createElement("canvas"),e=(t.width=128,t.height=128,t.getContext("2d"));return e.rect(0,0,128,128),e.fillStyle=new L(this.Kt).getStyle(),e.fill(),t}}])&&Ra(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function La(t){return(La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Da(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===La(t=function(t,e){if("object"!==La(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==La(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Qa(t){return(Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ka(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Qa(t=function(t,e){if("object"!==Qa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Qa(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}$s=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Ri="FMFlowEffect",this.Ii=null,this.Oi=null,this.Kt=e.color,this.G=e.url,this.Y=e.count,this.Pi=e.strength,this.Ht=e.speed,null==this.Ht&&(this.Ht=0),this.Li=e.direct,void 0===this.Li&&(this.Li="x")}var e,n;return e=t,(n=[{key:"type",get:function(){return this.Ri}},{key:"direct",get:function(){return this.Li},set:function(t){this.Li=t}},{key:"speed",get:function(){return this.Ht},set:function(t){this.Ht=t}},{key:"add",value:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].addEffect(this,this.Pi,this.Kt);else t.addEffect(this,this.Pi,this.Kt)}},{key:"remove",value:function(t){t.removeEffect(this)}},{key:"update",value:function(t){var e=t.getRenderNode().material,n=0,i=(1===(n=void 0!==this.Li&&"y"===this.Li?1:n)&&t.type!==fengmap.FMType.WALL_MARKER&&(n=0),e.uniforms.direct&&e.uniforms.direct.value!==n&&(e.uniforms.direct.value=n),e.uniforms.repeat&&e.uniforms.repeat.value!==t.count&&(e.uniforms.repeat.value=t.count),this.Ht);0===n&&(i=this.Ht/t.count),e.uniforms.time.value+=i/1e3}},{key:"getMaterial",value:function(t,e){t.type===fengmap.FMType.WALL_MARKER?new Pa(this,t).init(function(t){e(t)}):t.type===fengmap.FMType.TUBE_MARKER&&new Ia(this,t).init(function(t){e(t)})}}])&&Da(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Na=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Ri="FMDiffusion",this.Kt=e.color,this.Ui=e.maxScale,void 0===this.Ui&&(this.Ui=10),this.Ht=e.speed,void 0===this.Ht&&(this.Ht=1),this.ji=!1,void 0!==this.Kt&&(this.ji=!0),this.Di="\n            #include <common>\n            #include <logdepthbuf_pars_vertex>\n            varying vec3 vPosition;\n            varying vec3 vNormal;\n            varying vec2 vUv;\n            \n            void main() {\n            \n                vPosition =  vec3(modelMatrix * vec4( position, 1.0 ));\n                vNormal =  normal;\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n                #include <logdepthbuf_vertex>\n                \n            }\n        ",this.Ci="\n            varying vec3 vPosition;\n            varying vec3 vNormal;\n            varying vec2 vUv;\n            \n            uniform vec3 color;\n            uniform bool iscolor;\n            uniform float opacity;\n            uniform bool isTexture;\n            uniform sampler2D texture;\n            #include <logdepthbuf_pars_fragment>\n            \n            void main() {\n                #include <logdepthbuf_fragment>\n\n                vec3 viewDir = normalize(cameraPosition - vPosition);\n                \n                float res = max(dot(viewDir,vNormal),0.20);\n            \n                float alpha = (1.0 - res);\n            \n                alpha *= alpha;\n                if(!isTexture){\n                    gl_FragColor = 3.0*vec4(color, alpha * opacity);\n                } else {\n                    vec4 tex = texture2D( texture, vUv );\n                    if(!iscolor){\n                        gl_FragColor = 3.0*vec4(tex.rgb, alpha * opacity*tex.a);\n                    } else {\n                        gl_FragColor = 3.0*vec4(tex.rgb+color, alpha * opacity*tex.a);\n                    }\n                }\n            }\n        "}var e,n;return e=t,(n=[{key:"type",get:function(){return this.Ri}},{key:"maxScale",get:function(){return this.Ui},set:function(t){this.Ui=t}},{key:"speed",get:function(){return this.Ht},set:function(t){this.Ht=t}},{key:"getMaterial",value:function(t,e){var n,i,r,o=this;void 0!==t.url?(n=t.url,i=function(t){t=new oo(t),t=new ve({uniforms:{color:{value:new L(o.Kt)},opacity:{value:1},texture:{value:t},isTexture:{value:!0},iscolor:{value:o.ji}},transparent:!0,depthTest:!0,depthWrite:!1,vertexShader:o.Di,fragmentShader:o.Ci}),e(t)},(r=new Image).crossOrigin="Anonymous",r.onload=function(){var t=document.createElement("canvas");t.width=512,t.height=512,t.getContext("2d").drawImage(r,0,0,512,512),i&&i(t)},r.src=n):(t=new ve({uniforms:{color:{value:new L(n=void 0===(n=this.Kt)?t.color:n)},opacity:{value:1},texture:{value:null},isTexture:{value:!1},iscolor:{value:!0}},transparent:!0,depthTest:!0,depthWrite:!1,vertexShader:this.Di,fragmentShader:this.Ci}),e(t))}},{key:"add",value:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)t[e].addEffect(this);else t.addEffect(this)}},{key:"remove",value:function(t){t.removeEffect(this)}},{key:"update",value:function(t){var e=this.Ht/60;t.scale.x+=e,t.scale.y+=e,t.scale.z+=e,t.scale.x>this.Ui-.4*this.Ui&&(t.material.uniforms.opacity.value-=.005),t.scale.x>this.Ui&&(t.scale.x=.1,t.scale.y=.1,t.scale.z=.1,t.material.uniforms.opacity.value=.8)}}])&&ka(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ja(t){return(ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ha(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ja(t=function(t,e){if("object"!==ja(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ja(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var za=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.B=e,this.U=(n=void 0===n?{}:n).color,void 0===this.U&&(this.U="#CCE0FF"),this.j=n.density,void 0===this.j&&(this.j=25e-5),this.Hn=!1,this.Qt=this.Qt.bind(this)}var e,n;return e=t,(n=[{key:"color",get:function(){return this.U},set:function(t){if(this.U=t,this.Hn){for(var e=this.B.getVisibleLevels(),n=0;n<e.length;n++)for(var i=this.B.getFloor(e[n]).getLayers(fengmap.FMType.EXTENT_LAYER|fengmap.FMType.MODEL_LAYER|fengmap.FMType.EXTERNAL_MODEL_LAYER),r=0;r<i.length;r++)i[r].scene.fog?i[r].scene.fog.color=new L(this.U):i[r].scene.fog=new rn(new L(this.U),this.j),0===n&&i[r].type===fengmap.FMType.EXTENT_LAYER&&(i[r].scene.background=new L(this.U));this.B.enableUpdateRender()}}},{key:"density",get:function(){return this.j},set:function(t){if(this.j=t,this.Hn){for(var e=this.B.getVisibleLevels(),n=0;n<e.length;n++)for(var i=this.B.getFloor(e[n]).getLayers(fengmap.FMType.EXTENT_LAYER|fengmap.FMType.MODEL_LAYER|fengmap.FMType.EXTERNAL_MODEL_LAYER),r=0;r<i.length;r++)i[r].scene.fog?i[r].scene.fog.density=this.j:i[r].scene.fog=new rn(new L(this.U),this.j);this.B.enableUpdateRender()}}},{key:"enable",value:function(){this.Hn=!0,this.di(this.Hn),this.B.on("update",this.Qt)}},{key:"disable",value:function(){this.Hn=!1,this.di(this.Hn),this.B.off("update",this.Qt),this.ki(!1)}}])&&Ha(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();Object.assign(za.prototype,{di:function(t){for(var e,n,i,r,o,s,a=this,A=this,l=this.B.getRenderManager(),u=("basic"===l.type&&this.B.setRenderManager(new ln),t?(l.fogEffect=this,e=function(t){t=new oo(t),l.fristRenderScene.fog=new rn(new L(a.U),a.j),l.fristRenderScene.background=t},""===(n=A.B.getMapOptions().container.style.backgroundImage)?((i=document.createElement("canvas")).height=1024,i.width=1024,r=i.getContext("2d"),""!==(o=A.B.getMapOptions().container.style.backgroundColor)&&(r.fillStyle=o,r.fillRect(0,0,i.width,i.height)),r.globalAlpha=.8,r.fillStyle=A.U,r.fillRect(0,0,i.width,i.height),e&&e(i)):(n=(n=n.substring(n.indexOf("(")+1,n.indexOf(")"))).replaceAll('"',""),(s=new Image).crossOrigin="Anonymous",s.onload=function(){var t=document.createElement("canvas"),n=(t.height=s.height/2,t.width=s.width/2,t.getContext("2d"));n.drawImage(s,0,0,t.width,t.height),n.globalAlpha=.8,n.fillStyle=A.U,n.fillRect(0,0,t.width,t.height),e&&e(t)},s.src=n)):(l.fogEffect=null,l.fristRenderScene.fog=null,l.fristRenderScene.background=null),this.B.getVisibleLevels()),h=0;h<u.length;h++)for(var c=this.B.getFloor(u[h]).getLayers(fengmap.FMType.EXTENT_LAYER|fengmap.FMType.MODEL_LAYER|fengmap.FMType.EXTERNAL_MODEL_LAYER),f=0;f<c.length;f++)t?c[f].scene.fog||(c[f].scene.fog=new rn(new L(this.U),this.j)):(c[f].scene.fog=null,c[f].scene.background=null);this.B.enableUpdateRender()},Qt:function(){this.ki(!0)},ki:function(t){for(var e=this.B.getVisibleLevels(),n=0;n<e.length;n++)for(var i=this.B.getFloor(e[n]).getLayers(fengmap.FMType.MODEL_LAYER),r=0;r<i.length;r++)for(var o=i[r].scene.children,s=0;s<o.length;s++)o[s].mapNode&&o[s].mapNode.type===fengmap.FMType.MODEL&&(t?o[s].material.polygonOffset||(o[s].material.polygonOffset=!0,o[s].material.polygonOffsetFactor=1,o[s].material.polygonOffsetUnits=4):(o[s].material.polygonOffset=!1,o[s].material.polygonOffsetFactor=0,o[s].material.polygonOffsetUnits=0));this.B.enableUpdateRender()}});var Va,Ga={FMParticle:n,FMRain:Qi,FMSky:or,FMTextureBasedSkybox:sa,FMWater:io,FMBloom:_o,FMOutline:Po,FMSweep:Io,FMSAO:Go,FMFlowline:ts,FMFireMarker:os,FMFlow:$s,FMDiffusion:Na,FMFog:za,FMHDR:aa};for(Va in Ga)window.fengmap[Va]=Ga[Va];e.default=fengmap}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"Hi",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.Hi)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.Hi?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=0).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()},EApQ:function(t,e,n){var i;i=function(){return e=[function(t,e,n){"use strict";(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){return"symbol"===n(t=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0===i)return String(t);if("object"!==n(i=i.call(t,e)))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(r.key),r)}}var r=null,o=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var n,o,s;function a(){return s.apply(this,arguments)}return n=e,null,(o=[{key:"global",value:(s=function(){if("undefined"!=typeof self&&null!==self&&0!==Object.keys(self).length)return self;if("undefined"!=typeof window&&null!==window&&0!==Object.keys(window).length)return window;if(null!=t&&0!==Object.keys(t).length)return t;var e;if("undefined"!=typeof my)return r||(e=my.getAppIdSync(),r={location:{host:e.appId+".hybrid.alipay-eco.com"}}),r;throw new Error("unable to locate global object")},a.toString=function(){return s.toString()},a)}])&&i(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.a=o}).call(this,n(1))},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e);for(var i={},r=(n.r(i),n.d(i,"ShadowMaterial",function(){return pu}),n.d(i,"SpriteMaterial",function(){return du}),n.d(i,"RawShaderMaterial",function(){return Bu}),n.d(i,"ShaderMaterial",function(){return wu}),n.d(i,"PointsMaterial",function(){return Mu}),n.d(i,"MeshPhysicalMaterial",function(){return _u}),n.d(i,"MeshStandardMaterial",function(){return Su}),n.d(i,"MeshPhongMaterial",function(){return Eu}),n.d(i,"MeshToonMaterial",function(){return Tu}),n.d(i,"MeshNormalMaterial",function(){return Cu}),n.d(i,"MeshLambertMaterial",function(){return Fu}),n.d(i,"MeshDepthMaterial",function(){return Ou}),n.d(i,"MeshDistanceMaterial",function(){return Pu}),n.d(i,"MeshBasicMaterial",function(){return $t}),n.d(i,"MeshMatcapMaterial",function(){return Uu}),n.d(i,"LineDashedMaterial",function(){return Iu}),n.d(i,"LineBasicMaterial",function(){return Ru}),n.d(i,"Material",function(){return Jt}),[]),o=0;o<256;o++)r[o]=(o<16?"0":"")+o.toString(16);var s={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&e]+r[e>>8&255]+"-"+r[e>>16&15|64]+r[e>>24&255]+"-"+r[63&n|128]+r[n>>8&255]+"-"+r[n>>16&255]+r[n>>24&255]+r[255&i]+r[i>>8&255]+r[i>>16&255]+r[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*s.DEG2RAD},radToDeg:function(t){return t*s.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var o=Math.cos,s=Math.sin,a=o(n/2),A=(n=s(n/2),o((e+i)/2)),l=s((e+i)/2),u=o((e-i)/2),h=s((e-i)/2);o=o((i-e)/2),s=s((i-e)/2);"XYX"===r?t.set(a*l,n*u,n*h,a*A):"YZY"===r?t.set(n*h,a*l,n*u,a*A):"ZXZ"===r?t.set(n*u,n*h,a*l,a*A):"XZX"===r?t.set(a*l,n*s,n*o,a*A):"YXY"===r?t.set(n*o,a*l,n*s,a*A):"ZYZ"===r&&t.set(n*s,n*o,a*l,a*A)}};function a(t,e,n,i){this.u=t||0,this.v=e||0,this.j=n||0,this.M=void 0!==i?i:1}Object.assign(a,{slerp:function(t,e,n,i){return n.copy(t).slerp(e,i)},slerpFlat:function(t,e,n,i,r,o,s){var a,A,l,u=n[i+0],h=n[i+1],c=n[i+2],f=(n=n[i+3],i=r[o+0],r[o+1]),p=r[o+2];n===(r=r[o+3])&&u===i&&h===f&&c===p||(o=1-s,a=0<=(A=u*i+h*f+c*p+n*r)?1:-1,(l=1-A*A)>Number.EPSILON&&(l=Math.sqrt(l),A=Math.atan2(l,A*a),o=Math.sin(o*A)/l,s=Math.sin(s*A)/l),u=u*o+i*(A=s*a),h=h*o+f*A,c=c*o+p*A,n=n*o+r*A,o===1-s&&(u*=l=1/Math.sqrt(u*u+h*h+c*c+n*n),h*=l,c*=l,n*=l)),t[e]=u,t[e+1]=h,t[e+2]=c,t[e+3]=n}}),Object.defineProperties(a.prototype,{x:{get:function(){return this.u},set:function(t){this.u=t,this.S()}},y:{get:function(){return this.v},set:function(t){this.v=t,this.S()}},z:{get:function(){return this.j},set:function(t){this.j=t,this.S()}},w:{get:function(){return this.M},set:function(t){this.M=t,this.S()}}}),Object.assign(a.prototype,{isQuaternion:!0,set:function(t,e,n,i){return this.u=t,this.v=e,this.j=n,this.M=i,this.S(),this},clone:function(){return new this.constructor(this.u,this.v,this.j,this.M)},copy:function(t){return this.u=t.x,this.v=t.y,this.j=t.z,this.M=t.w,this.S(),this},setFromEuler:function(t,e){var n,i,r,o,s,a,A;if(t&&t.isEuler)return s=t.u,a=t.v,n=t.j,t=t.order,o=Math.cos,A=Math.sin,i=o(s/2),r=o(a/2),o=o(n/2),s=A(s/2),a=A(a/2),A=A(n/2),"XYZ"===t?(this.u=s*r*o+i*a*A,this.v=i*a*o-s*r*A,this.j=i*r*A+s*a*o,this.M=i*r*o-s*a*A):"YXZ"===t?(this.u=s*r*o+i*a*A,this.v=i*a*o-s*r*A,this.j=i*r*A-s*a*o,this.M=i*r*o+s*a*A):"ZXY"===t?(this.u=s*r*o-i*a*A,this.v=i*a*o+s*r*A,this.j=i*r*A+s*a*o,this.M=i*r*o-s*a*A):"ZYX"===t?(this.u=s*r*o-i*a*A,this.v=i*a*o+s*r*A,this.j=i*r*A-s*a*o,this.M=i*r*o+s*a*A):"YZX"===t?(this.u=s*r*o+i*a*A,this.v=i*a*o+s*r*A,this.j=i*r*A-s*a*o,this.M=i*r*o-s*a*A):"XZY"===t&&(this.u=s*r*o-i*a*A,this.v=i*a*o-s*r*A,this.j=i*r*A+s*a*o,this.M=i*r*o+s*a*A),!1!==e&&this.S(),this;throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.")},setFromAxisAngle:function(t,e){e/=2;var n=Math.sin(e);return this.u=t.x*n,this.v=t.y*n,this.j=t.z*n,this.M=Math.cos(e),this.S(),this},setFromRotationMatrix:function(t){var e,n=(t=t.elements)[0],i=t[4],r=t[8],o=t[1],s=t[5],a=t[9],A=t[2],l=t[6],u=n+s+(t=t[10]);return 0<u?(e=.5/Math.sqrt(u+1),this.M=.25/e,this.u=(l-a)*e,this.v=(r-A)*e,this.j=(o-i)*e):s<n&&t<n?(e=2*Math.sqrt(1+n-s-t),this.M=(l-a)/e,this.u=.25*e,this.v=(i+o)/e,this.j=(r+A)/e):t<s?(e=2*Math.sqrt(1+s-n-t),this.M=(r-A)/e,this.u=(i+o)/e,this.v=.25*e,this.j=(a+l)/e):(e=2*Math.sqrt(1+t-n-s),this.M=(o-i)/e,this.u=(r+A)/e,this.v=(a+l)/e,this.j=.25*e),this.S(),this},setFromUnitVectors:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.u=-t.y,this.v=t.x,this.j=0):(this.u=0,this.v=-t.z,this.j=t.y)):(this.u=t.y*e.z-t.z*e.y,this.v=t.z*e.x-t.x*e.z,this.j=t.x*e.y-t.y*e.x),this.M=n,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(s.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,e){var n=this.angleTo(t);return 0!==n&&(e=Math.min(1,e/n),this.slerp(t,e)),this},inverse:function(){return this.conjugate()},conjugate:function(){return this.u*=-1,this.v*=-1,this.j*=-1,this.S(),this},dot:function(t){return this.u*t.u+this.v*t.v+this.j*t.j+this.M*t.M},lengthSq:function(){return this.u*this.u+this.v*this.v+this.j*this.j+this.M*this.M},length:function(){return Math.sqrt(this.u*this.u+this.v*this.v+this.j*this.j+this.M*this.M)},normalize:function(){var t=this.length();return 0===t?(this.u=0,this.v=0,this.j=0,this.M=1):(this.u=this.u*(t=1/t),this.v=this.v*t,this.j=this.j*t,this.M=this.M*t),this.S(),this},multiply:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t.u,i=t.v,r=t.j,o=(t=t.M,e.u),s=e.v,a=e.j;e=e.M;return this.u=n*e+t*o+i*a-r*s,this.v=i*e+t*s+r*o-n*a,this.j=r*e+t*a+n*s-i*o,this.M=t*e-n*o-i*s-r*a,this.S(),this},slerp:function(t,e){if(0!==e){if(1===e)return this.copy(t);var n,i=this.u,r=this.v,o=this.j,s=this.M,a=s*t.M+i*t.u+r*t.v+o*t.j;a<0?(this.M=-t.M,this.u=-t.u,this.v=-t.v,this.j=-t.j,a=-a):this.copy(t),1<=a?(this.M=s,this.u=i,this.v=r,this.j=o):((t=1-a*a)<=Number.EPSILON?(this.M=(n=1-e)*s+e*this.M,this.u=n*i+e*this.u,this.v=n*r+e*this.v,this.j=n*o+e*this.j,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,a),a=Math.sin((1-e)*t)/n,e=Math.sin(e*t)/n,this.M=s*a+this.M*e,this.u=i*a+this.u*e,this.v=r*a+this.v*e,this.j=o*a+this.j*e),this.S())}return this},equals:function(t){return t.u===this.u&&t.v===this.v&&t.j===this.j&&t.M===this.M},fromArray:function(t,e){return this.u=t[e=void 0===e?0:e],this.v=t[e+1],this.j=t[e+2],this.M=t[e+3],this.S(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.u,t[e+1]=this.v,t[e+2]=this.j,t[e+3]=this.M,t},fromBufferAttribute:function(t,e){return this.u=t.getX(e),this.v=t.getY(e),this.j=t.getZ(e),this.M=t.getW(e),this},O:function(t){return this.S=t,this},S:function(){}});var A=new u,l=new a;function u(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}Object.assign(u.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(t){return t&&t.isEuler,this.applyQuaternion(l.setFromEuler(t))},applyAxisAngle:function(t,e){return this.applyQuaternion(l.setFromAxisAngle(t,e))},applyMatrix3:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=1/((t=t.elements)[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this},applyQuaternion:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=(t=t.w)*e+o*i-s*n,A=t*n+s*e-r*i,l=t*i+r*n-o*e;e=-r*e-o*n-s*i;return this.x=a*t+e*-r+A*-s-l*-o,this.y=A*t+e*-o+l*-r-a*-s,this.z=l*t+e*-s+a*-o-A*-r,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,i=t.y,r=(t=t.z,e.x),o=e.y;e=e.z;return this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this},projectOnVector:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))},projectOnPlane:function(t){return A.copy(this).projectOnVector(t),this.sub(A)},reflect:function(t){return this.sub(A.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(s.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n+(t=this.z-t.z)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=t,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},setFromMatrix3Column:function(t,e){return this.fromArray(t.elements,3*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}});var h=new u,c=new g,f=new u(0,0,0),p=new u(1,1,1),d=new u,y=new u,m=new u;function g(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length}function v(){}Object.assign(g.prototype,{isMatrix4:!0,set:function(t,e,n,i,r,o,s,a,A,l,u,h,c,f,p,d){var y=this.elements;return y[0]=t,y[4]=e,y[8]=n,y[12]=i,y[1]=r,y[5]=o,y[9]=s,y[13]=a,y[2]=A,y[6]=l,y[10]=u,y[14]=h,y[3]=c,y[7]=f,y[11]=p,y[15]=d,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new g).fromArray(this.elements)},copy:function(t){var e=this.elements;t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],this},copyPosition:function(t){var e=this.elements;t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(t){var e=this.elements,n=t.elements,i=1/h.setFromMatrixColumn(t,0).length(),r=1/h.setFromMatrixColumn(t,1).length();t=1/h.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*t,e[9]=n[9]*t,e[10]=n[10]*t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler;var e,n,i,r,o,s,a,A,l,u,h,c,f=this.elements,p=t.x,d=t.y,y=t.z,m=Math.cos(p),g=(p=Math.sin(p),Math.cos(d)),v=(d=Math.sin(d),Math.cos(y));y=Math.sin(y);return"XYZ"===t.order?(o=m*v,s=m*y,a=p*v,A=p*y,f[0]=g*v,f[4]=-g*y,f[8]=d,f[1]=s+a*d,f[5]=o-A*d,f[9]=-p*g,f[2]=A-o*d,f[6]=a+s*d,f[10]=m*g):"YXZ"===t.order?(n=g*y,i=d*v,f[0]=(e=g*v)+(r=d*y)*p,f[4]=i*p-n,f[8]=m*d,f[1]=m*y,f[5]=m*v,f[9]=-p,f[2]=n*p-i,f[6]=r+e*p,f[10]=m*g):"ZXY"===t.order?(n=g*y,i=d*v,f[0]=(e=g*v)-(r=d*y)*p,f[4]=-m*y,f[8]=i+n*p,f[1]=n+i*p,f[5]=m*v,f[9]=r-e*p,f[2]=-m*d,f[6]=p,f[10]=m*g):"ZYX"===t.order?(o=m*v,s=m*y,a=p*v,A=p*y,f[0]=g*v,f[4]=a*d-s,f[8]=o*d+A,f[1]=g*y,f[5]=A*d+o,f[9]=s*d-a,f[2]=-d,f[6]=p*g,f[10]=m*g):"YZX"===t.order?(l=m*g,u=m*d,h=p*g,c=p*d,f[0]=g*v,f[4]=c-l*y,f[8]=h*y+u,f[1]=y,f[5]=m*v,f[9]=-p*v,f[2]=-d*v,f[6]=u*y+h,f[10]=l-c*y):"XZY"===t.order&&(l=m*g,u=m*d,h=p*g,c=p*d,f[0]=g*v,f[4]=-y,f[8]=d*v,f[1]=l*y+c,f[5]=m*v,f[9]=u*y-h,f[2]=h*y-u,f[6]=p*v,f[10]=c*y+l),f[3]=0,f[7]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(f,t,p)},lookAt:function(t,e,n){var i=this.elements;return m.subVectors(t,e),0===m.lengthSq()&&(m.z=1),m.normalize(),d.crossVectors(n,m),0===d.lengthSq()&&(1===Math.abs(n.z)?m.x+=1e-4:m.z+=1e-4,m.normalize(),d.crossVectors(n,m)),d.normalize(),y.crossVectors(m,d),i[0]=d.x,i[4]=y.x,i[8]=m.x,i[1]=d.y,i[5]=y.y,i[9]=m.y,i[2]=d.z,i[6]=y.z,i[10]=m.z,this},multiply:function(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){t=t.elements,e=e.elements;var n=this.elements,i=t[0],r=t[4],o=t[8],s=t[12],a=t[1],A=t[5],l=t[9],u=t[13],h=t[2],c=t[6],f=t[10],p=t[14],d=t[3],y=t[7],m=t[11],g=(t=t[15],e[0]),v=e[4],b=e[8],x=e[12],w=e[1],B=e[5],M=e[9],S=e[13],_=e[2],E=e[6],T=e[10],C=e[14],F=e[3],O=e[7],P=e[11];e=e[15];return n[0]=i*g+r*w+o*_+s*F,n[4]=i*v+r*B+o*E+s*O,n[8]=i*b+r*M+o*T+s*P,n[12]=i*x+r*S+o*C+s*e,n[1]=a*g+A*w+l*_+u*F,n[5]=a*v+A*B+l*E+u*O,n[9]=a*b+A*M+l*T+u*P,n[13]=a*x+A*S+l*C+u*e,n[2]=h*g+c*w+f*_+p*F,n[6]=h*v+c*B+f*E+p*O,n[10]=h*b+c*M+f*T+p*P,n[14]=h*x+c*S+f*C+p*e,n[3]=d*g+y*w+m*_+t*F,n[7]=d*v+y*B+m*E+t*O,n[11]=d*b+y*M+m*T+t*P,n[15]=d*x+y*S+m*C+t*e,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],o=t[1],s=t[5],a=t[9],A=t[13],l=t[2],u=t[6],h=t[10],c=t[14];return t[3]*(+r*a*u-i*A*u-r*s*h+n*A*h+i*s*c-n*a*c)+t[7]*(+e*a*c-e*A*h+r*o*h-i*o*c+i*A*l-r*a*l)+t[11]*(+e*A*u-e*s*c-r*o*u+n*o*c+r*s*l-n*A*l)+t[15]*(-i*s*l-e*a*u+e*s*h+i*o*u-n*o*h+n*a*l)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this},getInverse:function(t,e){e=this.elements;var n=(t=t.elements)[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],A=t[6],l=t[7],u=t[8],h=t[9],c=t[10],f=t[11],p=t[12],d=t[13],y=t[14],m=h*y*l-d*c*l+d*A*f-a*y*f-h*A*(t=t[15])+a*c*t,g=p*c*l-u*y*l-p*A*f+s*y*f+u*A*t-s*c*t,v=u*d*l-p*h*l+p*a*f-s*d*f-u*a*t+s*h*t,b=p*h*A-u*d*A-p*a*c+s*d*c+u*a*y-s*h*y,x=n*m+i*g+r*v+o*b;return 0==x?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(e[0]=m*(m=1/x),e[1]=(d*c*o-h*y*o-d*r*f+i*y*f+h*r*t-i*c*t)*m,e[2]=(a*y*o-d*A*o+d*r*l-i*y*l-a*r*t+i*A*t)*m,e[3]=(h*A*o-a*c*o-h*r*l+i*c*l+a*r*f-i*A*f)*m,e[4]=g*m,e[5]=(u*y*o-p*c*o+p*r*f-n*y*f-u*r*t+n*c*t)*m,e[6]=(p*A*o-s*y*o-p*r*l+n*y*l+s*r*t-n*A*t)*m,e[7]=(s*c*o-u*A*o+u*r*l-n*c*l-s*r*f+n*A*f)*m,e[8]=v*m,e[9]=(p*h*o-u*d*o-p*i*f+n*d*f+u*i*t-n*h*t)*m,e[10]=(s*d*o-p*a*o+p*i*l-n*d*l-s*i*t+n*a*t)*m,e[11]=(u*a*o-s*h*o-u*i*l+n*h*l+s*i*f-n*a*f)*m,e[12]=b*m,e[13]=(u*d*r-p*h*r+p*i*c-n*d*c-u*i*y+n*h*y)*m,e[14]=(p*a*r-s*d*r-p*i*A+n*d*A+s*i*y-n*a*y)*m,e[15]=(s*h*r-u*a*r+u*i*A-n*h*A-s*i*c+n*a*c)*m,this)},invert:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7],l=t[8],u=t[9],h=t[10],c=t[11],f=t[12],p=t[13],d=t[14],y=t[15],m=u*d*A-p*h*A+p*a*c-s*d*c-u*a*y+s*h*y,g=f*h*A-l*d*A-f*a*c+o*d*c+l*a*y-o*h*y,v=l*p*A-f*u*A+f*s*c-o*p*c-l*s*y+o*u*y,b=f*u*a-l*p*a-f*s*h+o*p*h+l*s*d-o*u*d,x=e*m+n*g+i*v+r*b;return 0==x?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(t[0]=m*(m=1/x),t[1]=(p*h*r-u*d*r-p*i*c+n*d*c+u*i*y-n*h*y)*m,t[2]=(s*d*r-p*a*r+p*i*A-n*d*A-s*i*y+n*a*y)*m,t[3]=(u*a*r-s*h*r-u*i*A+n*h*A+s*i*c-n*a*c)*m,t[4]=g*m,t[5]=(l*d*r-f*h*r+f*i*c-e*d*c-l*i*y+e*h*y)*m,t[6]=(f*a*r-o*d*r-f*i*A+e*d*A+o*i*y-e*a*y)*m,t[7]=(o*h*r-l*a*r+l*i*A-e*h*A-o*i*c+e*a*c)*m,t[8]=v*m,t[9]=(f*u*r-l*p*r-f*n*c+e*p*c+l*n*y-e*u*y)*m,t[10]=(o*p*r-f*s*r+f*n*A-e*p*A-o*n*y+e*s*y)*m,t[11]=(l*s*r-o*u*r-l*n*A+e*u*A+o*n*c-e*s*c)*m,t[12]=b*m,t[13]=(l*p*i-f*u*i+f*n*h-e*p*h-l*n*d+e*u*d)*m,t[14]=(f*s*i-o*p*i-f*n*a+e*p*a+o*n*d-e*s*d)*m,t[15]=(o*u*i-l*s*i+l*n*a-e*u*a-o*n*h+e*s*h)*m,this)},scale:function(t){var e=this.elements,n=t.x,i=t.y;t=t.z;return e[0]*=n,e[4]*=i,e[8]*=t,e[1]*=n,e[5]*=i,e[9]*=t,e[2]*=n,e[6]*=i,e[10]*=t,e[3]*=n,e[7]*=i,e[11]*=t,this},getMaxScaleOnAxis:function(){var t=(n=this.elements)[0]*n[0]+n[1]*n[1]+n[2]*n[2],e=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(t,e,n))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(1,0,0,0,0,e,-t,0,0,t,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,0,t,0,0,1,0,0,-t,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t);t=Math.sin(t);return this.set(e,-t,0,0,t,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),1-n),r=t.x,o=t.y,s=(t=t.z,i*r),a=i*o;return this.set(s*r+n,s*o-e*t,s*t+e*o,0,s*o+e*t,a*o+n,a*t-e*r,0,s*t-e*o,a*t+e*r,i*t*t+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){var i=this.elements,r=e.u,o=e.v,s=e.j,a=(e=e.M,r*(u=r+r)),A=r*(h=o+o),l=(r=r*(c=s+s),o*h),u=(o=o*c,s=s*c,e*u),h=e*h,c=(e=e*c,n.x),f=n.y;n=n.z;return i[0]=(1-(l+s))*c,i[1]=(A+e)*c,i[2]=(r-h)*c,i[3]=0,i[4]=(A-e)*f,i[5]=(1-(a+s))*f,i[6]=(o+u)*f,i[7]=0,i[8]=(r+h)*n,i[9]=(o-u)*n,i[10]=(1-(a+l))*n,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this},decompose:function(t,e,n){var i=this.elements,r=h.set(i[0],i[1],i[2]).length(),o=h.set(i[4],i[5],i[6]).length(),s=h.set(i[8],i[9],i[10]).length(),a=(t=(this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],c.copy(this),1/r),i=1/o,1/s);return c.elements[0]*=t,c.elements[1]*=t,c.elements[2]*=t,c.elements[4]*=i,c.elements[5]*=i,c.elements[6]*=i,c.elements[8]*=a,c.elements[9]*=a,c.elements[10]*=a,e.setFromRotationMatrix(c),n.x=r,n.y=o,n.z=s,this},makePerspective:function(t,e,n,i,r,o){var s=this.elements,a=2*r/(n-i),A=(e+t)/(e-t);n=(n+i)/(n-i),i=-(o+r)/(o-r),o=-2*o*r/(o-r);return s[0]=2*r/(e-t),s[4]=0,s[8]=A,s[12]=0,s[1]=0,s[5]=a,s[9]=n,s[13]=0,s[2]=0,s[6]=0,s[10]=i,s[14]=o,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,n,i,r,o){var s=this.elements,a=1/(e-t),A=1/(n-i),l=1/(o-r);e=(e+t)*a,t=(n+i)*A,n=(o+r)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-e,s[1]=0,s[5]=2*A,s[9]=0,s[13]=-t,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-n,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){var n=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(v.prototype,{addEventListener:function(t,e){void 0===this.k&&(this.k={});var n=this.k;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){var n;return void 0!==this.k&&void 0!==(n=this.k)[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){var n;void 0!==this.k&&void 0!==(t=this.k[t])&&-1!==(n=t.indexOf(e))&&t.splice(n,1)},dispatchEvent:function(t){if(void 0!==this.k){var e=this.k[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t)}}}});var b=new g,x=new a;function w(t,e,n,i){this.u=t||0,this.v=e||0,this.j=n||0,this.T=i||w.DefaultOrder}function B(){this.mask=1}function M(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length}w.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],w.DefaultOrder="XYZ",Object.defineProperties(w.prototype,{x:{get:function(){return this.u},set:function(t){this.u=t,this.S()}},y:{get:function(){return this.v},set:function(t){this.v=t,this.S()}},z:{get:function(){return this.j},set:function(t){this.j=t,this.S()}},order:{get:function(){return this.T},set:function(t){this.T=t,this.S()}}}),Object.assign(w.prototype,{isEuler:!0,set:function(t,e,n,i){return this.u=t,this.v=e,this.j=n,this.T=i||this.T,this.S(),this},clone:function(){return new this.constructor(this.u,this.v,this.j,this.T)},copy:function(t){return this.u=t.u,this.v=t.v,this.j=t.j,this.T=t.T,this.S(),this},setFromRotationMatrix:function(t,e,n){var i=s.clamp,r=(t=t.elements)[0],o=t[4],a=t[8],A=t[1],l=t[5],u=t[9],h=t[2],c=t[6];t=t[10];return"XYZ"===(e=e||this.T)?(this.v=Math.asin(i(a,-1,1)),Math.abs(a)<.9999999?(this.u=Math.atan2(-u,t),this.j=Math.atan2(-o,r)):(this.u=Math.atan2(c,l),this.j=0)):"YXZ"===e?(this.u=Math.asin(-i(u,-1,1)),Math.abs(u)<.9999999?(this.v=Math.atan2(a,t),this.j=Math.atan2(A,l)):(this.v=Math.atan2(-h,r),this.j=0)):"ZXY"===e?(this.u=Math.asin(i(c,-1,1)),Math.abs(c)<.9999999?(this.v=Math.atan2(-h,t),this.j=Math.atan2(-o,l)):(this.v=0,this.j=Math.atan2(A,r))):"ZYX"===e?(this.v=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this.u=Math.atan2(c,t),this.j=Math.atan2(A,r)):(this.u=0,this.j=Math.atan2(-o,l))):"YZX"===e?(this.j=Math.asin(i(A,-1,1)),Math.abs(A)<.9999999?(this.u=Math.atan2(-u,l),this.v=Math.atan2(-h,r)):(this.u=0,this.v=Math.atan2(a,t))):"XZY"===e&&(this.j=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this.u=Math.atan2(c,l),this.v=Math.atan2(a,r)):(this.u=Math.atan2(-u,t),this.v=0)),this.T=e,!1!==n&&this.S(),this},setFromQuaternion:function(t,e,n){return b.makeRotationFromQuaternion(t),this.setFromRotationMatrix(b,e,n)},setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this.T)},reorder:function(t){return x.setFromEuler(this),this.setFromQuaternion(x,t)},equals:function(t){return t.u===this.u&&t.v===this.v&&t.j===this.j&&t.T===this.T},fromArray:function(t){return this.u=t[0],this.v=t[1],this.j=t[2],void 0!==t[3]&&(this.T=t[3]),this.S(),this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.u,t[e+1]=this.v,t[e+2]=this.j,t[e+3]=this.T,t},toVector3:function(t){return t?t.set(this.u,this.v,this.j):new u(this.u,this.v,this.j)},O:function(t){return this.S=t,this},S:function(){}}),Object.assign(B.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(M.prototype,{isMatrix3:!0,set:function(t,e,n,i,r,o,s,a,A){var l=this.elements;return l[0]=t,l[1]=i,l[2]=s,l[3]=e,l[4]=r,l[5]=a,l[6]=n,l[7]=o,l[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements;t=t.elements;return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],this},extractBasis:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){t=t.elements,e=e.elements;var n=this.elements,i=t[0],r=t[3],o=t[6],s=t[1],a=t[4],A=t[7],l=t[2],u=t[5],h=(t=t[8],e[0]),c=e[3],f=e[6],p=e[1],d=e[4],y=e[7],m=e[2],g=e[5];e=e[8];return n[0]=i*h+r*p+o*m,n[3]=i*c+r*d+o*g,n[6]=i*f+r*y+o*e,n[1]=s*h+a*p+A*m,n[4]=s*c+a*d+A*g,n[7]=s*f+a*y+A*e,n[2]=l*h+u*p+t*m,n[5]=l*c+u*d+t*g,n[8]=l*f+u*y+t*e,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t,e=(t=this.elements)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],A=t[7];return e*o*(t=t[8])-e*s*A-n*r*t+n*s*a+i*r*A-i*o*a},getInverse:function(t,e){e=t.elements,t=this.elements;var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],A=e[6],l=e[7],u=(e=e[8])*s-a*l,h=a*A-e*o,c=l*o-s*A,f=n*u+i*h+r*c;return 0==f?this.set(0,0,0,0,0,0,0,0,0):(t[0]=u*(u=1/f),t[1]=(r*l-e*i)*u,t[2]=(a*i-r*s)*u,t[3]=h*u,t[4]=(e*n-r*A)*u,t[5]=(r*o-a*n)*u,t[6]=c*u,t[7]=(i*A-l*n)*u,t[8]=(s*n-i*o)*u,this)},transpose:function(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,i,r,o,s){var a=Math.cos(r);r=Math.sin(r);this.set(n*a,n*r,-n*(a*o+r*s)+o+t,-i*r,i*a,-i*(-r*o+a*s)+s+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=(t=Math.sin(t),this.elements),i=n[0],r=n[3],o=n[6],s=n[1],a=n[4],A=n[7];return n[0]=e*i+t*s,n[3]=e*r+t*a,n[6]=e*o+t*A,n[1]=-t*i+e*s,n[4]=-t*r+e*a,n[7]=-t*o+e*A,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){var n=this.elements;return(t=void 0===t?[]:t)[e=void 0===e?0:e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var S=0,_=new u,E=new a,T=new g,C=new u,F=new u,O=new u,P=new a,U=new u(1,0,0),R=new u(0,1,0),I=new u(0,0,1),L={type:"added"},D={type:"removed"};function Q(){Object.defineProperty(this,"id",{value:S++}),this.uuid=s.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Q.DefaultUp.clone();var t=new u,e=new w,n=new a,i=new u(1,1,1);e.O(function(){n.setFromEuler(e,!1)}),n.O(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new g},normalMatrix:{value:new M}}),this.matrix=new g,this.matrixWorld=new g,this.matrixAutoUpdate=Q.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new B,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function k(){Q.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Q.DefaultUp=new u(0,1,0),Q.DefaultMatrixAutoUpdate=!0,Q.prototype=Object.assign(Object.create(v.prototype),{constructor:Q,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return E.setFromAxisAngle(t,e),this.quaternion.multiply(E),this},rotateOnWorldAxis:function(t,e){return E.setFromAxisAngle(t,e),this.quaternion.premultiply(E),this},rotateX:function(t){return this.rotateOnAxis(U,t)},rotateY:function(t){return this.rotateOnAxis(R,t)},rotateZ:function(t){return this.rotateOnAxis(I,t)},translateOnAxis:function(t,e){return _.copy(t).applyQuaternion(this.quaternion),this.position.add(_.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(U,t)},translateY:function(t){return this.translateOnAxis(R,t)},translateZ:function(t){return this.translateOnAxis(I,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(T.getInverse(this.matrixWorld))},lookAt:function(t,e,n){t.isVector3?C.copy(t):C.set(t,e,n),t=this.parent,this.updateWorldMatrix(!0,!1),F.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?T.lookAt(F,C,this.up):T.lookAt(C,F,this.up),this.quaternion.setFromRotationMatrix(T),t&&(T.extractRotation(t.matrixWorld),E.setFromRotationMatrix(T),this.quaternion.premultiply(E.inverse()))},add:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.add(arguments[e]);else t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(L));return this},remove:function(t){if(1<arguments.length)for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);else{var n=this.children.indexOf(t);-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(D))}return this},attach:function(t){return this.updateWorldMatrix(!0,!1),T.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),T.multiply(t.parent.matrixWorld)),t.applyMatrix4(T),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){return void 0===t&&(t=new u),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(t=new a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(F,t,O),t},getWorldScale:function(t){return void 0===t&&(t=new u),this.updateMatrixWorld(!0),this.matrixWorld.decompose(F,P,t),t},getWorldDirection:function(t){void 0===t&&(t=new u),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var i=this.children,r=0,o=i.length;r<o;r++)i[r].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}}),k.prototype=Object.assign(Object.create(Q.prototype),{constructor:k,isScene:!0,copy:function(t,e){return Q.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var N={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},j={h:0,s:0,l:0},H={h:0,s:0,l:0};function z(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function V(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function G(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Y(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function K(t,e,n){this.name="",this.color=new z(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}Object.assign(z.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){return t=s.euclideanModulo(t,1),e=s.clamp(e,0,1),n=s.clamp(n,0,1),0===e?this.r=this.g=this.b=n:(this.r=V(e=2*n-(n=n<=.5?n*(1+e):n+e-n*e),n,t+1/3),this.g=V(e,n,t),this.b=V(e,n,t-1/3)),this},setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}if(A=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,i,r,o,s=A[1],a=A[2];switch(s){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return i=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100,e(n[5]),this.setHSL(i,r,o)}}else if(A=/^\#([A-Fa-f0-9]+)$/.exec(t)){var A=(s=A[1]).length;if(3===A)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===A)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var e=N[t];return void 0!==e&&this.setHex(e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return e=0<(e=void 0===e?2:e)?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=G(t.r),this.g=G(t.g),this.b=G(t.b),this},copyLinearToSRGB:function(t){return this.r=Y(t.r),this.g=Y(t.g),this.b=Y(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var e,n=this.r,i=this.g,r=this.b,o=Math.max(n,i,r),s=Math.min(n,i,r),a=(s+o)/2;if(s===o)l=e=0;else{var A=o-s,l=a<=.5?A/(o+s):A/(2-o-s);switch(o){case n:e=(i-r)/A+(i<r?6:0);break;case i:e=(r-n)/A+2;break;case r:e=(n-i)/A+4}e/=6}return t.h=e,t.s=l,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(j),j.h+=t,j.s+=e,j.l+=n,this.setHSL(j.h,j.s,j.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(j),t.getHSL(H);t=s.lerp(j.h,H.h,e);var n=s.lerp(j.s,H.s,e);e=s.lerp(j.l,H.l,e);return this.setHSL(t,n,e),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return this.r=t[e=void 0===e?0:e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}}),z.NAMES=N,Object.assign(K.prototype,{isFog:!0,clone:function(){return new K(this.color,this.near,this.far)}});var X=[new u,new u,new u,new u,new u,new u,new u,new u],W=new u,Z=new at,q=new u,J=new u,$=new u,tt=new u,et=new u,nt=new u,it=new u,rt=new u,ot=new u,st=new u;function at(t,e){this.min=void 0!==t?t:new u(1/0,1/0,1/0),this.max=void 0!==e?e:new u(-1/0,-1/0,-1/0)}function At(t,e,n,i,r){for(var o=0,s=t.length-3;o<=s;o+=3){st.fromArray(t,o);var a=r.x*Math.abs(st.x)+r.y*Math.abs(st.y)+r.z*Math.abs(st.z),A=e.dot(st),l=n.dot(st),u=i.dot(st);if(Math.max(-Math.max(A,l,u),Math.min(A,l,u))>a)return!1}return!0}function lt(t,e,n,i){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==i?i:1}function ut(t,e){this.x=t||0,this.y=e||0}Object.assign(at.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,A=t.length;a<A;a+=3){var l=t[a],u=t[a+1],h=t[a+2];l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),s<h&&(s=h)}return this.min.set(e,n,i),this.max.set(r,o,s),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,o=-1/0,s=-1/0,a=0,A=t.count;a<A;a++){var l=t.getX(a),u=t.getY(a),h=t.getZ(a);l<e&&(e=l),u<n&&(n=u),h<i&&(i=h),r<l&&(r=l),o<u&&(o=u),s<h&&(s=h)}return this.min.set(e,n,i),this.max.set(r,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(t,e){return e=W.copy(e).multiplyScalar(.5),this.min.copy(t).sub(e),this.max.copy(t).add(e),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(t=new u),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(t=new u),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);for(var e=t.geometry,n=(void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Z.copy(e.boundingBox),Z.applyMatrix4(t.matrixWorld),this.union(Z)),t.children),i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(e=new u),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,W),W.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var e,n=0<t.normal.x?(e=t.normal.x*this.min.x,t.normal.x*this.max.x):(e=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(it),rt.subVectors(this.max,it),q.subVectors(t.a,it),J.subVectors(t.b,it),$.subVectors(t.c,it),tt.subVectors(J,q),et.subVectors($,J),nt.subVectors(q,$),!!At([0,-tt.z,tt.y,0,-et.z,et.y,0,-nt.z,nt.y,tt.z,0,-tt.x,et.z,0,-et.x,nt.z,0,-nt.x,-tt.y,tt.x,0,-et.y,et.x,0,-nt.y,nt.x,0],q,J,$,rt))&&!!At([1,0,0,0,1,0,0,0,1],q,J,$,rt)&&(ot.crossVectors(tt,et),At([ot.x,ot.y,ot.z],q,J,$,rt))},clampPoint:function(t,e){return void 0===e&&(e=new u),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return W.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return this.getCenter(t.center),t.radius=.5*this.getSize(W).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(X[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),X[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),X[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),X[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),X[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),X[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),X[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),X[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(X)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.defineProperties(lt.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(lt.prototype,{isVector4:!0,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i+t[12]*r,this.y=t[1]*e+t[5]*n+t[9]*i+t[13]*r,this.z=t[2]*e+t[6]*n+t[10]*i+t[14]*r,this.w=t[3]*e+t[7]*n+t[11]*i+t[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,i,r,o,s,a,A,l,u,h=(t=t.elements)[0],c=t[4],f=t[8],p=t[1],d=t[5],y=t[9],m=t[2],g=t[6];t=t[10];return Math.abs(c-p)<.01&&Math.abs(f-m)<.01&&Math.abs(y-g)<.01?Math.abs(c+p)<.1&&Math.abs(f+m)<.1&&Math.abs(y+g)<.1&&Math.abs(h+d+t-3)<.1?this.set(1,0,0,0):(r=Math.PI,s=(t+1)/2,a=(c+p)/4,A=(f+m)/4,l=(y+g)/4,(o=(d+1)/2)<(u=(h+1)/2)&&s<u?i=u<.01?(e=0,n=.707106781):(n=a/(e=Math.sqrt(u)),A/e):s<o?i=o<.01?(n=0,e=.707106781):(e=a/(n=Math.sqrt(o)),l/n):s<.01?(n=e=.707106781,i=0):(e=A/(i=Math.sqrt(s)),n=l/i),this.set(e,n,i,r)):(u=Math.sqrt((g-y)*(g-y)+(f-m)*(f-m)+(p-c)*(p-c)),Math.abs(u)<.001&&(u=1),this.x=(g-y)/u,this.y=(f-m)/u,this.z=(p-c)/u,this.w=Math.acos((h+d+t-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Object.defineProperties(ut.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(ut.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6],this.y=t[1]*e+t[4]*n+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this},clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return this.x=t[e=void 0===e?0:e],this.y=t[e+1],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),this.x-t.x),r=this.y-t.y;return this.x=i*n-r*e+t.x,this.y=i*e+r*n+t.y,this}});var ht=0,ct=1,ft=2,pt=1,dt=100,yt=204,mt=205,gt=3,vt=0,bt=1001,xt=1006,wt=2300,Bt=2301,Mt=3200,St=0,_t=7680,Et=519,Tt=new u;function Ct(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Ft(t,e,n){Ct.call(this,new Int8Array(t),e,n)}function Ot(t,e,n){Ct.call(this,new Uint8Array(t),e,n)}function Pt(t,e,n){Ct.call(this,new Uint8ClampedArray(t),e,n)}function Ut(t,e,n){Ct.call(this,new Int16Array(t),e,n)}function Rt(t,e,n){Ct.call(this,new Uint16Array(t),e,n)}function It(t,e,n){Ct.call(this,new Int32Array(t),e,n)}function Lt(t,e,n){Ct.call(this,new Uint32Array(t),e,n)}function Dt(t,e,n){Ct.call(this,new Float32Array(t),e,n)}function Qt(t,e,n){Ct.call(this,new Float64Array(t),e,n)}Object.defineProperty(Ct.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ct.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new z),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new ut),e[n++]=o.x,e[n++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new u),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,i=0,r=t.length;i<r;i++){var o=t[i];void 0===o&&(o=new lt),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},applyMatrix3:function(t){for(var e=0,n=this.count;e<n;e++)Tt.x=this.getX(e),Tt.y=this.getY(e),Tt.z=this.getZ(e),Tt.applyMatrix3(t),this.setXYZ(e,Tt.x,Tt.y,Tt.z);return this},applyMatrix4:function(t){for(var e=0,n=this.count;e<n;e++)Tt.x=this.getX(e),Tt.y=this.getY(e),Tt.z=this.getZ(e),Tt.applyMatrix4(t),this.setXYZ(e,Tt.x,Tt.y,Tt.z);return this},applyNormalMatrix:function(t){for(var e=0,n=this.count;e<n;e++)Tt.x=this.getX(e),Tt.y=this.getY(e),Tt.z=this.getZ(e),Tt.applyNormalMatrix(t),this.setXYZ(e,Tt.x,Tt.y,Tt.z);return this},transformDirection:function(t){for(var e=0,n=this.count;e<n;e++)Tt.x=this.getX(e),Tt.y=this.getY(e),Tt.z=this.getZ(e),Tt.transformDirection(t),this.setXYZ(e,Tt.x,Tt.y,Tt.z);return this},set:function(t,e){return this.array.set(t,e=void 0===e?0:e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(Ft.prototype=Object.create(Ct.prototype)).constructor=Ft,(Ot.prototype=Object.create(Ct.prototype)).constructor=Ot,(Pt.prototype=Object.create(Ct.prototype)).constructor=Pt,(Ut.prototype=Object.create(Ct.prototype)).constructor=Ut,Rt.prototype=Object.create(Ct.prototype),Rt.prototype.constructor=Rt,(It.prototype=Object.create(Ct.prototype)).constructor=It,Lt.prototype=Object.create(Ct.prototype),Lt.prototype.constructor=Lt,(Dt.prototype=Object.create(Ct.prototype)).constructor=Dt,(Qt.prototype=Object.create(Ct.prototype)).constructor=Qt;var kt=new at;function Nt(t,e){this.center=void 0!==t?t:new u,this.radius=void 0!==e?e:0}function jt(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(Nt.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(t,e){for(var n=this.center,i=(void 0!==e?n.copy(e):kt.setFromPoints(t).getCenter(n),0),r=0,o=t.length;r<o;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(e=new u),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(t=new at),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(jt.prototype,{computeGroups:function(t){for(var e,n=[],i=void 0,r=t.faces,o=0;o<r.length;o++){var s=r[o];s.materialIndex!==i&&(i=s.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:i})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&0<i[0].length,o=i[1]&&0<i[1].length,s=t.morphTargets,a=s.length;if(0<a){for(var A=[],l=0;l<a;l++)A[l]={name:s[l].name,data:[]};this.morphTargets.position=A}var u=t.morphNormals,h=u.length;if(0<h){var c=[];for(l=0;l<h;l++)c[l]={name:u[l].name,data:[]};this.morphTargets.normal=c}var f=t.skinIndices,p=t.skinWeights,d=f.length===n.length,y=p.length===n.length;for(0<n.length&&e.length,l=0;l<e.length;l++){var m,g,v=e[l];3===(g=(3===(g=(this.vertices.push(n[v.a],n[v.b],n[v.c]),v.vertexNormals)).length?this.normals.push(g[0],g[1],g[2]):(g=v.normal,this.normals.push(g,g,g)),v.vertexColors)).length?this.colors.push(g[0],g[1],g[2]):(g=v.color,this.colors.push(g,g,g)),!0===r&&(void 0!==(m=i[0][l])?this.uvs.push(m[0],m[1],m[2]):this.uvs.push(new ut,new ut,new ut)),!0===o&&(void 0!==(m=i[1][l])?this.uvs2.push(m[0],m[1],m[2]):this.uvs2.push(new ut,new ut,new ut));for(var b=0;b<a;b++){var x=s[b].vertices;A[b].data.push(x[v.a],x[v.b],x[v.c])}for(b=0;b<h;b++){var w=u[b].vertexNormals[l];c[b].data.push(w.a,w.b,w.c)}d&&this.skinIndices.push(f[v.a],f[v.b],f[v.c]),y&&this.skinWeights.push(p[v.a],p[v.b],p[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var Ht=1,zt=new g,Vt=new Q,Gt=new u,Yt=new at,Kt=new at,Xt=new u;function Wt(){Object.defineProperty(this,"id",{value:Ht+=2}),this.uuid=s.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Zt(t,e,n,i){Wt.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};for(var r=(t=t||1)/2,o=(e=e||1)/2,s=Math.floor(n)||1,a=Math.floor(i)||1,A=s+1,l=a+1,u=t/s,h=e/a,c=[],f=[],p=[],d=[],y=0;y<l;y++)for(var m=y*h-o,g=0;g<A;g++)f.push(g*u-r,-m,0),p.push(0,0,1),d.push(g/s),d.push(1-y/a);for(y=0;y<a;y++)for(g=0;g<s;g++){var v=g+A*(y+1),b=g+1+A*(y+1),x=g+1+A*y;c.push(g+A*y,v,x),c.push(v,b,x)}this.setIndex(c),this.setAttribute("position",new Dt(f,3)),this.setAttribute("normal",new Dt(p,3)),this.setAttribute("uv",new Dt(d,2))}Wt.prototype=Object.assign(Object.create(v.prototype),{constructor:Wt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<function(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}(t)?Lt:Rt)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){var e,n=(void 0!==(e=(void 0!==(e=this.attributes.position)&&(e.applyMatrix4(t),e.needsUpdate=!0),this.attributes.normal))&&(n=(new M).getNormalMatrix(t),e.applyNormalMatrix(n),e.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return zt.makeRotationX(t),this.applyMatrix4(zt),this},rotateY:function(t){return zt.makeRotationY(t),this.applyMatrix4(zt),this},rotateZ:function(t){return zt.makeRotationZ(t),this.applyMatrix4(zt),this},translate:function(t,e,n){return zt.makeTranslation(t,e,n),this.applyMatrix4(zt),this},scale:function(t,e,n){return zt.makeScale(t,e,n),this.applyMatrix4(zt),this},lookAt:function(t){return Vt.lookAt(t),Vt.updateMatrix(),this.applyMatrix4(Vt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gt).negate(),this.translate(Gt.x,Gt.y,Gt.z),this},setFromObject:function(t){var e,n,i=t.geometry;return t.isPoints||t.isLine?(n=new Dt(3*i.vertices.length,3),e=new Dt(3*i.colors.length,3),this.setAttribute("position",n.copyVector3sArray(i.vertices)),this.setAttribute("color",e.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length&&(n=new Dt(i.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(i.lineDistances))),null!==i.boundingSphere&&(this.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(this.boundingBox=i.boundingBox.clone())):t.isMesh&&i&&i.isGeometry&&this.fromGeometry(i),this},setFromPoints:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Dt(e,3)),this},updateFromObject:function(t){var e,n=t.geometry;if(t.isMesh){var i=n.R;if(!0===n.elementsNeedUpdate&&(i=void 0,n.elementsNeedUpdate=!1),void 0===i)return this.fromGeometry(n);i.verticesNeedUpdate=n.verticesNeedUpdate,i.normalsNeedUpdate=n.normalsNeedUpdate,i.colorsNeedUpdate=n.colorsNeedUpdate,i.uvsNeedUpdate=n.uvsNeedUpdate,i.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=i}return!0===n.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(n.vertices),e.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(n.normals),e.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(n.colors),e.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(n.uvs),e.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(n.lineDistances),e.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.R=(new jt).fromGeometry(t),this.fromDirectGeometry(t.R)},fromDirectGeometry:function(t){var e,n=new Float32Array(3*t.vertices.length);for(e in this.setAttribute("position",new Ct(n,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(n=new Float32Array(3*t.normals.length),this.setAttribute("normal",new Ct(n,3).copyVector3sArray(t.normals))),0<t.colors.length&&(n=new Float32Array(3*t.colors.length),this.setAttribute("color",new Ct(n,3).copyColorsArray(t.colors))),0<t.uvs.length&&(n=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new Ct(n,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(n=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new Ct(n,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var i=[],r=t.morphTargets[e],o=0,s=r.length;o<s;o++){var a=r[o],A=new Dt(3*a.data.length,3);A.name=a.name,i.push(A.copyVector3sArray(a.data))}this.morphAttributes[e]=i}return 0<t.skinIndices.length&&(n=new Dt(4*t.skinIndices.length,4),this.setAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new Dt(4*t.skinWeights.length,4),this.setAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new at);var t=this.attributes.position,e=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var r=e[n];Yt.setFromBufferAttribute(r),this.morphTargetsRelative?(Xt.addVectors(this.boundingBox.min,Yt.min),this.boundingBox.expandByPoint(Xt),Xt.addVectors(this.boundingBox.max,Yt.max),this.boundingBox.expandByPoint(Xt)):(this.boundingBox.expandByPoint(Yt.min),this.boundingBox.expandByPoint(Yt.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Nt);var t=this.attributes.position,e=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(Yt.setFromBufferAttribute(t),e)for(var i=0,r=e.length;i<r;i++){var o=e[i];Kt.setFromBufferAttribute(o),this.morphTargetsRelative?(Xt.addVectors(Yt.min,Kt.min),Yt.expandByPoint(Xt),Xt.addVectors(Yt.max,Kt.max),Yt.expandByPoint(Xt)):(Yt.expandByPoint(Kt.min),Yt.expandByPoint(Kt.max))}Yt.getCenter(n);var s=0;for(i=0,r=t.count;i<r;i++)Xt.fromBufferAttribute(t,i),s=Math.max(s,n.distanceToSquared(Xt));if(e)for(i=0,r=e.length;i<r;i++){o=e[i];for(var a=this.morphTargetsRelative,A=0,l=o.count;A<l;A++)Xt.fromBufferAttribute(o,A),a&&(Gt.fromBufferAttribute(t,A),Xt.add(Gt)),s=Math.max(s,n.distanceToSquared(Xt))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes;if(e.position){var n=e.position.array;if(void 0===e.normal)this.setAttribute("normal",new Ct(new Float32Array(n.length),3));else for(var i=e.normal.array,r=0,o=i.length;r<o;r++)i[r]=0;var s,a,A,l=e.normal.array,h=new u,c=new u,f=new u,p=new u,d=new u;if(t){var y=t.array;for(r=0,o=t.count;r<o;r+=3)s=3*y[r+0],a=3*y[r+1],A=3*y[r+2],h.fromArray(n,s),c.fromArray(n,a),f.fromArray(n,A),p.subVectors(f,c),d.subVectors(h,c),p.cross(d),l[s]+=p.x,l[1+s]+=p.y,l[2+s]+=p.z,l[a]+=p.x,l[1+a]+=p.y,l[2+a]+=p.z,l[A]+=p.x,l[1+A]+=p.y,l[2+A]+=p.z}else for(r=0,o=n.length;r<o;r+=9)h.fromArray(n,r),c.fromArray(n,r+3),f.fromArray(n,r+6),p.subVectors(f,c),d.subVectors(h,c),p.cross(d),l[r]=p.x,l[r+1]=p.y,l[r+2]=p.z,l[r+3]=p.x,l[r+4]=p.y,l[r+5]=p.z,l[r+6]=p.x,l[r+7]=p.y,l[r+8]=p.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)Xt.x=t.getX(e),Xt.y=t.getY(e),Xt.z=t.getZ(e),Xt.normalize(),t.setXYZ(e,Xt.x,Xt.y,Xt.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}}),(Zt.prototype=Object.create(Wt.prototype)).constructor=Zt;var qt=0;function Jt(){Object.defineProperty(this,"id",{value:qt++}),this.uuid=s.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=pt,this.side=ht,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=yt,this.blendDst=mt,this.blendEquation=dt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=gt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Et,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=_t,this.stencilZFail=_t,this.stencilZPass=_t,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function $t(t){Jt.call(this),this.type="MeshBasicMaterial",this.color=new z(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Jt.prototype=Object.assign(Object.create(v.prototype),{constructor:Jt,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n,i=t[e];void 0===i||("shading"===e?this.flatShading=1===i:void 0===(n=this[e])||(n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i))}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e)for(var i=e.length,r=(n=new Array(i),0);r!==i;++r)n[r]=e[r].clone();return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Jt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),(($t.prototype=Object.create(Jt.prototype)).constructor=$t).prototype.isMeshBasicMaterial=!0,$t.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var te=0;function ee(t,e,n,i,r,o,a,A,l,u){Object.defineProperty(this,"id",{value:te++}),this.uuid=s.generateUUID(),this.name="",this.image=void 0!==t?t:ee.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:ee.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:bt,this.wrapT=void 0!==i?i:bt,this.magFilter=void 0!==r?r:xt,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==l?l:1,this.format=void 0!==a?a:1023,this.internalFormat=null,this.type=void 0!==A?A:1009,this.offset=new ut(0,0),this.repeat=new ut(1,1),this.center=new ut(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new M,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function ne(t,e,n,i,r,o,s,a,A){ee.call(this,t,e,n,i,r,o,s,a,A),this.needsUpdate=!0}ee.DEFAULT_IMAGE=void 0,ee.DEFAULT_MAPPING=300,ee.prototype=Object.assign(Object.create(v.prototype),{constructor:ee,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(300===this.mapping){if(t.applyMatrix3(this.matrix),t.x<0||1<t.x)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case bt:t.x=t.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||1<t.y)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case bt:t.y=t.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}return t}}),Object.defineProperty(ee.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),((ne.prototype=Object.create(ee.prototype)).constructor=ne).prototype.isCanvasTexture=!0;var ie=new u,re=new u,oe=new M;function se(t,e){this.normal=void 0!==t?t:new u(1,0,0),this.constant=void 0!==e?e:0}Object.assign(se.prototype,{isPlane:!0,set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(t,e,n){return n=ie.subVectors(n,e).cross(re.subVectors(t,e)).normalize(),this.setFromNormalAndCoplanarPoint(n,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(e=new u),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,e){void 0===e&&(e=new u);var n=t.delta(ie),i=this.normal.dot(n);return 0===i?0===this.distanceToPoint(t.start)?e.copy(t.start):void 0:(i=-(t.start.dot(this.normal)+this.constant)/i)<0||1<i?void 0:e.copy(n).multiplyScalar(i).add(t.start)},intersectsLine:function(t){var e=this.distanceToPoint(t.start);t=this.distanceToPoint(t.end);return e<0&&0<t||t<0&&0<e},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(t=new u),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,e){return e=e||oe.getNormalMatrix(t),t=this.coplanarPoint(ie).applyMatrix4(t),e=this.normal.applyMatrix3(e).normalize(),this.constant=-t.dot(e),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var ae=new u,Ae=new u,le=new u,ue=new u,he=new u,ce=new u,fe=new u;function pe(t,e){this.origin=void 0!==t?t:new u,this.direction=void 0!==e?e:new u(0,0,-1)}Object.assign(pe.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(e=new u),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,ae)),this},closestPointToPoint:function(t,e){return void 0===e&&(e=new u),e.subVectors(t,this.origin),(t=e.dot(this.direction))<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var e=ae.subVectors(t,this.origin).dot(this.direction);return(e<0?this.origin:(ae.copy(this.direction).multiplyScalar(e).add(this.origin),ae)).distanceToSquared(t)},distanceSqToSegment:function(t,e,n,i){Ae.copy(t).add(e).multiplyScalar(.5),le.copy(e).sub(t).normalize(),ue.copy(this.origin).sub(Ae);t=.5*t.distanceTo(e),e=-this.direction.dot(le);var r,o,s,a=ue.dot(this.direction),A=-ue.dot(le),l=ue.lengthSq(),u=Math.abs(1-e*e);return u=0<u?(o=e*a-A,s=t*u,0<=(r=e*A-a)?-s<=o?o<=s?(r*=u=1/u)*(r+e*(o*=u)+2*a)+o*(e*r+o+2*A)+l:(o=t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l):(o=-t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l):o<=-s?-(r=Math.max(0,-(-e*t+a)))*r+(o=0<r?-t:Math.min(Math.max(-t,-A),t))*(o+2*A)+l:o<=s?(r=0,(o=Math.min(Math.max(-t,-A),t))*(o+2*A)+l):-(r=Math.max(0,-(e*t+a)))*r+(o=0<r?t:Math.min(Math.max(-t,-A),t))*(o+2*A)+l):(o=0<e?-t:t,-(r=Math.max(0,-(e*o+a)))*r+o*(o+2*A)+l),n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(le).multiplyScalar(o).add(Ae),u},intersectSphere:function(t,e){ae.subVectors(t.center,this.origin);var n=ae.dot(this.direction),i=ae.dot(ae)-n*n;return(t=t.radius*t.radius)<i||(i=n+(t=Math.sqrt(t-i)),(n-=t)<0&&i<0)?null:n<0?this.at(i,e):this.at(n,e)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);return 0===e?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/e)?t:null},intersectPlane:function(t,e){return null===(t=this.distanceToPlane(t))?null:this.at(t,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,i,r,o=1/this.direction.x,s=1/this.direction.y,a=1/this.direction.z,A=this.origin;o=0<=o?(n=(t.min.x-A.x)*o,(t.max.x-A.x)*o):(n=(t.max.x-A.x)*o,(t.min.x-A.x)*o);return(s=0<=s?(r=(t.min.y-A.y)*s,(t.max.y-A.y)*s):(r=(t.max.y-A.y)*s,(t.min.y-A.y)*s))<n||o<r||((n<r||n!=n)&&(n=r),(s<o||o!=o)&&(o=s),(r=0<=a?(i=(t.min.z-A.z)*a,(t.max.z-A.z)*a):(i=(t.max.z-A.z)*a,(t.min.z-A.z)*a))<n)||o<i||((n<i||n!=n)&&(n=i),(o=r<o||o!=o?r:o)<0)?null:this.at(0<=n?n:o,e)},intersectsBox:function(t){return null!==this.intersectBox(t,ae)},intersectTriangle:function(t,e,n,i,r){var o;if(he.subVectors(e,t),ce.subVectors(n,t),fe.crossVectors(he,ce),0<(e=this.direction.dot(fe))){if(i)return null;o=1}else{if(!(e<0))return null;o=-1,e=-e}return ue.subVectors(this.origin,t),(n=o*this.direction.dot(ce.crossVectors(ue,ce)))<0||(i=o*this.direction.dot(he.cross(ue)))<0||e<n+i||(t=-o*ue.dot(fe))<0?null:this.at(t/e,r)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var de=new u,ye=new u,me=new u,ge=new u,ve=new u,be=new u,xe=new u,we=new u,Be=new u,Me=new u;function Se(t,e,n){this.a=void 0!==t?t:new u,this.b=void 0!==e?e:new u,this.c=void 0!==n?n:new u}function _e(t,e,n,i,r,o){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new u,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new z,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==o?o:0}Object.assign(Se,{getNormal:function(t,e,n,i){return void 0===i&&(i=new u),i.subVectors(n,e),de.subVectors(t,e),i.cross(de),0<(n=i.lengthSq())?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)},getBarycoord:function(t,e,n,i,r){de.subVectors(i,e),ye.subVectors(n,e),me.subVectors(t,e);i=de.dot(de),n=de.dot(ye),t=de.dot(me),e=ye.dot(ye);var o=ye.dot(me),s=i*e-n*n;return void 0===r&&(r=new u),0==s?r.set(-2,-1,-1):r.set(1-(e=(e*t-n*o)*(r=1/s))-(s=(i*o-n*t)*r),s,e)},containsPoint:function(t,e,n,i){return Se.getBarycoord(t,e,n,i,ge),0<=ge.x&&0<=ge.y&&ge.x+ge.y<=1},getUV:function(t,e,n,i,r,o,s,a){return this.getBarycoord(t,e,n,i,ge),a.set(0,0),a.addScaledVector(r,ge.x),a.addScaledVector(o,ge.y),a.addScaledVector(s,ge.z),a},isFrontFacing:function(t,e,n,i){return de.subVectors(n,e),ye.subVectors(t,e),de.cross(ye).dot(i)<0}}),Object.assign(Se.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return de.subVectors(this.c,this.b),ye.subVectors(this.a,this.b),.5*de.cross(ye).length()},getMidpoint:function(t){return void 0===t&&(t=new u),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Se.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(t=new se),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Se.getBarycoord(t,this.a,this.b,this.c,e)},getUV:function(t,e,n,i,r){return Se.getUV(t,this.a,this.b,this.c,e,n,i,r)},containsPoint:function(t){return Se.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Se.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,e){void 0===e&&(e=new u);var n=this.a,i=this.b,r=this.c,o=(ve.subVectors(i,n),be.subVectors(r,n),we.subVectors(t,n),ve.dot(we)),s=be.dot(we);if(o<=0&&s<=0)return e.copy(n);Be.subVectors(t,i);var a=ve.dot(Be),A=be.dot(Be);if(0<=a&&A<=a)return e.copy(i);var l=o*A-a*s;if(l<=0&&0<=o&&a<=0)return h=o/(o-a),e.copy(n).addScaledVector(ve,h);Me.subVectors(t,r);t=ve.dot(Me);var h,c,f=be.dot(Me);return 0<=f&&t<=f?e.copy(r):(o=t*s-o*f)<=0&&0<=s&&f<=0?(c=s/(s-f),e.copy(n).addScaledVector(be,c)):(s=a*f-t*A)<=0&&0<=A-a&&0<=t-f?(xe.subVectors(r,i),c=(A-a)/(A-a+(t-f)),e.copy(i).addScaledVector(xe,c)):(h=o*(r=1/(s+o+l)),c=l*r,e.copy(n).addScaledVector(ve,h).addScaledVector(be,c))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Object.assign(_e.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Ee=new g,Te=new pe,Ce=new Nt,Fe=new u,Oe=new u,Pe=new u,Ue=new u,Re=new u,Ie=new u,Le=new u,De=new u,Qe=new u,ke=new ut,Ne=new ut,je=new ut,He=new u,ze=new u;function Ve(t,e){Q.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Wt,this.material=void 0!==e?e:new $t,this.updateMorphTargets()}function Ge(t,e,n,i,r,o,s,a){return null===(i=e.side===ct?i.intersectTriangle(s,o,r,!0,a):i.intersectTriangle(r,o,s,e.side!==ft,a))?null:(ze.copy(a),ze.applyMatrix4(t.matrixWorld),(r=n.ray.origin.distanceTo(ze))<n.near||r>n.far?null:{distance:r,point:ze.clone(),object:t})}function Ye(t,e,n,i,r,o,s,a,A,l,u,h){Fe.fromBufferAttribute(r,l),Oe.fromBufferAttribute(r,u),Pe.fromBufferAttribute(r,h);var c=t.morphTargetInfluences;if(e.morphTargets&&o&&c){Le.set(0,0,0),De.set(0,0,0),Qe.set(0,0,0);for(var f=0,p=o.length;f<p;f++){var d=c[f],y=o[f];0!==d&&(Ue.fromBufferAttribute(y,l),Re.fromBufferAttribute(y,u),Ie.fromBufferAttribute(y,h),s?(Le.addScaledVector(Ue,d),De.addScaledVector(Re,d),Qe.addScaledVector(Ie,d)):(Le.addScaledVector(Ue.sub(Fe),d),De.addScaledVector(Re.sub(Oe),d),Qe.addScaledVector(Ie.sub(Pe),d)))}Fe.add(Le),Oe.add(De),Pe.add(Qe)}return(r=Ge(t,e,n,i,Fe,Oe,Pe,He))&&(a&&(ke.fromBufferAttribute(a,l),Ne.fromBufferAttribute(a,u),je.fromBufferAttribute(a,h),r.uv=Se.getUV(He,Fe,Oe,Pe,ke,Ne,je,new ut)),A&&(ke.fromBufferAttribute(A,l),Ne.fromBufferAttribute(A,u),je.fromBufferAttribute(A,h),r.uv2=Se.getUV(He,Fe,Oe,Pe,ke,Ne,je,new ut)),t=new _e(l,u,h),Se.getNormal(Fe,Oe,Pe,t.normal),r.face=t),r}function Ke(t,e,n,i){this.ray=new pe(t,e),this.near=n||0,this.far=i||1/0,this.camera=null,this.layers=new B,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return this.Points}}})}function Xe(t,e){return t.distance-e.distance}function We(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i)for(var r=t.children,o=0,s=r.length;o<s;o++)We(r[o],e,n,!0)}Ve.prototype=Object.assign(Object.create(Q.prototype),{constructor:Ve,isMesh:!0,copy:function(t){return Q.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(0<o.length){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else void 0!==(r=i.morphTargets)&&r.length},raycast:function(t,e){var n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i&&(null===n.boundingSphere&&n.computeBoundingSphere(),Ce.copy(n.boundingSphere),Ce.applyMatrix4(r),!1!==t.ray.intersectsSphere(Ce)&&(Ee.getInverse(r),Te.copy(t.ray).applyMatrix4(Ee),null===n.boundingBox||!1!==Te.intersectsBox(n.boundingBox))))if(n.isBufferGeometry){var o,s,a,A,l,u,h,c,f,p=n.index,d=n.attributes.position,y=n.morphAttributes.position,m=n.morphTargetsRelative,g=n.attributes.uv,v=n.attributes.uv2,b=n.groups,x=n.drawRange;if(null!==p)if(Array.isArray(i))for(A=0,u=b.length;A<u;A++)for(f=i[(c=b[A]).materialIndex],l=Math.max(c.start,x.start),h=Math.min(c.start+c.count,x.start+x.count);l<h;l+=3)o=p.getX(l),s=p.getX(l+1),a=p.getX(l+2),(O=Ye(this,f,t,Te,d,y,m,g,v,o,s,a))&&(O.faceIndex=Math.floor(l/3),O.face.materialIndex=c.materialIndex,e.push(O));else for(A=Math.max(0,x.start),u=Math.min(p.count,x.start+x.count);A<u;A+=3)o=p.getX(A),s=p.getX(A+1),a=p.getX(A+2),(O=Ye(this,i,t,Te,d,y,m,g,v,o,s,a))&&(O.faceIndex=Math.floor(A/3),e.push(O));else if(void 0!==d)if(Array.isArray(i))for(A=0,u=b.length;A<u;A++)for(f=i[(c=b[A]).materialIndex],l=Math.max(c.start,x.start),h=Math.min(c.start+c.count,x.start+x.count);l<h;l+=3)(O=Ye(this,f,t,Te,d,y,m,g,v,o=l,s=l+1,a=l+2))&&(O.faceIndex=Math.floor(l/3),O.face.materialIndex=c.materialIndex,e.push(O));else for(A=Math.max(0,x.start),u=Math.min(d.count,x.start+x.count);A<u;A+=3)(O=Ye(this,i,t,Te,d,y,m,g,v,o=A,s=A+1,a=A+2))&&(O.faceIndex=Math.floor(A/3),e.push(O))}else if(n.isGeometry){var w,B=Array.isArray(i),M=n.vertices,S=n.faces;0<(r=n.faceVertexUvs[0]).length&&(w=r);for(var _=0,E=S.length;_<E;_++){var T,C,F,O,P=S[_],U=B?i[P.materialIndex]:i;void 0!==U&&(T=M[P.a],C=M[P.b],F=M[P.c],O=Ge(this,U,t,Te,T,C,F,He))&&(w&&w[_]&&(U=w[_],ke.copy(U[0]),Ne.copy(U[1]),je.copy(U[2]),O.uv=Se.getUV(He,T,C,F,ke,Ne,je,new ut)),O.face=P,O.faceIndex=_,e.push(O))}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Object.assign(Ke.prototype,{set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera&&(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e)},intersectObject:function(t,e,n){return We(t,this,n=n||[],e),n.sort(Xe),n},intersectObjects:function(t,e,n){var i=n||[];if(!1===Array.isArray(t));else{for(var r=0,o=t.length;r<o;r++)We(t[r],this,i,e);i.sort(Xe)}return i}});var Ze={AMAP_SATELLITE:1,AMAP_VECTOR:2,BAIDU_VECTOR:4,BAIDU_SATELLITE:8,TD_VECTOR:16,TD_SATELLITE:32,OSM:64},qe={FOV:35,CAMERA_NEAR:1,CAMERA_FAR:1e5,ZOOM_UPPER_BOUND:30,TILT_UPPER_BOUND:90,THOUSAND:1e3,DEG2RAD:.0174532,RAD2DEG:57.2957795,DRAW_TIME:500,EPS:.001},Je=(Object.freeze(qe),qe),$e={YELLOW:"YELLOW",CELESTE:"CELESTE",GRAY:"GRAY",PEACH:"PEACH",PINK:"PINK",SAPPHIRE:"SAPPHIRE",NONE:"NONE",CUSTOM:"CUSTOM"};function tn(){Q.call(this),this.type="Group"}function en(t){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===en(t=function(t,e){if("object"!==en(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==en(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}tn.prototype=Object.assign(Object.create(Q.prototype),{constructor:tn,isGroup:!0});var rn=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.disposed=!1}var e,n;return e=t,(n=[{key:"dispose",value:function(){this.disposed||(this.disposed=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}])&&nn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function on(t,e){return e<t?1:t<e?-1:0}function sn(t,e,n){var i,r=t.length;if(t[0]<=e)return 0;if(!(e<=t[r-1]))if(0<n){for(i=1;i<r;++i)if(t[i]<e)return i-1}else if(n<0){for(i=1;i<r;++i)if(t[i]<=e)return i}else for(i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return"function"==typeof n?0<n(e,t[i-1],t[i])?i-1:i:t[i-1]-e<e-t[i]?i-1:i}return r-1}function an(t,e){var n=t.length;if(n===e.length){for(var i=0;i<n;i++)if(t[i]!==e[i])return;return 1}}function An(){return!0}function ln(){}function un(){throw new Error("Unimplemented abstract method.")}var hn=0;function cn(t){return t.ol_uid||(t.ol_uid=String(++hn))}var fn=((qe="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"").indexOf("firefox"),-1!==qe.indexOf("safari")&&qe.indexOf("chrom"),-1!==qe.indexOf("webkit")&&qe.indexOf("edge"),qe.indexOf("macintosh"),"undefined"!=typeof devicePixelRatio?devicePixelRatio:1),pn="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,dn="undefined"!=typeof Image&&Image.prototype.decode;function yn(t){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}function gn(t,e){return(gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vn(t){return(vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}!function(){try{var t=Object.defineProperty({},"passive",{get:function(){!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch(t){}}();var bn=function(t){var e=i;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gn(e,t);var n=function(t){var e=mn();return function(){var n,i=vn(t);if(n=e?(n=vn(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===yn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e,r;if(this instanceof i)return(r=n.call(this,e="Assertion failed. See https://openlayers.org/en/latest/doc/errors/#"+t+" for details.")).code=t,r.name="AssertionError",r.message=e,r;throw new TypeError("Cannot call a class as a function")}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(function(t){var e="function"==typeof Map?new Map:void 0;return function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){return(mn()?Reflect.construct.bind():function(t,e,n){var i=[null];return i.push.apply(i,e),e=new(Function.bind.apply(t,i)),n&&gn(e,n.prototype),e}).apply(null,arguments)}(t,arguments,vn(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),gn(n,t)}(t)}(Error));function xn(t,e){if(!t)throw new bn(e)}function wn(t,e){var n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function Bn(t,e,n,i,r,o,s,a){var A=Math.sin(o);o=Math.cos(o);return t[0]=i*o,t[1]=r*A,t[2]=-i*A,t[3]=r*o,t[4]=s*i*o-a*i*A+e,t[5]=s*r*A+a*r*o+n,t}function Mn(t,e){var n=e[0]*e[3]-e[1]*e[2],i=(xn(0!=n,32),e[0]),r=e[1],o=e[2],s=e[3],a=e[4];e=e[5];return t[0]=s/n,t[1]=-r/n,t[2]=-o/n,t[3]=i/n,t[4]=(o*e-s*a)/n,t[5]=-(i*e-r*a)/n,t}new Array(6);var Sn={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},_n={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function En(t,e,n){return(e=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*e+(n=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*n}function Tn(t,e){return Cn(t,e[0],e[1])}function Cn(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Fn(t,e){var n=t[0],i=t[1],r=t[2],o=(t=t[3],e[0]),s=(e=e[1],_n.UNKNOWN);return o<n?s|=_n.LEFT:r<o&&(s|=_n.RIGHT),e<i?s|=_n.BELOW:t<e&&(s|=_n.ABOVE),s===_n.UNKNOWN?_n.INTERSECTING:s}function On(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function Pn(t){return On(1/0,1/0,-1/0,-1/0,t)}function Un(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Rn(t,e,n,i,r){for(;n<i;n+=r)o=t,s=e[n],a=e[n+1],o[0]=Math.min(o[0],s),o[1]=Math.min(o[1],a),o[2]=Math.max(o[2],s),o[3]=Math.max(o[3],a);var o,s,a;return t}function In(t){return[t[0],t[1]]}function Ln(t){return[t[2],t[1]]}function Dn(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Qn(t,e,n,i,r){var o=e*i[0]/2,s=(e=e*i[1]/2,o*(i=Math.cos(n))),a=(o=o*(n=Math.sin(n)),i=e*i,e=e*n,(n=t[0])-s+e),A=n-s-e,l=n+s-e,u=(n=n+s+e,s=(t=t[1])-o-i,e=t-o+i,t+o+i);t=t+o-i;return On(Math.min(a,A,l,n),Math.min(s,e,u,t),Math.max(a,A,l,n),Math.max(s,e,u,t),r)}function kn(t){return t[3]-t[1]}function Nn(t,e,n){return n=n||[1/0,1/0,-1/0,-1/0],Vn(t,e)?(t[0]>e[0]?n[0]=t[0]:n[0]=e[0],t[1]>e[1]?n[1]=t[1]:n[1]=e[1],t[2]<e[2]?n[2]=t[2]:n[2]=e[2],t[3]<e[3]?n[3]=t[3]:n[3]=e[3]):Pn(n),n}function jn(t){return[t[0],t[3]]}function Hn(t){return[t[2],t[3]]}function zn(t){return t[2]-t[0]}function Vn(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Gn(t,e,n){return Math.min(Math.max(t,e),n)}var Yn="cosh"in Math?Math.cosh:function(t){return((t=Math.exp(t))+1/t)/2};function Kn(t,e,n,i){return(n-=t)*n+(t=i-e)*t}function Xn(t,e){return(t%=e)*e<0?t+e:t}function Wn(t,e){return e=Math.pow(10,e),Math.round(t*e)/e}function Zn(t,e){return Math.floor(Wn(t,e))}function qn(t,e){return Math.ceil(Wn(t,e))}"log2"in Math&&Math.log2;var Jn=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,$n=/^([a-z]*)$|^hsla?\(.*\)$/i;ti={},ei=0;var ti,ei,ni=function(t){var e;if(ti.hasOwnProperty(t))e=ti[t];else{if(1024<=ei){var n,i=0;for(n in ti)0==(3&i++)&&(delete ti[n],--ei)}e=function(t){var e,n,i,r,o,s;return $n.exec(t)&&(t=function(t){var e=document.createElement("div");return e.style.color=t,""!==e.style.color?(document.body.appendChild(e),t=getComputedStyle(e).color,document.body.removeChild(e),t):""}(t)),Jn.exec(t)?(o=(s=t.length-1)<=4?1:2,s=4==s||8==s,e=parseInt(t.substr(1+0*o,o),16),n=parseInt(t.substr(+o+1,o),16),i=parseInt(t.substr(1+2*o,o),16),r=s?parseInt(t.substr(1+3*o,o),16):255,1==o&&(e=(e<<4)+e,n=(n<<4)+n,i=(i<<4)+i,s)&&(r=(r<<4)+r),o=[e,n,i,r/255]):0==t.indexOf("rgba(")?ri(o=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((o=t.slice(4,-1).split(",").map(Number)).push(1),ri(o)):xn(!1,14),o}(t),ti[t]=e,++ei}return e};function ii(t){return Array.isArray(t)?t:ni(t)}function ri(t){t[0]=Gn(t[0]+.5|0,0,255),t[1]=Gn(t[1]+.5|0,0,255),t[2]=Gn(t[2]+.5|0,0,255),t[3]=Gn(t[3],0,1)}function oi(t){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function si(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===oi(t=function(t,e){if("object"!==oi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==oi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function ai(t,e,n){return e+":"+t+":"+(n?function(t){var e,n,i;return"string"==typeof t?t:((e=(t=t)[0])!=(0|e)&&(e=e+.5|0),(n=t[1])!=(0|n)&&(n=n+.5|0),(i=t[2])!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(t=void 0===t[3]?1:Math.round(100*t[3])/100)+")")}(n):"null")}var Ai=new(qe=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}var e,n;return e=t,(n=[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t,e=0;for(t in this.cache_){var n=this.cache_[t];0!=(3&e++)||n.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}}},{key:"get",value:function(t,e,n){return(t=ai(t,e,n))in this.cache_?this.cache_[t]:null}},{key:"set",value:function(t,e,n,i){t=ai(t,e,n),this.cache_[t]=i,++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}])&&si(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function li(t){return(li="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ui(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===li(t=function(t,e){if("object"!==li(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==li(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var hi=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}var e,n;return e=t,(n=[{key:"preventDefault",value:function(){this.defaultPrevented=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&ui(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),ci="propertychange",fi="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1,r=arguments.length;i<r;++i){var o=arguments[i];if(null!=o)for(var s in o)o.hasOwnProperty(s)&&(n[s]=o[s])}return n};function pi(t){for(var e in t)delete t[e]}function di(t){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===di(t=function(t,e){if("object"!==di(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==di(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function mi(t,e){return(mi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function gi(t){return(gi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}"function"==typeof Object.values&&Object.values;var vi=function(){var t=i,e=rn;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mi(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=gi(t);if(n=e?(n=gi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===di(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this)).eventTarget_=t,e.pendingRemovals_=null,e.dispatching_=null,e.listeners_=null,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"addEventListener",value:function(t,e){var n;t&&e&&-1===(n=(n=this.listeners_||(this.listeners_={}))[t]||(n[t]=[])).indexOf(e)&&n.push(e)}},{key:"dispatchEvent",value:function(t){var e=(o="string"==typeof t)?t:t.type,n=this.listeners_&&this.listeners_[e];if(n){var i,r=o?new hi(t):t,o=(r.target||(r.target=this.eventTarget_||this),this.dispatching_||(this.dispatching_={}));t=this.pendingRemovals_||(this.pendingRemovals_={});e in o||(o[e]=0,t[e]=0),++o[e];for(var s=0,a=n.length;s<a;++s)if(!1===(i="handleEvent"in n[s]?n[s].handleEvent(r):n[s].call(this,r))||r.propagationStopped){i=!1;break}if(0==--o[e]){var A=t[e];for(delete t[e];A--;)this.removeEventListener(e,ln);delete o[e]}return i}}},{key:"disposeInternal",value:function(){this.listeners_&&pi(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_&&this.listeners_[t]||void 0}},{key:"hasListener",value:function(t){return!!this.listeners_&&(t?t in this.listeners_:0<Object.keys(this.listeners_).length)}},{key:"removeEventListener",value:function(t,e){var n=this.listeners_&&this.listeners_[t];n&&-1!==(e=n.indexOf(e))&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[e]=ln,++this.pendingRemovals_[t]):(n.splice(e,1),0===n.length&&delete this.listeners_[t]))}}])&&yi(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),bi="change",xi="error",wi="load";function Bi(t,e,n,i,r){i&&i!==t&&(n=n.bind(i)),r&&(o=n,n=function(){t.removeEventListener(e,n),o.apply(this,arguments)});var o;i={target:t,type:e,listener:n};return t.addEventListener(e,n),i}function Mi(t,e,n,i){return Bi(t,e,n,i,!0)}function Si(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),pi(t))}function _i(t){return(_i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ei(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===_i(t=function(t,e){if("object"!==_i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==_i(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ti(t,e){return(Ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ci(t){return(Ci=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(qe=function(){var t=i,e=vi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ti(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ci(t);if(n=e?(n=Ci(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===_i(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t;if(this instanceof i)return(t=n.call(this)).on=t.onInternal,t.once=t.onceInternal,t.un=t.unInternal,t.revision_=0,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(bi)}},{key:"getRevision",value:function(){return this.revision_}},{key:"onInternal",value:function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=Bi(this,t[r],e);return i}return Bi(this,t,e)}},{key:"onceInternal",value:function(t,e){if(Array.isArray(t))for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=Mi(this,t[r],e);else i=Mi(this,t,e);return e.ol_key=i}},{key:"unInternal",value:function(t,e){var n=e.ol_key;if(n){var i=n;if(Array.isArray(i))for(var r=0,o=i.length;r<o;++r)Si(i[r]);else Si(i)}else if(Array.isArray(t))for(var s=0,a=t.length;s<a;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}}])&&Ei(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}()).prototype.on,qe.prototype.once,qe.prototype.un;var Fi=qe;function Oi(t){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Oi(t=function(t,e){if("object"!==Oi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Oi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ui(t,e,n){return e&&Pi(t.prototype,e),n&&Pi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Ri(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ii(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Li(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Qi(t);n=e?(n=Qi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this;if(n&&("object"===Oi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Di(i)}}function Di(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Qi(t){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ki=function(){Ii(e,hi);var t=Li(e);function e(n,i,r){return Ri(this,e),(n=t.call(this,n)).key=i,n.oldValue=r,n}return Ui(e)}(),Ni=function(){Ii(e,Fi);var t=Li(e);function e(n){var i;return Ri(this,e),(i=t.call(this)).on,i.once,i.un,cn(Di(i)),i.values_=null,void 0!==n&&i.setProperties(n),i}return Ui(e,[{key:"get",value:function(t){var e;return this.values_&&this.values_.hasOwnProperty(t)?this.values_[t]:e}},{key:"getKeys",value:function(){return this.values_&&Object.keys(this.values_)||[]}},{key:"getProperties",value:function(){return this.values_&&fi({},this.values_)||{}}},{key:"hasProperties",value:function(){return!!this.values_}},{key:"notify",value:function(t,e){var n="change:".concat(t);this.hasListener(n)&&this.dispatchEvent(new ki(n,t,e)),n=ci,this.hasListener(n)&&this.dispatchEvent(new ki(n,t,e))}},{key:"addChangeListener",value:function(t,e){this.addEventListener("change:".concat(t),e)}},{key:"removeChangeListener",value:function(t,e){this.removeEventListener("change:".concat(t),e)}},{key:"set",value:function(t,e,n){var i=this.values_||(this.values_={});n?i[t]=e:(n=i[t])!==(i[t]=e)&&this.notify(t,n)}},{key:"setProperties",value:function(t,e){for(var n in t)this.set(n,t[n],e)}},{key:"applyProperties",value:function(t){t.values_&&fi(this.values_||(this.values_={}),t.values_)}},{key:"unset",value:function(t,e){var n;this.values_&&t in this.values_&&(n=this.values_[t],delete this.values_[t],function(t){for(var e in t)return;return!e}(this.values_)&&(this.values_=null),e||this.notify(t,n))}}]),e}(),ji="opacity",Hi="visible",zi="zIndex",Vi="maxResolution",Gi="minResolution",Yi="maxZoom",Ki="minZoom",Xi="source";function Wi(t){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Wi(t=function(t,e){if("object"!==Wi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Wi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function qi(){return(qi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$i(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function Ji(t,e){return(Ji=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function $i(t){return($i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tr=function(){var t=i,e=Ni;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ji(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=$i(t);if(n=e?(n=$i(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Wi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(e=n.call(this)).on,e.once,e.un,e.background_=t.background;var r=fi({},t);return"object"===Wi(t.properties)&&(delete r.properties,fi(r,t.properties)),r[ji]=void 0!==t.opacity?t.opacity:1,xn("number"==typeof r[ji],64),r[Hi]=void 0===t.visible||t.visible,r[zi]=t.zIndex,r[Vi]=void 0!==t.maxResolution?t.maxResolution:1/0,r[Gi]=void 0!==t.minResolution?t.minResolution:0,r[Ki]=void 0!==t.minZoom?t.minZoom:-1/0,r[Yi]=void 0!==t.maxZoom?t.maxZoom:1/0,e.className_=void 0!==r.className?r.className:"ol-layer",delete r.className,e.setProperties(r),e.state_=null,e}return t=i,(e=[{key:"getBackground",value:function(){return this.background_}},{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){t=this.state_||{layer:this,managed:void 0===t||t};var e=this.getZIndex();return t.opacity=Gn(Math.round(100*this.getOpacity())/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0!==e||t.managed?e:1/0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t}},{key:"getLayersArray",value:un},{key:"getLayerStatesArray",value:function(t){return un()}},{key:"getExtent",value:function(){return this.get("extent")}},{key:"getMaxResolution",value:function(){return this.get(Vi)}},{key:"getMinResolution",value:function(){return this.get(Gi)}},{key:"getMinZoom",value:function(){return this.get(Ki)}},{key:"getMaxZoom",value:function(){return this.get(Yi)}},{key:"getOpacity",value:function(){return this.get(ji)}},{key:"getSourceState",value:function(){return un()}},{key:"getVisible",value:function(){return this.get(Hi)}},{key:"getZIndex",value:function(){return this.get(zi)}},{key:"setBackground",value:function(t){this.background_=t,this.changed()}},{key:"setExtent",value:function(t){this.set("extent",t)}},{key:"setMaxResolution",value:function(t){this.set(Vi,t)}},{key:"setMinResolution",value:function(t){this.set(Gi,t)}},{key:"setMaxZoom",value:function(t){this.set(Yi,t)}},{key:"setMinZoom",value:function(t){this.set(Ki,t)}},{key:"setOpacity",value:function(t){xn("number"==typeof t,64),this.set(ji,t)}},{key:"setVisible",value:function(t){this.set(Hi,t)}},{key:"setZIndex",value:function(t){this.set(zi,t)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),qi($i(i.prototype),"disposeInternal",this).call(this)}}])&&Zi(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),er="rendercomplete",nr="undefined",ir="ready";function rr(t){return(rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function or(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===rr(t=function(t,e){if("object"!==rr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==rr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function sr(){return(sr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ar(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function ar(t,e){return(ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ar(t){return(Ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function lr(t,e){if(t.visible){var n=e.resolution;if(!(n<t.minResolution||n>=t.maxResolution))return(n=e.zoom)>t.minZoom&&n<=t.maxZoom}}var ur=function(){var t=i,e=tr;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ar(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ar(t);if(n=e?(n=Ar(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===rr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return delete(e=fi({},t)).source,(e=n.call(this,e)).on,e.once,e.un,e.mapPrecomposeKey_=null,e.mapRenderKey_=null,e.sourceChangeKey_=null,e.renderer_=null,e.rendered=!1,t.render&&(e.render=t.render),t.map&&e.setMap(t.map),e.addChangeListener(Xi,e.handleSourcePropertyChange_),t=t.source||null,e.setSource(t),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getLayersArray",value:function(t){return(t=t||[]).push(this),t}},{key:"getLayerStatesArray",value:function(t){return(t=t||[]).push(this.getLayerState()),t}},{key:"getSource",value:function(){return this.get(Xi)||null}},{key:"getRenderSource",value:function(){return this.getSource()}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():nr}},{key:"handleSourceChange_",value:function(){this.changed()}},{key:"handleSourcePropertyChange_",value:function(){this.sourceChangeKey_&&(Si(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Bi(t,bi,this.handleSourceChange_,this)),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(function(t){return t([])})}},{key:"getData",value:function(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}},{key:"render",value:function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return this.rendered=!0,n.renderFrame(t,e)}},{key:"unrender",value:function(){this.rendered=!1}},{key:"setMapInternal",value:function(t){t||this.unrender(),this.set("map",t)}},{key:"getMapInternal",value:function(){return this.get("map")}},{key:"setMap",value:function(t){this.mapPrecomposeKey_&&(Si(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Si(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Bi(t,"precompose",function(t){t=t.frameState.layerStatesArray;var e=this.getLayerState(!1);xn(!t.some(function(t){return t.layer===e.layer}),67),t.push(e)},this),this.mapRenderKey_=Bi(this,bi,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(Xi,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),sr(Ar(i.prototype),"disposeInternal",this).call(this)}}])&&or(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function hr(t,e){for(var n=!0,i=t.length-1;0<=i;--i)if(t[i]!=e[i]){n=!1;break}return n}function cr(t){return(cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===cr(t=function(t,e){if("object"!==cr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==cr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function pr(t,e){return(pr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function dr(t){return(dr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,e){Ai.expire()}var mr=function(){var t=i,e=rn;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pr(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=dr(t);if(n=e?(n=dr(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===cr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this)).map_=t,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"dispatchRenderEvent",value:function(t,e){un()}},{key:"calculateMatrices2D",value:function(t){var e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;Bn(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Mn(i,n)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r,o,s,a){var A,l=e.viewState;function u(t,e,n,i){return r.call(o,e,t?n:null,i)}for(var h,c,f,p,d=l.projection,y=(h=t.slice(),(f=d).canWrapX()&&(f=function(t,e,n){var i=e.getExtent(),r=0;return e.canWrapX()&&(t[0]<i[0]||t[0]>i[2])&&(e=n||zn(i),r=Math.floor((t[0]-i[0])/e)),r}(h,f,c=zn(f.getExtent())))&&(h[0]-=f*c),h),m=[[0,0]],g=(d.canWrapX()&&i&&(f=zn(d.getExtent()),m.push([-f,0],[f,0])),e.layerStatesArray),v=g.length,b=[],x=[],w=0;w<m.length;w++)for(var B=v-1;0<=B;--B){var M=g[B];if((_=M.layer).hasRenderer()&&lr(M,l)&&s.call(a,_)){var S=_.getRenderer(),_=_.getSource();if(S&&_&&(_=_.getWrapX()?y:t,M=u.bind(null,M.managed),x[0]=_[0]+m[w][0],x[1]=_[1]+m[w][1],A=S.forEachFeatureAtCoordinate(x,e,n,M,b)),A)return A}}if(0!==b.length)return p=1/b.length,b.forEach(function(t,e){return t.distanceSq+=e*p}),b.sort(function(t,e){return t.distanceSq-e.distanceSq}),b.some(function(t){return A=t.callback(t.feature,t.layer,t.geometry)}),A}},{key:"forEachLayerAtPixel",value:function(t,e,n,i,r){return un()}},{key:"hasFeatureAtCoordinate",value:function(t,e,n,i,r,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,An,this,r,o)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){un()}},{key:"scheduleExpireIconCache",value:function(t){Ai.canExpireCache()&&t.postRenderFunctions.push(yr)}}])&&fr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===gr(t=function(t,e){if("object"!==gr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==gr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function br(){return(br="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wr(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function xr(t,e){return(xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function wr(t){return(wr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Br=function(){var t=i,e=mr;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xr(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=wr(t);if(n=e?(n=wr(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===gr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){if(this instanceof i)return(t=n.call(this,t)).children_=[],t.renderedVisible_=!0,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"disposeInternal",value:function(){br(wr(i.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(t){this.calculateMatrices2D(t);for(var e=t.layerStatesArray.sort(function(t,e){return t.zIndex-e.zIndex}),n=t.viewState,i=[],r=null,o=this.children_.length=0,s=e.length;o<s;++o){var a=e[o],A=(t.layerIndex=o,a.layer),l=A.getSourceState();!lr(a,n)||l!=ir&&l!=nr?A.unrender():(a=A.render(t,r))&&(a!==r&&(this.children_.push(a),r=a),"getDeclutter"in A)&&i.push(A)}for(var u=i.length-1;0<=u;--u)i[u].renderDeclutter(t);this.scheduleExpireIconCache(t)}}])&&vr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),Mr="remove";function Sr(t){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Sr(t=function(t,e){if("object"!==Sr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Sr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Er(t,e,n){return e&&_r(t.prototype,e),n&&_r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Cr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function Fr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Or(t);n=e?(n=Or(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this;if(n&&("object"===Sr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Or(t){return(Or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Pr=function(){Cr(e,hi);var t=Fr(e);function e(n,i,r){return Tr(this,e),(n=t.call(this,n)).element=i,n.index=r,n}return Er(e)}(),Ur=function(){Cr(e,Ni);var t=Fr(e);function e(n,i){Tr(this,e),(r=t.call(this)).on,r.once,r.un;var r;i=i||{};if(r.unique_=!!i.unique,r.array_=n||[],r.unique_)for(var o=0,s=r.array_.length;o<s;++o)r.assertUnique_(r.array_[o],o);return r.updateLength_(),r}return Er(e,[{key:"clear",value:function(){for(;0<this.getLength();)this.pop()}},{key:"extend",value:function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this}},{key:"forEach",value:function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)t(e[n],n,e)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get("length")}},{key:"insertAt",value:function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Pr("add",e,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}},{key:"remove",value:function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}},{key:"removeAt",value:function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Pr(Mr,e,t)),e}},{key:"setAt",value:function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Pr(Mr,i,t)),this.dispatchEvent(new Pr("add",e,t))}else{for(var r=n;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}}},{key:"updateLength_",value:function(){this.set("length",this.array_.length)}},{key:"assertUnique_",value:function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new bn(58)}}]),e}();function Rr(t){return(Rr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ir(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Rr(t=function(t,e){if("object"!==Rr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Rr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Lr(t,e,n){return e&&Ir(t.prototype,e),n&&Ir(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qr(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function kr(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Nr(t);n=e?(n=Nr(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this;if(n&&("object"===Rr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function Nr(t){return(Nr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var jr=function(){Qr(e,hi);var t=kr(e);function e(n,i){return Dr(this,e),(n=t.call(this,n)).layer=i,n}return Lr(e)}(),Hr="layers",zr=function(){Qr(e,tr);var t=kr(e);function e(n){Dr(this,e);var i;delete(i=fi({},n=n||{})).layers,n=n.layers;return(i=t.call(this,i)).on,i.once,i.un,i.layersListenerKeys_=[],i.listenerKeys_={},i.addChangeListener(Hr,i.handleLayersChanged_),n?Array.isArray(n)?n=new Ur(n.slice(),{unique:!0}):xn("function"==typeof n.getArray,43):n=new Ur(void 0,{unique:!0}),i.setLayers(n),i}return Lr(e,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(Si),this.layersListenerKeys_.length=0;var t,e=this.getLayers();for(t in this.layersListenerKeys_.push(Bi(e,"add",this.handleLayersAdd_,this),Bi(e,Mr,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(Si);pi(this.listenerKeys_);for(var n=e.getArray(),i=0,r=n.length;i<r;i++){var o=n[i];this.registerLayerListeners_(o),this.dispatchEvent(new jr("addlayer",o))}this.changed()}},{key:"registerLayerListeners_",value:function(t){var n=[Bi(t,ci,this.handleLayerChange_,this),Bi(t,bi,this.handleLayerChange_,this)];t instanceof e&&n.push(Bi(t,"addlayer",this.handleLayerGroupAdd_,this),Bi(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[cn(t)]=n}},{key:"handleLayerGroupAdd_",value:function(t){this.dispatchEvent(new jr("addlayer",t.layer))}},{key:"handleLayerGroupRemove_",value:function(t){this.dispatchEvent(new jr("removelayer",t.layer))}},{key:"handleLayersAdd_",value:function(t){t=t.element,this.registerLayerListeners_(t),this.dispatchEvent(new jr("addlayer",t)),this.changed()}},{key:"handleLayersRemove_",value:function(t){var e=cn(t=t.element);this.listenerKeys_[e].forEach(Si),delete this.listenerKeys_[e],this.dispatchEvent(new jr("removelayer",t)),this.changed()}},{key:"getLayers",value:function(){return this.get(Hr)}},{key:"setLayers",value:function(t){var e=this.getLayers();if(e)for(var n=e.getArray(),i=0,r=n.length;i<r;++i)this.dispatchEvent(new jr("removelayer",n[i]));this.set(Hr,t)}},{key:"getLayersArray",value:function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}},{key:"getLayerStatesArray",value:function(t){var e=void 0!==t?t:[],n=e.length,i=(this.getLayers().forEach(function(t){t.getLayerStatesArray(e)}),this.getLayerState()),r=i.zIndex;t||void 0!==i.zIndex||(r=0);for(var o=n,s=e.length;o<s;o++){var a=e[o];a.opacity*=i.opacity,a.visible=a.visible&&i.visible,a.maxResolution=Math.min(a.maxResolution,i.maxResolution),a.minResolution=Math.max(a.minResolution,i.minResolution),a.minZoom=Math.max(a.minZoom,i.minZoom),a.maxZoom=Math.min(a.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==a.extent?a.extent=Nn(a.extent,i.extent):a.extent=i.extent),void 0===a.zIndex&&(a.zIndex=r)}return e}},{key:"getSourceState",value:function(){return ir}}]),e}();function Vr(t){return(Vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gr(t,e){return(Gr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Yr(t){return(Yr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Kr=function(){var t=i,e=hi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gr(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Yr(t);if(n=e?(n=Yr(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Vr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return(t=n.call(this,t)).map=e,t.frameState=void 0!==r?r:null,t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(),Xr={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};function Wr(t){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Wr(t=function(t,e){if("object"!==Wr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Wr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var qr=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}var e,n;return e=t,(n=[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,pi(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0)),t=this.keyFunction_(n);return delete this.queuedElements_[t],n}},{key:"enqueue",value:function(t){xn(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){for(var t=(this.elements_.length>>1)-1;0<=t;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var e=this.elements_,n=this.priorities_,i=e.length,r=e[t],o=n[t],s=t;t<i>>1;){var a=this.getLeftChildIndex_(t),A=(A=this.getRightChildIndex_(t))<i&&n[A]<n[a]?A:a;e[t]=e[A],n[t]=n[A],t=A}e[t]=r,n[t]=o,this.siftDown_(s,t)}},{key:"siftDown_",value:function(t,e){for(var n=this.elements_,i=this.priorities_,r=n[e],o=i[e];t<e;){var s=this.getParentIndex_(e);if(!(i[s]>o))break;n[e]=n[s],i[e]=i[s],e=s}n[e]=r,i[e]=o}},{key:"reprioritize",value:function(){for(var t,e,n=this.priorityFunction_,i=this.elements_,r=this.priorities_,o=0,s=i.length,a=0;a<s;++a)(e=n(t=i[a]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(r[o]=e,i[o++]=t);i.length=o,r.length=o,this.heapify_()}}])&&Zr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Jr(t){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Jr(t=function(t,e){if("object"!==Jr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Jr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function to(){return(to="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=io(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function eo(t,e){return(eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function no(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function io(t){return(io=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ro=function(){var t=i,e=qr;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eo(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=io(t);if(n=e?(n=io(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Jr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return no(i)}}(i);function i(t,e){var r;if(this instanceof i)return(r=n.call(this,function(e){return t.apply(null,e)},function(t){return t[0].getKey()})).boundHandleTileChange_=r.handleTileChange.bind(no(r)),r.tileChangeCallback_=e,r.tilesLoading_=0,r.tilesLoadingKeys_={},r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"enqueue",value:function(t){var e=to(io(i.prototype),"enqueue",this).call(this,t);return e&&t[0].addEventListener(bi,this.boundHandleTileChange_),e}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var e=(t=t.target).getState();2!==e&&3!==e&&4!==e||(t.removeEventListener(bi,this.boundHandleTileChange_),(e=t.getKey())in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[e],--this.tilesLoading_),this.tileChangeCallback_())}},{key:"loadMoreTiles",value:function(t,e){for(var n,i,r=0;this.tilesLoading_<t&&r<e&&0<this.getCount();)i=(n=this.dequeue()[0]).getKey(),0!==n.getState()||i in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[i]=!0,++this.tilesLoading_,++r,n.load())}}])&&$r(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),oo={},so=(oo[(qe={RADIANS:"radians",DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"}).RADIANS]=6370997/(2*Math.PI),oo[qe.DEGREES]=2*Math.PI*6370997/360,oo[qe.FEET]=.3048,oo[qe.METERS]=1,oo[qe.USFEET]=1200/3937,qe),ao={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Ao=42,lo=256;function uo(t){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ho(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===uo(t=function(t,e){if("object"!==uo(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==uo(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var co=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}var e,n;return e=t,(n=[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||oo[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}])&&ho(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function fo(t){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function po(t,e){return(po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yo(t){return(yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mo=6378137,go=Math.PI*mo,vo=[-go,-go,go,go],bo=[-180,-85,180,85],xo=mo*Math.log(Math.tan(Math.PI/2));qe=[new(qe=function(){var t=i,e=co;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&po(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=yo(t);if(n=e?(n=yo(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===fo(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){if(this instanceof i)return n.call(this,{code:t,units:so.METERS,extent:vo,global:!0,worldExtent:bo,getPointResolution:function(t,e){return t/Yn(e[1]/mo)}});throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}())("EPSG:3857"),new qe("EPSG:102100"),new qe("EPSG:102113"),new qe("EPSG:900913"),new qe("http://www.opengis.net/def/crs/EPSG/0/3857"),new qe("http://www.opengis.net/gml/srs/epsg.xml#3857")];function wo(t){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Bo(t,e){return(Bo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Mo(t){return(Mo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var So=[-180,-90,180,90],_o=6378137*Math.PI/180,Eo=[new(Eo=function(){var t=i,e=co;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bo(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Mo(t);if(n=e?(n=Mo(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===wo(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return n.call(this,{code:t,units:so.DEGREES,extent:So,axisOrientation:e,global:!0,metersPerUnit:_o,worldExtent:So});throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}())("CRS:84"),new Eo("EPSG:4326","neu"),new Eo("urn:ogc:def:crs:OGC:1.3:CRS84"),new Eo("urn:ogc:def:crs:OGC:2:84"),new Eo("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Eo("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Eo("http://www.opengis.net/def/crs/EPSG/0/4326","neu")],To={},Co={};function Fo(t,e,n){t=t.getCode(),e=e.getCode(),t in Co||(Co[t]={}),Co[t][e]=n}var Oo=!0;function Po(t,e,n){var i;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];i=e}else i=t.slice();return i}function Uo(t,e,n){if(void 0!==e&&t!==e){for(var i=0,r=t.length;i<r;++i)e[i]=t[i];t=e}return t}function Ro(t){var e;e=t.getCode(),Fo(To[e]=t,t,Po)}function Io(t){return"string"==typeof t?To[e=t]||To[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Lo(t){t.forEach(Ro),t.forEach(function(e){t.forEach(function(t){e!==t&&Fo(e,t,Po)})})}function Do(t,e){return t?"string"==typeof t?Io(t):t:Io(e)}function Qo(t,e){var n;return t===e||(n=t.getUnits()===e.getUnits(),(t.getCode()===e.getCode()||ko(t,e)===Po)&&n)}function ko(t,e){var n;t=t.getCode();return e=e=e.getCode(),(n=(t=t)in Co&&e in Co[t]?Co[t][e]:n)||Uo}function No(t,e){return ko(Io(t),Io(e))}function jo(t,e,n){return No(e,n)(t,void 0,t.length)}function Ho(t,e,n,i){return function(t,e,n,i){var r=[];if(1<i)for(var o=t[2]-t[0],s=t[3]-t[1],a=0;a<i;++a)r.push(t[0]+o*a/i,t[1],t[2],t[1]+s*a/i,t[2]-o*a/i,t[3],t[0],t[3]-s*a/i);else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);for(var A,l=[],u=[],h=0,c=r.length;h<c;h+=2)l.push(r[h]),u.push(r[h+1]);return e=l,A=u,n=n,On(Math.min.apply(null,e),Math.min.apply(null,A),Math.max.apply(null,e),Math.max.apply(null,A),n)}(t,No(e,n),void 0,i)}var zo,Vo,Go,Yo=null;function Ko(t,e){return Yo?jo(t,e,Yo):t}function Xo(t,e){return Yo?jo(t,Yo,e):(Oo&&!hr(t,[0,0])&&-180<=t[0]&&t[0]<=180&&-90<=t[1]&&t[1]<=90&&(Oo=!1),t)}function Wo(t,e){return Yo?Ho(t,Yo,e):t}function Zo(t,e,n){return function(i,r,o,s,a){var A,l,u,h;if(i)return r||e?(l=e?0:o[0]*r,o=e?0:o[1]*r,u=a?a[0]:0,a=a?a[1]:0,A=t[0]+l/2+u,l=t[2]-l/2+u,u=t[1]+o/2+a,l<A&&(l=A=(l+A)/2),(o=t[3]-o/2+a)<u&&(o=u=(o+u)/2),a=Gn(i[0],A,l),h=Gn(i[1],u,o),s&&n&&r&&(a+=-(s=30*r)*Math.log(1+Math.max(0,A-i[0])/s)+s*Math.log(1+Math.max(0,i[0]-l)/s),h+=-s*Math.log(1+Math.max(0,u-i[1])/s)+s*Math.log(1+Math.max(0,i[1]-o)/s)),[a,h]):i}}function qo(t){return t}function Jo(t){if(void 0!==t)return 0}function $o(t){if(void 0!==t)return t}function ts(t){return Math.pow(t,3)}function es(t){return 1-ts(1-t)}function ns(t){return 3*t*t-2*t*t*t}function is(t){return(is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function rs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===is(t=function(t,e){if("object"!==is(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==is(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function os(t,e){return(os=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ss(t){return(ss=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function as(t,e){setTimeout(function(){t(e)},0)}function As(t,e,n,i,r){var o=Math.cos(-r),s=(r=Math.sin(-r),t[0]*o-t[1]*r);t=t[1]*o+t[0]*r;return[(s+=(e[0]/2-n[0])*i)*o-(t+=(n[1]-e[1]/2)*i)*(r=-r),t*o+s*r]}Lo(qe),Lo(Eo),zo=qe,Vo=function(t,e,n){var i=t.length,r=1<n?n:2,o=e;void 0===o&&(o=2<r?t.slice():new Array(i));for(var s=0;s<i;s+=r){o[s]=go*t[s]/180;var a=mo*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));xo<a?a=xo:a<-xo&&(a=-xo),o[s+1]=a}return o},Go=function(t,e,n){var i=t.length,r=1<n?n:2,o=e;void 0===o&&(o=2<r?t.slice():new Array(i));for(var s=0;s<i;s+=r)o[s]=180*t[s]/go,o[s+1]=360*Math.atan(Math.exp(t[s+1]/mo))/Math.PI-90;return o},Eo.forEach(function(t){zo.forEach(function(e){Fo(t,e,Vo),Fo(e,t,Go)})});var ls=function(){var t=i,e=Ni;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&os(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ss(t);if(n=e?(n=ss(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===is(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");return(e=n.call(this)).on,e.once,e.un,t=fi({},t),e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=Do(t.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.nextCenter_=null,e.nextResolution_,e.nextRotation_,e.cancelAnchor_=void 0,t.center&&(t.center=Xo(t.center,e.projection_)),t.extent&&(t.extent=Wo(t.extent,e.projection_)),t.projection&&function(t){Oo=!(void 0===t||t)}(),e.applyOptions_(t),e}return t=i,(e=[{key:"applyOptions_",value:function(t){var e,n=fi({},t);for(e in ao)delete n[e];this.setProperties(n,!0);var i=function(t){var e,n=void 0!==t.minZoom?t.minZoom:0,i=void 0!==t.maxZoom?t.maxZoom:28,r=void 0!==t.zoomFactor?t.zoomFactor:2,o=void 0!==t.multiWorld&&t.multiWorld,s=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,a=void 0!==t.showFullExtent&&t.showFullExtent,A=Do(t.projection,"EPSG:3857"),l=A.getExtent(),u=t.constrainOnlyCenter,h=t.extent;return o||h||!A.isGlobal()||(u=!1,h=l),l=(o=(l?Math.max(zn(l),kn(l)):360*oo[so.DEGREES]/A.getMetersPerUnit())/lo/Math.pow(2,0))/Math.pow(2,28),void 0!==(A=t.maxResolution)?n=0:A=o/Math.pow(r,n),void 0===(e=t.minResolution)&&(e=void 0!==t.maxZoom?void 0!==t.maxResolution?A/Math.pow(r,i):o/Math.pow(r,i):l),i=n+Math.floor(Math.log(A/e)/Math.log(r)),{constraint:function(t,e,n,i,r){return function(o,s,a,A){var l,u,h;if(void 0!==o)return a=i?(l=t,h=zn(u=i)/a[0],u=kn(u)/a[1],r?Math.min(l,Math.max(h,u)):Math.min(l,Math.min(h,u))):t,(void 0===n||n)&&A?(l=o,h=a,u=e,A=Math.min(l,h),A*=Math.log(1+50*Math.max(0,l/h-1))/50+1,u&&(A=Math.max(A,u),A/=Math.log(1+50*Math.max(0,u/l-1))/50+1),Gn(A,u/2,2*h)):Gn(o,e,a)}}(A,e=A/Math.pow(r,i-n),s,!u&&h,a),maxResolution:A,minResolution:e,minZoom:n,zoomFactor:r}}(t),r=(this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom,function(t){if(void 0!==t.extent)return e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint,Zo(t.extent,t.constrainOnlyCenter,e);var e=Do(t.projection,"EPSG:3857");return!0!==t.multiWorld&&e.isGlobal()?((t=e.getExtent().slice())[0]=-1/0,t[2]=1/0,Zo(t,!1,!1)):qo}(t)),o=(i=i.constraint,void 0===(o=t).enableRotation||o.enableRotation?void 0===(o=o.constrainRotation)||!0===o?function(t){var e=function(t){return t*Math.PI/180}(5);return function(t,n){return n?t:void 0!==t?Math.abs(t)<=e?0:t:void 0}}():!1!==o&&"number"==typeof o?function(t){var e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?Math.floor(t/e+.5)*e:void 0}}(o):$o:Jo);this.constraints_={center:r,resolution:i,rotation:o},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom)}},{key:"padding",get:function(){return this.padding_},set:function(t){var e,n,i=this.padding_,r=(this.padding_=t,this.getCenter());r&&(t=t||[0,0,0,0],i=i||[0,0,0,0],e=(n=this.getResolution())/2*(t[3]-i[3]+i[1]-t[1]),n=n/2*(t[0]-i[0]+i[2]-t[2]),this.setCenterInternal([r[0]+e,r[1]-n]))}},{key:"getUpdatedOptions_",value:function(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),fi({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var i=arguments[n];i.center&&((i=fi({},i)).center=Xo(i.center,this.getProjection())),i.anchor&&((i=fi({},i)).anchor=Xo(i.anchor,this.getProjection())),e[n]=i}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){for(var e,n=arguments.length,i=(1<n&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),0);i<n&&!this.isDef();++i){var r=arguments[i];r.center&&this.setCenterInternal(r.center),void 0!==r.zoom?this.setZoom(r.zoom):r.resolution&&this.setResolution(r.resolution),void 0!==r.rotation&&this.setRotation(r.rotation)}if(i===n)e&&as(e,!0);else{for(var o=Date.now(),s=this.targetCenter_.slice(),a=this.targetResolution_,A=this.targetRotation_,l=[];i<n;++i){var u=arguments[i],h={start:o,complete:!1,anchor:u.anchor,duration:void 0!==u.duration?u.duration:1e3,easing:u.easing||ns,callback:e};u.center&&(h.sourceCenter=s,h.targetCenter=u.center.slice(),s=h.targetCenter),void 0!==u.zoom?(h.sourceResolution=a,h.targetResolution=this.getResolutionForZoom(u.zoom),a=h.targetResolution):u.resolution&&(h.sourceResolution=a,h.targetResolution=u.resolution,a=h.targetResolution),void 0!==u.rotation&&(h.sourceRotation=A,u=Xn(u.rotation-A+Math.PI,2*Math.PI)-Math.PI,h.targetRotation=A+u,A=h.targetRotation),function(t){if(!t.sourceCenter||!t.targetCenter||hr(t.sourceCenter,t.targetCenter))return t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}(h)?h.complete=!0:o+=h.duration,l.push(h)}this.animations_.push(l),this.setHint(0,1),this.updateAnimations_()}}},{key:"getAnimating",value:function(){return 0<this.hints_[0]}},{key:"getInteracting",value:function(){return 0<this.hints_[1]}},{key:"cancelAnimations",value:function(){var t;this.setHint(0,-this.hints_[0]);for(var e=0,n=this.animations_.length;e<n;++e){var i=this.animations_[e];if(i[0].callback&&as(i[0].callback,!1),!t)for(var r=0,o=i.length;r<o;++r){var s=i[r];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;0<=n;--n){for(var i,r=this.animations_[n],o=!0,s=0,a=r.length;s<a;++s){var A=r[s];if(!A.complete){var l,u,h,c,f=t-A.start;f=(1<=(f=0<A.duration?f/A.duration:1)?(A.complete=!0,f=1):o=!1,A.easing(f));if(A.sourceCenter&&(u=A.sourceCenter[0],c=A.sourceCenter[1],l=A.targetCenter[0],h=A.targetCenter[1],this.nextCenter_=A.targetCenter,this.targetCenter_=[u+f*(l-u),c+f*(h-c)]),A.sourceResolution&&A.targetResolution&&(l=1===f?A.targetResolution:A.sourceResolution+f*(A.targetResolution-A.sourceResolution),A.anchor&&(u=this.getViewportSize_(this.getRotation()),h=this.constraints_.resolution(l,0,u,!0),this.targetCenter_=this.calculateCenterZoom(h,A.anchor)),this.nextResolution_=A.targetResolution,this.targetResolution_=l,this.applyTargetState_(!0)),void 0!==A.sourceRotation&&void 0!==A.targetRotation&&(c=1===f?Xn(A.targetRotation+Math.PI,2*Math.PI)-Math.PI:A.sourceRotation+f*(A.targetRotation-A.sourceRotation),A.anchor&&(f=this.constraints_.rotation(c,!0),this.targetCenter_=this.calculateCenterRotate(f,A.anchor)),this.nextRotation_=A.targetRotation,this.targetRotation_=c),this.applyTargetState_(!0),e=!0,!A.complete)break}}o&&(this.animations_[n]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN,i=r[0].callback)&&as(i,!0)}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,i,r,o=this.getCenterInternal();return void 0!==o&&(o=n=[o[0]-e[0],o[1]-e[1]],t-=this.getRotation(),i=Math.cos(t),t=Math.sin(t),r=o[0]*i-o[1]*t,i=o[1]*i+o[0]*t,o[0]=r,o[1]=i,t=e,(r=n)[0]+=+t[0],r[1]+=+t[1]),n}},{key:"calculateCenterZoom",value:function(t,e){var n,i=this.getCenterInternal(),r=this.getResolution();return void 0!==i&&void 0!==r?[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]:n}},{key:"getViewportSize_",value:function(t){var e,n,i=this.viewportSize_;return t?(e=i[0],n=i[1],[Math.abs(e*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(e*Math.sin(t))+Math.abs(n*Math.cos(t))]):i}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t&&Ko(t,this.getProjection())}},{key:"getCenterInternal",value:function(){return this.get(ao.CENTER)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.get("constrainResolution")}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){var e;return t=t=this.calculateExtentInternal(t),e=this.getProjection(),Yo?Ho(t,e,Yo):t}},{key:"calculateExtentInternal",value:function(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal(),n=(xn(e,1),this.getResolution()),i=(xn(void 0!==n,2),this.getRotation());return xn(void 0!==i,3),Qn(e,n,i,t)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(ao.RESOLUTION)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal(Wo(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){e=e||this.getViewportSizeMinusPadding_();var n=zn(t)/e[0];t=kn(t)/e[1];return Math.max(n,t)}},{key:"getResolutionForValueFunction",value:function(t){var e=t||2,n=this.getConstrainedResolution(this.maxResolution_),i=(t=this.minResolution_,Math.log(n/t)/Math.log(e));return function(t){return n/Math.pow(e,t*i)}}},{key:"getRotation",value:function(){return this.get(ao.ROTATION)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=(t=this.minResolution_,Math.log(n/t)/e);return function(t){return Math.log(n/t)/e/i}}},{key:"getViewportSizeMinusPadding_",value:function(t){t=this.getViewportSize_(t);var e=this.padding_;return e?[t[0]-e[1]-e[3],t[1]-e[0]-e[2]]:t}},{key:"getState",value:function(){var t,e=this.getProjection(),n=this.getResolution(),i=this.getRotation(),r=this.getCenterInternal(),o=this.padding_;return o&&(t=this.getViewportSizeMinusPadding_(),r=As(r,this.getViewportSize_(),[t[0]/2+o[3],t[1]/2+o[0]],n,i)),{center:r.slice(0),projection:void 0!==e?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e?this.getZoomForResolution(e):t}},{key:"getZoomForResolution",value:function(t){var e,n,i=this.minZoom_||0;return n=this.resolutions_?(n=sn(this.resolutions_,t,1),e=this.resolutions_[i=n],n==this.resolutions_.length-1?2:e/this.resolutions_[n+1]):(e=this.maxResolution_,this.zoomFactor_),i+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){var e,n;return this.resolutions_?this.resolutions_.length<=1?0:(e=Gn(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1],this.resolutions_[e]/Math.pow(n,Gn(t-e,0,1))):this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){this.fitInternal(t,e)}},{key:"rotatedExtentForGeometry",value:function(t){for(var e=this.getRotation(),n=Math.cos(e),i=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride(),s=1/0,a=1/0,A=-1/0,l=-1/0,u=0,h=r.length;u<h;u+=o){var c=r[u]*n-r[u+1]*i,f=r[u]*i+r[u+1]*n;s=Math.min(s,c),a=Math.min(a,f),A=Math.max(A,c),l=Math.max(l,f)}return[s,a,A,l]}},{key:"fitInternal",value:function(t,e){var n=(n=(e=e||{}).size)||this.getViewportSizeMinusPadding_(),i=void 0!==e.padding?e.padding:[0,0,0,0],r=void 0!==e.nearest&&e.nearest,o=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;t=this.rotatedExtentForGeometry(t),n=this.getResolutionForExtentInternal(t,[n[0]-i[1]-i[3],n[1]-i[0]-i[2]]),n=isNaN(n)?o:Math.max(n,o),n=this.getConstrainedResolution(n,r?0:1),o=this.getRotation(),r=Math.sin(o),o=Math.cos(o),(t=Dn(t))[0]+=(i[1]-i[3])/2*n,t[1]+=(i[0]-i[2])/2*n,i=t[0]*o-t[1]*r,o=t[1]*o+t[0]*r,t=this.getConstrainedCenter([i,o],n),r=e.callback||ln;void 0!==e.duration?this.animateInternal({resolution:n,center:t,duration:e.duration,easing:e.easing},r):(this.targetResolution_=n,this.targetCenter_=t,this.applyTargetState_(!1,!0),as(r,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal(Xo(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){this.setCenterInternal(As(t,e,n,this.getResolution(),this.getRotation()))}},{key:"calculateCenterShift",value:function(t,e,n,i){var r,o=this.padding_;return o&&t&&(i=As(t,i,[(i=this.getViewportSizeMinusPadding_(-n))[0]/2+o[3],i[1]/2+o[0]],e,n),r=[t[0]-i[0],t[1]-i[1]]),r}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=Ko(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){e=e&&Xo(e,this.getProjection()),this.adjustResolutionInternal(t,e)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation());i=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(i,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e=e&&Xo(e,this.getProjection()),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting();n=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(t&&Xo(t,this.getProjection()))}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){e=this.getAnimating()||this.getInteracting()||e;var n=this.constraints_.rotation(this.targetRotation_,e),i=this.getViewportSize_(n),r=this.constraints_.resolution(this.targetResolution_,0,i,e);e=this.constraints_.center(this.targetCenter_,r,i,e,this.calculateCenterShift(this.targetCenter_,r,n,i));this.get(ao.ROTATION)!==n&&this.set(ao.ROTATION,n),this.get(ao.RESOLUTION)!==r&&(this.set(ao.RESOLUTION,r),this.set("zoom",this.getZoom(),!0)),e&&this.get(ao.CENTER)&&hr(this.get(ao.CENTER),e)||this.set(ao.CENTER,e),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){t=void 0!==t?t:200,e=e||0;var i=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(i);e=this.constraints_.resolution(this.targetResolution_,e,r),r=this.constraints_.center(this.targetCenter_,e,r,!1,this.calculateCenterShift(this.targetCenter_,e,i,r));0!==t||this.cancelAnchor_?(n=n||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===e&&this.getRotation()===i&&this.getCenterInternal()&&hr(this.getCenterInternal(),r)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:i,center:r,resolution:e,duration:t,easing:es,anchor:n}))):(this.targetResolution_=e,this.targetRotation_=i,this.targetCenter_=r,this.applyTargetState_())}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(1,1)}},{key:"endInteraction",value:function(t,e,n){n=n&&Xo(n,this.getProjection()),this.endInteractionInternal(t,e,n)}},{key:"endInteractionInternal",value:function(t,e,n){this.setHint(1,-1),this.resolveConstraints(t,e,n)}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){return t=this.getResolutionForZoom(t),this.getZoomForResolution(this.getConstrainedResolution(t,e))}},{key:"getConstrainedResolution",value:function(t,e){e=e||0;var n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}])&&rs(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function us(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function hs(t){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function cs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===hs(t=function(t,e){if("object"!==hs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==hs(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function fs(){return(fs="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ys(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function ps(t,e){return(ps=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ds(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ys(t){return(ys=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ms(t){t instanceof ur?t.setMapInternal(null):t instanceof zr&&t.getLayers().forEach(ms)}var gs=function(){var t=i,e=Ni;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ps(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ys(t);if(n=e?(n=ys(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===hs(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return ds(i)}}(i);function i(t){var e;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(e=n.call(this)).on,e.once,e.size_=t.size,void 0===e.size_&&(e.size_=[2e3,2e3]),e.un,o={},s=(r=t).layers&&"function"==typeof r.layers.getLayers?r.layers:new zr({layers:r.layers}),o[Xr.LAYERGROUP]=s,o[Xr.TARGET]=r.target,o[Xr.VIEW]=r.view instanceof ls?r.view:new ls;var r,o,s={values:o},a=(e.renderComplete_,e.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,e.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:fn,e.postRenderTimeoutHandle_,e.animationDelayKey_,e.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(ds(e)),e.coordinateToPixelTransform_=[1,0,0,1,0,0],e.pixelToCoordinateTransform_=[1,0,0,1,0,0],e.frameIndex_=0,e.frameState_=null,e.previousExtent_=null,e.viewPropertyListenerKey_=null,e.viewChangeListenerKey_=null,e.layerGroupPropertyListenerKeys_=null,e.moveTolerance_=t.moveTolerance,e.targetChangeHandlerKeys_=null,e.overlayIdIndex_={},e.renderer_=null,e.postRenderFunctions_=[],e.tileQueue_=new ro(e.getTilePriority.bind(ds(e)),e.handleTileChange_.bind(ds(e))),e.addChangeListener(Xr.VIEW,e.handleViewChanged_),e.addChangeListener(Xr.TARGET,e.handleTargetChanged_),e.setProperties(s.values),ds(e));return!t.view||t.view instanceof ls||t.view.then(function(t){a.setView(new ls(t))}),e}return t=i,(e=[{key:"createRenderer",value:function(){throw new Error("Use a map type that has a createRenderer method")}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"handleLayerAdd_",value:function(t){!function t(e,n){if(e instanceof ur)e.setMapInternal(n);else if(e instanceof zr)for(var i=e.getLayers().getArray(),r=0,o=i.length;r<o;++r)t(i[r],n)}(t.layer,this)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){this.setTarget(null),fs(ys(i.prototype),"disposeInternal",this).call(this)}},{key:"getAllLayers",value:function(){var t=[];return function e(n){n.forEach(function(n){n instanceof zr?e(n.getLayers()):t.push(n)})}(this.getLayers()),t}},{key:"getTarget",value:function(){return this.get(Xr.TARGET)}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){return void 0!==(t=this.overlayIdIndex_[t.toString()])?t:null}},{key:"getLayerGroup",value:function(){return this.get(Xr.LAYERGROUP)}},{key:"setLayers",value:function(t){var e=this.getLayerGroup();t instanceof Ur?e.setLayers(t):((e=e.getLayers()).clear(),e.extend(t))}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoadingOrNotReady",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e].layer;if(!i.getRenderer().ready)return!0;if((i=i.getSource())&&i.loading)return!0}return!1}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.size_}},{key:"getView",value:function(){return this.get(Xr.VIEW)}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getTilePriority",value:function(t,e,n,i){return t=t,e=e,n=n,i=i,(r=this.frameState_)&&e in r.wantedTiles&&r.wantedTiles[e][t.getKey()]?(e=r.viewState.center,t=n[0]-e[0],r=n[1]-e[1],65536*Math.log(i)+Math.sqrt(t*t+r*r)/i):1/0;var r}},{key:"handlePostRender",value:function(){for(var t,e,n,i=this.frameState_,r=this.tileQueue_,o=(r.isEmpty()||(n=e=this.maxTilesLoading_,i&&((t=i.viewHints)[0]||t[1])&&(e=(t=8<Date.now()-i.time)?0:8,n=t?0:2),r.getTilesLoading()<e&&(r.reprioritize(),r.loadMoreTiles(e,n))),i&&this.hasListener(er)&&!i.animate&&this.renderComplete_&&this.renderer_.dispatchRenderEvent(er,i),this.postRenderFunctions_),s=0,a=o.length;s<a;++s)o[s](this,i);o.length=0}},{key:"handleTargetChanged_",value:function(){this.renderer_||(this.renderer_=this.createRenderer()),this.targetChangeHandlerKeys_=[Bi(document,"resize",this.updateSize,this)],this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&(Si(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Si(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=Bi(t,ci,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Bi(t,bi,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"handleLayerRemove_",value:function(t){ms(t.layer)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var e,n=this,i=this.getSize(),r=this.getView(),o=this.frameState_,s=null;void 0!==i&&0<(e=i)[0]&&0<e[1]&&r&&r.isDef()&&(e=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),r=r.getState(),s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Qn(r.center,r.resolution,r.rotation,i),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:i,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:r,viewHints:e,wantedTiles:{},mapId:cn(this),renderTargets:{}},r.nextCenter)&&r.nextResolution&&(t=isNaN(r.nextRotation)?r.rotation:r.nextRotation,s.nextExtent=Qn(r.nextCenter,r.nextResolution,t,i)),this.frameState_=s,this.renderer_.renderFrame(s),!s||(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),!o||this.previousExtent_&&(function(t){return t[2]<t[0]||t[3]<t[1]}(this.previousExtent_)||Un(s.extent,this.previousExtent_))||(this.dispatchEvent(new Kr("movestart",this,o)),this.previousExtent_=Pn(this.previousExtent_)),!this.previousExtent_)||s.viewHints[0]||s.viewHints[1]||Un(s.extent,this.previousExtent_)||(this.dispatchEvent(new Kr("moveend",this,s)),e=s.extent,(r=this.previousExtent_)?(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]):e.slice()),this.dispatchEvent(new Kr("postrender",this,s)),this.renderComplete_=!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(function(){n.postRenderTimeoutHandle_=void 0,n.handlePostRender()},0))}},{key:"setSize",value:function(t){this.set(Xr.SIZE,t)}},{key:"setTarget",value:function(t){this.set(Xr.TARGET,t)}},{key:"setView",value:function(t){var e;!t||t instanceof ls?this.set(Xr.VIEW,t):(this.set(Xr.VIEW,new ls),e=this,t.then(function(t){e.setView(new ls(t))}))}},{key:"updateSize",value:function(){var t=this.size_;this.setSize(t),this.updateViewportSize_()}},{key:"updateViewportSize_",value:function(){var t,e=this.getView();e&&(t=this.size_,e.setViewportSize(t))}}])&&cs(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function vs(t){return(vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bs(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===vs(t=function(t,e){if("object"!==vs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==vs(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function xs(t,e){return(xs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ws(t){return(ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bs=function(){var t=i,e=gs;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xs(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ws(t);if(n=e?(n=ws(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===vs(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){if(this instanceof i)return t=fi({},t),n.call(this,t);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"createRenderer",value:function(){return new Br(this)}}])&&bs(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Ms(t){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ss(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ms(t=function(t,e){if("object"!==Ms(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ms(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function _s(t,e){return(_s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Es(t){return(Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ts=function(){var t=i,e=vi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_s(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Es(t);if(n=e?(n=Es(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ms(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){var o;if(this instanceof i)return r=r||{},(o=n.call(this)).tileCoord=t,o.state=e,o.interimTile=null,o.key="",o.transition_=void 0===r.transition?250:r.transition,o.transitionStarts_={},o.interpolate=!!r.interpolate,o;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"changed",value:function(){this.dispatchEvent(bi)}},{key:"release",value:function(){}},{key:"getKey",value:function(){return this.key+"/"+this.tileCoord}},{key:"getInterimTile",value:function(){if(this.interimTile){var t=this.interimTile;do{if(2==t.getState())return this.transition_=0,t}while(t=t.interimTile)}return this}},{key:"refreshInterimChain",value:function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(2==t.getState()){t.interimTile=null;break}}while(1!=t.getState()&&0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile)}}},{key:"getTileCoord",value:function(){return this.tileCoord}},{key:"getState",value:function(){return this.state}},{key:"setState",value:function(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}},{key:"load",value:function(){un()}},{key:"getAlpha",value:function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else this.transitionStarts_[t]=n=e;return(t=e-n+1e3/60)>=this.transition_?1:ts(t/this.transition_)}},{key:"inTransition",value:function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}},{key:"endTransition",value:function(t){this.transition_&&(this.transitionStarts_[t]=-1)}}])&&Ss(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Cs(t,e,n,i){return n=n&&n.length?n.shift():pn?new OffscreenCanvas(t||300,e||300):document.createElement("canvas"),t&&(n.width=t),e&&(n.height=e),n.getContext("2d",i)}function Fs(t){return(Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Os(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Fs(t=function(t,e){if("object"!==Fs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Fs(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ps(t,e){return(Ps=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Us(t){return(Us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rs=function(){var t=i,e=Ts;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ps(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Us(t);if(n=e?(n=Us(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Fs(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r,o,s,a){if(this instanceof i)return(t=n.call(this,t,e,a)).crossOrigin_=o,t.src_=r,t.key=r,t.image_=new Image,null!==o&&(t.image_.crossOrigin=o),t.unlisten_=null,t.tileLoadFunction_=s,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}},{key:"handleImageError_",value:function(){var t;this.state=3,this.unlistenImage_(),this.image_=((t=Cs(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}},{key:"handleImageLoad_",value:function(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}},{key:"load",value:function(){var t,e,n,i,r,o,s;3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_)&&(this.image_.crossOrigin=this.crossOrigin_),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(t=this.image_,e=this.handleImageLoad_.bind(this),n=this.handleImageError_.bind(this),i=!0,r=!1,o=!1,s=[Mi(t,wi,function(){o=!0,r||e()})],t.src&&dn?(r=!0,t.decode().then(function(){i&&e()}).catch(function(t){i&&(o?e:n)()})):s.push(Mi(t,xi,n)),function(){i=!1,s.forEach(Si)}))}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}])&&Os(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Is(t){return(Is="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ls(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Is(t=function(t,e){if("object"!==Is(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Is(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var Ds=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.highWaterMark=void 0!==e?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}var e,n;return e=t,(n=[{key:"canExpireCache",value:function(){return 0<this.highWaterMark&&this.getCount()>this.highWaterMark}},{key:"expireCache",value:function(t){for(;this.canExpireCache();)this.pop()}},{key:"clear",value:function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}},{key:"containsKey",value:function(t){return this.entries_.hasOwnProperty(t)}},{key:"forEach",value:function(t){for(var e=this.oldest_;e;)t(e.value_,e.key_,this),e=e.newer}},{key:"get",value:function(t,e){return xn(void 0!==(t=this.entries_[t]),15),t!==this.newest_&&(t===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(t.newer.older=t.older,t.older.newer=t.newer),t.newer=null,t.older=this.newest_,this.newest_.newer=t,this.newest_=t),t.value_}},{key:"remove",value:function(t){var e=this.entries_[t];return xn(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}},{key:"getCount",value:function(){return this.count_}},{key:"getKeys",value:function(){for(var t=new Array(this.count_),e=0,n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}},{key:"getValues",value:function(){for(var t=new Array(this.count_),e=0,n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}},{key:"peekLast",value:function(){return this.oldest_.value_}},{key:"peekLastKey",value:function(){return this.oldest_.key_}},{key:"peekFirstKey",value:function(){return this.newest_.key_}},{key:"pop",value:function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}},{key:"replace",value:function(t,e){this.get(t),this.entries_[t].value_=e}},{key:"set",value:function(t,e){xn(!(t in this.entries_),16),e={key_:t,newer:null,older:this.newest_,value_:e},this.newest_?this.newest_.newer=e:this.oldest_=e,this.newest_=e,this.entries_[t]=e,++this.count_}},{key:"setSize",value:function(t){this.highWaterMark=t}}])&&Ls(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qs(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]}function ks(t,e,n){return t+"/"+e+"/"+n}function Ns(t){return(Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function js(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ns(t=function(t,e){if("object"!==Ns(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ns(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Hs(t,e){return(Hs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function zs(t){return(zs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vs=function(){var t=i,e=Ds;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hs(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=zs(t);if(n=e?(n=zs(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ns(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){if(this instanceof i)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"expireCache",value:function(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}},{key:"pruneExceptNewestZ",value:function(){var t;0!==this.getCount()&&(t=this.peekFirstKey().split("/").map(Number)[0],this.forEach(function(e){var n;e.tileCoord[0]!==t&&(this.remove(ks((n=e.tileCoord)[0],n[1],n[2])),e.release())}.bind(this)))}}])&&js(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Gs(t){return(Gs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ys(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Gs(t=function(t,e){if("object"!==Gs(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Gs(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ks(t,e){return(Ks=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Xs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ws(t){return(Ws=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zs(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var qs=function(){var t=i,e=Ni;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ks(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ws(t);if(n=e?(n=Ws(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Gs(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Xs(i)}}(i);function i(t){var e;if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");(e=n.call(this)).projection=Io(t.projection),e.attributions_=Zs(t.attributions),e.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,e.loading=!1,e.state_=void 0!==t.state?t.state:ir,e.wrapX_=void 0!==t.wrapX&&t.wrapX,e.interpolate_=!!t.interpolate,e.viewResolver=null,e.viewRejector=null;var r=Xs(e);return e.viewPromise_=new Promise(function(t,e){r.viewResolver=t,r.viewRejector=e}),e}return t=i,(e=[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection}},{key:"getResolutions",value:function(){return un()}},{key:"getView",value:function(){return this.viewPromise_}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"getInterpolate",value:function(){return this.interpolate_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=Zs(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}])&&Ys(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Js(t){return(Js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Js(t=function(t,e){if("object"!==Js(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Js(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var ta=function(){function t(e,n,i,r){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.minX=e,this.maxX=n,this.minY=i,this.maxY=r}var e,n;return e=t,(n=[{key:"contains",value:function(t){return this.containsXY(t[1],t[2])}},{key:"containsTileRange",value:function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}},{key:"containsXY",value:function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}},{key:"equals",value:function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}},{key:"extend",value:function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}},{key:"getHeight",value:function(){return this.maxY-this.minY+1}},{key:"getSize",value:function(){return[this.getWidth(),this.getHeight()]}},{key:"getWidth",value:function(){return this.maxX-this.minX+1}},{key:"intersects",value:function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}])&&$s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ea(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new ta(t,e,n,i)}var na=ta;function ia(t){return(ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ra(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ia(t=function(t,e){if("object"!==ia(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ia(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var oa=[0,0,0],sa=function(){function t(e){var n,i,r;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");if(this.minZoom=void 0!==e.minZoom?e.minZoom:0,this.resolutions_=e.resolutions,xn((n=this.resolutions_,!0,i=function(t,e){return e-t}||on,n.every(function(t,e){return 0===e||!(0<(e=i(n[e-1],t))||0===e)})),17),!e.origins)for(var o=0,s=this.resolutions_.length-1;o<s;++o)if(r){if(this.resolutions_[o]/this.resolutions_[o+1]!==r){r=void 0;break}}else r=this.resolutions_[o]/this.resolutions_[o+1];this.zoomFactor_=r,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==e.origin?e.origin:null,this.origins_=null,void 0!==e.origins&&(this.origins_=e.origins,xn(this.origins_.length==this.resolutions_.length,20));var a=e.extent;void 0===a||this.origin_||this.origins_||(this.origin_=jn(a)),xn(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==e.tileSizes&&(this.tileSizes_=e.tileSizes,xn(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==e.tileSize?e.tileSize:this.tileSizes_?null:lo,xn(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==a?a:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==e.sizes?this.fullTileRanges_=e.sizes.map(function(t,e){return t=new na(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1)),a&&(e=this.getTileRangeForExtentAndZ(a,e),t.minX=Math.max(e.minX,t.minX),t.maxX=Math.min(e.maxX,t.maxX),t.minY=Math.max(e.minY,t.minY),t.maxY=Math.min(e.maxY,t.maxY)),t},this):a&&this.calculateTileRanges_(a)}var e,n;return e=t,(n=[{key:"forEachTileCoord",value:function(t,e,n){for(var i=this.getTileRangeForExtentAndZ(t,e),r=i.minX,o=i.maxX;r<=o;++r)for(var s=i.minY,a=i.maxY;s<=a;++s)n([e,r,s])}},{key:"forEachTileCoordParentTileRange",value:function(t,e,n,i){var r,o,s=null,a=t[0]-1;for(2===this.zoomFactor_?(r=t[1],o=t[2]):s=this.getTileCoordExtent(t,i);a>=this.minZoom;){if(e(a,2===this.zoomFactor_?ea(r=Math.floor(r/2),r,o=Math.floor(o/2),o,n):this.getTileRangeForExtentAndZ(s,a,n)))return!0;--a}return!1}},{key:"getExtent",value:function(){return this.extent_}},{key:"getMaxZoom",value:function(){return this.maxZoom}},{key:"getMinZoom",value:function(){return this.minZoom}},{key:"getOrigin",value:function(t){return this.origin_||this.origins_[t]}},{key:"getResolution",value:function(t){return this.resolutions_[t]}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getTileCoordChildTileRange",value:function(t,e,n){var i;return t[0]<this.maxZoom?2===this.zoomFactor_?ea(i=2*t[1],1+i,i=2*t[2],1+i,e):(i=this.getTileCoordExtent(t,n||this.tmpExtent_),this.getTileRangeForExtentAndZ(i,t[0]+1,e)):null}},{key:"getTileRangeForTileCoordAndZ",value:function(t,e,n){var i,r,o,s,a,A;return e>this.maxZoom||e<this.minZoom?null:(A=t[0],i=t[1],r=t[2],e===A?ea(i,r,i,r,n):this.zoomFactor_?(o=Math.pow(this.zoomFactor_,e-A),s=Math.floor(i*o),a=Math.floor(r*o),e<A?ea(s,s,a,a,n):ea(s,Math.floor(o*(i+1))-1,a,Math.floor(o*(r+1))-1,n)):(A=this.getTileCoordExtent(t,this.tmpExtent_),this.getTileRangeForExtentAndZ(A,e,n)))}},{key:"getTileRangeExtent",value:function(t,e,n){var i=this.getOrigin(t),r=this.getResolution(t),o=(t=us(this.getTileSize(t),this.tmpSize_),i[0]+e.minX*t[0]*r),s=i[0]+(e.maxX+1)*t[0]*r;return On(o,i[1]+e.minY*t[1]*r,s,i[1]+(e.maxY+1)*t[1]*r,n)}},{key:"getTileRangeForExtentAndZ",value:function(t,e,n){var i=oa,r=(this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,i),i[1]),o=i[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,i),ea(r,i[1],o,i[2],n)}},{key:"getTileCoordCenter",value:function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=us(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]-(t[2]+.5)*i[1]*n]}},{key:"getTileCoordExtent",value:function(t,e){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=us(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*i;return On(o,n=n[1]-(t[2]+1)*r[1]*i,o+r[0]*i,n+r[1]*i,e)}},{key:"getTileCoordForCoordAndResolution",value:function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}},{key:"getTileCoordForXYAndResolution_",value:function(t,e,n,i,r){var o=this.getZForResolution(n),s=n/this.getResolution(o),a=this.getOrigin(o),A=us(this.getTileSize(o),this.tmpSize_);t=s*(t-a[0])/n/A[0],s=s*(a[1]-e)/n/A[1],s=i?(t=qn(t,5)-1,qn(s,5)-1):(t=Zn(t,5),Zn(s,5));return Qs(o,t,s,r)}},{key:"getTileCoordForXYAndZ_",value:function(t,e,n,i,r){var o=this.getOrigin(n),s=this.getResolution(n),a=us(this.getTileSize(n),this.tmpSize_);t=(t-o[0])/s/a[0],o=(o[1]-e)/s/a[1],o=i?(t=qn(t,5)-1,qn(o,5)-1):(t=Zn(t,5),Zn(o,5));return Qs(n,t,o,r)}},{key:"getTileCoordForCoordAndZ",value:function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}},{key:"getTileCoordResolution",value:function(t){return this.resolutions_[t[0]]}},{key:"getTileSize",value:function(t){return this.tileSize_||this.tileSizes_[t]}},{key:"getFullTileRange",value:function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}},{key:"getZForResolution",value:function(t,e){return Gn(sn(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}},{key:"calculateTileRanges_",value:function(t){for(var e=this.resolutions_.length,n=new Array(e),i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n}}])&&ra(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function aa(t){var e=t.getDefaultTileGrid();return e||(e=function(t,e,n,i){return i=void 0!==i?i:Sn.TOP_LEFT,e=Aa(t,e,n),new sa({extent:t,origin:function(t,e){var n;return e===Sn.BOTTOM_LEFT?n=In(t):e===Sn.BOTTOM_RIGHT?n=Ln(t):e===Sn.TOP_LEFT?n=jn(t):e===Sn.TOP_RIGHT?n=Hn(t):xn(!1,13),n}(t,i),resolutions:e,tileSize:n})}(la(t),void 0,void 0,void 0),t.setDefaultTileGrid(e)),e}function Aa(t,e,n,i){e=void 0!==e?e:Ao;for(var r=kn(t),o=(t=zn(t),n=us(void 0!==n?n:lo),0<i?i:Math.max(t/n[0],r/n[1])),s=e+1,a=new Array(s),A=0;A<s;++A)a[A]=o/Math.pow(2,A);return a}function la(t){var e=(t=Io(t)).getExtent();return e||On(-(t=180*oo[so.DEGREES]/t.getMetersPerUnit()),-t,t,t)}function ua(t){return(ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ha(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ca(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ua(t=function(t,e){if("object"!==ua(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ua(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function fa(t,e,n){return e&&ca(t.prototype,e),n&&ca(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function pa(){return(pa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ma(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function da(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&function(t,e){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function ya(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ma(t);n=e?(n=ma(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this;if(n&&("object"===ua(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function ma(t){return(ma=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}qe=function(){da(e,qs);var t=ya(e);function e(n){var i;return ha(this,e),(i=t.call(this,{attributions:n.attributions,attributionsCollapsible:n.attributionsCollapsible,projection:n.projection,state:n.state,wrapX:n.wrapX,interpolate:n.interpolate})).on,i.once,i.un,i.opaque_=void 0!==n.opaque&&n.opaque,i.tilePixelRatio_=void 0!==n.tilePixelRatio?n.tilePixelRatio:1,i.tileGrid=void 0!==n.tileGrid?n.tileGrid:null,i.tileGrid&&us(i.tileGrid.getTileSize(i.tileGrid.getMinZoom()),[256,256]),i.tileCache=new Vs(n.cacheSize||0),i.tmpSize=[0,0],i.key_=n.key||"",i.tileOptions={transition:n.transition,interpolate:n.interpolate},i.zDirection=n.zDirection||0,i}return fa(e,[{key:"canExpireCache",value:function(){return this.tileCache.canExpireCache()}},{key:"expireCache",value:function(t,e){(t=this.getTileCacheForProjection(t))&&t.expireCache(e)}},{key:"forEachLoadedTile",value:function(t,e,n,i){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,s,a=!0,A=n.minX;A<=n.maxX;++A)for(var l=n.minY;l<=n.maxY;++l)o=ks(e,A,l),s=!1,(s=r.containsKey(o)?(s=2===(o=r.get(o)).getState())&&!1!==i(o):s)||(a=!1);return a}},{key:"getGutterForProjection",value:function(t){return 0}},{key:"getKey",value:function(){return this.key_}},{key:"setKey",value:function(t){this.key_!==t&&(this.key_=t,this.changed())}},{key:"getOpaque",value:function(t){return this.opaque_}},{key:"getResolutions",value:function(){return this.tileGrid?this.tileGrid.getResolutions():null}},{key:"getTile",value:function(t,e,n,i,r){return un()}},{key:"getTileGrid",value:function(){return this.tileGrid}},{key:"getTileGridForProjection",value:function(t){return this.tileGrid||aa(t)}},{key:"getTileCacheForProjection",value:function(t){return xn(Qo(this.getProjection(),t),68),this.tileCache}},{key:"getTilePixelRatio",value:function(t){return this.tilePixelRatio_}},{key:"getTilePixelSize",value:function(t,e,n){n=this.getTileGridForProjection(n),e=this.getTilePixelRatio(e),n=us(n.getTileSize(t),this.tmpSize);return 1==e?n:(t=n,n=e,(e=void 0===(e=this.tmpSize)?[0,0]:e)[0]=t[0]*n+.5|0,e[1]=t[1]*n+.5|0,e)}},{key:"getTileCoordForTileUrlFunction",value:function(t,e){e=void 0!==e?e:this.getProjection();var n,i,r,o,s=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(n=s,e=e,r=(i=t)[0],o=n.getTileCoordCenter(i),t=Tn(e=la(e),o)?i:(i=zn(e),e=Math.ceil((e[0]-o[0])/i),o[0]+=i*e,n.getTileCoordForCoordAndZ(o,r))),function(t,e){var n=t[0],i=t[1];t=t[2];if(!(e.getMinZoom()>n||n>e.getMaxZoom()))return!(e=e.getFullTileRange(n))||e.containsXY(i,t)}(t,s)?t:null}},{key:"clear",value:function(){this.tileCache.clear()}},{key:"refresh",value:function(){this.clear(),pa(ma(e.prototype),"refresh",this).call(this)}},{key:"updateCacheSize",value:function(t,e){t>(e=this.getTileCacheForProjection(e)).highWaterMark&&(e.highWaterMark=t)}},{key:"useTile",value:function(t,e,n,i){}}]),e}();var ga=function(){da(e,hi);var t=ya(e);function e(n,i){return ha(this,e),(n=t.call(this,n)).tile=i,n}return fa(e)}(),va=qe;function ba(t){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ba(t=function(t,e){if("object"!==ba(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ba(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function wa(t,e){return(wa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ba(t){return(Ba=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ma=function(){var t=i,e=va;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wa(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ba(t);if(n=e?(n=Ba(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===ba(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).generateTileUrlFunction_=e.tileUrlFunction===i.prototype.tileUrlFunction,e.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(e.tileUrlFunction=t.tileUrlFunction),e.urls=null,t.urls?e.setUrls(t.urls):t.url&&e.setUrl(t.url),e.tileLoadingKeys_={},e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getTileLoadFunction",value:function(){return this.tileLoadFunction}},{key:"getTileUrlFunction",value:function(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}},{key:"getUrls",value:function(){return this.urls}},{key:"handleTileChange",value:function(t){var e,n=cn(t=t.target),i=t.getState();1==i?(this.tileLoadingKeys_[n]=!0,e="tileloadstart"):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],e=3==i?"tileloaderror":2==i?"tileloadend":void 0),null!=e&&this.dispatchEvent(new ga(e,t))}},{key:"setTileLoadFunction",value:function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}},{key:"setTileUrlFunction",value:function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}},{key:"setUrl",value:function(t){t=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n)for(var i=n[1].charCodeAt(0),r=n[2].charCodeAt(0),o=i;o<=r;++o)e.push(t.replace(n[0],String.fromCharCode(o)));else if(n=/\{(\d+)-(\d+)\}/.exec(t))for(var s=parseInt(n[2],10),a=parseInt(n[1],10);a<=s;a++)e.push(t.replace(n[0],a.toString()));else e.push(t);return e}(t),this.urls=t,this.setUrls(t)}},{key:"setUrls",value:function(t){var e=(this.urls=t).join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(t,e){for(var n,i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=function(t,e){var n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(s,a,A){if(s)return t.replace(n,s[0].toString()).replace(i,s[1].toString()).replace(r,s[2].toString()).replace(o,function(){var t=s[0];return xn(t=e.getFullTileRange(t),55),(t.getHeight()-s[2]-1).toString()})}}(t[o],e);return 1!==(n=r).length?function(t,e,i){var r;if(t)return r=Xn((t[1]<<t[0])+t[2],n.length),n[r](t,e,i)}:n[0]}(t,this.tileGrid),e):this.setKey(e)}},{key:"tileUrlFunction",value:function(t,e,n){}},{key:"useTile",value:function(t,e,n){t=ks(t,e,n),this.tileCache.containsKey(t)&&this.tileCache.get(t)}}])&&xa(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Sa(t){return(Sa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Sa(t=function(t,e){if("object"!==Sa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Sa(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ea(){return(Ea="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ca(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function Ta(t,e){return(Ta=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ca(t){return(Ca=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Fa(t,e){t.getImage().src=e}var Oa=function(){var t=i,e=Ma;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ta(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ca(t);if(n=e?(n=Ca(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Sa(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return e=void 0===t.imageSmoothing||t.imageSmoothing,void 0!==t.interpolate&&(e=t.interpolate),(e=n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction||Fa,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:e,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection})).crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,e.tileClass=void 0!==t.tileClass?t.tileClass:Rs,e.tileCacheForProjection={},e.tileGridForProjection={},e.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,e.renderReprojectionEdges_=!1,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"canExpireCache",value:function(){if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}},{key:"expireCache",value:function(t,e){var n,i=this.getTileCacheForProjection(t);for(n in this.tileCache.expireCache(this.tileCache==i?e:{}),this.tileCacheForProjection){var r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}}},{key:"getGutterForProjection",value:function(t){return this.getProjection()&&t&&!Qo(this.getProjection(),t)?0:this.getGutter()}},{key:"getGutter",value:function(){return 0}},{key:"getKey",value:function(){var t=Ea(Ca(i.prototype),"getKey",this).call(this);return this.getInterpolate()||(t+=":disable-interpolation"),t}},{key:"getOpaque",value:function(t){return!(this.getProjection()&&t&&!Qo(this.getProjection(),t))&&Ea(Ca(i.prototype),"getOpaque",this).call(this,t)}},{key:"getTileGridForProjection",value:function(t){var e=this.getProjection();return!this.tileGrid||e&&!Qo(e,t)?((e=cn(t))in this.tileGridForProjection||(this.tileGridForProjection[e]=aa(t)),this.tileGridForProjection[e]):this.tileGrid}},{key:"getTileCacheForProjection",value:function(t){var e=this.getProjection();return!e||Qo(e,t)?this.tileCache:((e=cn(t))in this.tileCacheForProjection||(this.tileCacheForProjection[e]=new Vs(this.tileCache.highWaterMark)),this.tileCacheForProjection[e])}},{key:"createTile_",value:function(t,e,n,i,r,o){return t=[t,e,n],n=(e=this.getTileCoordForTileUrlFunction(t,r))?this.tileUrlFunction(e,i,r):void 0,(e=new this.tileClass(t,void 0!==n?0:4,void 0!==n?n:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions)).key=o,e.addEventListener(bi,this.handleTileChange.bind(this)),e}},{key:"getTile",value:function(t,e,n,i,r){var o=this.getProjection();return this.getTileInternal(t,e,n,i,o||r)}},{key:"getTileInternal",value:function(t,e,n,i,r){var o,s=null,a=ks(t,e,n),A=this.getKey();return this.tileCache.containsKey(a)?(s=this.tileCache.get(a)).key!=A&&(o=s,s=this.createTile_(t,e,n,i,r,A),0==o.getState()?s.interimTile=o.interimTile:s.interimTile=o,s.refreshInterimChain(),this.tileCache.replace(a,s)):(s=this.createTile_(t,e,n,i,r,A),this.tileCache.set(a,s)),s}},{key:"setRenderReprojectionEdges",value:function(t){if(this.renderReprojectionEdges_!=t){for(var e in this.renderReprojectionEdges_=t,this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}}])&&_a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Pa(t){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ua(t,e){return(Ua=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ra(t){return(Ra=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ia=function(){var t=i,e=Oa;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ua(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ra(t);if(n=e?(n=Ra(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Pa(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e,r,o,s;if(this instanceof i)return e=void 0===(t=t||{}).imageSmoothing||t.imageSmoothing,void 0!==t.interpolate&&(e=t.interpolate),r=void 0!==t.projection?t.projection:"EPSG:3857",o=void 0!==t.tileGrid?t.tileGrid:(s={extent:s=(o=(o={extent:la(r),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})||{}).extent||Io("EPSG:3857").getExtent(),minZoom:o.minZoom,tileSize:o.tileSize,resolutions:Aa(s,o.maxZoom,o.tileSize,o.maxResolution)},new sa(s)),n.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:e,opaque:t.opaque,projection:r,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:o,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection});throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function La(t){return(La="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Da(t,e){return(Da=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Qa(t){return(Qa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ka=function(){var t=i,e=Ia;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Da(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Qa(t);if(n=e?(n=Qa(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===La(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e,r,o,s;if(this instanceof i)return e=void 0===(t=t||{}).imageSmoothing||t.imageSmoothing,void 0!==t.interpolate&&(e=t.interpolate),r=void 0!==t.attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],o=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",s=void 0!==t.url?t.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",n.call(this,{attributions:r,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:o,interpolate:e,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:s,wrapX:t.wrapX,zDirection:t.zDirection});throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(),Na="preload",ja="useInterimTilesOnError";function Ha(t){return(Ha="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function za(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ha(t=function(t,e){if("object"!==Ha(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ha(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Va(){return(Va="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ya(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function Ga(t,e){return(Ga=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ya(t){return(Ya=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ka=function(){var t=i,e=ur;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ga(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ya(t);if(n=e?(n=Ya(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ha(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return delete(e=fi({},t=t||{})).preload,delete e.useInterimTilesOnError,(e=n.call(this,e)).on,e.once,e.un,e.setPreload(void 0!==t.preload?t.preload:0),e.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getPreload",value:function(){return this.get(Na)}},{key:"setPreload",value:function(t){this.set(Na,t)}},{key:"getUseInterimTilesOnError",value:function(){return this.get(ja)}},{key:"setUseInterimTilesOnError",value:function(t){this.set(ja,t)}},{key:"getData",value:function(t){return Va(Ya(i.prototype),"getData",this).call(this,t)}}])&&za(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Xa(t){return(Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Wa(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Xa(t=function(t,e){if("object"!==Xa(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Xa(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Za(){return(Za="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=$a(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function qa(t,e){return(qa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ja(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $a(t){return($a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var tA=function(){var t=i,e=Fi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qa(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=$a(t);if(n=e?(n=$a(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Xa(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Ja(i)}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this)).ready=!0,e.boundHandleImageChange_=e.handleImageChange_.bind(Ja(e)),e.layer_=t,e.declutterExecutorGroup=null,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getFeatures",value:function(t){return un()}},{key:"getData",value:function(t){return null}},{key:"prepareFrame",value:function(t){return un()}},{key:"renderFrame",value:function(t,e){return un()}},{key:"loadedTileCallback",value:function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}},{key:"createLoadedTileFinder",value:function(t,e,n){return function(i,r){var o=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,r,o)}.bind(this)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r){}},{key:"getDataAtPixel",value:function(t,e,n){return null}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){2===t.target.getState()&&this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var e=t.getState();return 2!=e&&3!=e&&t.addEventListener(bi,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==ir&&t.changed()}},{key:"disposeInternal",value:function(){delete this.layer_,Za($a(i.prototype),"disposeInternal",this).call(this)}}])&&Wa(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function eA(t){return(eA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nA(t,e){return(nA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function iA(t){return(iA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var rA=function(){var t=i,e=hi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=iA(t);if(n=e?(n=iA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===eA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r,o){if(this instanceof i)return(t=n.call(this,t)).inversePixelTransform=e,t.frameState=r,t.context=o,t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function oA(t){return(oA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===oA(t=function(t,e){if("object"!==oA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==oA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function aA(){return(aA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=lA(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function AA(t,e){return(AA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function lA(t){return(lA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var uA=null,hA=function(){var t=i,e=tA;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=lA(t);if(n=e?(n=lA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===oA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){if(this instanceof i)return(t=n.call(this,t)).container=null,t.renderedResolution,t.tempTransform=[1,0,0,1,0,0],t.pixelTransform=[1,0,0,1,0,0],t.inversePixelTransform=[1,0,0,1,0,0],t.context=null,t.containerReused=!1,t.pixelContext_=null,t.frameState=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getImageData",value:function(t,e,n){var i,r;uA||((i=document.createElement("canvas")).width=1,i.height=1,uA=i.getContext("2d")),uA.clearRect(0,0,1,1);try{uA.drawImage(t,e,n,1,1,0,0,1,1),r=uA.getImageData(0,0,1,1).data}catch(t){return null}return r}},{key:"getBackground",value:function(t){var e=this.getLayer().getBackground();return(e="function"==typeof e?e(t.viewState.resolution):e)||void 0}},{key:"useContainer",value:function(t,e,n,i){var r,o=this.getLayer().getClassName();(r=t&&t.className===o&&""===t.style.opacity&&1===n&&(!i||t.style.backgroundColor&&an(ii(t.style.backgroundColor),ii(i)))&&(n=t.firstElementChild)instanceof HTMLCanvasElement?n.getContext("2d"):r)&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),this.container||((n=document.createElement("div")).className=o,(e=n.style).position="absolute",e.width="100%",e.height="100%",i&&(e.backgroundColor=i),t=(r=Cs()).canvas,n.appendChild(t),(e=t.style).position="absolute",e.left="0",e.transformOrigin="top left",this.container=n,this.context=r)}},{key:"clipUnrotated",value:function(t,e,n){var i=jn(n),r=Hn(n),o=Ln(n);n=In(n);wn(e=(wn(e.coordinateToPixelTransform,i),wn(e.coordinateToPixelTransform,r),wn(e.coordinateToPixelTransform,o),wn(e.coordinateToPixelTransform,n),this.inversePixelTransform),i),wn(e,r),wn(e,o),wn(e,n),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(n[0]),Math.round(n[1])),t.clip()}},{key:"dispatchRenderEvent_",value:function(t,e,n){var i=this.getLayer();i.hasListener(t)&&(t=new rA(t,this.inversePixelTransform,n,e),i.dispatchEvent(t))}},{key:"preRender",value:function(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)}},{key:"postRender",value:function(t,e){this.dispatchRenderEvent_("postrender",t,e)}},{key:"getRenderTransform",value:function(t,e,n,i,r,o,s){return i/=e,e=-t[0]+s,s=-t[1],Bn(this.tempTransform,r/2,o/2,i,-i,-n,e,s)}},{key:"getDataAtPixel",value:function(t,e,n){var i=wn(this.inversePixelTransform,t.slice()),r=this.context;if((s=this.getLayer().getExtent())&&!Tn(s,wn(e.pixelToCoordinateTransform,t.slice())))return null;var o,s=Math.round(i[0]);e=Math.round(i[1]);(t=this.pixelContext_)||((i=document.createElement("canvas")).width=1,i.height=1,t=i.getContext("2d"),this.pixelContext_=t),t.clearRect(0,0,1,1);try{t.drawImage(r.canvas,s,e,1,1,0,0,1,1),o=t.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?(this.pixelContext_=null,new Uint8Array):o}return 0===o[3]?null:o}},{key:"disposeInternal",value:function(){delete this.frameState,aA(lA(i.prototype),"disposeInternal",this).call(this)}}])&&sA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function cA(t){return(cA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===cA(t=function(t,e){if("object"!==cA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==cA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function pA(){return(pA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=yA(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function dA(t,e){return(dA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function yA(t){return(yA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var mA=function(){var t=i,e=hA;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=yA(t);if(n=e?(n=yA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===cA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this,t)).extentChanged=!0,e.renderedExtent_=null,e.renderedPixelRatio,e.renderedProjection=null,e.renderedRevision,e.renderedTiles=[],e.newTiles_=!1,e.tmpExtent=[1/0,1/0,-1/0,-1/0],e.tmpTileRange_=new na(0,0,0,0),e.thirdMap_=t.thirdMap_,e.layercount_=t.layercount_,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"isDrawableTile",value:function(t){var e=this.getLayer();t=t.getState(),e=e.getUseInterimTilesOnError();return 2==t||4==t||3==t&&!e}},{key:"getTile",value:function(t,e,n,i){var r=i.pixelRatio,o=(i=i.viewState.projection,this.getLayer());return 3==(t=o.getSource().getTile(t,e,n,r,i)).getState()&&(o.getUseInterimTilesOnError()?0<o.getPreload()&&(this.newTiles_=!0):t.setState(2)),this.isDrawableTile(t)?t:t.getInterimTile()}},{key:"getData",value:function(t){var e=this.frameState;if(e){var n=this.getLayer(),i=wn(e.pixelToCoordinateTransform,t.slice());if(!(t=n.getExtent())||Tn(t,i))for(var r=e.pixelRatio,o=e.viewState.projection,s=(t=e.viewState,n.getRenderSource()),a=s.getTileGridForProjection(t.projection),A=s.getTilePixelRatio(e.pixelRatio),l=a.getZForResolution(t.resolution);l>=a.getMinZoom();--l){var u,h,c,f,p=a.getTileCoordForCoordAndZ(i,l),d=s.getTile(l,p[1],p[2],r,o);if(!(d instanceof Rs))return null;if(2===d.getState())return f=a.getOrigin(l),u=us(a.getTileSize(l)),h=a.getResolution(l),c=Math.floor(A*((i[0]-f[0])/h-p[1]*u[0])),f=Math.floor(A*((f[1]-i[1])/h-p[2]*u[1])),this.getImageData(d.getImage(),c,f)}}return null}},{key:"loadedTileCallback",value:function(t,e,n){return!!this.isDrawableTile(n)&&pA(yA(i.prototype),"loadedTileCallback",this).call(this,t,e,n)}},{key:"prepareFrame",value:function(t){return!!this.getLayer().getSource()}},{key:"renderFrame",value:function(t,e){var n=t.layerStatesArray[t.layerIndex],i=(s=t.viewState).projection,r=s.resolution,o=s.center,s=s.rotation,a=t.pixelRatio,A=this.getLayer(),l=A.getSource(),u=l.getRevision(),h=l.getTileGridForProjection(i),c=h.getZForResolution(r,l.zDirection),f=h.getResolution(c),p=t.extent,d=(n.extent&&Wo(n.extent,i)&&(p=Nn(p,Wo(n.extent,i))),l.getTilePixelRatio(a)),y=Math.round(t.size[0]*d),m=Math.round(t.size[1]*d),g=(s&&(m=y=Math.round(Math.sqrt(y*y+m*m))),f*y/2/d),v=f*m/2/d,b=[o[0]-g,o[1]-v,o[0]+g,o[1]+v],x=h.getTileRangeForExtentAndZ(p,c),w={},B=(w[c]={},this.createLoadedTileFinder(l,i,w)),M=this.tmpExtent,S=this.tmpTileRange_;this.newTiles_=!1;for(var _=x.minX;_<=x.maxX;++_)for(var E=x.minY;E<=x.maxY;++E){var T=this.getTile(c,_,E,t);if(this.isDrawableTile(T)){var C=cn(this);if(2==T.getState()&&(F=(w[c][T.tileCoord.toString()]=T).inTransition(C),this.newTiles_||!F&&-1!==this.renderedTiles.indexOf(T)||(this.newTiles_=!0)),1===T.getAlpha(C,t.time))continue}var F=h.getTileCoordChildTileRange(T.tileCoord,S,M);C=!1;(C=F?B(c+1,F):C)||h.forEachTileCoordParentTileRange(T.tileCoord,B,S,M)}for(var O,P=f/r,U=(Bn(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/d,1/d,s,-y/2,-m/2),Mn(this.inversePixelTransform,this.pixelTransform),Bn(this.tempTransform,y/2,m/2,P,P,0,-y/2,-m/2),this.renderedTiles.length=0,Object.keys(w).map(Number)),R=(U.sort(on),1!==n.opacity||this.containerReused&&!l.getOpaque(t.viewState.projection)?O=[]:U=U.reverse(),[]),I=null,L=U.length-1;0<=L;--L){var D,Q=U[L],k=((null===I||Q<I)&&(I=Q),l.getTilePixelSize(Q,a,i)),N=h.getResolution(Q)/f,j=k[0]*N*P,H=k[1]*N*P,z=h.getTileCoordForCoordAndZ(jn(b),Q),V=(k=h.getTileCoordExtent(z),wn(this.tempTransform,[d*(k[0]-b[0])/f,d*(b[3]-k[3])/f])),G=d*l.getGutterForProjection(i),Y=w[Q];for(D in Y){var K=Y[D],X=K.tileCoord,W=z[1]-X[1],Z=Math.round(V[0]-(W-1)*j),q=(X=z[2]-X[2],Math.round(V[1]-(X-1)*H)),J=(Z=Z-(W=Math.round(V[0]-W*j)),q=q-(X=Math.round(V[1]-X*H)),c===Q),$=J&&1!==K.getAlpha(cn(this),t.time);this.drawTileImage(K,t,W,X,Z,q,G,J,R),O&&!$?this.renderedTiles.unshift(K):this.renderedTiles.push(K),this.updateUsedTiles(t.usedTiles,l,K)}}return this.renderedRevision=u,this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!Un(this.renderedExtent_,b),this.renderedExtent_=b,this.renderedPixelRatio=a,this.renderedProjection=i,this.manageTilePyramid(t,l,h,a,i,p,c,A.getPreload()),this.scheduleExpireCache(t,l),this.thirdMap_&&(1===this.layercount_?this.thirdMap_.A&&this.thirdMap_.A(R,I):this.thirdMap_.P&&this.thirdMap_.P(R,I)),this.container}},{key:"drawTileImage",value:function(t,e,n,i,r,o,s,a,A){var l,u,h=this.getTileImage(t);h&&(l=cn(this),u=a?t.getAlpha(l,e.time):1,A.push({image:h,x:n,y:i,w:r,h:o,frameState:e}),1!==u?e.animate=!0:a&&t.endTransition(l))}},{key:"getTileImage",value:function(t){return t.getImage()}},{key:"scheduleExpireCache",value:function(t,e){e.canExpireCache()&&(e=function(t,e,n){var i=cn(t);i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}.bind(null,e),t.postRenderFunctions.push(e))}},{key:"updateUsedTiles",value:function(t,e,n){(e=cn(e))in t||(t[e]={}),t[e][n.getKey()]=!0}},{key:"manageTilePyramid",value:function(t,e,n,i,r,o,s,a,A){for(var l,u,h,c,f,p=cn(e),d=(p in t.wantedTiles||(t.wantedTiles[p]={}),t.wantedTiles[p]),y=t.tileQueue,m=0,g=n.getMinZoom();g<=s;++g)for(u=n.getTileRangeForExtentAndZ(o,g,u),h=n.getResolution(g),c=u.minX;c<=u.maxX;++c)for(f=u.minY;f<=u.maxY;++f)s-g<=a?(++m,0==(l=e.getTile(g,c,f,i,r)).getState()&&(d[l.getKey()]=!0,y.isKeyQueued(l.getKey())||y.enqueue([l,p,n.getTileCoordCenter(l.tileCoord),h])),void 0!==A&&A(l)):e.useTile(g,c,f,r);e.updateCacheSize(m,r)}}])&&fA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function gA(t){return(gA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===gA(t=function(t,e){if("object"!==gA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==gA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function bA(t,e){return(bA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function xA(t){return(xA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var wA=function(){var t=i,e=Ka;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=xA(t);if(n=e?(n=xA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===gA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this,t)).layercount_=t.layercount,e.thirdMap_=t.thirdMap,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"createRenderer",value:function(){return new mA(this)}}])&&vA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),BA="XY",MA="XYZ",SA="XYM",_A="XYZM";function EA(t){return(EA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function TA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===EA(t=function(t,e){if("object"!==EA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==EA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function CA(t,e){return(CA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function FA(t){return(FA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var OA=[1,0,0,1,0,0],PA=function(){var t=i,e=Ni;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&CA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=FA(t);if(n=e?(n=FA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===EA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t,e,r,o,s,a;if(this instanceof i)return(t=n.call(this)).extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(a=!(e=function(t,e,n){var i;return(n?((i=this.clone()).applyTransform(n),i):this).getSimplifiedGeometry(e)}),function(){var t=Array.prototype.slice.call(arguments);return a&&this===s&&an(t,o)||(a=!0,s=this,o=t,r=e.apply(this,arguments)),r}),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return un()}},{key:"closestPointXY",value:function(t,e,n,i){return un()}},{key:"containsXY",value:function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}},{key:"getClosestPoint",value:function(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return un()}},{key:"getExtent",value:function(t){var e;return this.extentRevision_!=this.getRevision()&&(e=this.computeExtent(this.extent_),(isNaN(e[0])||isNaN(e[1]))&&Pn(e),this.extentRevision_=this.getRevision()),e=this.extent_,(t=t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):e}},{key:"rotate",value:function(t,e){un()}},{key:"scale",value:function(t,e,n){un()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return un()}},{key:"getType",value:function(){return un()}},{key:"applyTransform",value:function(t){un()}},{key:"intersectsExtent",value:function(t){return un()}},{key:"translate",value:function(t,e){un()}},{key:"transform",value:function(t,e){var n=Io(t);t=n.getUnits()==so.TILE_PIXELS?function(t,i,r){var o=n.getExtent(),s=n.getWorldExtent();o=kn(s)/kn(o);return Bn(OA,s[0],s[3],o,-o,0,0,0),function(t,e,n,i,r,o){for(var s=o||[],a=0,A=e;A<n;A+=i){var l=t[A],u=t[A+1];s[a++]=r[0]*l+r[2]*u+r[4],s[a++]=r[1]*l+r[3]*u+r[5]}o&&s.length!=a&&(s.length=a)}(t,0,t.length,r,OA,i),No(n,e)(t,i,r)}:No(n,e);return this.applyTransform(t),this}}])&&TA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function UA(t){return(UA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function RA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===UA(t=function(t,e){if("object"!==UA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==UA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function IA(t,e){return(IA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function LA(t){return(LA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function DA(t){var e;return t==BA?e=2:t==MA||t==SA?e=3:t==_A&&(e=4),e}var QA=function(){var t=i,e=PA;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&IA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=LA(t);if(n=e?(n=LA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===UA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t;if(this instanceof i)return(t=n.call(this)).layout=BA,t.stride=2,t.flatCoordinates=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"computeExtent",value:function(t){return e=this.flatCoordinates,0,n=this.flatCoordinates.length,i=this.stride,Rn(Pn(t),e,0,n,i);var e,n,i}},{key:"getCoordinates",value:function(){return un()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){var e;return this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance?this:(e=this.getSimplifiedGeometryInternal(t)).getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=DA(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){un()}},{key:"setLayout",value:function(t,e,n){var i;if(t)i=DA(t);else{for(var r=0;r<n;++r){if(0===e.length)return this.layout=BA,void(this.stride=2);e=e[0]}t=function(t){var e;return 2==t?e=BA:3==t?e=MA:4==t&&(e=_A),e}(i=e.length)}this.layout=t,this.stride=i}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var n=this.getFlatCoordinates();if(n){for(var i=this.getStride(),r=n,o=n.length,s=i,a=(i=t,t=e,(e=n)||[]),A=Math.cos(i),l=Math.sin(i),u=t[0],h=t[1],c=0,f=0;f<o;f+=s){var p=r[f]-u,d=r[f+1]-h;a[c++]=u+p*A-d*l,a[c++]=h+p*l+d*A;for(var y=f+2;y<f+s;++y)a[c++]=r[y]}e&&a.length!=c&&(a.length=c),this.changed()}}},{key:"scale",value:function(t,e,n){var i=e;if(void 0===e&&(i=t),e=(e=n)||Dn(this.getExtent()),n=this.getFlatCoordinates()){for(var r=this.getStride(),o=n,s=n.length,a=r,A=t,l=i,u=(r=e,(t=n)||[]),h=r[0],c=r[1],f=0,p=0;p<s;p+=a){var d=o[p]-h,y=o[p+1]-c;u[f++]=h+A*d,u[f++]=c+l*y;for(var m=p+2;m<p+a;++m)u[f++]=o[m]}t&&u.length!=f&&(u.length=f),this.changed()}}},{key:"translate",value:function(t,e){var n=this.getFlatCoordinates();if(n){for(var i=this.getStride(),r=n,o=n.length,s=i,a=t,A=e,l=(i=n)||[],u=0,h=0;h<o;h+=s){l[u++]=r[h]+a,l[u++]=r[h+1]+A;for(var c=h+2;c<h+s;++c)l[u++]=r[c]}i&&l.length!=u&&(l.length=u),this.changed()}}}])&&RA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function kA(t,e,n,i,r,o,s){var a,A,l=t[e],u=t[e+1],h=t[n]-l,c=t[n+1]-u;if(0==h&&0==c)a=e;else{var f=((r-l)*h+(o-u)*c)/(h*h+c*c);if(1<f)a=n;else{if(0<f){for(var p=0;p<i;++p)s[p]=(A=t[e+p])+f*(t[n+p]-A);return void(s.length=i)}a=e}}for(var d=0;d<i;++d)s[d]=t[a+d];s.length=i}function NA(t,e,n,i,r){var o=t[e],s=t[e+1];for(e+=i;e<n;e+=i){var a=t[e],A=t[e+1],l=Kn(o,s,a,A);r<l&&(r=l),o=a,s=A}return r}function jA(t,e,n,i,r,o,s,a,A,l,u){var h,c;if(e!=n)if(0===r){if((c=Kn(s,a,t[e],t[e+1]))<l){for(h=0;h<i;++h)A[h]=t[e+h];return A.length=i,c}}else{for(var f=u||[NaN,NaN],p=e+i;p<n;)if(kA(t,p-i,p,i,s,a,f),(c=Kn(s,a,f[0],f[1]))<l){for(l=c,h=0;h<i;++h)A[h]=f[h];p+=A.length=i}else p+=i*Math.max((Math.sqrt(c)-Math.sqrt(l))/r|0,1);if(o&&(kA(t,n-i,e,i,s,a,f),(c=Kn(s,a,f[0],f[1]))<l)){for(l=c,h=0;h<i;++h)A[h]=f[h];A.length=i}}return l}function HA(t,e,n,i){for(var r=0,o=n.length;r<o;++r)for(var s=n[r],a=0;a<i;++a)t[e++]=s[a];return e}function zA(t,e){return e*Math.round(t/e)}function VA(t,e,n,i,r){for(var o=void 0!==r?r:[],s=0,a=e;a<n;a+=i)o[s++]=t.slice(a,a+i);return o.length=s,o}function GA(t,e,n,i){for(var r=0,o=t[n-i],s=t[n-i+1];e<n;e+=i){var a=t[e],A=t[e+1];r+=s*a-o*A,o=a,s=A}return r/2}function YA(t){return(YA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function KA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===YA(t=function(t,e){if("object"!==YA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==YA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function XA(t,e){return(XA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function WA(t){return(WA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ZA=function(){var t=i,e=QA;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XA(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=WA(t);if(n=e?(n=WA(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===YA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){var r;if(this instanceof i)return(r=n.call(this)).maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?r.setCoordinates(t,e):r.setFlatCoordinates(e,t),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){return new i(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){return i<En(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(NA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),jA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"getArea",value:function(){return GA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return VA(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=function(t,e,n,i,r,o,s){var a=(n-e)/i;if(a<3)for(;e<n;e+=i)o[s++]=t[e],o[s++]=t[e+1];else{for(var A,l,u,h,c,f,p=new Array(a),d=(p[0]=1,p[a-1]=1,[e,n-i]),y=0;0<d.length;){for(var m=d.pop(),g=d.pop(),v=0,b=t[g],x=t[g+1],w=t[m],B=t[m+1],M=g+i;M<m;M+=i){var S=t[M],_=t[M+1],E=(S=S,_=_,f=c=h=void 0,f=(u=B)-(l=x),0==(c=(E=w)-(A=b))&&0==f||(1<(h=((S-A)*c+(_-l)*f)/(c*c+f*f))?(A=E,l=u):0<h&&(A+=c*h,l+=f*h)),Kn(S,_,A,l));v<E&&(y=M,v=E)}r<v&&(p[(y-e)/i]=1,g+i<y&&d.push(g,y),y+i<m)&&d.push(y,m)}for(var T=0;T<a;++T)p[T]&&(o[s++]=t[e+T*i],o[s++]=t[e+T*i+1])}return s}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new i(e,BA)}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=HA(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&KA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function qA(t){return(qA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function JA(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===qA(t=function(t,e){if("object"!==qA(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==qA(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function $A(t,e){return($A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function tl(t){return(tl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var el=function(){var t=i,e=QA;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$A(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=tl(t);if(n=e?(n=tl(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===qA(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){var r;if(this instanceof i)return(r=n.call(this)).setCoordinates(t,e),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){var r=this.flatCoordinates;if((t=Kn(t,e,r[0],r[1]))<i){for(var o=this.stride,s=0;s<o;++s)n[s]=r[s];return n.length=o,t}return i}},{key:"getCoordinates",value:function(){return this.flatCoordinates?this.flatCoordinates.slice():[]}},{key:"computeExtent",value:function(t){return On(n=(e=this.flatCoordinates)[0],e=e[1],n,e,t);var e,n}},{key:"getType",value:function(){return"Point"}},{key:"intersectsExtent",value:function(t){return Cn(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(t,e,n){for(var i=0,r=n.length;i<r;++i)t[e++]=n[i];return e}(this.flatCoordinates,0,t,this.stride),this.changed()}}])&&JA(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function nl(t,e,n,i,r){var o;return!((o=function(r){return!il(t,e,n,i,r[0],r[1])})(In(r=r))||o(Ln(r))||o(Hn(r))||o(jn(r)))}function il(t,e,n,i,r,o){for(var s=0,a=t[n-i],A=t[n-i+1];e<n;e+=i){var l=t[e],u=t[e+1];A<=o?o<u&&0<(l-a)*(o-A)-(r-a)*(u-A)&&s++:u<=o&&(l-a)*(o-A)-(r-a)*(u-A)<0&&s--,a=l,A=u}return 0!==s}function rl(t,e,n,i,r,o){if(0===n.length)return!1;if(!il(t,e,n[0],i,r,o))return!1;for(var s=1,a=n.length;s<a;++s)if(il(t,n[s-1],n[s],i,r,o))return!1;return!0}function ol(t,e,n,i,r){var o,s,a=Rn([1/0,1/0,-1/0,-1/0],t,e,n,i);if(Vn(r,a)){if(s=a,(o=r)[0]<=s[0]&&s[2]<=o[2]&&o[1]<=s[1]&&s[3]<=o[3])return 1;if(a[0]>=r[0]&&a[2]<=r[2])return 1;if(a[1]>=r[1]&&a[3]<=r[3])return 1;var A,l=t,u=e,h=n,c=i,f=function(t,e){return e=e,h=!1,c=Fn(n=r,t=t),f=Fn(n,e),c===_n.INTERSECTING||f===_n.INTERSECTING?h=!0:(i=n[0],o=n[1],s=n[2],n=n[3],a=t[0],t=t[1],A=e[0],t=((e=e[1])-t)/(A-a),(h=(h=(h=f&_n.ABOVE&&!(c&_n.ABOVE)?i<=(l=A-(e-n)/t)&&l<=s:h)||!(f&_n.RIGHT)||c&_n.RIGHT?h:o<=(u=e-(A-s)*t)&&u<=n)||!(f&_n.BELOW)||c&_n.BELOW?h:i<=(l=A-(e-o)/t)&&l<=s)||!(f&_n.LEFT)||c&_n.LEFT||(h=o<=(u=e-(A-i)*t)&&u<=n)),h;var n,i,o,s,a,A,l,u,h,c,f};for(u+=c;u<h;u+=c)if(A=f(l.slice(u-c,u),l.slice(u,u+c)))return A}}function sl(t,e,n,i){for(var r=0,o=t[n-i],s=t[n-i+1];e<n;e+=i){var a=t[e],A=t[e+1];r+=(a-o)*(A+s),o=a,s=A}return 0===r?void 0:0<r}function al(t,e,n,i,r){for(var o=void 0!==r&&r,s=0,a=n.length;s<a;++s){var A=n[s],l=sl(t,e,A,i);if(0===s?o&&l||!o&&!l:o&&!l||!o&&l){d=p=c=h=u=void 0;for(var u=t,h=e,c=A,f=i;h<c-f;){for(var p=0;p<f;++p){var d=u[h+p];u[h+p]=u[c-f+p],u[c-f+p]=d}h+=f,c-=f}}e=A}return e}function Al(t){return(Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ll(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Al(t=function(t,e){if("object"!==Al(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Al(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function ul(t,e){return(ul=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function hl(t){return(hl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var cl=function(){var t=i,e=QA;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ul(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=hl(t);if(n=e?(n=hl(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Al(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){var o;if(this instanceof i)return(o=n.call(this)).ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==e&&r?(o.setFlatCoordinates(e,t),o.ends_=r):o.setCoordinates(t,e),o;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"appendLinearRing",value:function(t){this.flatCoordinates?function(t,e){for(var n=Array.isArray(e)?e:[e],i=n.length,r=0;r<i;r++)t[t.length]=n[r]}(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){var t=new i(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}},{key:"closestPointXY",value:function(t,e,n,i){return i<En(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,r){for(var o=0,s=n.length;o<s;++o){var a=n[o];r=NA(t,e,a,i,r),e=a}return r}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,r,o,s,a,A,l,u){for(var h=u||[NaN,NaN],c=0,f=n.length;c<f;++c){var p=n[c];l=jA(t,e,p,i,r,o,s,a,A,l,h),e=p}return l}(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"containsXY",value:function(t,e){return rl(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return function(t,e,n,i){for(var r=0,o=0,s=n.length;o<s;++o){var a=n[o];r+=GA(t,e,a,i),e=a}return r}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?al(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,function(t,e,n,i,r){for(var o=void 0!==r?r:[],s=0,a=0,A=n.length;a<A;++a){var l=n[a];o[s++]=VA(t,e,l,i,o[s]),e=l}return o.length=s,o}(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){var t;return this.flatInteriorPointRevision_!=this.getRevision()&&(t=Dn(this.getExtent()),this.flatInteriorPoint_=function(t,e,n,i,r,o,s){for(var a,A,l,u=r[o+1],h=[],c=0,f=n.length;c<f;++c)for(var p=n[c],d=t[p-i],y=t[p-i+1],m=e;m<p;m+=i)b=t[m],l=t[m+1],(u<=y&&l<=u||y<=u&&u<=l)&&h.push(A=(u-y)/(l-y)*(b-d)+d),d=b,y=l;var g=NaN,v=-1/0;for(h.sort(on),d=h[0],m=1,a=h.length;m<a;++m){var b=h[m],x=Math.abs(b-d);v<x&&rl(t,e,n,i,A=(d+b)/2,u)&&(g=A,v=x),d=b}return isNaN(g)&&(g=r[o]),s?(s.push(g,u,v),s):[g,u,v]}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()),this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new el(this.getFlatInteriorPoint(),SA)}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new ZA(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[],r=0,o=0,s=n.length;o<s;++o){var a=n[o],A=new ZA(e.slice(r,a),t);i.push(A),r=a}return i}},{key:"getOrientedFlatCoordinates",value:function(){var t;return this.orientedRevision_!=this.getRevision()&&(function(t,e,n,i,r){for(var o=void 0!==r&&r,s=0,a=n.length;s<a;++s){var A=n[s],l=sl(t,e,A,i);if(0===s){if(o&&l||!o&&!l)return}else if(o&&!l||!o&&l)return;e=A}return 1}(t=this.flatCoordinates,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=al(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],n=[];return e.length=function(t,e,n,i,r,o,s,a){for(var A=0,l=n.length;A<l;++A){var u=n[A];s=function(t,e,n,i,r,o,s){if(e!=n){var a,A=zA(t[e],r),l=zA(t[e+1],r);e+=i,o[s++]=A,o[s++]=l;do{if(a=zA(t[e],r),p=zA(t[e+1],r),(e+=i)==n)return o[s++]=a,o[s++]=p,s}while(a==A&&p==l);for(;e<n;){var u,h,c,f,p,d=zA(t[e],r),y=zA(t[e+1],r);e+=i,d==a&&y==p||((u=a-A)*(f=y-l)==(h=p-l)*(c=d-A)&&(u<0&&c<u||u==c||0<u&&u<c)&&(h<0&&f<h||h==f||0<h&&h<f)||(A=o[s++]=a,l=o[s++]=p),a=d,p=y)}o[s++]=a,o[s++]=p}return s}(t,e,u,i,r,o,s),a.push(s),e=u}return s}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new i(e,BA,n)}},{key:"getType",value:function(){return"Polygon"}},{key:"intersectsExtent",value:function(t){return function(t,e,n,i,r){if(!(ol(o=t,e=e,s=n[0],a=i,A=r)||il(o,e,s,a,A[0],A[1])||il(o,e,s,a,A[0],A[3])||il(o,e,s,a,A[2],A[1])||il(o,e,s,a,A[2],A[3])))return!1;var o,s,a,A;if(1!==n.length)for(var l=1,u=n.length;l<u;++l)if(nl(t,n[l-1],n[l],i,r)&&!ol(t,n[l-1],n[l],i,r))return!1;return!0}(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]),e=function(t,e,n,i,r){for(var o=r||[],s=0,a=0,A=n.length;a<A;++a){var l=HA(t,e,n[a],i);e=o[s++]=l}return o.length=s,o}(this.flatCoordinates,0,t,this.stride,this.ends_),this.flatCoordinates.length=0===e.length?0:e[e.length-1],this.changed()}}])&&ll(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function fl(t){return(fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===fl(t=function(t,e){if("object"!==fl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==fl(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function dl(t){try{e=new URL(t,"http://fakehost.com/")}catch(t){return null}var e=(t=e.pathname.split("/").pop()).lastIndexOf(".");return-1===e||e===t.length-1?null:t.substring(e+1)}function yl(t){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ml(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===yl(t=function(t,e){if("object"!==yl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==yl(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Eo=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");e=e||{},this.C=4e3,this.L=void 0!==e.offset?e.offset:1,this.I=void 0===e.visible||e.visible,this.N=void 0!==e.mode?e.mode:Ze.AMAP_VECTOR,this.N!==Ze.TD_VECTOR&&this.N!==Ze.TD_SATELLITE||(this.C=5e3),this.B=e.replaceColor,this._=e.replaceOpacity,void 0===this._&&(this._=1),this.F={YELLOW:"sepia(60%) hue-rotate(3deg) grayscale(5%) saturate(2)",CELESTE:"grayscale(100%) sepia(50%) hue-rotate(170deg) saturate(2)",GRAY:"grayscale(220%) sepia(2%) hue-rotate(-20deg) saturate(2.5) invert(10%) contrast(1.5)",PEACH:"grayscale(90%) sepia(30%) hue-rotate(-44deg) saturate(4) contrast(1.2)",PINK:"grayscale(10%) sepia(10%) hue-rotate(-80deg)",SAPPHIRE:"grayscale(60%) hue-rotate(20deg) sepia(70%) invert(95%) brightness(3)",NONE:"none",CUSTOM:"custom"},this.D=e.filter,void 0===this.D&&(this.D=$e.NONE),this.H=this.F[this.D],this.U=e.filterCustomization,"custom"===this.H&&(this.H=this.U,void 0===this.H)&&(this.H="none"),this.G=new Map,this.G.set(""+Ze.AMAP_SATELLITE,20),this.G.set(""+Ze.AMAP_VECTOR,20),this.G.set(""+Ze.BAIDU_VECTOR,20),this.G.set(""+Ze.BAIDU_SATELLITE,20),this.G.set(""+Ze.TD_VECTOR,20),this.G.set(""+Ze.TD_SATELLITE,20),this.V=!1,this.q=null,this.X=e.offlineUrl,void 0!==this.X&&(this.V=!0),this.Z=e.imageType,void 0===this.Z&&(this.Z="png"),this.Y=.5*this.C,this.W=.9*this.C,this.K=null,this.$=new k,this.$.background=new z(13426943),this.$.fog=new K(13426943,this.Y,this.W),this.J=new tn,this.$.add(this.J),this.tt=new Ke,this.it=null,this.nt=this.L,this.et=null,this.rt=new se(new u(0,1,0),0),this.ot=!1,this.st=this.st.bind(this),this.ut=this.ut.bind(this),this.ht=[],this.ct=!1,this.ft=null,this.lt=1.2}var e,n;return e=t,(n=[{key:"visible",get:function(){return this.I},set:function(t){this.I=t,this.$.visible=this.I,this.it.enableUpdateRender()}},{key:"addTo",value:function(t){this.it=t,this.it.getRenderManager().setTileLayScene(this.$),this.nt=this.it.getFloor(this.it.getVisibleLevels()[0]).height-this.L,this.vt(),t.enableUpdateRender()}},{key:"remove",value:function(){this.dispose(),this.it.off("resize",this.st),this.it.off("viewChanged",this.st),this.it.off("viewModeChanged",this.ut),this.it.off("visibleLevelsLoaded",this.st),this.it.off("zoom",this.st),this.it=null,this.ot=!1}},{key:"dispose",value:function(){this.et&&this.et.dispose(),this.et=null,this.yt(),this.J.parent&&this.J.parent.remove(this.J),this.it.getRenderManager().setTileLayScene(void 0),this.it.enableUpdateRender()}},{key:"setFilter",value:function(t,e){this.D=t,void 0===this.D&&(this.D=$e.NONE),this.H=this.F[this.D],this.U=e,"custom"===this.H&&(this.H=this.U,void 0===this.H)&&(this.H="none"),this.dt(),this.it.enableUpdateRender()}},{key:"getFilter",value:function(){return{filter:this.D,value:this.H}}}])&&pl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(Eo.prototype,{vt:function(){this.ot||(this.K=this.it.getContainer(),this.et=this.bt(),this.wt(),this.it.on("resize",this.st),this.it.on("viewChanged",this.st),this.it.on("viewModeChanged",this.ut),this.it.on("visibleLevelsLoaded",this.st),this.it.on("zoom",this.st),this.ot=!0)},gt:function(){if(0!==this.ht.length)if(this.jt())for(var t=this.Mt(),e=0;e<this.ht.length;e++){var n,i=this.ht[e];i.oldTexture||(i.oldTexture=i.material.map.clone(),i.material.map.dispose(),(n=new ne(t)).minFilter=xt,i.material.map=n)}else for(var r=0;r<this.ht.length;r++){var o=this.ht[r];o.oldTexture&&(o.material.map.dispose(),o.material.map=o.oldTexture.clone(),o.oldTexture=null)}},dt:function(){for(var t=0;t<this.ht.length;t++){var e=this.ht[t].imageinfo.image,n=this.ht[t].imageinfo.coverimage,i=document.createElement("canvas"),r=(i.width=e.width,i.height=e.height,i.getContext("2d"));r.filter=this.H,r.drawImage(e,0,0,i.width,i.height),n&&r.drawImage(n,0,0,i.width,i.height),this.ht[t].material.map=new ne(i)}},st:function(t){var e;"viewChanged"===t.type?(e=this.it.getCenter(),this.q.x===e.x&&this.q.y===e.y||this.wt(t)):"visibleLevelsLoaded"===t.type?this.St():"zoom"===t.type&&(this.wt(),this.gt())},Ot:function(t){var e=4;this.N===Ze.AMAP_SATELLITE||this.N===Ze.AMAP_VECTOR||this.N===Ze.BAIDU_VECTOR||this.N===Ze.BAIDU_SATELLITE?e=5:this.N!==Ze.TD_VECTOR&&this.N!==Ze.TD_SATELLITE||(e=4),t!==e||this.ct||(t=this.it.getZoomRange(),this.ct=!0,t[0]=this.it.getZoom(),this.it.setZoomRange(t))},Mt:function(){var t;return null===this.ft&&(this.ft=document.createElement("canvas"),this.ft.width=256,this.ft.height=256,(t=this.ft.getContext("2d")).fillStyle=this.B,t.globalAlpha=this._,t.fillRect(0,0,256,256)),this.ft},jt:function(){var t=this.G.get(""+this.N),e=this.it.getZoom();return!!(t&&this.B&&t<=e)},P:function(t,e){if(0!==this.ht.length&&!this.jt()){var n=this;this.Ot(e);for(var i,r,o,s=0;s<t.length;s++){var a,A=function(t){for(var e=null,i=0;i<n.ht.length;i++){var r=n.ht[i].imageinfo;if(t.x===r.x&&t.y===r.y&&t.w===r.w&&t.h===r.h&&!n.ht[i].isCovered){e=n.ht[i];break}}return e}(t[s]);null!==A&&(a=A.imageinfo.image,i=t[s].image,o=r=void 0,(r=document.createElement("canvas")).width=a.width,r.height=a.height,(o=r.getContext("2d")).filter=n.H,o.drawImage(a,0,0,r.width,r.height),o.drawImage(i,0,0,r.width,r.height),(a=new ne(r)).minFilter=xt,A.material.map.dispose(),A.material.map=a,A.imageinfo.coverimage=t[s].image,A.isCovered=!0)}}},A:function(t,e){this.it&&(this.Ot(e),this.Et(t),e=this.kt(),"OrthographicCamera"===this.it.camera.type?(this.$.fog.near=1e4*this.Y,this.$.fog.far=1e4*this.W):(t=this.lt*this.kt(!0),this.$.fog.near=this.Y*t,this.$.fog.far=this.W*t),this.J.scale.set(e,e,e),this.it.getRenderManager().render())},Et:function(t){for(var e=this,n=0;n<this.ht.length;n++)this.ht[n].visible=!1;var i=this.jt();if(0===this.ht.length)for(var r=0;r<t.length;r++){var o=B(t[r]);this.J.add(o),this.ht.push(o)}else{for(var s=[],a=[],A=0;A<t.length;A++){var l,u=t[A].image.width,h=t[A].image.height,c=function(t,e){for(var n=null,i=0;i<t.length;i++)if(t[i].src===e){n=i;break}return n}(this.ht,t[A].image.src);null!==c&&((l=this.ht[c]).scale.set(t[A].w/u,t[A].h/h,1),l.imageinfo=t[A],l.position.x=t[A].x+t[A].w/2-this.C/2,l.position.z=t[A].y+t[A].h/2-this.C/2,l.visible=!0,s.push(l),this.ht.splice(c,1),a.push(A))}t=x(a,t);for(var f=a.length=0;f<t.length&&0!==this.ht.length;f++){var p,d=t[f].image.width,y=t[f].image.height,m=this.ht.splice(0,1)[0],g=new ne(w(t[f].image));g.minFilter=xt,m.material.map.dispose(),i?((p=new ne(this.Mt())).minFilter=xt,m.material.map=p):m.material.map=g,m.scale.set(t[f].w/d,t[f].h/y,1),m.position.x=t[f].x+t[f].w/2-this.C/2,m.position.z=t[f].y+t[f].h/2-this.C/2,m.src=t[f].image.src,m.imageinfo=t[f],m.visible=!0,m.oldTexture=i?g:null,s.push(m),a.push(f)}t=x(a,t);for(var v=0;v<t.length;v++){var b=B(t[v]);this.J.add(b),s.push(b)}this.yt(),this.ht=s}function x(t,e){for(var n=[],i=0;i<e.length;i++)!function(t,e){for(var n=!0,i=0;i<t.length;i++)if(t[i]===e){n=!1;break}return n}(t,i)||n.push(e[i]);return n}function w(t){var n=document.createElement("canvas"),i=(n.width=t.width,n.height=t.height,n.getContext("2d"));return i.filter=e.H,i.drawImage(t,0,0,n.width,n.height),n}function B(t){var n=t.image.width,r=t.image.height,o=new Zt(n,r),s=new ne(w(t.image)),a=null;return(o=((a=new $t(i?{map:new ne(e.Mt()),depthWrite:!1,transparent:!0}:{map:s,depthWrite:!1,transparent:!0})).polygonOffset=!0,a.polygonOffsetFactor=1,a.polygonOffsetUnits=4,new Ve(o,a))).material.map.minFilter=xt,o.material.needsUpdate=!0,o.src=t.image.src,o.imageinfo=t,o.scale.set(t.w/n,t.h/r,1),o.position.x=t.x+t.w/2-e.C/2,o.position.z=t.y+t.h/2-e.C/2,o.rotation.x=-Math.PI/2,o.renderOrder=-10,o.oldTexture=i?s:null,o}this.J.position.y=this.nt},yt:function(){for(var t=0;t<this.ht.length;t++)this.ht[t].parent&&(this.ht[t].parent.remove(this.ht[t]),this.ht[t].geometry.dispose(),this.ht[t].material.map.dispose(),this.ht[t].material.dispose());this.ht.length=0},bt:function(){var t,e=this,n=Io("EPSG:3857");if(this.N===Ze.AMAP_SATELLITE||this.N===Ze.AMAP_VECTOR){var i={url:this.Tt(),crossOrigin:"anonymous",maxZoom:18,thirdMap:this};this.N===Ze.AMAP_SATELLITE&&(i.maxZoom=18),i=new Ia(i)}else if(this.N===Ze.BAIDU_VECTOR||this.N===Ze.BAIDU_SATELLITE){for(var r=[],o=0;o<19;o++)r[o]=Math.pow(2,18-o);var s=new sa({origin:[0,0],resolutions:r});i=new Oa({projection:n,crossOrigin:"anonymous",tileGrid:s,tileUrlFunction:function(t){var n,i;return t?(n=t[0],i=t[1],t=-t[2]-1,e.Rt(i=i<0?"M"+-i:i,t=t<0?"M"+-t:t,n)):""}})}else this.N===Ze.OSM?i=new ka:(i=new Ia({url:this.At()[0],crossOrigin:"anonymous",tileSize:[512,512],maxZoom:18}),t=new Ia({url:this.At()[1],crossOrigin:"anonymous",tileSize:[512,512],maxZoom:18}));return(s=new Bs({size:[this.C,this.C],view:new ls({projection:n}),layers:[new wA({layercount:1,source:i,thirdMap:this}),new wA({layercount:2,source:t,thirdMap:this})]})).setTarget(this.K),s},Tt:function(){return this.V?this.X+"/{z}/{x}/{y}."+this.Z:this.N===Ze.AMAP_SATELLITE?"http://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&style=6&x={x}&y={y}&z={z}":"https://wprd0{1-4}.is.autonavi.com/appmaptile?lang=zh_cn&size=2&style=7&x={x}&y={y}&z={z}"},Rt:function(t,e,n){return t=this.N===Ze.BAIDU_SATELLITE?"https://gss0.bdstatic.com/5bwHcj7lABFY8t_jkk_Z1zRvfdw6buu/it/u=x="+t+";y="+e+";z="+n+";v=009;type=sate&fm=46&udt=20210415&scaler=2":"https://maponline"+parseInt(4*Math.random())+".bdimg.com/tile/?qt=vtile&x="+t+"&y="+e+"&z="+n+"&styles=pl&scaler=2&udt=20210415&from=jsapi2_0&scaler=2"},At:function(){var t;return this.V?this.N===Ze.TD_SATELLITE?((t=[]).push(this.X+"?type=img_w&number={0-7}&x={x}&y={y}&z={z}"),t.push(this.X+"?type=cia_w&number={0-7}&x={x}&y={y}&z={z}")):((t=[]).push(this.X+"?type=vec_w&number={0-7}&x={x}&y={y}&z={z}"),t.push(this.X+"?type=cva_w&number={0-7}&x={x}&y={y}&z={z}")):this.N===Ze.TD_SATELLITE?((t=[]).push("http://t{0-7}.tianditu.gov.cn/img_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer=img&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=9a8b557e9db74e442bd9544001392255"),t.push("https://t{0-7}.tianditu.gov.cn/cia_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cia&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=9a8b557e9db74e442bd9544001392255")):((t=[]).push("http://t{0-7}.tianditu.gov.cn/vec_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&Layer=vec&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}&tk=9a8b557e9db74e442bd9544001392255"),t.push("https://t{0-7}.tianditu.gov.cn/cva_w/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER=cva&STYLE=default&TILEMATRIXSET=w&FORMAT=png&TILECOL={x}&TILEROW={y}&TILEMATRIX={z}&tk=9a8b557e9db74e442bd9544001392255")),t},xt:function(){this.Pt.setSize(this.it.getContainer().clientWidth,this.it.getContainer().clientHeight)},ut:function(){var t;"OrthographicCamera"===this.it.camera.type?(this.$.fog.near=1e4*this.Y,this.$.fog.far=1e4*this.W):(t=this.kt(!0)*this.lt,this.$.fog.near=this.Y*t,this.$.fog.far=this.W*t)},wt:function(t){var e,n,i;this.Ct&&t&&t.target&&t.target.target&&t.target.target.x===this.Ct.x&&t.target.target.z===this.Ct.z||(t&&t.target&&t.target.target&&(this.Ct={x:t.target.target.x,y:t.target.target.y,z:t.target.target.z}),t=new u(0,0,.5),n=this.it.camera,this.tt.setFromCamera(t,n),t=new u,this.tt.ray.intersectPlane(this.rt,t),n=this.kt(),i=t.x+this.it.x,e=-t.z+this.it.y,n=this.C/2*n,this.J.position.x=t.x,this.J.position.z=t.z,i=(t=[i-n,e-n,i+n,e+n])[0],e=t[1],n=t[2],t=t[3],n=new cl(t=[i,e,i,t,n,t,n,e,i,e],BA,[t.length]),this.et.getView().fit(n),i=this.it.getCenter(),this.q={x:i.x,y:i.y})},kt:function(t){var e=this.it.camera,n=3;return this.N!==Ze.BAIDU_VECTOR&&this.N!==Ze.BAIDU_SATELLITE||(n=6),t&&(n=2.8),this.tt.setFromCamera(new u(0,0,.5),e),this.tt.ray.distanceToPlane(this.rt)*Math.tan(Je.FOV*Je.DEG2RAD/2)*2*n/this.C},St:function(){this.nt=this.it.getFloor(this.it.getVisibleLevels()[0]).height-this.L,this.J.position.y=this.nt}}),qe=Eo;var gl=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.maxSize=800,this.minSize=600,this.unloadPercent=.05,this.itemSet=new Map,this.itemList=[],this.usedSet=new Set,this.callbacks=new Map,this.unloadPriorityCallback=null;var e=this.itemSet;this.defaultPriorityCallback=function(t){return e.get(t)}}var e,n;return e=t,(n=[{key:"isFull",value:function(){return this.itemSet.size>=this.maxSize}},{key:"add",value:function(t,e){var n,i,r,o=this.itemSet;return!o.has(t)&&!this.isFull()&&(n=this.usedSet,i=this.itemList,r=this.callbacks,i.push(t),n.add(t),o.set(t,Date.now()),r.set(t,e),!0)}},{key:"remove",value:function(t){var e,n=this.usedSet,i=this.itemSet,r=this.itemList,o=this.callbacks;return!!i.has(t)&&(o.get(t)(t),e=r.indexOf(t),r.splice(e,1),n.delete(t),i.delete(t),o.delete(t),!0)}},{key:"markUsed",value:function(t){var e=this.itemSet,n=this.usedSet;e.has(t)&&!n.has(t)&&(e.set(t,Date.now()),n.add(t))}},{key:"markAllUnused",value:function(){this.usedSet.clear()}},{key:"unloadUnusedContent",value:function(){var t=this.unloadPercent,e=this.minSize,n=this.itemList,i=this.itemSet,r=this.usedSet,o=this.callbacks,s=n.length-r.size,a=n.length-e,A=this.unloadPriorityCallback||this.defaultPriorityCallback;if(0<a&&0<s){n.sort(function(t,e){var n=r.has(t),i=r.has(e);return n&&i?0:n||i?n?1:-1:A(e)-A(t)});a=Math.min(a,s),e=Math.max(e*t,a*t),a=Math.min(e,s),a=Math.ceil(a);for(var l=n.splice(0,a),u=0,h=l.length;u<h;u++){var c=l[u];o.get(c)(c),i.delete(c),o.delete(c)}}}},{key:"scheduleUnload",value:function(){var t=this,e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];this.scheduled||(this.scheduled=!0,Promise.resolve().then(function(){t.scheduled=!1,t.unloadUnusedContent(),e&&t.markAllUnused()}))}}])&&ml(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function vl(t){return(vl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===vl(t=function(t,e){if("object"!==vl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==vl(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var xl=function(){function t(){var e=this;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.maxJobs=6,this.items=[],this.callbacks=new Map,this.currJobs=0,this.scheduled=!1,this.autoUpdate=!0,this.priorityCallback=function(){throw new Error("PriorityQueue: PriorityCallback function not defined.")},this.schedulingCallback=function(t){requestAnimationFrame(t)},this.Lt=function(){e.tryRunJobs(),e.scheduled=!1}}var e,n;return e=t,(n=[{key:"sort",value:function(){var t=this.priorityCallback;this.items.sort(t)}},{key:"add",value:function(t,e){var n=this;return new Promise(function(i,r){var o=n.items,s=n.callbacks;o.push(t),s.set(t,function(){return e.apply(void 0,arguments).then(i).catch(r)}),n.autoUpdate&&n.scheduleJobRun()})}},{key:"remove",value:function(t){var e=this.items,n=this.callbacks,i=e.indexOf(t);-1!==i&&(e.splice(i,1),n.delete(t))}},{key:"tryRunJobs",value:function(){for(var t=this,e=(this.sort(),this.items),n=this.callbacks,i=this.maxJobs,r=this.currJobs;r<i&&0<e.length;){r++;var o=e.pop(),s=n.get(o);n.delete(o),s(o).then(function(){t.currJobs--,t.autoUpdate&&t.scheduleJobRun()}).catch(function(){t.currJobs--,t.autoUpdate&&t.scheduleJobRun()})}this.currJobs=r}},{key:"scheduleJobRun",value:function(){this.scheduled||(this.schedulingCallback(this.Lt),this.scheduled=!0)}}])&&bl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),wl=3,Bl=4;function Ml(t){return t===wl||t===Bl}function Sl(t,e){return t.It===e&&t.Nt}function _l(t,e){t.It!==e&&(t.It=e,t.Nt=!1,t.Bt=!1,t._t=!1,t.Ft=!1,t.Dt=!1,t.Ht=1/0,t.Ut=1/0,t.Gt=!1,t.Vt=!1)}function El(t,e,n,i,r){var o=1<arguments.length&&void 0!==e?e:null,s=2<arguments.length&&void 0!==n?n:null,a=(e=3<arguments.length&&void 0!==i?i:null,4<arguments.length&&void 0!==r?r:0);if(!o||!o(t,e,a))for(var A=t.children,l=0,u=A.length;l<u;l++)El(A[l],o,s,t,a+1);s&&s(t,e,a)}function Tl(t){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cl(t,e,n){return(e=function(t){return"symbol"===Tl(t=function(t,e){if("object"!==Tl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Tl(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fl(t,e){var n=1<arguments.length&&void 0!==e?e:{};return new Promise(function(e,i){var r=n.method||"GET",o=n.responseType||"json",s=n.xhr||new XMLHttpRequest,a=(s.addEventListener("timeout",function(){i({errorType:"timeout_error",xhr:s})}),s.addEventListener("abort",function(){i({errorType:"abort",xhr:s})}),s.addEventListener("error",function(t){i({errorType:"onerror",xhr:s,error:t})}),{arraybuffer:"arrayBuffer",json:"json"});s.addEventListener("load",function(){var t;200===s.status||0===s.status||201===s.status?(t=Cl(Cl({},a[o],function(){return s.response}),"ok",!0),e(t)):i({errorType:"loadError",xhr:s})}),"POST"===r?(s.open("POST",t,!0),s.responseType=o,s.setRequestHeader("Accept","application/json"),s.send(JSON.parse(n.data))):(s.open("GET",t,!0),s.responseType=o,s.send())})}function Ol(t){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ol(t=function(t,e){if("object"!==Ol(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ol(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Ul(t,e){return t.Xt!==e.Xt?t.Xt>e.Xt?-1:1:t.Bt!==e.Bt?t.Bt?1:-1:t.Nt!==e.Nt?t.Nt?1:-1:t.Ht!==e.Ht?t.Ht>e.Ht?1:-1:t.Ut!==e.Ut?t.Ut>e.Ut?-1:1:0}function Rl(t){return 1/(t.Zt+1)}var Il=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.tileSets={},this.rootURL=e,this.fetchOptions={},this.preprocessURL=null;var n=((e=new gl).unloadPriorityCallback=Rl,new xl),i=(n.maxJobs=4,n.priorityCallback=Ul,new xl);i.maxJobs=1,i.priorityCallback=Ul,this.lruCache=e,this.downloadQueue=n,this.parseQueue=i,this.stats={parsing:0,downloading:0,failed:0,inFrustum:0,used:0,active:0,visible:0},this.frameCount=0,this.errorTarget=6,this.errorThreshold=1/0,this.loadSiblings=!0,this.displayActiveTiles=!1,this.maxDepth=1/0,this.stopAtEmptyTiles=!0}var e,n;return e=t,(n=[{key:"rootTileSet",get:function(){var t=this.tileSets[this.rootURL];return!t||t instanceof Promise?null:t}},{key:"root",get:function(){var t=this.rootTileSet;return t?t.root:null}},{key:"traverse",value:function(t,e){var n=this.tileSets[this.rootURL];n&&n.root&&El(n.root,t,e)}},{key:"update",value:function(){var t=this.stats,e=this.lruCache,n=this.tileSets,i=n[this.rootURL];this.rootURL in n?i&&i.root&&(n=i.root,t.inFrustum=0,t.used=0,t.active=0,t.visible=0,this.frameCount++,function t(e,n){var i=n.stats,r=n.frameCount,o=n.errorTarget,s=n.maxDepth,a=n.loadSiblings,A=n.lruCache,l=n.stopAtEmptyTiles;if(_l(e,r),!1===n.tileInView(e))return!1;if(e.Nt=!0,A.markUsed(e),e.Bt=!0,i.inFrustum++,(l||!e.qt)&&!e.zt){if(n.calculateError(e),e.Ht<=o)return!0;if(0<n.maxDepth&&e.Xt+1>=s)return!0}for(var u=!1,h=e.children,c=0,f=h.length;c<f;c++){var p=t(h[c],n);u=u||p}if(u&&a)for(var d=0,y=h.length;d<y;d++)!function t(e,n,i){if(_l(e,n),e.Nt=!0,i.markUsed(e),e.qt)for(var r=e.children,o=0,s=r.length;o<s;o++)t(r[o],n,i)}(h[d],r,A);return!0}(n,this),function t(e,n){var i=n.stats,r=n.frameCount;if(Sl(e,r)){i.used++;for(var o=e.children,s=!1,a=0,A=o.length;a<A;a++){var l=o[a];s=s||Sl(l,r)}if(s){for(var u=!1,h=!0,c=0,f=o.length;c<f;c++){var p=o[c];t(p,n),u=u||p.Wt||p.Gt,Sl(p,r)&&(p=p.Vt||!p.qt&&Ml(p.Yt)||p.zt&&p.Yt===Bl,h=h&&p)}e.Gt=u,e.Vt=h}else e._t=!0}}(n,this),function t(e,n){var i=n.stats,r=n.frameCount;if(Sl(e,r)){var o=(o=e.parent)?o.Zt:-1,s=(e.Zt=o,n.lruCache);if(e._t)e.Zt++,e.Yt===wl?(e.Bt&&(e.Ft=!0,i.visible++),e.Dt=!0,i.active++):s.isFull()||e.qt&&!e.zt||n.requestTileContents(e);else{o=(n.errorTarget+1)*n.errorThreshold;var a=(o=e.Ht<=o)||"ADD"===e.refine,A=!e.qt,l=A||e.zt,u=Ml(e.Yt)&&l,h=e.Gt,c=e.children,f=e.Vt;if(a&&A&&e.Zt++,a&&!u&&!s.isFull()&&l&&n.requestTileContents(e),(o&&!f&&!h&&u||"ADD"===e.refine&&u)&&(e.Bt&&(e.Ft=!0,i.visible++),e.Dt=!0,i.active++),"ADD"!==e.refine&&o&&!f&&u)for(var p=0,d=c.length;p<d;p++){var y=c[p];Sl(y,r)&&!s.isFull()&&(y.Zt=e.Zt+1,function t(e,n,i){if(!e.qt||e.zt&&!Ml(e.Yt))i.requestTileContents(e);else for(var r=e.children,o=0,s=r.length;o<s;o++){var a=r[o];a.Zt=n,t(a,n,i)}}(y,y.Zt,n))}else for(var m=0,g=c.length;m<g;m++){var v=c[m];Sl(v,r)&&t(v,n)}}}}(n,this),function t(e,n){var i=Sl(e,n.frameCount);if(i||e.Kt)for(var r=!1,o=!1,s=(i&&(r=e.Dt,o=n.displayActiveTiles&&e.Dt||e.Ft),e.qt||e.Yt!==wl||(e.Qt!==r&&n.setTileActive(e,r),e.Wt!==o&&n.setTileVisible(e,o)),e.Qt=r,e.Wt=o,e.Kt=i,e.children),a=0,A=s.length;a<A;a++)t(s[a],n)}(n,this),e.scheduleUnload()):this.loadRootTileSet(this.rootURL)}},{key:"parseTile",value:function(t,e,n){return null}},{key:"disposeTile",value:function(t){}},{key:"preprocessNode",value:function(t,e,n){t.content&&(!("uri"in t.content)&&"url"in t.content&&(t.content.uri=t.content.url,delete t.content.url),t.content.uri&&(t.content.uri=new URL(t.content.uri,n+"/").toString()),t.content.boundingVolume)&&!("box"in t.content.boundingVolume||"sphere"in t.content.boundingVolume||"region"in t.content.boundingVolume)&&delete t.content.boundingVolume,t.parent=e,t.children=t.children||[],t.content&&t.content.uri?(n=dl(t.content.uri),n=Boolean(n&&"json"===n.toLowerCase()),t.zt=n,t.qt=n):(t.zt=!1,t.qt=!0),t.Ut=1/0,t.Ht=1/0,t.Bt=!1,t._t=!1,t.Kt=!1,t.Nt=!1,t.Wt=!1,t.Ft=!1,t.Gt=!1,t.Vt=!1,t.Qt=!1,t.Dt=!1,t.Yt=0,t.$t=0,t.Jt=null,t.Zt=-1,null===e?(t.Xt=0,t.refine=t.refine||"REPLACE"):(t.Xt=e.Xt+1,t.refine=t.refine||e.refine)}},{key:"setTileActive",value:function(t,e){}},{key:"setTileVisible",value:function(t,e){}},{key:"calculateError",value:function(t){return 0}},{key:"tileInView",value:function(t){return!0}},{key:"resetFailedTiles",value:function(){var t=this.stats;0!==t.failed&&(this.traverse(function(t){t.Yt===Bl&&(t.Yt=0)}),t.failed=0)}},{key:"fetchTileSet",value:function(t,e){var n=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Fl(t,e).then(function(e){if(e.ok)return e.json();throw new Error('TilesRenderer: Failed to load tileset "'.concat(t,'" with status ').concat(e.status," : ").concat(e.statusText))}).then(function(e){e.asset.version;var r=t.replace(/\/[^\/]*\/?$/,"");r=new URL(r,window.location.href).toString();return El(e.root,function(t,e){return n.preprocessNode(t,e,r)},null,i,i?i.Xt:0),e})}},{key:"loadRootTileSet",value:function(t){var e,n=this.tileSets;return t in n?n[t]instanceof Error?Promise.reject(n[t]):Promise.resolve(n[t]):((e=this.fetchTileSet(this.preprocessURL?this.preprocessURL(t):t,this.fetchOptions).then(function(e){n[t]=e})).catch(function(e){n[t]=e}),n[t]=e)}},{key:"requestTileContents",value:function(t){var e,n,i,r,o,s,a,A,l=this;0===t.Yt&&(e=this.stats,n=this.lruCache,i=this.downloadQueue,r=this.parseQueue,o=t.zt,n.add(t,function(t){1===t.Yt?(t.Jt.abort(),t.Jt=null):o?t.children.length=0:l.disposeTile(t),1===t.Yt?e.downloading--:2===t.Yt&&e.parsing--,t.Yt=0,t.$t++,r.remove(t),i.remove(t)}),t.$t++,s=t.$t,a=new XMLHttpRequest,e.downloading++,t.Jt={abort:a.abort.bind(a)},t.Yt=1,A=function(o){t.$t===s&&("AbortError"!==o.name?(r.remove(t),i.remove(t),2===t.Yt?e.parsing--:1===t.Yt&&e.downloading--,e.failed++,t.Yt=Bl):n.remove(t))},(o?i.add(t,function(t){var e;return t.$t!==s?Promise.resolve():(e=l.preprocessURL?l.preprocessURL(t.content.uri):t.content.uri,l.fetchTileSet(e,Object.assign({xhr:a,responseType:"json"},l.fetchOptions),t))}).then(function(n){t.$t===s&&(e.downloading--,t.Jt=null,t.Yt=wl,t.children.push(n.root))}):i.add(t,function(t){return t.$t!==s?Promise.resolve():Fl(l.preprocessURL?l.preprocessURL(t.content.uri):t.content.uri,Object.assign({xhr:a,responseType:"arraybuffer"},l.fetchOptions))}).then(function(e){if(t.$t===s){if(e.ok)return e.arrayBuffer();throw new Error("Failed to load model with error code ".concat(e.status))}}).then(function(n){if(t.$t===s)return e.downloading--,e.parsing++,t.Jt=null,t.Yt=2,r.add(t,function(t){var e;return t.$t!==s?Promise.resolve():(e=dl(t.content.uri),l.parseTile(n,t,e))})}).then(function(){t.$t===s&&(e.parsing--,t.Yt=wl,t.Wt&&l.setTileVisible(t,!0),t.Qt)&&l.setTileActive(t,!0)})).catch(A))}},{key:"dispose",value:function(){var t=this.lruCache;this.traverse(function(e){t.remove(e)}),this.stats={parsing:0,downloading:0,failed:0,inFrustum:0,used:0,active:0,visible:0},this.frameCount=0}}])&&Pl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ll(t){return(Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dl(){return(Dl="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=kl(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function Ql(t,e){return(Ql=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function kl(t){return(kl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Nl(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ll(t=function(t,e){if("object"!==Ll(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ll(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Hl(t,e,n){e&&jl(t.prototype,e),n&&jl(t,n),Object.defineProperty(t,"prototype",{writable:!1})}var zl=function(){function t(e,n,i,r){Nl(this,t),this.buffer=e,this.binOffset=n+i,this.binLength=r,r=null,r=0!==i?(e=new Uint8Array(e,n,i),JSON.parse((n=e,(new TextDecoder).decode(n)))):{},this.header=r}return Hl(t,[{key:"getKeys",value:function(){return Object.keys(this.header)}},{key:"getData",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,r=this.header;if(!(t in r))return null;if((r=r[t])instanceof Object){if(Array.isArray(r))return r;var o,s,a=this.buffer,A=this.binOffset,l=this.binLength,u=r.byteOffset||0,h=r.type||i;n=r.componentType||n;if("type"in r&&i&&r.type!==i)throw new Error("FeatureTable: Specified type does not match expected type.");switch(h){case"SCALAR":o=1;break;case"VEC2":o=2;break;case"VEC3":o=3;break;case"VEC4":o=4;break;default:throw new Error('FeatureTable : Feature type not provided for "'.concat(t,'".'))}var c=A+u,f=e*o;switch(n){case"BYTE":s=new Int8Array(a,c,f);break;case"UNSIGNED_BYTE":s=new Uint8Array(a,c,f);break;case"SHORT":s=new Int16Array(a,c,f);break;case"UNSIGNED_SHORT":s=new Uint16Array(a,c,f);break;case"INT":s=new Int32Array(a,c,f);break;case"UNSIGNED_INT":s=new Uint32Array(a,c,f);break;case"FLOAT":s=new Float32Array(a,c,f);break;case"DOUBLE":s=new Float64Array(a,c,f);break;default:throw new Error('FeatureTable : Feature component type not provided for "'.concat(t,'".'))}if(A+l<c+f*s.BYTES_PER_ELEMENT)throw new Error("FeatureTable: Feature data read outside binary body length.");return s}return r}}]),t}(),Vl=function(){var t=o,e=zl;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ql(t,e);var n,i,r=(n=o,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=kl(n);if(t=i?(t=kl(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),e=this,t&&("object"===Ll(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")});function o(t,e,n,i,s){return Nl(this,o),(t=r.call(this,t,n,i,s)).batchSize=e,t}return Hl(o,[{key:"getData",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Dl(kl(o.prototype),"getData",this).call(this,t,this.batchSize,e,n)}}]),o}();function Gl(t){return(Gl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Gl(t=function(t,e){if("object"!==Gl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Gl(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var Kl=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.fetchOptions={},this.workingPath=""}var e,n;return e=t,(n=[{key:"load",value:function(t){var e=this;return fetch(t,this.fetchOptions).then(function(e){if(e.ok)return e.arrayBuffer();throw new Error('Failed to load file "'.concat(t,'" with status ').concat(e.status," : ").concat(e.statusText))}).then(function(n){return""===e.workingPath&&(e.workingPath=e.workingPathForURL(t)),e.parse(n)})}},{key:"resolveExternalURL",value:function(t){return/^[^\\/]/.test(t)?this.workingPath+"/"+t:t}},{key:"workingPathForURL",value:function(t){return(t=t.split(/[\\/]/g)).pop(),t.join("/")+"/"}},{key:"parse",value:function(t){throw new Error("LoaderBase: Parse not implemented.")}}])&&Yl(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Xl(t){var e=t instanceof DataView?t:new DataView(t);if("{"===String.fromCharCode(e.getUint8(0)))return null;for(var n="",i=0;i<4;i++)n+=String.fromCharCode(e.getUint8(i));return n}function Wl(t){return(Wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zl(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Wl(t=function(t,e){if("object"!==Wl(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Wl(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function ql(t,e){return(ql=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Jl(t){return(Jl=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var $l=function(){var t=i,e=Kl;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ql(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Jl(t);if(n=e?(n=Jl(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Wl(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){if(this instanceof i)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"parse",value:function(t){var e=Xl(s=new DataView(t)),n=(e=s.getUint32(4,!0),s.getUint32(8,!0)),i=s.getUint32(12,!0),r=s.getUint32(16,!0),o=s.getUint32(20,!0),s=s.getUint32(24,!0),a=t.slice(28,28+i+r);a=new zl(a,0,i,r),i=28+i+r,r=t.slice(i,i+o+s),i=i+o+s;return{version:e,featureTable:a,batchTable:r=new Vl(r,a.getData("BATCH_LENGTH"),0,o,s),glbBytes:new Uint8Array(t,i,n-i)}}}])&&Zl(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function tu(t,e,n){var i=this,r=!1,o=0,s=0,a=void 0,A=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){s++,!1===r&&void 0!==i.onStart&&i.onStart(t,o,s),r=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,s),o===s&&(r=!1,void 0!==i.onLoad)&&i.onLoad()},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this},this.addHandler=function(t,e){return A.push(t,e),this},this.removeHandler=function(t){return-1!==(t=A.indexOf(t))&&A.splice(t,2),this},this.getHandler=function(t){for(var e=0,n=A.length;e<n;e+=2){var i=A[e],r=A[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return r}return null},this.isLoaded=function(){return o===s}}var eu=new tu;function nu(t,e){Q.call(this),this.type="Light",this.color=new z(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}nu.prototype=Object.assign(Object.create(Q.prototype),{constructor:nu,isLight:!0,copy:function(t){return Q.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this}});var iu=new Nt,ru=new u;function ou(t,e,n,i,r,o){this.planes=[void 0!==t?t:new se,void 0!==e?e:new se,void 0!==n?n:new se,void 0!==i?i:new se,void 0!==r?r:new se,void 0!==o?o:new se]}function su(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new ut(512,512),this.map=null,this.mapPass=null,this.matrix=new g,this.ti=new ou,this.ii=new ut(1,1),this.ni=1,this.ei=[new lt(0,0,1,1)]}function au(){Q.call(this),this.type="Camera",this.matrixWorldInverse=new g,this.projectionMatrix=new g,this.projectionMatrixInverse=new g}function Au(t,e,n,i,r,o){au.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==e?e:1,this.top=void 0!==n?n:1,this.bottom=void 0!==i?i:-1,this.near=void 0!==r?r:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function lu(){su.call(this,new Au(-5,5,5,-5,.5,500))}function uu(t,e){nu.call(this,t,e),this.type="DirectionalLight",this.position.copy(Q.DefaultUp),this.updateMatrix(),this.target=new Q,this.shadow=new lu}Object.assign(ou.prototype,{set:function(t,e,n,i,r,o){var s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(n),s[3].copy(i),s[4].copy(r),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromProjectionMatrix:function(t){var e=this.planes,n=(t=t.elements)[0],i=t[1],r=t[2],o=t[3],s=t[4],a=t[5],A=t[6],l=t[7],u=t[8],h=t[9],c=t[10],f=t[11],p=t[12],d=t[13],y=t[14];t=t[15];return e[0].setComponents(o-n,l-s,f-u,t-p).normalize(),e[1].setComponents(o+n,l+s,f+u,t+p).normalize(),e[2].setComponents(o+i,l+a,f+h,t+d).normalize(),e[3].setComponents(o-i,l-a,f-h,t-d).normalize(),e[4].setComponents(o-r,l-A,f-c,t-y).normalize(),e[5].setComponents(o+r,l+A,f+c,t+y).normalize(),this},intersectsObject:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),iu.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(iu)},intersectsSprite:function(t){return iu.center.set(0,0,0),iu.radius=.7071067811865476,iu.applyMatrix4(t.matrixWorld),this.intersectsSphere(iu)},intersectsSphere:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++)if(e[r].distanceToPoint(n)<i)return!1;return!0},intersectsBox:function(t){for(var e=this.planes,n=0;n<6;n++){var i=e[n];if(ru.x=(0<i.normal.x?t.max:t.min).x,ru.y=(0<i.normal.y?t.max:t.min).y,ru.z=(0<i.normal.z?t.max:t.min).z,i.distanceToPoint(ru)<0)return!1}return!0},containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}}),Object.assign(su.prototype,{ri:new g,oi:new u,si:new u,getViewportCount:function(){return this.ni},getFrustum:function(){return this.ti},updateMatrices:function(t){var e=this.camera,n=this.matrix,i=this.ri,r=this.si,o=this.oi;o.setFromMatrixPosition(t.matrixWorld),e.position.copy(o),r.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(r),e.updateMatrixWorld(),i.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this.ti.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)},getViewport:function(t){return this.ei[t]},getFrameExtents:function(){return this.ii},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)}}),au.prototype=Object.assign(Object.create(Q.prototype),{constructor:au,isCamera:!0,copy:function(t,e){return Q.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(t=new u),this.updateMatrixWorld(!0);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(t){Q.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,e){Q.prototype.updateWorldMatrix.call(this,t,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Au.prototype=Object.assign(Object.create(au.prototype),{constructor:Au,isOrthographicCamera:!0,copy:function(t,e){return au.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,i,r,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(r=(this.right+this.left)/2)-e,r=r+e,o=(e=(o=(this.top+this.bottom)/2)+n,o-n);null!==this.view&&this.view.enabled&&(n=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom,r=(i+=n*this.view.offsetX)+n*this.view.width,o=(e-=t*this.view.offsetY)-t*this.view.height),this.projectionMatrix.makeOrthographic(i,r,e,o,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}),lu.prototype=Object.assign(Object.create(su.prototype),{constructor:lu,isDirectionalLightShadow:!0,updateMatrices:function(t){su.prototype.updateMatrices.call(this,t)}}),uu.prototype=Object.assign(Object.create(nu.prototype),{constructor:uu,isDirectionalLight:!0,copy:function(t){return nu.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}});var hu={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function cu(t){Du.call(this,t)}function fu(t){Du.call(this,t)}function pu(t){Jt.call(this),this.type="ShadowMaterial",this.color=new z(0),this.transparent=!0,this.setValues(t)}function du(t){Jt.call(this),this.type="SpriteMaterial",this.color=new z(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}cu.prototype=Object.assign(Object.create(Du.prototype),{constructor:cu,load:function(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r,o=this,s=hu.get(t);return void 0!==s?(o.manager.itemStart(t),setTimeout(function(){e&&e(s),o.manager.itemEnd(t)},0),s):((r=document.createElementNS("http://www.w3.org/1999/xhtml","img")).addEventListener("load",a,!1),r.addEventListener("error",A,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(r.crossOrigin=this.crossOrigin),o.manager.itemStart(t),r.src=t,r);function a(){r.removeEventListener("load",a,!1),r.removeEventListener("error",A,!1),hu.add(t,this),e&&e(this),o.manager.itemEnd(t)}function A(e){r.removeEventListener("load",a,!1),r.removeEventListener("error",A,!1),i&&i(e),o.manager.itemError(t),o.manager.itemEnd(t)}}}),fu.prototype=Object.assign(Object.create(Du.prototype),{constructor:fu,load:function(t,e,n,i){var r=new ee,o=new cu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){r.image=n,n=0<t.search(/\.jpe?g($|\?)/i)||0===t.search(/^data\:image\/jpeg/),r.format=n?1022:1023,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r}}),((pu.prototype=Object.create(Jt.prototype)).constructor=pu).prototype.isShadowMaterial=!0,pu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this},((du.prototype=Object.create(Jt.prototype)).constructor=du).prototype.isSpriteMaterial=!0,du.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var yu,mu,gu,vu,bu="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",xu="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n";function wu(t){Jt.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=bu,this.fragmentShader=xu,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(t.attributes,this.setValues(t))}function Bu(t){wu.call(this,t),this.type="RawShaderMaterial"}function Mu(t){Jt.call(this),this.type="PointsMaterial",this.color=new z(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function Su(t){Jt.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new z(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function _u(t){Su.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new ut(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function Eu(t){Jt.call(this),this.type="MeshPhongMaterial",this.color=new z(16777215),this.specular=new z(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Tu(t){Jt.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new z(16777215),this.specular=new z(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Cu(t){Jt.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Fu(t){Jt.call(this),this.type="MeshLambertMaterial",this.color=new z(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new z(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ou(t){Jt.call(this),this.type="MeshDepthMaterial",this.depthPacking=Mt,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Pu(t){Jt.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new u,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function Uu(t){Jt.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new z(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=St,this.normalScale=new ut(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ru(t){Jt.call(this),this.type="LineBasicMaterial",this.color=new z(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}function Iu(t){Ru.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Lu(t){Du.call(this,t),this.textures={}}function Du(t){this.manager=void 0!==t?t:eu,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}((wu.prototype=Object.create(Jt.prototype)).constructor=wu).prototype.isShaderMaterial=!0,wu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=function(t){var e,n={};for(e in t)for(var i in n[e]={},t[e]){var r=t[e][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?n[e][i]=r.clone():Array.isArray(r)?n[e][i]=r.slice():n[e][i]=r}return n}(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},((Bu.prototype=Object.create(wu.prototype)).constructor=Bu).prototype.isRawShaderMaterial=!0,((Mu.prototype=Object.create(Jt.prototype)).constructor=Mu).prototype.isPointsMaterial=!0,Mu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this},((Su.prototype=Object.create(Jt.prototype)).constructor=Su).prototype.isMeshStandardMaterial=!0,Su.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},((_u.prototype=Object.create(Su.prototype)).constructor=_u).prototype.isMeshPhysicalMaterial=!0,_u.prototype.copy=function(t){return Su.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,t.sheen?this.sheen=(this.sheen||new z).copy(t.sheen):this.sheen=null,this.transparency=t.transparency,this},((Eu.prototype=Object.create(Jt.prototype)).constructor=Eu).prototype.isMeshPhongMaterial=!0,Eu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Tu.prototype=Object.create(Jt.prototype)).constructor=Tu).prototype.isMeshToonMaterial=!0,Tu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Cu.prototype=Object.create(Jt.prototype)).constructor=Cu).prototype.isMeshNormalMaterial=!0,Cu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Fu.prototype=Object.create(Jt.prototype)).constructor=Fu).prototype.isMeshLambertMaterial=!0,Fu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Ou.prototype=Object.create(Jt.prototype)).constructor=Ou).prototype.isMeshDepthMaterial=!0,Ou.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},((Pu.prototype=Object.create(Jt.prototype)).constructor=Pu).prototype.isMeshDistanceMaterial=!0,Pu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},((Uu.prototype=Object.create(Jt.prototype)).constructor=Uu).prototype.isMeshMatcapMaterial=!0,Uu.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},((Ru.prototype=Object.create(Jt.prototype)).constructor=Ru).prototype.isLineBasicMaterial=!0,Ru.prototype.copy=function(t){return Jt.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},((Iu.prototype=Object.create(Ru.prototype)).constructor=Iu).prototype.isLineDashedMaterial=!0,Iu.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this},Lu.prototype=Object.assign(Object.create(Du.prototype),{constructor:Lu,load:function(t,e,n,i){var r=this,o=new ku(r.manager);o.setPath(r.path),o.load(t,function(t){e(r.parse(JSON.parse(t)))},n,i)},parse:function(t){var e=this.textures;function n(t){return e[t],e[t]}var r,o=new i[t.type];if(void 0!==t.uuid&&(o.uuid=t.uuid),void 0!==t.name&&(o.name=t.name),void 0!==t.color&&o.color.setHex(t.color),void 0!==t.roughness&&(o.roughness=t.roughness),void 0!==t.metalness&&(o.metalness=t.metalness),void 0!==t.sheen&&(o.sheen=(new z).setHex(t.sheen)),void 0!==t.emissive&&o.emissive.setHex(t.emissive),void 0!==t.specular&&o.specular.setHex(t.specular),void 0!==t.shininess&&(o.shininess=t.shininess),void 0!==t.clearcoat&&(o.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(o.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(o.fog=t.fog),void 0!==t.flatShading&&(o.flatShading=t.flatShading),void 0!==t.blending&&(o.blending=t.blending),void 0!==t.combine&&(o.combine=t.combine),void 0!==t.side&&(o.side=t.side),void 0!==t.opacity&&(o.opacity=t.opacity),void 0!==t.transparent&&(o.transparent=t.transparent),void 0!==t.alphaTest&&(o.alphaTest=t.alphaTest),void 0!==t.depthTest&&(o.depthTest=t.depthTest),void 0!==t.depthWrite&&(o.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(o.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(o.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(o.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(o.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(o.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(o.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(o.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(o.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(o.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(o.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(o.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(o.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(o.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(o.rotation=t.rotation),1!==t.linewidth&&(o.linewidth=t.linewidth),void 0!==t.dashSize&&(o.dashSize=t.dashSize),void 0!==t.gapSize&&(o.gapSize=t.gapSize),void 0!==t.scale&&(o.scale=t.scale),void 0!==t.polygonOffset&&(o.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(o.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(o.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(o.skinning=t.skinning),void 0!==t.morphTargets&&(o.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(o.morphNormals=t.morphNormals),void 0!==t.dithering&&(o.dithering=t.dithering),void 0!==t.vertexTangents&&(o.vertexTangents=t.vertexTangents),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.toneMapped&&(o.toneMapped=t.toneMapped),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.vertexColors&&("number"==typeof t.vertexColors?o.vertexColors=0<t.vertexColors:o.vertexColors=t.vertexColors),void 0!==t.uniforms)for(var s in t.uniforms){var a=t.uniforms[s];switch(o.uniforms[s]={},a.type){case"t":o.uniforms[s].value=n(a.value);break;case"c":o.uniforms[s].value=(new z).setHex(a.value);break;case"v2":o.uniforms[s].value=(new ut).fromArray(a.value);break;case"v3":o.uniforms[s].value=(new u).fromArray(a.value);break;case"v4":o.uniforms[s].value=(new lt).fromArray(a.value);break;case"m3":o.uniforms[s].value=(new M).fromArray(a.value);case"m4":o.uniforms[s].value=(new g).fromArray(a.value);break;default:o.uniforms[s].value=a.value}}if(void 0!==t.defines&&(o.defines=t.defines),void 0!==t.vertexShader&&(o.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(o.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(var A in t.extensions)o.extensions[A]=t.extensions[A];return void 0!==t.shading&&(o.flatShading=1===t.shading),void 0!==t.size&&(o.size=t.size),void 0!==t.sizeAttenuation&&(o.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(o.map=n(t.map)),void 0!==t.matcap&&(o.matcap=n(t.matcap)),void 0!==t.alphaMap&&(o.alphaMap=n(t.alphaMap)),void 0!==t.bumpMap&&(o.bumpMap=n(t.bumpMap)),void 0!==t.bumpScale&&(o.bumpScale=t.bumpScale),void 0!==t.normalMap&&(o.normalMap=n(t.normalMap)),void 0!==t.normalMapType&&(o.normalMapType=t.normalMapType),void 0!==t.normalScale&&(r=t.normalScale,!1===Array.isArray(r)&&(r=[r,r]),o.normalScale=(new ut).fromArray(r)),void 0!==t.displacementMap&&(o.displacementMap=n(t.displacementMap)),void 0!==t.displacementScale&&(o.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(o.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(o.roughnessMap=n(t.roughnessMap)),void 0!==t.metalnessMap&&(o.metalnessMap=n(t.metalnessMap)),void 0!==t.emissiveMap&&(o.emissiveMap=n(t.emissiveMap)),void 0!==t.emissiveIntensity&&(o.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(o.specularMap=n(t.specularMap)),void 0!==t.envMap&&(o.envMap=n(t.envMap)),void 0!==t.envMapIntensity&&(o.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(o.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(o.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(o.lightMap=n(t.lightMap)),void 0!==t.lightMapIntensity&&(o.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(o.aoMap=n(t.aoMap)),void 0!==t.aoMapIntensity&&(o.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(o.gradientMap=n(t.gradientMap)),void 0!==t.clearcoatMap&&(o.clearcoatMap=n(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(o.clearcoatRoughnessMap=n(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(o.clearcoatNormalMap=n(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(o.clearcoatNormalScale=(new ut).fromArray(t.clearcoatNormalScale)),o},setTextures:function(t){return this.textures=t,this}}),Object.assign(Du.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this}}),Object.assign(Du.prototype,{crossOrigin:"anonymous",onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var i=[],r=0;r<t.length;++r)i[r]=this.createMaterial(t[r],e,n);return i},createMaterial:(yu={NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5},mu=new z,gu=new fu,vu=new Lu,function(t,e,n){var i={};function r(t,r,o,a,A){t=e+t;var l=(null!==(l=(new tu).getHandler(t))?l:(gu.setCrossOrigin(n),gu)).load(t);void 0!==r&&(l.repeat.fromArray(r),1!==r[0]&&(l.wrapS=1e3),1!==r[1])&&(l.wrapT=1e3),void 0!==o&&l.offset.fromArray(o),void 0!==a&&("repeat"===a[0]&&(l.wrapS=1e3),"mirror"===a[0]&&(l.wrapS=1002),"repeat"===a[1]&&(l.wrapT=1e3),"mirror"===a[1])&&(l.wrapT=1002),void 0!==A&&(l.anisotropy=A),t=s.generateUUID();return i[t]=l,t}var o,a={uuid:s.generateUUID(),type:"MeshLambertMaterial"};for(o in t){var A=t[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=A;break;case"blending":a.blending=yu[A];break;case"colorAmbient":case"mapAmbient":break;case"colorDiffuse":a.color=mu.fromArray(A).getHex();break;case"colorSpecular":a.specular=mu.fromArray(A).getHex();break;case"colorEmissive":a.emissive=mu.fromArray(A).getHex();break;case"specularCoef":a.shininess=A;break;case"shading":"basic"===A.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===A.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===A.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=r(A,t.mapDiffuseRepeat,t.mapDiffuseOffset,t.mapDiffuseWrap,t.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=r(A,t.mapEmissiveRepeat,t.mapEmissiveOffset,t.mapEmissiveWrap,t.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=r(A,t.mapLightRepeat,t.mapLightOffset,t.mapLightWrap,t.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=r(A,t.mapAORepeat,t.mapAOOffset,t.mapAOWrap,t.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=r(A,t.mapBumpRepeat,t.mapBumpOffset,t.mapBumpWrap,t.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=A;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=r(A,t.mapNormalRepeat,t.mapNormalOffset,t.mapNormalWrap,t.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=A;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=r(A,t.mapSpecularRepeat,t.mapSpecularOffset,t.mapSpecularWrap,t.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=r(A,t.mapMetalnessRepeat,t.mapMetalnessOffset,t.mapMetalnessWrap,t.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=r(A,t.mapRoughnessRepeat,t.mapRoughnessOffset,t.mapRoughnessWrap,t.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=r(A,t.mapAlphaRepeat,t.mapAlphaOffset,t.mapAlphaWrap,t.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=1;break;case"doubleSided":a.side=2;break;case"transparency":a.opacity=A;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=A;break;case"vertexColors":!0===A&&(a.vertexColors=2),"face"===A&&(a.vertexColors=1)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),vu.setTextures(i),vu.parse(a)})});var Qu={};function ku(t){Du.call(this,t)}ku.prototype=Object.assign(Object.create(Du.prototype),{constructor:ku,load:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,o=hu.get(t);if(void 0!==o)return r.manager.itemStart(t),setTimeout(function(){e&&e(o),r.manager.itemEnd(t)},0),o;if(void 0===Qu[t]){var s=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var a=s[1],A=!!s[2],l=s[3];l=decodeURIComponent(l);A&&(l=atob(l));try{var u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var h=new Uint8Array(l.length),c=0;c<l.length;c++)h[c]=l.charCodeAt(c);f="blob"===u?new Blob([h.buffer],{type:a}):h.buffer;break;case"document":var f=(new DOMParser).parseFromString(l,a);break;case"json":f=JSON.parse(l);break;default:f=l}setTimeout(function(){e&&e(f),r.manager.itemEnd(t)},0)}catch(e){setTimeout(function(){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)},0)}}else{Qu[t]=[],Qu[t].push({onLoad:e,onProgress:n,onError:i});var p,d=new XMLHttpRequest;for(p in d.open("GET",t,!0),d.addEventListener("load",function(e){var n=this.response,i=Qu[t];if(delete Qu[t],200===this.status||0===this.status){this.status,hu.add(t,n);for(var o=0,s=i.length;o<s;o++)(a=i[o]).onLoad&&a.onLoad(n)}else{var a;for(o=0,s=i.length;o<s;o++)(a=i[o]).onError&&a.onError(e);r.manager.itemError(t)}r.manager.itemEnd(t)},!1),d.addEventListener("progress",function(e){for(var n=Qu[t],i=0,r=n.length;i<r;i++){var o=n[i];o.onProgress&&o.onProgress(e)}},!1),d.addEventListener("error",function(e){var n=Qu[t];delete Qu[t];for(var i=0,o=n.length;i<o;i++){var s=n[i];s.onError&&s.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),d.addEventListener("abort",function(e){var n=Qu[t];delete Qu[t];for(var i=0,o=n.length;i<o;i++){var s=n[i];s.onError&&s.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),void 0!==this.responseType&&(d.responseType=this.responseType),void 0!==this.withCredentials&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)d.setRequestHeader(p,this.requestHeader[p]);d.send(null)}return r.manager.itemStart(t),d}Qu[t].push({onLoad:e,onProgress:n,onError:i})},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var Nu=function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(t){return e}};function ju(t,e,n,i){au.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==i?i:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Hu(){su.call(this,new ju(90,1,.5,500)),this.ii=new ut(4,2),this.ni=6,this.ei=[new lt(2,1,1,1),new lt(0,1,1,1),new lt(3,1,1,1),new lt(1,1,1,1),new lt(3,0,1,1),new lt(1,0,1,1)],this.ui=[new u(1,0,0),new u(-1,0,0),new u(0,0,1),new u(0,0,-1),new u(0,1,0),new u(0,-1,0)],this.hi=[new u(0,1,0),new u(0,1,0),new u(0,1,0),new u(0,1,0),new u(0,0,1),new u(0,0,-1)]}function zu(t,e,n,i){nu.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==i?i:1,this.shadow=new Hu}function Vu(){su.call(this,new ju(50,1,.5,500))}function Gu(t,e,n,i,r,o){nu.call(this,t,e),this.type="SpotLight",this.position.copy(Q.DefaultUp),this.updateMatrix(),this.target=new Q,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==i?i:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==o?o:1,this.shadow=new Vu}function Yu(t,e,n,i){this.parameterPositions=t,this.ai=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function Ku(t){Du.call(this,t)}function Xu(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}ju.prototype=Object.assign(Object.create(au.prototype),{constructor:ju,isPerspectiveCamera:!0,copy:function(t,e){return au.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*s.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*s.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*s.RAD2DEG*Math.atan(Math.tan(.5*s.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,i,r,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t,e=this.near,n=e*Math.tan(.5*s.DEG2RAD*this.fov)/this.zoom,i=2*n,r=this.aspect*i,o=-.5*r,a=this.view,A=(null!==this.view&&this.view.enabled&&(A=a.fullWidth,t=a.fullHeight,o+=a.offsetX*r/A,n-=a.offsetY*i/t,r*=a.width/A,i*=a.height/t),this.filmOffset);0!==A&&(o+=e*A/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,n,n-i,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}),Hu.prototype=Object.assign(Object.create(su.prototype),{constructor:Hu,isPointLightShadow:!0,updateMatrices:function(t,e){void 0===e&&(e=0);var n=this.camera,i=this.matrix,r=this.oi,o=this.si,s=this.ri;r.setFromMatrixPosition(t.matrixWorld),n.position.copy(r),o.copy(n.position),o.add(this.ui[e]),n.up.copy(this.hi[e]),n.lookAt(o),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),s.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this.ti.setFromProjectionMatrix(s)}}),zu.prototype=Object.assign(Object.create(nu.prototype),{constructor:zu,isPointLight:!0,copy:function(t){return nu.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Vu.prototype=Object.assign(Object.create(su.prototype),{constructor:Vu,isSpotLightShadow:!0,updateMatrices:function(t){var e=this.camera,n=2*s.RAD2DEG*t.angle,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),su.prototype.updateMatrices.call(this,t)}}),Gu.prototype=Object.assign(Object.create(nu.prototype),{constructor:Gu,isSpotLight:!0,copy:function(t){return nu.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Object.assign(Yu.prototype,{evaluate:function(t){var e,n=this.parameterPositions,i=this.ai,r=n[i],o=n[i-1];t:{e:{n:{i:if(!(t<r)){for(var s=i+2;;){if(void 0===r){if(t<o)break i;return i=n.length,this.ai=i,this.afterEnd_(i-1,t,o)}if(i===s)break;if(o=r,t<(r=n[++i]))break e}e=n.length;break n}if(o<=t)break t;var a=n[1];for(t<a&&(i=2,o=a),s=i-2;;){if(void 0===o)return this.ai=0,this.beforeStart_(0,t,r);if(i===s)break;if(r=o,(o=n[--i-1])<=t)break e}e=i,i=0}for(;i<e;){var A=i+e>>>1;t<n[A]?e=A:i=1+A}if(r=n[i],void 0===(o=n[i-1]))return this.ai=0,this.beforeStart_(0,t,r);if(void 0===r)return i=n.length,this.ai=i,this.afterEnd_(i-1,o,t)}this.ai=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i,o=0;o!==i;++o)e[o]=n[r+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Yu.prototype,{beforeStart_:Yu.prototype.copySampleValue_,afterEnd_:Yu.prototype.copySampleValue_}),Ku.prototype=Object.assign(Object.create(Du.prototype),{constructor:Ku,load:function(t,e,n,i){var r=null,o=new cu(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(t){var n=t.width,i=t.height,o=(512<(n=s.isPowerOfTwo(n)?n:Math.pow(2,Math.floor(Math.log(n)/Math.LN2)))&&(n=512),512<(i=s.isPowerOfTwo(i)?i:Math.pow(2,Math.floor(Math.log(i)/Math.LN2)))&&(i=512),document.createElement("canvas"));o.width=n,o.height=i,o.getContext("2d").drawImage(t,0,0,o.width,o.height),r=new ne(o),void 0!==e&&e(r)},n,i),r}}),Object.defineProperty(Xu.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Xu.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this},set:function(t,e){return this.array.set(t,e=void 0===e?0:e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Wu=new u;function Zu(t,e,n,i){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}function qu(t,e){t&&t.isGeometry,Ve.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new g,this.bindMatrixInverse=new g}Object.defineProperties(Zu.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Zu.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var e=0,n=this.data.count;e<n;e++)Wu.x=this.getX(e),Wu.y=this.getY(e),Wu.z=this.getZ(e),Wu.applyMatrix4(t),this.setXYZ(e,Wu.x,Wu.y,Wu.z);return this},setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this},setXYZW:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}}),qu.prototype=Object.assign(Object.create(Ve.prototype),{constructor:qu,isSkinnedMesh:!0,bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new lt,e=this.geometry.attributes.skinWeight,n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);var r=1/t.manhattanLength();r!=1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Ve.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode&&this.bindMatrixInverse.getInverse(this.bindMatrix)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ju=new u,$u=new u,th=new g,eh=new pe,nh=new Nt;function ih(t,e,n){Q.call(this),this.type="Line",this.geometry=void 0!==t?t:new Wt,this.material=void 0!==e?e:new Ru}ih.prototype=Object.assign(Object.create(Q.prototype),{constructor:ih,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var e=t.attributes.position,n=[0],i=1,r=e.count;i<r;i++)Ju.fromBufferAttribute(e,i-1),$u.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=Ju.distanceTo($u);t.setAttribute("lineDistance",new Dt(n,1))}}else if(t.isGeometry){var o=t.vertices;for((n=t.lineDistances)[0]=0,i=1,r=o.length;i<r;i++)n[i]=n[i-1],n[i]+=o[i-1].distanceTo(o[i])}return this},raycast:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),nh.copy(n.boundingSphere),nh.applyMatrix4(i),nh.radius+=r,!1!==t.ray.intersectsSphere(nh)){th.getInverse(i),eh.copy(t.ray).applyMatrix4(th);var o=(i=r/((this.scale.x+this.scale.y+this.scale.z)/3))*i,s=new u,a=new u,A=new u,l=new u,h=this&&this.isLineSegments?2:1;if(n.isBufferGeometry){r=n.index;var c=n.attributes.position.array;if(null!==r)for(var f=r.array,p=0,d=f.length-1;p<d;p+=h){var y=f[p],m=f[p+1];s.fromArray(c,3*y),a.fromArray(c,3*m),o<eh.distanceSqToSegment(s,a,l,A)||(l.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(l))<t.near)||g>t.far||e.push({distance:g,point:A.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}else for(p=0,d=c.length/3-1;p<d;p+=h)s.fromArray(c,3*p),a.fromArray(c,3*p+3),o<eh.distanceSqToSegment(s,a,l,A)||(l.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(l))<t.near)||g>t.far||e.push({distance:g,point:A.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}else if(n.isGeometry){var g,v=n.vertices,b=v.length;for(p=0;p<b-1;p+=h)o<eh.distanceSqToSegment(v[p],v[p+1],l,A)||(l.applyMatrix4(this.matrixWorld),(g=t.ray.origin.distanceTo(l))<t.near)||g>t.far||e.push({distance:g,point:A.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var rh=new u,oh=new u;function sh(t,e){ih.call(this,t,e),this.type="LineSegments"}function ah(t,e){ih.call(this,t,e),this.type="LineLoop"}sh.prototype=Object.assign(Object.create(ih.prototype),{constructor:sh,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry){if(null===t.index){for(var e=t.attributes.position,n=[],i=0,r=e.count;i<r;i+=2)rh.fromBufferAttribute(e,i),oh.fromBufferAttribute(e,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+rh.distanceTo(oh);t.setAttribute("lineDistance",new Dt(n,1))}}else if(t.isGeometry){var o=t.vertices;for(n=t.lineDistances,i=0,r=o.length;i<r;i+=2)rh.copy(o[i]),oh.copy(o[i+1]),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+rh.distanceTo(oh)}return this}}),ah.prototype=Object.assign(Object.create(ih.prototype),{constructor:ah,isLineLoop:!0});var Ah=new g,lh=new pe,uh=new Nt,hh=new u;function ch(t,e){Q.call(this),this.type="Points",this.geometry=void 0!==t?t:new Wt,this.material=void 0!==e?e:new Mu,this.updateMorphTargets()}function fh(t,e,n,i,r,o,s){var a=lh.distanceSqToPoint(t);a<n&&(n=new u,lh.closestPointToPoint(t,n),n.applyMatrix4(i),(t=r.ray.origin.distanceTo(n))<r.near||t>r.far||o.push({distance:t,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:s}))}function ph(t,e,n,i){Yu.call(this,t,e,n,i),this.ci=-0,this.fi=-0,this.li=-0,this.vi=-0}function dh(t,e,n,i){Yu.call(this,t,e,n,i)}function yh(t,e,n,i){Yu.call(this,t,e,n,i)}ch.prototype=Object.assign(Object.create(Q.prototype),{constructor:ch,isPoints:!0,raycast:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold;if(null===n.boundingSphere&&n.computeBoundingSphere(),uh.copy(n.boundingSphere),uh.applyMatrix4(i),uh.radius+=r,!1!==t.ray.intersectsSphere(uh)){Ah.getInverse(i),lh.copy(t.ray).applyMatrix4(Ah);var o=(r=r/((this.scale.x+this.scale.y+this.scale.z)/3))*r;if(n.isBufferGeometry){r=n.index;var s=n.attributes.position.array;if(null!==r)for(var a=r.array,A=0,l=a.length;A<l;A++){var u=a[A];hh.fromArray(s,3*u),fh(hh,u,o,i,t,e,this)}else{A=0;for(var h=s.length/3;A<h;A++)hh.fromArray(s,3*A),fh(hh,A,o,i,t,e,this)}}else{var c=n.vertices;for(A=0,h=c.length;A<h;A++)fh(c[A],A,o,i,t,e,this)}}},updateMorphTargets:function(){var t,e,n,i=this.geometry;if(i.isBufferGeometry){var r=i.morphAttributes,o=Object.keys(r);if(0<o.length){var s=r[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else void 0!==(r=i.morphTargets)&&r.length},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ph.prototype=Object.assign(Object.create(Yu.prototype),{constructor:ph,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,e,n){var i=this.parameterPositions,r=t-2,o=t+1,s=i[r],a=i[o];if(void 0===s)switch(this.getSettings_().endingStart){case 2401:r=t,s=2*e-n;break;case 2402:s=e+i[r=i.length-2]-i[r+1];break;default:r=t,s=n}if(void 0===a)switch(this.getSettings_().endingEnd){case 2401:o=t,a=2*n-e;break;case 2402:a=n+i[o=1]-i[0];break;default:o=t-1,a=e}var A=.5*(n-e),l=this.valueSize;this.ci=A/(e-s),this.li=A/(a-n),this.fi=r*l,this.vi=o*l},interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,A=a-s,l=this.fi,u=this.vi,h=(t=this.ci,this.li),c=-t*(e=(i=(n=(n-e)/(i-e))*n)*n)+2*t*i-t*n,f=(1+t)*e+(-1.5-2*t)*i+(-.5+t)*n+1,p=(-1-h)*e+(1.5+h)*i+.5*n,d=h*e-h*i,y=0;y!==s;++y)r[y]=c*o[l+y]+f*o[A+y]+p*o[a+y]+d*o[u+y];return r}}),dh.prototype=Object.assign(Object.create(Yu.prototype),{constructor:dh,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,A=a-s,l=(n-e)/(i-e),u=1-l,h=0;h!==s;++h)r[h]=o[A+h]*u+o[a+h]*l;return r}}),yh.prototype=Object.assign(Object.create(Yu.prototype),{constructor:yh,interpolate_:function(t){return this.copySampleValue_(t-1)}});var mh={arraySlice:function(t,e,n){return mh.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,n=new Array(e),i=0;i!==e;++i)n[i]=i;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){for(var i=t.length,r=new t.constructor(i),o=0,s=0;s!==i;++o)for(var a=n[o]*e,A=0;A!==e;++A)r[s++]=t[a+A];return r},flattenJSON:function(t,e,n,i){for(var r=1,o=t[0];void 0!==o&&void 0===o[i];)o=t[r++];if(void 0!==o){var s=o[i];if(void 0!==s)if(Array.isArray(s))for(;void 0!==(s=o[i])&&(e.push(o.time),n.push.apply(n,s)),void 0!==(o=t[r++]););else if(void 0!==s.toArray)for(;void 0!==(s=o[i])&&(e.push(o.time),s.toArray(n,n.length)),void 0!==(o=t[r++]););else for(;void 0!==(s=o[i])&&(e.push(o.time),n.push(s)),void 0!==(o=t[r++]););}},subclip:function(t,e,n,i,r){r=r||30;for(var o=t.clone(),s=(o.name=e,[]),a=0;a<o.tracks.length;++a){for(var A=o.tracks[a],l=A.getValueSize(),u=[],h=[],c=0;c<A.times.length;++c){var f=A.times[c]*r;if(!(f<n||i<=f)){u.push(A.times[c]);for(var p=0;p<l;++p)h.push(A.values[c*l+p])}}0!==u.length&&(A.times=mh.convertArray(u,A.times.constructor),A.values=mh.convertArray(h,A.values.constructor),s.push(A))}o.tracks=s;var d=1/0;for(a=0;a<o.tracks.length;++a)d>o.tracks[a].times[0]&&(d=o.tracks[a].times[0]);for(a=0;a<o.tracks.length;++a)o.tracks[a].shift(-1*d);return o.resetDuration(),o}};function gh(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=mh.convertArray(e,this.TimeBufferType),this.values=mh.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}function vh(t,e,n,i){gh.call(this,t,e,n,i)}function bh(t,e,n,i){Yu.call(this,t,e,n,i)}function xh(t,e,n,i){gh.call(this,t,e,n,i)}function wh(t,e,n,i){gh.call(this,t,e,n,i)}function Bh(t,e,n){gh.call(this,t,e,n)}function Mh(t,e,n,i){gh.call(this,t,e,n,i)}function Sh(t,e,n,i){gh.call(this,t,e,n,i)}function _h(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=s.generateUUID(),this.duration<0&&this.resetDuration()}function Eh(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e,n,i=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vh;case"vector":case"vector2":case"vector3":case"vector4":return wh;case"color":return Mh;case"quaternion":return xh;case"bool":case"boolean":return Bh;case"string":return Sh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);return void 0===t.times&&(mh.flattenJSON(t.keys,e=[],n=[],"value"),t.times=e,t.values=n),void 0!==i.parse?i.parse(t):new i(t.name,t.times,t.values,t.interpolation)}function Th(){Q.call(this),this.type="Bone"}Object.assign(gh.prototype,{constructor:gh,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Bt,InterpolantFactoryMethodDiscrete:function(t){return new yh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new dh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new ph(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case wt:e=this.InterpolantFactoryMethodDiscrete;break;case Bt:e=this.InterpolantFactoryMethodLinear;break;case 2302:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}}else this.createInterpolant=e;return this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wt;case this.InterpolantFactoryMethodLinear:return Bt;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this},trim:function(t,e){for(var n,i=this.times,r=i.length,o=0,s=r-1;o!==r&&i[o]<t;)++o;for(;-1!==s&&i[s]>e;)--s;return++s,0===o&&s===r||(s<=o&&(o=(s=Math.max(s,1))-1),n=this.getValueSize(),this.times=mh.arraySlice(i,o,s),this.values=mh.arraySlice(this.values,o*n,s*n)),this},validate:function(){for(var t=!0,e=this.getValueSize(),n=(e-Math.floor(e)!=0&&(t=!1),this.times),i=this.values,r=n.length,o=(0===r&&(t=!1),null),s=0;s!==r;s++){var a=n[s];if("number"==typeof a&&isNaN(a)){t=!1;break}if(null!==o&&a<o){t=!1;break}o=a}if(void 0!==i&&mh.isTypedArray(i)){s=0;for(var A=i.length;s!==A;++s){var l=i[s];if(isNaN(l)){t=!1;break}}}return t},optimize:function(){for(var t=mh.arraySlice(this.times),e=mh.arraySlice(this.values),n=this.getValueSize(),i=2302===this.getInterpolation(),r=1,o=t.length-1,s=1;s<o;++s){var a=!1,A=t[s];if(A!==t[s+1]&&(1!==s||A!==A[0]))if(i)a=!0;else for(var l=s*n,u=l-n,h=l+n,c=0;c!==n;++c){var f=e[l+c];if(f!==e[u+c]||f!==e[h+c]){a=!0;break}}if(a){if(s!==r){t[r]=t[s];var p=s*n,d=r*n;for(c=0;c!==n;++c)e[d+c]=e[p+c]}++r}}if(0<o){for(t[r]=t[o],p=o*n,d=r*n,c=0;c!==n;++c)e[d+c]=e[p+c];++r}return r!==t.length?(this.times=mh.arraySlice(t,0,r),this.values=mh.arraySlice(e,0,r*n)):(this.times=t,this.values=e),this},clone:function(){var t=mh.arraySlice(this.times,0),e=mh.arraySlice(this.values,0);return(t=new this.constructor(this.name,t,e)).createInterpolant=this.createInterpolant,t}}),vh.prototype=Object.assign(Object.create(gh.prototype),{constructor:vh,ValueTypeName:"number"}),bh.prototype=Object.assign(Object.create(Yu.prototype),{constructor:bh,interpolate_:function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,A=t*s,l=(n-e)/(i-e),u=A+s;A!==u;A+=4)a.slerpFlat(r,0,o,A-s,o,A,l);return r}}),xh.prototype=Object.assign(Object.create(gh.prototype),{constructor:xh,ValueTypeName:"quaternion",DefaultInterpolation:Bt,InterpolantFactoryMethodLinear:function(t){return new bh(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),wh.prototype=Object.assign(Object.create(gh.prototype),{constructor:wh,ValueTypeName:"vector"}),Bh.prototype=Object.assign(Object.create(gh.prototype),{constructor:Bh,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Mh.prototype=Object.assign(Object.create(gh.prototype),{constructor:Mh,ValueTypeName:"color"}),Sh.prototype=Object.assign(Object.create(gh.prototype),{constructor:Sh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:wt,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(_h,{parse:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,o=n.length;r!==o;++r)e.push(Eh(n[r]).scale(i));return new _h(t.name,t.duration,e)},CreateFromMorphTargetSequence:function(t,e,n,i){for(var r=e.length,o=[],s=0;s<r;s++){var a=[],A=((l=[]).push((s+r-1)%r,s,(s+1)%r),a.push(0,1,0),mh.getKeyframeOrder(l)),l=mh.sortedArray(l,1,A);a=mh.sortedArray(a,1,A);i||0!==l[0]||(l.push(r),a.push(a[0])),o.push(new vh(".morphTargetInfluences["+e[s].name+"]",l,a).scale(1/n))}return new _h(t,-1,o)},findByName:function(t,e){var n=t;Array.isArray(t)||(n=t.geometry&&t.geometry.animations||t.animations);for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,o=0,s=t.length;o<s;o++){var a=t[o],A=a.name.match(r);A&&1<A.length&&((A=i[l=A[1]])||(i[l]=A=[]),A.push(a))}var l,u=[];for(l in i)u.push(_h.CreateFromMorphTargetSequence(l,i[l],e,n));return u},parseAnimation:function(t,e){if(!t)return null;for(var n=function(t,e,n,i,r){var o;0!==n.length&&(mh.flattenJSON(n,n=[],o=[],i),0!==n.length)&&r.push(new t(e,n,o))},i=[],r=t.name||"default",o=t.length||-1,s=t.fps||30,a=t.hierarchy||[],A=0;A<a.length;A++){var l=a[A].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var u,h={},c=0;c<l.length;c++)if(l[c].morphTargets)for(var f=0;f<l[c].morphTargets.length;f++)h[l[c].morphTargets[f]]=-1;for(u in h){var p=[],d=[];for(f=0;f!==l[c].morphTargets.length;++f){var y=l[c];p.push(y.time),d.push(y.morphTarget===u?1:0)}i.push(new vh(".morphTargetInfluence["+u+"]",p,d))}o=h.length*(s||1)}else{var m=".bones["+e[A].name+"]";n(wh,m+".position",l,"pos",i),n(xh,m+".quaternion",l,"rot",i),n(wh,m+".scale",l,"scl",i)}}return 0===i.length?null:new _h(r,o,i)}}),Object.assign(_h.prototype,{resetDuration:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new _h(this.name,this.duration,t)}}),Th.prototype=Object.assign(Object.create(Q.prototype),{constructor:Th,isBone:!0});Eo="\\[\\]\\.:\\/";var Ch=new RegExp("["+Eo+"]","g"),Fh="[^"+Eo+"]",Oh=(Eo="[^"+Eo.replace("\\.","")+"]",/((?:WC+[\/:])*)/.source.replace("WC",Fh)),Ph=(Eo=/(WCOD+)?/.source.replace("WCOD",Eo),/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Fh)),Uh=(Fh=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Fh),new RegExp("^"+Oh+Eo+Ph+Fh+"$")),Rh=["material","materials","bones"];function Ih(t,e,n){n=n||Lh.parseTrackName(e),this.yi=t,this.di=t.subscribe_(e,n)}function Lh(t,e,n){this.path=e,this.parsedPath=n||Lh.parseTrackName(e),this.node=Lh.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}Object.assign(Ih.prototype,{getValue:function(t,e){this.bind();var n=this.yi.nCachedObjects_;void 0!==(n=this.di[n])&&n.getValue(t,e)},setValue:function(t,e){for(var n=this.di,i=this.yi.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)},bind:function(){for(var t=this.di,e=this.yi.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this.di,e=this.yi.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Lh,{Composite:Ih,create:function(t,e,n){return new(t&&t.isAnimationObjectGroup?Lh.Composite:Lh)(t,e,n)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(Ch,"")},parseTrackName:function(t){if(!(n=Uh.exec(t)))throw new Error("PropertyBinding: Cannot parse trackName: "+t);var e,n,i=(n={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]}).nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i&&(e=n.nodeName.substring(i+1),-1!==Rh.indexOf(e))&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=e),null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n},findNode:function(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}return t.children&&(n=function t(n){for(var i=0;i<n.length;i++){var r=n[i];if(r.name===e||r.uuid===e)return r;if(r=t(r.children))return r}return null}(t.children))?n:null}}),Object.assign(Lh.prototype,{bi:function(){},pi:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=(a=this.parsedPath).objectName,n=a.propertyName,i=a.propertyIndex;if(t||(t=Lh.findNode(this.rootNode,a.nodeName)||this.rootNode,this.node=t),this.getValue=this.bi,this.setValue=this.pi,t){if(e){var r=a.objectIndex;switch(e){case"materials":if(!t.material)return;if(!t.material.materials)return;t=t.material.materials;break;case"bones":if(!t.skeleton)return;t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===r){r=o;break}break;default:if(void 0===t[e])return;t=t[e]}if(void 0!==r){if(void 0===t[r])return;t=t[r]}}var s=t[n];if(void 0===s)a=a.nodeName;else{var a=this.Versioning.None,A=(void 0!==(this.targetObject=t).needsUpdate?a=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(a=this.Versioning.MatrixWorldNeedsUpdate),this.BindingType.Direct);if(void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return;if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return;for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!t.geometry.morphTargets)return;for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===i){i=o;break}}}A=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(A=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(A=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[A],this.setValue=this.SetterByBindingTypeAndVersioning[A][a]}}},unbind:function(){this.node=null,this.getValue=this.mi,this.setValue=this.wi}}),Object.assign(Lh.prototype,{mi:Lh.prototype.getValue,wi:Lh.prototype.setValue});var Dh,Qh,kh,Nh,jh,Hh,zh,Vh,Gh,Yh,Kh,Xh,Wh=new g,Zh=new g;function qh(t,e){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new g)}}function Jh(t){return(Jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $h(t){Du.call(this,t),this.dracoLoader=null,this.ddsLoader=null}function tc(t){if(!t)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=Dh.MSFT_TEXTURE_DDS,this.ddsLoader=t}function ec(t){this.name=Dh.KHR_LIGHTS_PUNCTUAL,t=t.extensions&&t.extensions[Dh.KHR_LIGHTS_PUNCTUAL]||{},this.lightDefs=t.lights||[]}function nc(){this.name=Dh.KHR_MATERIALS_UNLIT}function ic(){this.name=Dh.KHR_MATERIALS_CLEARCOAT}function rc(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Dh.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}function oc(){this.name=Dh.KHR_TEXTURE_TRANSFORM}function sc(t){Su.call(this),this.isGLTFSpecularGlossinessMaterial=!0,["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n");var e=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),r=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),o={specular:{value:(new z).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this.gi=o,this.onBeforeCompile=function(t){for(var s in o)t.uniforms[s]=o[s];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),t.fragmentShader=t.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_pars_fragment>",e),t.fragmentShader=t.fragmentShader.replace("#include <roughnessmap_fragment>",n),t.fragmentShader=t.fragmentShader.replace("#include <metalnessmap_fragment>",i),t.fragmentShader=t.fragmentShader.replace("#include <lights_physical_fragment>",r)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(t){o.specular.value=t}},specularMap:{get:function(){return o.specularMap.value},set:function(t){o.specularMap.value=t}},glossiness:{get:function(){return o.glossiness.value},set:function(t){o.glossiness.value=t}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(t){(o.glossinessMap.value=t)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function ac(){return{name:Dh.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return sc},extendParams:function(t,e,n){e=e.extensions[this.name];var i,r=(t.color=new z(1,1,1),t.opacity=1,[]);return Array.isArray(e.diffuseFactor)&&(i=e.diffuseFactor,t.color.fromArray(i),t.opacity=i[3]),void 0!==e.diffuseTexture&&r.push(n.assignTexture(t,"map",e.diffuseTexture)),t.emissive=new z(0,0,0),t.glossiness=void 0!==e.glossinessFactor?e.glossinessFactor:1,t.specular=new z(1,1,1),Array.isArray(e.specularFactor)&&t.specular.fromArray(e.specularFactor),void 0!==e.specularGlossinessTexture&&(i=e.specularGlossinessTexture,r.push(n.assignTexture(t,"glossinessMap",i)),r.push(n.assignTexture(t,"specularMap",i))),Promise.all(r)},createMaterial:function(t){var e=new sc(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=St,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}}function Ac(){this.name=Dh.KHR_MESH_QUANTIZATION}function lc(t,e,n,i){Yu.call(this,t,e,n,i)}function uc(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function hc(t,e,n){for(var i in n.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function cc(t,e){void 0!==e.extras&&"object"===Jh(e.extras)&&Object.assign(t.userData,e.extras)}function fc(t){for(var e="",n=Object.keys(t).sort(),i=0,r=n.length;i<r;i++)e+=n[i]+":"+t[n[i]]+";";return e}function pc(t,e,n){this.json=t||{},this.extensions=e||{},this.options=n||{},this.cache=new function(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}},this.primitiveCache={},this.textureLoader=new Ku(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new ku(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function dc(t,e,n){var i,r=e.attributes,o=[];for(i in r){var s=Gh[i]||i.toLowerCase();s in t.attributes||o.push(function(e,i){return n.getDependency("accessor",e).then(function(e){t.setAttribute(i,e)})}(r[i],s))}void 0===e.indices||t.index||(a=n.getDependency("accessor",e.indices).then(function(e){t.setIndex(e)}),o.push(a)),cc(t,e);var a=t,A=e,l=n,h=A.attributes,c=new at;if(void 0!==h.POSITION){var f=(b=l.json.accessors[h.POSITION]).min,p=b.max;if(void 0===f||void 0===p);else{c.set(new u(f[0],f[1],f[2]),new u(p[0],p[1],p[2]));var d=A.targets;if(void 0!==d){for(var y=new u,m=new u,g=0,v=d.length;g<v;g++){var b,x=d[g];void 0!==x.POSITION&&(f=(b=l.json.accessors[x.POSITION]).min,p=b.max,void 0!==f&&void 0!==p&&(m.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),m.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),m.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),y.max(m)))}c.expandByVector(y)}a.boundingBox=c,h=new Nt,c.getCenter(h.center),h.radius=c.min.distanceTo(c.max)/2,a.boundingSphere=h}}return Promise.all(o).then(function(){if(void 0===e.targets)return t;for(var i=t,r=e.targets,o=n,s=!1,a=!1,A=0,l=r.length;A<l&&(void 0!==(f=r[A]).POSITION&&(s=!0),void 0!==f.NORMAL&&(a=!0),!s||!a);A++);if(!s&&!a)return Promise.resolve(i);var u=[],h=[];for(A=0,l=r.length;A<l;A++){var c,f=r[A];s&&(c=void 0!==f.POSITION?o.getDependency("accessor",f.POSITION):i.attributes.position,u.push(c)),a&&(c=void 0!==f.NORMAL?o.getDependency("accessor",f.NORMAL):i.attributes.normal,h.push(c))}return Promise.all([Promise.all(u),Promise.all(h)]).then(function(t){var e=t[0];t=t[1];return s&&(i.morphAttributes.position=e),a&&(i.morphAttributes.normal=t),i.morphTargetsRelative=!0,i})})}function yc(t,e){var n=t.getIndex();if(null===n){var i=[],r=t.getAttribute("position");if(void 0===r)return t;for(var o=0;o<r.count;o++)i.push(o);t.setIndex(i),n=t.getIndex()}var s=n.count-2,a=[];if(2===e)for(o=1;o<=s;o++)a.push(n.getX(0)),a.push(n.getX(o)),a.push(n.getX(o+1));else for(o=0;o<s;o++)o%2==0?(a.push(n.getX(o)),a.push(n.getX(o+1)),a.push(n.getX(o+2))):(a.push(n.getX(o+2)),a.push(n.getX(o+1)),a.push(n.getX(o)));return a.length,(e=t.clone()).setIndex(a),e}Object.assign(qh.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new g;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(var t,e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,o=t.length;r<o;r++){var s=t[r]?t[r].matrixWorld:Zh;Wh.multiplyMatrices(s,e[r]),Wh.toArray(n,16*r)}void 0!==i&&(i.needsUpdate=!0)},clone:function(){return new qh(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var i=this.bones[e];if(i.name===t)return i}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),$h.prototype=Object.assign(Object.create(Du.prototype),{constructor:$h,load:function(t,e,n,i){function r(e){i&&i(e),o.manager.itemError(t),o.manager.itemEnd(t)}var o=this,s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}(t),a=(o.manager.itemStart(t),new ku(o.manager));a.setPath(this.path),a.setResponseType("arraybuffer"),"use-credentials"===o.crossOrigin&&a.setWithCredentials(!0),a.load(t,function(n){try{o.parse(n,s,function(i){e(i,n),o.manager.itemEnd(t)},r)}catch(t){r(t)}},n,r)},setDRACOLoader:function(t){return this.dracoLoader=t,this},setDDSLoader:function(t){return this.ddsLoader=t,this},parse:function(t,e,n,i){var r,o={};if("string"==typeof t)r=t;else if(Nu(new Uint8Array(t,0,4))===Qh){try{o[Dh.KHR_BINARY_GLTF]=new function(t){this.name=Dh.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(t,0,kh);if(this.header={magic:Nu(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==Qh)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=new DataView(t,kh),i=0;i<n.byteLength;){var r,o=n.getUint32(i,!0),s=(i+=4,n.getUint32(i,!0));i+=4,s===Nh.JSON?(r=new Uint8Array(t,kh+i,o),this.content=Nu(r)):s===Nh.BIN&&(this.body=t.slice(r=kh+i,r+o)),i+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(t)}catch(t){return void(i&&i(t))}r=o[Dh.KHR_BINARY_GLTF].content}else r=Nu(new Uint8Array(t));var s=JSON.parse(r);if(void 0===s.asset||s.asset.version[0]<2)i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(s.extensionsUsed)for(var a=0;a<s.extensionsUsed.length;++a){var A=s.extensionsUsed[a],l=s.extensionsRequired||[];switch(A){case Dh.KHR_LIGHTS_PUNCTUAL:o[A]=new ec(s);break;case Dh.KHR_MATERIALS_CLEARCOAT:o[A]=new ic;break;case Dh.KHR_MATERIALS_UNLIT:o[A]=new nc;break;case Dh.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[A]=new ac;break;case Dh.KHR_DRACO_MESH_COMPRESSION:o[A]=new rc(s,this.dracoLoader);break;case Dh.MSFT_TEXTURE_DDS:o[A]=new tc(this.ddsLoader);break;case Dh.KHR_TEXTURE_TRANSFORM:o[A]=new oc;break;case Dh.KHR_MESH_QUANTIZATION:o[A]=new Ac;break;default:l.indexOf(A)}}new pc(s,o,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(n,i)}}}),Dh={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"},ec.prototype.loadLight=function(t){var e,n=this.lightDefs[t],i=new z(16777215),r=(void 0!==n.color&&i.fromArray(n.color),void 0!==n.range?n.range:0);switch(n.type){case"directional":(e=new uu(i)).target.position.set(0,0,-1),e.add(e.target);break;case"point":(e=new zu(i)).distance=r;break;case"spot":(e=new Gu(i)).distance=r,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,e.angle=n.spot.outerConeAngle,e.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,e.target.position.set(0,0,-1),e.add(e.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return e.position.set(0,0,0),e.decay=2,void 0!==n.intensity&&(e.intensity=n.intensity),e.name=n.name||"light_"+t,Promise.resolve(e)},nc.prototype.getMaterialType=function(){return $t},nc.prototype.extendParams=function(t,e,n){var i,r=[];return(e=(t.color=new z(1,1,1),t.opacity=1,e.pbrMetallicRoughness))&&(Array.isArray(e.baseColorFactor)&&(i=e.baseColorFactor,t.color.fromArray(i),t.opacity=i[3]),void 0!==e.baseColorTexture)&&r.push(n.assignTexture(t,"map",e.baseColorTexture)),Promise.all(r)},ic.prototype.getMaterialType=function(){return _u},ic.prototype.extendParams=function(t,e,n){var i=[];return void 0!==(e=e.extensions[this.name]).clearcoatFactor&&(t.clearcoat=e.clearcoatFactor),void 0!==e.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",e.clearcoatTexture)),void 0!==e.clearcoatRoughnessFactor&&(t.clearcoatRoughness=e.clearcoatRoughnessFactor),void 0!==e.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",e.clearcoatRoughnessTexture)),void 0!==e.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",e.clearcoatNormalTexture)),void 0!==e.clearcoatNormalTexture.scale)&&(n=e.clearcoatNormalTexture.scale,t.clearcoatNormalScale=new ut(n,n)),Promise.all(i)},Qh="glTF",kh=12,Nh={JSON:1313821514,BIN:5130562},rc.prototype.decodePrimitive=function(t,e){var n,i=this.json,r=this.dracoLoader,o=t.extensions[this.name].bufferView,s=t.extensions[this.name].attributes,a={},A={},l={};for(n in s){var u=Gh[n]||n.toLowerCase();a[u]=s[n]}for(n in t.attributes){var h,c;u=Gh[n]||n.toLowerCase();void 0!==s[n]&&(h=i.accessors[t.attributes[n]],c=jh[h.componentType],l[u]=c,A[u]=!0===h.normalized)}return e.getDependency("bufferView",o).then(function(t){return new Promise(function(e){r.decodeDracoFile(t,function(t){for(var n in t.attributes){var i=t.attributes[n];void 0!==(n=A[n])&&(i.normalized=n)}e(t)},a,l)})})},oc.prototype.extendTexture=function(t,e){return t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),e.texCoord,t.needsUpdate=!0,t},((sc.prototype=Object.create(Su.prototype)).constructor=sc).prototype.copy=function(t){return Su.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},((lc.prototype=Object.create(Yu.prototype)).constructor=lc).prototype.beforeStart_=lc.prototype.copySampleValue_=function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i*3+i,o=0;o!==i;o++)e[o]=n[r+o];return e},lc.prototype.afterEnd_=lc.prototype.copySampleValue_,lc.prototype.interpolate_=function(t,e,n,i){for(var r=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=2*s,A=3*s,l=i-e,u=t*A,h=u-A,c=-2*(e=(n=(i=(n-e)/l)*i)*i)+3*n,f=e-n,p=1-c,d=f-n+i,y=0;y!==s;y++){var m=o[h+y+s],g=o[h+y+a]*l,v=o[u+y+s],b=o[u+y]*l;r[y]=p*m+d*g+c*v+f*b}return r},jh={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Hh={9728:1003,9729:xt,9984:1004,9985:1007,9986:1005,9987:1008},zh={33071:bt,33648:1002,10497:1e3},Vh={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Gh={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Yh={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Kh={CUBICSPLINE:void 0,LINEAR:Bt,STEP:wt},Xh={"image/png":1023,"image/jpeg":1022},pc.prototype.parse=function(t,e){var n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(e){e={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:n,userData:{}},hc(r,e,i),cc(e,i),t(e)}).catch(e)},pc.prototype.markDefs=function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],i={},r={},o=0,s=e.length;o<s;o++)for(var a=e[o].joints,A=0,l=a.length;A<l;A++)t[a[A]].isBone=!0;for(var u=0,h=t.length;u<h;u++){var c=t[u];void 0!==c.mesh&&(void 0===i[c.mesh]&&(i[c.mesh]=r[c.mesh]=0),i[c.mesh]++,void 0!==c.skin)&&(n[c.mesh].isSkinnedMesh=!0)}this.json.meshReferences=i,this.json.meshUses=r},pc.prototype.getDependency=function(t,e){var n=t+":"+e,i=this.cache.get(n);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this.loadMesh(e);break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this.loadBufferView(e);break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this.loadMaterial(e);break;case"texture":i=this.loadTexture(e);break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;case"light":i=this.extensions[Dh.KHR_LIGHTS_PUNCTUAL].loadLight(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,i)}return i},pc.prototype.getDependencies=function(t){var e,n,i=this.cache.get(t);return i||(n=(e=this).json[t+("mesh"===t?"es":"s")]||[],i=Promise.all(n.map(function(n,i){return e.getDependency(t,i)})),this.cache.add(t,i)),i},pc.prototype.loadBuffer=function(t){var e,n=this.json.buffers[t],i=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");return void 0===n.uri&&0===t?Promise.resolve(this.extensions[Dh.KHR_BINARY_GLTF].body):(e=this.options,new Promise(function(t,r){i.load(uc(n.uri,e.path),t,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})}))},pc.prototype.loadBufferView=function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then(function(t){var n=e.byteLength||0,i=e.byteOffset||0;return t.slice(i,i+n)})},pc.prototype.loadAccessor=function(t){var e=this,n=this.json,i=this.json.accessors[t];return void 0===i.bufferView&&void 0===i.sparse?Promise.resolve(null):(t=[],void 0!==i.bufferView?t.push(this.getDependency("bufferView",i.bufferView)):t.push(null),void 0!==i.sparse&&(t.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),t.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(t).then(function(t){var r=t[0],o=Vh[i.type],s=jh[i.componentType],a=s.BYTES_PER_ELEMENT,A=i.byteOffset||0,l=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,u=!0===i.normalized,h=l&&l!==a*o?(c=Math.floor(A/l),f="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+c+":"+i.count,(p=e.cache.get(f))||(p=new Xu(new s(r,c*l,i.count*l/a),l/a),e.cache.add(f,p)),new Zu(p,o,A%l/a,u)):new Ct(null===r?new s(i.count*o):new s(r,A,i.count*o),o,u);if(void 0!==i.sparse){var c=jh[i.sparse.indices.componentType],f=i.sparse.indices.byteOffset||0,p=i.sparse.values.byteOffset||0,d=new c(t[1],f,i.sparse.count*Vh.SCALAR),y=new s(t[2],p,i.sparse.count*o);null!==r&&(h=new Ct(h.array.slice(),h.itemSize,h.normalized));for(var m=0,g=d.length;m<g;m++){var v=d[m];if(h.setX(v,y[m*o]),2<=o&&h.setY(v,y[m*o+1]),3<=o&&h.setZ(v,y[m*o+2]),4<=o&&h.setW(v,y[m*o+3]),5<=o)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return h}))},pc.prototype.loadTexture=function(t){var e=this,n=this.json,i=this.options,r=this.textureLoader,o=self.URL||self.webkitURL,s=n.textures[t],a=s.extensions||{},A=a[Dh.MSFT_TEXTURE_DDS]?n.images[a[Dh.MSFT_TEXTURE_DDS].source]:n.images[s.source],l=A.uri,u=!1;return void 0!==A.bufferView&&(l=e.getDependency("bufferView",A.bufferView).then(function(t){return u=!0,t=new Blob([t],{type:A.mimeType}),l=o.createObjectURL(t)})),Promise.resolve(l).then(function(t){var n=(n=i.manager.getHandler(t))||(a[Dh.MSFT_TEXTURE_DDS]?e.extensions[Dh.MSFT_TEXTURE_DDS].ddsLoader:r);return new Promise(function(e,r){n.load(uc(t,i.path),e,void 0,r)})}).then(function(t){!0===u&&o.revokeObjectURL(l),t.flipY=!1,s.name&&(t.name=s.name),A.mimeType in Xh&&(t.format=Xh[A.mimeType]);var e=(n.samplers||{})[s.sampler]||{};return t.magFilter=Hh[e.magFilter]||xt,t.minFilter=Hh[e.minFilter]||1008,t.wrapS=zh[e.wrapS]||1e3,t.wrapT=zh[e.wrapT]||1e3,t})},pc.prototype.assignTexture=function(t,e,n){var i=this;return this.getDependency("texture",n.index).then(function(r){if(!r.isCompressedTexture)switch(e){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":r.format=1022}var o;void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&n.texCoord,i.extensions[Dh.KHR_TEXTURE_TRANSFORM]&&(o=void 0!==n.extensions?n.extensions[Dh.KHR_TEXTURE_TRANSFORM]:void 0)&&(r=i.extensions[Dh.KHR_TEXTURE_TRANSFORM].extendTexture(r,o)),t[e]=r})},pc.prototype.assignFinalMaterial=function(t){var e,n,i=t.geometry,r=t.material,o=void 0!==i.attributes.tangent,s=void 0!==i.attributes.color,a=void 0===i.attributes.normal,A=!0===t.isSkinnedMesh,l=0<Object.keys(i.morphAttributes).length,u=l&&void 0!==i.morphAttributes.normal;t.isPoints?(e="PointsMaterial:"+r.uuid,(n=this.cache.get(e))||(n=new Mu,Jt.prototype.copy.call(n,r),n.color.copy(r.color),n.map=r.map,n.sizeAttenuation=!1,this.cache.add(e,n)),r=n):t.isLine&&(e="LineBasicMaterial:"+r.uuid,(n=this.cache.get(e))||(n=new Ru,Jt.prototype.copy.call(n,r),n.color.copy(r.color),this.cache.add(e,n)),r=n),(o||s||a||A||l)&&(e="ClonedMaterial:"+r.uuid+":",r.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),A&&(e+="skinning:"),o&&(e+="vertex-tangents:"),s&&(e+="vertex-colors:"),a&&(e+="flat-shading:"),l&&(e+="morph-targets:"),u&&(e+="morph-normals:"),(n=this.cache.get(e))||(n=r.clone(),A&&(n.skinning=!0),o&&(n.vertexTangents=!0),s&&(n.vertexColors=!0),a&&(n.flatShading=!0),l&&(n.morphTargets=!0),u&&(n.morphNormals=!0),this.cache.add(e,n)),r=n),r.aoMap&&void 0===i.attributes.uv2&&void 0!==i.attributes.uv&&i.setAttribute("uv2",new Ct(i.attributes.uv.array,2)),r.normalScale&&!o&&(r.normalScale.y=-r.normalScale.y),r.clearcoatNormalScale&&!o&&(r.clearcoatNormalScale.y=-r.clearcoatNormalScale.y),t.material=r},pc.prototype.loadMaterial=function(t){var e,n,i=this.json,r=this.extensions,o=i.materials[t],s={},a=(t=[],(i=o.extensions||{})[Dh.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]?(n=r[Dh.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],e=n.getMaterialType(),t.push(n.extendParams(s,o,this))):i[Dh.KHR_MATERIALS_UNLIT]?(n=r[Dh.KHR_MATERIALS_UNLIT],e=n.getMaterialType(),t.push(n.extendParams(s,o,this))):(e=Su,n=o.pbrMetallicRoughness||{},s.color=new z(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)&&(a=n.baseColorFactor,s.color.fromArray(a),s.opacity=a[3]),void 0!==n.baseColorTexture&&t.push(this.assignTexture(s,"map",n.baseColorTexture)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(t.push(this.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),t.push(this.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture)))),!0===o.doubleSided&&(s.side=ft),o.alphaMode||"OPAQUE");return"BLEND"===a?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,"MASK"===a&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&e!==$t&&(t.push(this.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new ut(1,1),void 0!==o.normalTexture.scale)&&s.normalScale.set(o.normalTexture.scale,o.normalTexture.scale),void 0!==o.occlusionTexture&&e!==$t&&(t.push(this.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength)&&(s.aoMapIntensity=o.occlusionTexture.strength),void 0!==o.emissiveFactor&&e!==$t&&(s.emissive=(new z).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&e!==$t&&t.push(this.assignTexture(s,"emissiveMap",o.emissiveTexture)),i[Dh.KHR_MATERIALS_CLEARCOAT]&&(n=r[Dh.KHR_MATERIALS_CLEARCOAT],e=n.getMaterialType(),t.push(n.extendParams(s,{extensions:i},this))),Promise.all(t).then(function(){var t=e===sc?r[Dh.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new e(s);return o.name&&(t.name=o.name),t.map&&(t.map.encoding=3001),t.emissiveMap&&(t.emissiveMap.encoding=3001),cc(t,o),o.extensions&&hc(r,t,o),t})},pc.prototype.loadGeometries=function(t){for(var e=this,n=this.extensions,i=this.primitiveCache,r=[],o=0,s=t.length;o<s;o++){var a=t[o],A=(l=void 0,l=(l=(A=a).extensions&&A.extensions[Dh.KHR_DRACO_MESH_COMPRESSION])?"draco:"+l.bufferView+":"+l.indices+":"+fc(l.attributes):A.indices+":"+fc(A.attributes)+":"+A.mode),l=i[A];l?r.push(l.promise):(l=a.extensions&&a.extensions[Dh.KHR_DRACO_MESH_COMPRESSION]?function(t){return n[Dh.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then(function(n){return dc(n,t,e)})}(a):dc(new Wt,a,e),i[A]={primitive:a,promise:l},r.push(l))}return Promise.all(r)},pc.prototype.loadMesh=function(t){for(var e=this,n=this.json.meshes[t],i=n.primitives,r=[],o=0,s=i.length;o<s;o++){var a=void 0===i[o].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new Su({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ht})),a.DefaultMaterial):this.getDependency("material",i[o].material);r.push(a)}return r.push(e.loadGeometries(i)),Promise.all(r).then(function(r){for(var o=r.slice(0,r.length-1),s=r[r.length-1],a=[],A=0,l=s.length;A<l;A++){var u,h=s[A],c=i[A],f=o[A];if(4===c.mode||5===c.mode||6===c.mode||void 0===c.mode)!0!==(u=new(!0===n.isSkinnedMesh?qu:Ve)(h,f)).isSkinnedMesh||u.geometry.attributes.skinWeight.normalized||u.normalizeSkinWeights(),5===c.mode?u.geometry=yc(u.geometry,1):6===c.mode&&(u.geometry=yc(u.geometry,2));else if(1===c.mode)u=new sh(h,f);else if(3===c.mode)u=new ih(h,f);else if(2===c.mode)u=new ah(h,f);else{if(0!==c.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);u=new ch(h,f)}if(0<Object.keys(u.geometry.morphAttributes).length){g=m=y=p=void 0;var p=u,d=n;if(p.updateMorphTargets(),void 0!==d.weights)for(var y=0,m=d.weights.length;y<m;y++)p.morphTargetInfluences[y]=d.weights[y];if(d.extras&&Array.isArray(d.extras.targetNames)){var g=d.extras.targetNames;if(p.morphTargetInfluences.length===g.length)for(p.morphTargetDictionary={},y=0,m=g.length;y<m;y++)p.morphTargetDictionary[g[y]]=y}}u.name=n.name||"mesh_"+t,1<s.length&&(u.name+="_"+A),cc(u,n),e.assignFinalMaterial(u),a.push(u)}if(1===a.length)return a[0];var v=new tn;for(A=0,l=a.length;A<l;A++)v.add(a[A]);return v})},pc.prototype.loadCamera=function(t){var e,n=(t=this.json.cameras[t])[t.type];if(n)return"perspective"===t.type?e=new ju(s.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===t.type&&(e=new Au(n.xmag/-2,n.xmag/2,n.ymag/2,n.ymag/-2,n.znear,n.zfar)),t.name&&(e.name=t.name),cc(e,t),Promise.resolve(e)},pc.prototype.loadSkin=function(t){var e={joints:(t=this.json.skins[t]).joints};return void 0===t.inverseBindMatrices?Promise.resolve(e):this.getDependency("accessor",t.inverseBindMatrices).then(function(t){return e.inverseBindMatrices=t,e})},pc.prototype.loadAnimation=function(t){for(var e=this.json.animations[t],n=[],i=[],r=[],o=[],s=[],a=0,A=e.channels.length;a<A;a++){var l=e.channels[a],u=e.samplers[l.sampler],h=void 0!==(l=l.target).node?l.node:l.id,c=void 0!==e.parameters?e.parameters[u.input]:u.input,f=void 0!==e.parameters?e.parameters[u.output]:u.output;n.push(this.getDependency("node",h)),i.push(this.getDependency("accessor",c)),r.push(this.getDependency("accessor",f)),o.push(u),s.push(l)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(r),Promise.all(o),Promise.all(s)]).then(function(n){for(var i=n[0],r=n[1],o=n[2],s=n[3],a=n[4],A=[],l=0,u=i.length;l<u;l++){var h,c=i[l],f=r[l],p=o[l],d=s[l],y=a[l];if(void 0!==c){switch(c.updateMatrix(),c.matrixAutoUpdate=!0,Yh[y.path]){case Yh.weights:h=vh;break;case Yh.rotation:h=xh;break;default:h=wh}var m,g=c.name||c.uuid,v=void 0!==d.interpolation?Kh[d.interpolation]:Bt,b=[],x=(Yh[y.path]===Yh.weights?c.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&b.push(t.name||t.uuid)}):b.push(g),p.array);if(p.normalized){if(x.constructor===Int8Array)m=1/127;else if(x.constructor===Uint8Array)m=1/255;else if(x.constructor==Int16Array)m=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");m=1/65535}for(var w=new Float32Array(x.length),B=0,M=x.length;B<M;B++)w[B]=x[B]*m;x=w}for(B=0,M=b.length;B<M;B++){var S=new h(b[B]+"."+Yh[y.path],f.array,x,v);"CUBICSPLINE"===d.interpolation&&(S.createInterpolant=function(t){return new lc(this.times,this.values,this.getValueSize()/3,t)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),A.push(S)}}}return new _h(e.name||"animation_"+t,void 0,A)})},pc.prototype.loadNode=function(t){var e=this.json,n=this.extensions,i=this,r=e.meshReferences,o=e.meshUses,s=e.nodes[t];return e=[],void 0!==s.mesh&&e.push(i.getDependency("mesh",s.mesh).then(function(t){var e,n;return 1<r[s.mesh]?(e=o[s.mesh]++,(n=t.clone()).name+="_instance_"+e):n=t,void 0!==s.weights&&n.traverse(function(t){if(t.isMesh)for(var e=0,n=s.weights.length;e<n;e++)t.morphTargetInfluences[e]=s.weights[e]}),n})),void 0!==s.camera&&e.push(i.getDependency("camera",s.camera)),s.extensions&&s.extensions[Dh.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[Dh.KHR_LIGHTS_PUNCTUAL].light&&e.push(i.getDependency("light",s.extensions[Dh.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e).then(function(t){var e,i=!0===s.isBone?new Th:1<t.length?new tn:1===t.length?t[0]:new Q;if(i!==t[0])for(var r=0,o=t.length;r<o;r++)i.add(t[r]);return s.name&&(i.userData.name=s.name,i.name=Lh.sanitizeNodeName(s.name)),cc(i,s),s.extensions&&hc(n,i,s),void 0!==s.matrix?((e=new g).fromArray(s.matrix),i.applyMatrix4(e)):(void 0!==s.translation&&i.position.fromArray(s.translation),void 0!==s.rotation&&i.quaternion.fromArray(s.rotation),void 0!==s.scale&&i.scale.fromArray(s.scale)),i})},pc.prototype.loadScene=function(t){for(var e=this.json,n=this.extensions,i=(t=this.json.scenes[t],new k),r=(t.name&&(i.name=t.name),cc(i,t),t.extensions&&hc(n,i,t),t.nodes||[]),o=[],s=0,a=r.length;s<a;s++)o.push(function t(e,n,i,r){var o=i.nodes[e];return r.getDependency("node",e).then(function(t){var e;return void 0===o.skin?t:r.getDependency("skin",o.skin).then(function(t){for(var n=[],i=0,o=(e=t).joints.length;i<o;i++)n.push(r.getDependency("node",e.joints[i]));return Promise.all(n)}).then(function(n){return t.traverse(function(t){if(t.isMesh){for(var i=[],r=[],o=0,s=n.length;o<s;o++){var a=n[o];a&&(i.push(a),a=new g,void 0!==e.inverseBindMatrices&&a.fromArray(e.inverseBindMatrices.array,16*o),r.push(a))}t.bind(new qh(i,r),t.matrixWorld)}}),t})}).then(function(e){n.add(e);var s=[];if(o.children)for(var a=o.children,A=0,l=a.length;A<l;A++){var u=a[A];s.push(t(u,e,i,r))}return Promise.all(s)})}(r[s],i,e,this));return Promise.all(o).then(function(){return i})};var mc=$h;function gc(t){return(gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===gc(t=function(t,e){if("object"!==gc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==gc(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function bc(){return(bc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wc(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function xc(t,e){return(xc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function wc(t){return(wc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bc=function(){var t=i,e=$l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xc(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=wc(t);if(n=e?(n=wc(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===gc(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:eu,e=this;if(e instanceof i)return(e=n.call(this)).manager=t,e.adjustmentTransform=new g,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"parse",value:function(t){var e=this,n=bc(wc(i.prototype),"parse",this).call(this,t),r=n.glbBytes.slice().buffer;return new Promise(function(t,i){var o=e.manager,s=e.fetchOptions,a=(o=o.getHandler("path.gltf")||new mc(o),s=("include"===s.credentials&&"cors"===s.mode&&o.setCrossOrigin("use-credentials"),"credentials"in s&&o.setWithCredentials("include"===s.credentials),s.headers&&o.setRequestHeader(s.headers),e.workingPath),!/[\\/]$/.test(s)&&s.length&&(s+="/"),e.adjustmentTransform);o.parse(r,s,function(e){var i=n.batchTable,r=n.featureTable,o=e.scene,s=r.getData("RTC_CENTER");s&&(o.position.x+=s[0],o.position.y+=s[1],o.position.z+=s[2]),e.scene.updateMatrix(),e.scene.matrix.multiply(a),e.scene.matrix.decompose(e.scene.position,e.scene.quaternion,e.scene.scale),e.batchTable=i,e.featureTable=r,o.batchTable=i,o.featureTable=r,t(e)},i)})}}])&&vc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Mc(t){return(Mc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Sc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Mc(t=function(t,e){if("object"!==Mc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Mc(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function _c(t,e){return(_c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ec(t){return(Ec=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Tc=new g,Cc=function(){var t=i,e=tn;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_c(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ec(t);if(n=e?(n=Ec(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Mc(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this)).name="TilesRenderer.TilesGroup",e.tilesRenderer=t,e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"raycast",value:function(t,e){this.tilesRenderer.optimizeRaycast&&this.tilesRenderer.raycast(t,e)}},{key:"updateMatrixWorld",value:function(t){if(this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldNeedsUpdate||t){null===this.parent?Tc.copy(this.matrix):Tc.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1;for(var e=Tc.elements,n=this.matrixWorld.elements,i=!1,r=0;r<16;r++){var o=e[r],s=n[r];if(Math.abs(o-s)>Number.EPSILON){i=!0;break}}if(i){this.matrixWorld.copy(Tc);for(var a=this.children,A=0,l=a.length;A<l;A++)a[A].updateMatrixWorld()}}}}])&&Sc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Fc(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Oc(t){return(Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Pc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Oc(t=function(t,e){if("object"!==Oc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Oc(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Uc(t){var e=t.x,n=t.y,i=t.z;t.x=i,t.y=e,t.z=n}Object.assign(Fc.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(s.clamp(e/this.radius,-1,1))),this}});var Rc=new Fc,Ic=new u,Lc=new u,Dc=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.radius=new u(e,n,i)}var e,n;return e=t,(n=[{key:"getCartographicToPosition",value:function(t,e,n,i){var r=this.radius;Rc.set(1,-t+Math.PI/2,e),Ic.setFromSpherical(Rc).normalize(),Uc(Ic),Lc.copy(Ic),Lc.x*=Math.pow(r.x,2),Lc.y*=Math.pow(r.y,2),Lc.z*=Math.pow(r.z,2),t=Math.sqrt(Ic.dot(Lc));return Lc.divideScalar(t),i.copy(Lc).addScaledVector(Ic,n)}},{key:"getCartographicToNormal",value:function(t,e,n){return Rc.set(1,-t+Math.PI/2,e),n.setFromSpherical(Rc).normalize(),Uc(n),n}},{key:"getPositionToNormal",value:function(t,e){var n=this.radius;return e.copy(t),e.x/=Math.pow(n.x,2),e.y/=Math.pow(n.y,2),e.z/=Math.pow(n.z,2),e.normalize(),e}}])&&Pc(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Qc(t){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kc(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],A=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;A=!1}else for(;!(A=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);A=!0);}catch(t){l=!0,r=t}finally{try{if(!A&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?Nc(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nc(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function jc(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Qc(t=function(t,e){if("object"!==Qc(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Qc(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Hc(t,e){return(Hc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function zc(t){return(zc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Vc=Math.PI,Gc=Vc/2,Yc=new u,Kc=new u,Xc=new u,Wc=new g,Zc=0,qc=[];function Jc(){Zc=0}var $c=function(){var t=i,e=Dc;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hc(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=zc(t);if(n=e?(n=zc(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Qc(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:-Gc,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:Gc,a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,A=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2*Vc,l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,u=8<arguments.length&&void 0!==arguments[8]?arguments[8]:0,h=this;if(h instanceof i)return(h=n.call(this,t,e,r)).latStart=o,h.latEnd=s,h.lonStart=a,h.lonEnd=A,h.heightStart=l,h.heightEnd=u,h;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"_getPoints",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.latStart,n=this.latEnd,i=this.lonStart,r=this.lonEnd,o=this.heightStart,a=this.heightEnd,A=s.mapLinear(.5,0,1,e,n),l=s.mapLinear(.5,0,1,i,r),h=Math.floor(i/Gc)*Gc,c=[[-Vc/2,0],[Vc/2,0],[0,h],[0,h+Vc/2],[0,h+Vc],[0,h+3*Vc/2],[e,r],[n,r],[e,i],[n,i],[0,i],[0,r],[A,l],[e,l],[n,l],[A,i],[A,r]],f=[],p=c.length,d=0;d<=1;d++)for(var y=s.mapLinear(d,0,1,o,a),m=0,g=p;m<g;m++){var v,b=(x=kc(c[m],2))[0],x=x[1];e<=b&&b<=n&&i<=x&&x<=r&&(v=function(t){return 0<arguments.length&&void 0!==t&&t?(qc[Zc]||(qc[Zc]=new u),qc[++Zc-1]):new u}(t),f.push(v),this.getCartographicToPosition(b,x,y,v))}return f}},{key:"getBoundingBox",value:function(t,e){Jc();for(var n=this.latStart,i=this.latEnd,r=this.lonStart,o=this.lonEnd,a=(i-n<Vc/2?(n=s.mapLinear(.5,0,1,n,i),i=s.mapLinear(.5,0,1,r,o),this.getCartographicToNormal(n,i,Xc),Kc.set(0,0,1),Yc.crossVectors(Kc,Xc),Kc.crossVectors(Yc,Xc)):(Yc.set(1,0,0),Kc.set(0,1,0),Xc.set(0,0,1)),e.makeBasis(Yc,Kc,Xc),Wc.copy(e).invert(),this._getPoints(!0)),A=0,l=a.length;A<l;A++)a[A].applyMatrix4(Wc);t.makeEmpty(),t.setFromPoints(a)}},{key:"getBoundingSphere",value:function(t,e){Jc();var n=this._getPoints(!0);t.makeEmpty(),t.setFromPoints(n,e)}}])&&jc(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),tf=new Nt,ef=new g,nf=new u,rf=new u,of=new pe,sf=[];function af(t,e){return t.distance-e.distance}function Af(t,e,n){t.traverse(function(t){Object.getPrototypeOf(t).raycast.call(t,e,n)})}function lf(t){return(lf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function uf(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function hf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,yf(i.key),i)}}function cf(){return(cf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=mf(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function ff(t,e){return(ff=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function pf(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function df(t,e,n,i){return(df="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,n,i){var r;if(t=mf(t,e)){if((r=Object.getOwnPropertyDescriptor(t,e)).set)return r.set.call(i,n),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(i,e)){if(!r.writable)return!1;r.value=n,Object.defineProperty(i,e,r)}else t=i,r=n,(i=yf(i=e))in t?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r;return!0})(t,e,n,i)}function yf(t){return"symbol"===lf(t=function(t,e){if("object"!==lf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==lf(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}function mf(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gf(t)););return t}function gf(t){return(gf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var vf=Symbol("INITIAL_FRUSTUM_CULLED"),bf=new g,xf=new g,wf=new u,Bf=new u,Mf=new u,Sf=new u,_f=new u(1,0,0),Ef=new u(0,1,0);function Tf(t,e){t.traverse(function(t){t.frustumCulled=t[vf]&&e})}var Cf=function(){var t=i,e=Il;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ff(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=gf(t);if(n=e?(n=gf(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===lf(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return pf(i)}}(i);function i(){var t;if(!((s=this)instanceof i))throw new TypeError("Cannot call a class as a function");for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];(t=n.call.apply(n,[this].concat(r))).group=new Cc(pf(t)),t.cameras=[],t.cameraMap=new Map,t.cameraInfo=[],t.activeTiles=new Set,t.visibleTiles=new Set,t.ji=!0,t.optimizeRaycast=!0,t.onLoadTileSet=null,t.onLoadModel=null,t.onDisposeModel=null,t.onTileVisibilityChange=null;var s,a=((s=new tu).setURLModifier(function(e){return t.preprocessURL?t.preprocessURL(e):e}),t.manager=s,pf(t));return t.Mi=function(t,e){a.optimizeRaycast||Object.getPrototypeOf(this).raycast.call(this,t,e)},t}return t=i,(e=[{key:"autoDisableRendererCulling",get:function(){return this.ji},set:function(t){if(this.ji!==t){var e=gf(i.prototype);if(!df(e,"_autoDisableRendererCulling",t,this||e))throw new TypeError("failed to set property");this.forEachLoadedModel(function(e){Tf(e,!t)})}}},{key:"getBounds",value:function(t){var e,n;return!!this.root&&(e=(n=this.root.cached).box,n=n.boxTransform,!!e)&&(t.copy(e),t.applyMatrix4(n),!0)}},{key:"getOrientedBounds",value:function(t,e){var n,i;return!!this.root&&(n=(i=this.root.cached).box,i=i.boxTransform,!!n)&&(t.copy(n),e.copy(i),!0)}},{key:"getBoundingSphere",value:function(t){var e;return!!this.root&&!!(e=this.root.cached.sphere)&&(t.copy(e),!0)}},{key:"forEachLoadedModel",value:function(t){this.traverse(function(e){var n=e.cached.scene;n&&t(n,e)})}},{key:"raycast",value:function(t,e){var n;this.root&&(t.firstHitOnly?(n=function t(e,n,i,r){var o;if(i.has(e))return Af(e.cached.scene,r,sf),0<sf.length?(1<sf.length&&sf.sort(af),o=sf[0],sf.length=0,o):null;for(var s=[],a=e.children,A=0,l=a.length;A<l;A++){var u=a[A],h=u.cached,c=n.matrixWorld;ef.copy(c),(c=h.sphere)&&(tf.copy(c),tf.applyMatrix4(ef),!r.ray.intersectsSphere(tf))||(c=h.box,h=h.boxTransform,c&&(ef.multiply(h).invert(),of.copy(r.ray),of.applyMatrix4(ef),of.intersectBox(c,nf))&&(rf.setFromMatrixScale(ef),h=rf.x,Math.abs(Math.max(rf.x-rf.y,rf.x-rf.z)),s.push(c={distance:1/0,tile:null}),c.distance=nf.distanceToSquared(of.origin)*h*h,c.tile=u))}s.sort(af);for(var f=1/0,p=null,d=0,y=s.length;d<y;d++){var m=s[d];if(f<m.distance)break;var g=(m=m.tile).cached.scene,v=null;i.has(m)?(Af(g,r,sf),0<sf.length&&(1<sf.length&&sf.sort(af),v=sf[0])):v=t(m,n,i,r),v&&((g=v.distance*v.distance)<f&&(f=g,p=v),sf.length=0)}return p}(this.root,this.group,this.activeTiles,t))&&e.push(n):function t(e,n,i,r,o){var s=e.cached,a=n.matrixWorld;if(!(a=(ef.copy(a),s.sphere))||(tf.copy(a),tf.applyMatrix4(ef),r.ray.intersectsSphere(tf))){a=s.box;var A=s.boxTransform;if(!a||(ef.multiply(A).invert(),of.copy(r.ray).applyMatrix4(ef),of.intersectsBox(a)))if(A=s.scene,i.has(e))Af(A,r,o);else for(var l=e.children,u=0,h=l.length;u<h;u++)t(l[u],n,i,r,o)}}(this.root,this.group,this.activeTiles,t,e))}},{key:"hasCamera",value:function(t){return this.cameraMap.has(t)}},{key:"setCamera",value:function(t){var e=this.cameras,n=this.cameraMap;return!n.has(t)&&(n.set(t,new ut),e.push(t),!0)}},{key:"setResolution",value:function(t,e,n){var i=this.cameraMap;return!!i.has(t)&&(e instanceof ut?i.get(t).copy(e):i.get(t).set(e,n),!0)}},{key:"setResolutionFromRenderer",value:function(t,e){var n=this.cameraMap;return!!n.has(t)&&(n=n.get(t),e.getSize(n),n.multiplyScalar(e.getPixelRatio()),!0)}},{key:"deleteCamera",value:function(t){var e,n=this.cameras,i=this.cameraMap;return!!i.has(t)&&(e=n.indexOf(t),n.splice(e,1),i.delete(t),!0)}},{key:"fetchTileSet",value:function(t){for(var e=this,n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var s=(s=cf(gf(i.prototype),"fetchTileSet",this)).call.apply(s,[this,t].concat(r));return s.then(function(n){e.onLoadTileSet&&Promise.resolve().then(function(){e.onLoadTileSet(n,t)}).catch(function(t){})}).catch(function(t){}),s}},{key:"update",value:function(){var t=this.group,e=this.cameras,n=this.cameraMap,r=this.cameraInfo;if(0===e.length);else{for(;r.length>e.length;)r.pop();for(;r.length<e.length;)r.push({frustum:new ou,isOrthographic:!1,sseDenominator:-1,position:new u,invScale:-1,pixelSize:0});xf.copy(t.matrixWorld).invert(),wf.setFromMatrixScale(xf);var o=wf.x;Math.abs(Math.max(wf.x-wf.y,wf.x-wf.z));for(var s=0,a=r.length;s<a;s++){var A,l,h=e[s],c=r[s],f=c.frustum,p=c.position,d=n.get(h),y=(0!==d.width&&d.height,h.projectionMatrix.elements);c.isOrthographic=1===y[15],c.isOrthographic?(A=2/y[0],l=2/y[5],c.pixelSize=Math.max(l/d.height,A/d.width)):c.sseDenominator=2/y[5]/d.height,c.invScale=o,bf.copy(t.matrixWorld),bf.premultiply(h.matrixWorldInverse),bf.premultiply(h.projectionMatrix),f.setFromProjectionMatrix(bf),p.set(0,0,0),p.applyMatrix4(h.matrixWorld),p.applyMatrix4(xf)}cf(gf(i.prototype),"update",this).call(this)}}},{key:"preprocessNode",value:function(t,e,n){cf(gf(i.prototype),"preprocessNode",this).call(this,t,e,n);var r=new g;if(t.transform)for(var o=t.transform,s=0;s<16;s++)r.elements[s]=o[s];else r.identity();e&&r.premultiply(e.cached.transform);n=(new g).copy(r).invert(),e=null;var a,A,l,u,h,c,f=null,p=null,d=("box"in t.boundingVolume&&(d=t.boundingVolume.box,e=new at,f=new g,p=new g,Bf.set(d[3],d[4],d[5]),Mf.set(d[6],d[7],d[8]),Sf.set(d[9],d[10],d[11]),c=Bf.length(),a=Mf.length(),y=Sf.length(),Bf.normalize(),Mf.normalize(),Sf.normalize(),0===c&&Bf.crossVectors(Mf,Sf),0===a&&Mf.crossVectors(Bf,Sf),0===y&&Sf.crossVectors(Bf,Mf),f.set(Bf.x,Mf.x,Sf.x,d[0],Bf.y,Mf.y,Sf.y,d[1],Bf.z,Mf.z,Sf.z,d[2],0,0,0,1),f.premultiply(r),p.copy(f).invert(),e.min.set(-c,-a,-y),e.max.set(c,a,y)),null),y=("sphere"in t.boundingVolume?(c=t.boundingVolume.sphere,(d=new Nt).center.set(c[0],c[1],c[2]),d.radius=c[3],d.applyMatrix4(r)):"box"in t.boundingVolume&&(a=t.boundingVolume.box,d=new Nt,e.getBoundingSphere(d),d.center.set(a[0],a[1],a[2]),d.applyMatrix4(r)),null);"region"in t.boundingVolume&&(a=(c=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],A=!0,l=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;A=!1}else for(;!(A=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);A=!0);}catch(t){l=!0,r=t}finally{try{if(!A&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return a}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?uf(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uf(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.boundingVolume.region,6))[0],A=c[1],l=c[2],u=c[3],h=c[4],c=c[5],y=new $c(6378137,6378137,6356752.314245179,A,u,a,l,h,c),null===d&&(d=new Nt,y.getBoundingSphere(d)),null===e)&&(e=new at,f=new g,p=new g,y.getBoundingBox(e,f),p.copy(f).invert()),t.cached={loadIndex:0,transform:r,transformInverse:n,active:!1,inFrustum:[],box:e,boxTransform:f,boxTransformInverse:p,sphere:d,region:y,scene:null,geometry:null,material:null}}},{key:"parseTile",value:function(t,e,n){var i=this;e.Si=e.Si||0,e.Si++;var r=((r=e.content.uri.split(/[\\\/]/g)).pop(),r.join("/")),o=this.fetchOptions,s=this.manager,a=e.Si,A=this.rootTileSet.asset&&this.rootTileSet.asset.gltfUpAxis||"y",l=e.cached,u=l.transform;switch(A.toLowerCase()){case"x":bf.makeRotationAxis(Ef,-Math.PI/2);break;case"y":bf.makeRotationAxis(_f,Math.PI/2);break;case"z":bf.identity()}var h=Xl(t)||n;return("b3dm"===h?((A=new Bc(s)).workingPath=r,A.fetchOptions=o,A.adjustmentTransform.copy(bf),A.parse(t).then(function(t){return t.scene})):Promise.resolve(null)).then(function(t){var n,r,o;e.Si===a&&(t.updateMatrix(),"glb"!==h&&"gltf"!==h||t.matrix.multiply(bf),t.matrix.premultiply(u),t.matrix.decompose(t.position,t.quaternion,t.scale),t.traverse(function(t){t[vf]=t.frustumCulled}),Tf(t,!i.autoDisableRendererCulling),(l.scene=t).traverse(function(t){t.raycast=i.Mi}),n=[],r=[],o=[],t.traverse(function(t){if(t.geometry&&r.push(t.geometry),t.material){var e,i=t.material;for(e in n.push(t.material),i){var s=i[e];s&&s.isTexture&&o.push(s)}}}),l.materials=n,l.geometry=r,l.textures=o,i.onLoadModel)&&i.onLoadModel(t,e)})}},{key:"disposeTile",value:function(t){var e=t.cached;if(e.scene){for(var n=e.materials,i=e.geometry,r=e.textures,o=e.scene.parent,s=0,a=i.length;s<a;s++)i[s].dispose();for(var A=0,l=n.length;A<l;A++)n[A].dispose();for(var u=0,h=r.length;u<h;u++)r[u].dispose();o&&o.remove(e.scene),this.onDisposeModel&&this.onDisposeModel(e.scene,t),e.scene=null,e.materials=null,e.textures=null,e.geometry=null}this.activeTiles.delete(t),this.visibleTiles.delete(t),t.Si++}},{key:"setTileVisible",value:function(t,e){var n=t.cached.scene,i=this.visibleTiles,r=this.group;e?(r.add(n),i.add(t),n.updateMatrixWorld(!0)):(r.remove(n),i.delete(t)),this.onTileVisibilityChange&&this.onTileVisibilityChange(n,t,e)}},{key:"setTileActive",value:function(t,e){var n=this.activeTiles;e?n.add(t):n.delete(t)}},{key:"calculateError",value:function(t){for(var e,n,i,r,o=t.cached,s=o.inFrustum,a=this.cameras,A=this.cameraInfo,l=o.sphere,u=o.box,h=o.boxTransformInverse,c=o.transformInverse,f=u&&h,p=-1/0,d=1/0,y=0,m=a.length;y<m;y++)s[y]&&(r=(e=A[y]).invScale,n=void 0,e.isOrthographic?(i=e.pixelSize,n=t.geometricError/(i*r)):(wf.copy(e.position),i=(f?(wf.applyMatrix4(h),u.distanceToPoint(wf)):(wf.applyMatrix4(c),Math.max(l.distanceToPoint(wf),0)))*r,r=e.sseDenominator,n=t.geometricError/(i*r),d=Math.min(d,i)),p=Math.max(p,n));t.Ut=d,t.Ht=p}},{key:"tileInView",value:function(t){var e=(t=t.cached).sphere,n=t.inFrustum;if(e){for(var i=this.cameraInfo,r=!1,o=0,s=i.length;o<s;o++)i[o].frustum.intersectsSphere(e)?n[o]=r=!0:n[o]=!1;return r}return!0}}])&&hf(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function Ff(t){return(Ff="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Of(t){Du.call(this,t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}function Pf(t,e){nu.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function Uf(t){return(Uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Uf(t=function(t,e){if("object"!==Uf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Uf(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Of.prototype=Object.assign(Object.create(Du.prototype),{constructor:Of,setDecoderPath:function(t){return this.decoderPath=t,this},setDecoderConfig:function(t){return this.decoderConfig=t,this},setWorkerLimit:function(t){return this.workerLimit=t,this},setVerbosity:function(){},setDrawMode:function(){},setSkipDequantization:function(){},load:function(t,e,n,i){var r=this,o=new ku(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&o.setWithCredentials(!0),o.load(t,function(t){var n={attributeIDs:r.defaultAttributeIDs,attributeTypes:r.defaultAttributeTypes,useUniqueIDs:!1};r.decodeGeometry(t,n).then(e).catch(i)},n,i)},decodeDracoFile:function(t,e,n,i){i={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n},this.decodeGeometry(t,i).then(e)},decodeGeometry:function(t,e){var n,i=this;for(n in e.attributeTypes){var r=e.attributeTypes[n];void 0!==r.BYTES_PER_ELEMENT&&(e.attributeTypes[n]=r.name)}var o,s=JSON.stringify(e);if(Of.taskCache.has(t)){if((A=Of.taskCache.get(t)).key===s)return A.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var a=this.workerNextTaskID++,A=t.byteLength;return(A=this.Oi(a,A).then(function(n){return o=n,new Promise(function(n,i){o.Ei[a]={resolve:n,reject:i},o.postMessage({type:"decode",id:a,taskConfig:e,buffer:t},[t])})}).then(function(t){return i.ki(t.geometry)})).finally(function(){o&&a&&i.Ti(o,a)}),Of.taskCache.set(t,{key:s,promise:A}),A},ki:function(t){var e=new Wt;t.index&&e.setIndex(new Ct(t.index.array,1));for(var n=0;n<t.attributes.length;n++){var i=(o=t.attributes[n]).name,r=o.array,o=o.itemSize;e.setAttribute(i,new Ct(r,o))}return e},Ri:function(t,e){var n=new ku(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),new Promise(function(e,i){n.load(t,e,void 0,i)})},preload:function(){return this.Ai(),this},Ai:function(){var t,e,n=this;return this.decoderPending||(e=[],(t="object"!==("undefined"==typeof WebAssembly?"undefined":Ff(WebAssembly))||"js"===this.decoderConfig.type)?e.push(this.Ri("draco_decoder.js","text")):(e.push(this.Ri("draco_wasm_wrapper.js","text")),e.push(this.Ri("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(function(e){var i=["/* draco decoder */",i=e[0],"","/* worker */",(e=(t||(n.decoderConfig.wasmBinary=e[1]),Of.DRACOWorker.toString())).substring(e.indexOf("{")+1,e.lastIndexOf("}"))].join("\n");n.workerSourceURL=URL.createObjectURL(new Blob([i]))})),this.decoderPending},Oi:function(t,e){var n=this;return this.Ai().then(function(){n.workerPool.length<n.workerLimit?((i=new Worker(n.workerSourceURL)).Ei={},i.xi={},i.Pi=0,i.postMessage({type:"init",decoderConfig:n.decoderConfig}),i.onmessage=function(t){var e=t.data;switch(e.type){case"decode":i.Ei[e.id].resolve(e);break;case"error":i.Ei[e.id].reject(e)}},n.workerPool.push(i)):n.workerPool.sort(function(t,e){return t.Pi>e.Pi?-1:1});var i=n.workerPool[n.workerPool.length-1];return i.xi[t]=e,i.Pi+=e,i})},Ti:function(t,e){t.Pi-=t.xi[e],delete t.Ei[e],delete t.xi[e]},debug:function(){this.workerPool.map(function(t){return t.Pi})},dispose:function(){for(var t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}),Of.DRACOWorker=function(){var t,e;onmessage=function(n){var i=n.data;switch(i.type){case"init":t=i.decoderConfig,e=new Promise(function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)});break;case"decode":var r=i.buffer,o=i.taskConfig;e.then(function(t){var e=new(t=t.draco).Decoder,n=new t.DecoderBuffer;n.Init(new Int8Array(r),r.byteLength);try{var s=function(t,e,n,i){var r,o,s=i.attributeIDs,a=i.attributeTypes,A=e.GetEncodedGeometryType(n);if(A===t.TRIANGULAR_MESH)r=new t.Mesh,o=e.DecodeBufferToMesh(n,r);else{if(A!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new t.PointCloud,o=e.DecodeBufferToPointCloud(n,r)}if(!o.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var l,u,h,c={index:null,attributes:[]};for(l in s){var f=self[a[l]];if(i.useUniqueIDs)h=s[l],u=e.GetAttributeByUniqueId(r,h);else{if(-1===(h=e.GetAttributeId(r,t[s[l]])))continue;u=e.GetAttribute(r,h)}c.attributes.push(function(t,e,n,i,r,o){var s,a,A=o.num_components(),l=n.num_points()*A;switch(r){case Float32Array:s=new t.DracoFloat32Array,e.GetAttributeFloatForAllPoints(n,o,s),a=new Float32Array(l);break;case Int8Array:s=new t.DracoInt8Array,e.GetAttributeInt8ForAllPoints(n,o,s),a=new Int8Array(l);break;case Int16Array:s=new t.DracoInt16Array,e.GetAttributeInt16ForAllPoints(n,o,s),a=new Int16Array(l);break;case Int32Array:s=new t.DracoInt32Array,e.GetAttributeInt32ForAllPoints(n,o,s),a=new Int32Array(l);break;case Uint8Array:s=new t.DracoUInt8Array,e.GetAttributeUInt8ForAllPoints(n,o,s),a=new Uint8Array(l);break;case Uint16Array:s=new t.DracoUInt16Array,e.GetAttributeUInt16ForAllPoints(n,o,s),a=new Uint16Array(l);break;case Uint32Array:s=new t.DracoUInt32Array,e.GetAttributeUInt32ForAllPoints(n,o,s),a=new Uint32Array(l);break;default:throw new Error("THREE.DRACOLoader: Unexpected attribute type.")}for(var u=0;u<l;u++)a[u]=s.GetValue(u);return t.destroy(s),{name:i,array:a,itemSize:A}}(t,e,r,l,f,u))}if(A===t.TRIANGULAR_MESH){for(var p=r.num_faces(),d=new Uint32Array(3*p),y=new t.DracoInt32Array,m=0;m<p;++m){e.GetFaceFromMesh(r,m,y);for(var g=0;g<3;++g)d[3*m+g]=y.GetValue(g)}c.index={array:d,itemSize:1},t.destroy(y)}return t.destroy(r),c}(t,e,n,o),a=s.attributes.map(function(t){return t.array.buffer});s.index&&a.push(s.index.array.buffer),self.postMessage({type:"decode",id:i.id,geometry:s},a)}catch(t){self.postMessage({type:"error",id:i.id,error:t.message})}finally{t.destroy(n),t.destroy(e)}})}}},Of.taskCache=new WeakMap,Of.setDecoderPath=function(){},Of.setDecoderConfig=function(){},Of.releaseDecoderModule=function(){},Of.getDecoderModule=function(){},Pf.prototype=Object.assign(Object.create(nu.prototype),{constructor:Pf,isAmbientLight:!0});var If=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Ci=e,this.Li=null,this.Ii=null,this.Ni=null,this.Bi=null,this.createLight=this.createLight.bind(this)}var e,n;return e=t,(n=[{key:"createLight",value:function(t,e){var n=(i=this.Ci.getMapOptions()).lockedLight,i=i.lightConfig[e];return t._i=new Pf(i[1].color,i[1].intensity),t.Fi=new Q,t.Di=new uu(i[0].color,i[0].intensity),t.Di.position.set(i[0].position.x,i[0].position.y,i[0].position.z),t.Di.target=t.Fi,t.Hi=new uu(i[2].color,i[2].intensity),t.Hi.position.set(i[2].position.x,i[2].position.y,i[2].position.z),t.Hi.target=t.Fi,this.Li=t,this.Ii=e,n&&(this.Ui=this.Ui.bind(this),this.Ci.on("viewChanged",this.Ui)),this}},{key:"createLightByTheme",value:function(t,e,n){return t._i=new Pf(new z("rgb("+n[1].color+")"),n[1].intensity),t.Di=new uu(new z("rgb("+n[0].color+")"),n[0].intensity),t.Di.position.set(n[0].position.x,n[0].position.y,n[0].position.z),t.Fi=new Q,t.Fi.position.set(n[0].target.x,n[0].target.y,n[0].target.z),t.Di.target=t.Fi,t.Hi=new uu(new z("rgb("+n[2].color+")"),n[2].intensity),t.Hi.position.set(n[2].position.x,n[2].position.y,n[2].position.z),t.Gi=new Q,t.Gi.position.set(n[2].target.x,n[2].target.y,n[2].target.z),t.Hi.target=t.Gi,this.Li=t,this.Ii=e,this}}])&&Rf(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Lf=(Object.assign(If.prototype,{Vi:function(t){var e=new Fc;return e.setFromVector3(t),e.theta},qi:function(t,e){var n=new Fc;(e=(n.setFromVector3(t),n.theta=e,new u)).setFromSpherical(n),t.copy(e)},Ui:function(){var t,e,n;this.Li&&(t=this.Vi(this.Ci.camera.position),null===this.Ni&&(e=this.Vi(this.Li.Di.position),n=this.Vi(this.Li.Hi.position),this.Ni=e-t,this.Bi=n-t),e=t+this.Ni,this.qi(this.Li.Di.position,e),n=t+this.Bi,this.qi(this.Li.Hi.position,n))},zi:function(){this.Ci.getMapOptions().lockedLight&&this.Ci.off("viewChanged",this.Ui)}}),n(0)),Df=0,Qf=2,kf=4,Nf=404;function jf(t){return(jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hf(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function zf(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Vf(i.key),i)}}function Vf(t){return"symbol"===jf(t=function(t,e){if("object"!==jf(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==jf(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}Oh=function(t,e,n){return e&&zf(t.prototype,e),n&&zf(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Xi=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hf(Object(n),!0).forEach(function(e){var i,r;i=t,r=n[e=e],(e=Vf(e))in i?Object.defineProperty(i,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hf(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({data:null,method:"GET",responseType:"json"},e),this.Zi=null});var Gf=(Object.assign(Oh.prototype,{Yi:function(t,e,n){var i=this.Xi,r=i.data,o=i.method,s=i.url,a=i.responseType,A=i.header,l=null;if((l=new("undefined"!=typeof XMLHttpRequest?XMLHttpRequest:Lf.a.global().fengmap.XMLHttpRequest)).responseType=a,l.open(o,s),"object"==jf(A))for(var u in A)l.setRequestHeader(u,A[u]);l.addEventListener("load",function(){200===l.status||0===l.status||201===l.status?t&&t(l.response):e&&(404===l.status?e(Nf):2069===l.response.error_code?e(Df):2063===l.response.error_code?e(Qf):400===l.response.error_code?e(kf):e(l.response))}),l.addEventListener("timeout",function(t){n&&n(t)}),l.addEventListener("error",function(t){e&&e(t)}),l.send(JSON.stringify(r)),this.Zi=l},zi:function(){this.Zi&&this.Zi.abort&&(this.Zi.abort(),this.Zi=null)}}),Oh),Yf=function(t){return null!=t};function Kf(t){var e;this.name="DeveloperError",this.message=t;try{throw new Error}catch(t){e=t.stack}this.stack=e}Yf(Object.create)&&((Kf.prototype=Object.create(Error.prototype)).constructor=Kf),Kf.prototype.toString=function(){var t="".concat(this.name,": ").concat(this.message);return Yf(this.stack)&&(t+="\n".concat(this.stack.toString())),t},Kf.throwInstantiationError=function(){throw new Kf("This function defines an interface and should not be called directly.")};var Xf=Kf;function Wf(t){return(Wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Zf={};function qf(t,e,n){return"Expected ".concat(n," to be typeof ").concat(e,", actual typeof was ").concat(t)}Zf.typeOf={},Zf.defined=function(t,e){if(!Yf(e))throw new Xf("".concat(t," is required, actual value was undefined"))},Zf.typeOf.func=function(t,e){if("function"!=typeof e)throw new Xf(qf(Wf(e),"function",t))},Zf.typeOf.string=function(t,e){if("string"!=typeof e)throw new Xf(qf(Wf(e),"string",t))},Zf.typeOf.number=function(t,e){if("number"!=typeof e)throw new Xf(qf(Wf(e),"number",t))},Zf.typeOf.number.lessThan=function(t,e,n){if(Zf.typeOf.number(t,e),n<=e)throw new Xf("Expected ".concat(t," to be less than ").concat(n,", actual value was ").concat(e))},Zf.typeOf.number.lessThanOrEquals=function(t,e,n){if(Zf.typeOf.number(t,e),n<e)throw new Xf("Expected ".concat(t," to be less than or equal to ").concat(n,", actual value was ").concat(e))},Zf.typeOf.number.greaterThan=function(t,e,n){if(Zf.typeOf.number(t,e),e<=n)throw new Xf("Expected ".concat(t," to be greater than ").concat(n,", actual value was ").concat(e))},Zf.typeOf.number.greaterThanOrEquals=function(t,e,n){if(Zf.typeOf.number(t,e),e<n)throw new Xf("Expected ".concat(t," to be greater than or equal to ").concat(n,", actual value was ").concat(e))},Zf.typeOf.object=function(t,e){if("object"!==Wf(e))throw new Xf(qf(Wf(e),"object",t))},Zf.typeOf.bool=function(t,e){if("boolean"!=typeof e)throw new Xf(qf(Wf(e),"boolean",t))},Zf.typeOf.bigint=function(t,e){if("bigint"!=typeof e)throw new Xf(qf(Wf(e),"bigint",t))},Zf.typeOf.number.equals=function(t,e,n,i){if(Zf.typeOf.number(t,n),Zf.typeOf.number(e,i),n!==i)throw new Xf("".concat(t," must be equal to ").concat(e,", the actual values are ").concat(n," and ").concat(i))};var Jf=Zf;function $f(t,e){return null!=t?t:e}$f.EMPTY_OBJECT=Object.freeze({});var tp=$f,ep={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536,FOUR_GIGABYTES:4294967296},np=(ep.sign=tp(Math.sign,function(t){return 0==(t=+t)||t!=t?t:0<t?1:-1}),ep.signNotZero=function(t){return t<0?-1:1},ep.toSNorm=function(t,e){return e=tp(e,255),Math.round((.5*ep.clamp(t,-1,1)+.5)*e)},ep.fromSNorm=function(t,e){return e=tp(e,255),ep.clamp(t,0,e)/e*2-1},ep.normalize=function(t,e,n){return 0===(n=Math.max(n-e,0))?0:ep.clamp((t-e)/n,0,1)},ep.sinh=tp(Math.sinh,function(t){return(Math.exp(t)-Math.exp(-t))/2}),ep.cosh=tp(Math.cosh,function(t){return(Math.exp(t)+Math.exp(-t))/2}),ep.lerp=function(t,e,n){return(1-n)*t+n*e},ep.PI=Math.PI,ep.ONE_OVER_PI=1/Math.PI,ep.PI_OVER_TWO=Math.PI/2,ep.PI_OVER_THREE=Math.PI/3,ep.PI_OVER_FOUR=Math.PI/4,ep.PI_OVER_SIX=Math.PI/6,ep.THREE_PI_OVER_TWO=3*Math.PI/2,ep.TWO_PI=2*Math.PI,ep.ONE_OVER_TWO_PI=1/(2*Math.PI),ep.RADIANS_PER_DEGREE=Math.PI/180,ep.DEGREES_PER_RADIAN=180/Math.PI,ep.RADIANS_PER_ARCSECOND=ep.RADIANS_PER_DEGREE/3600,ep.toRadians=function(t){if(Yf(t))return t*ep.RADIANS_PER_DEGREE;throw new Xf("degrees is required.")},ep.toDegrees=function(t){if(Yf(t))return t*ep.DEGREES_PER_RADIAN;throw new Xf("radians is required.")},ep.convertLongitudeRange=function(t){var e;if(Yf(t))return e=ep.TWO_PI,(t-=Math.floor(t/e)*e)<-Math.PI?t+e:t>=Math.PI?t-e:t;throw new Xf("angle is required.")},ep.clampToLatitudeRange=function(t){if(Yf(t))return ep.clamp(t,-1*ep.PI_OVER_TWO,ep.PI_OVER_TWO);throw new Xf("angle is required.")},ep.negativePiToPi=function(t){if(Yf(t))return-ep.PI<=t&&t<=ep.PI?t:ep.zeroToTwoPi(t+ep.PI)-ep.PI;throw new Xf("angle is required.")},ep.zeroToTwoPi=function(t){var e;if(Yf(t))return 0<=t&&t<=ep.TWO_PI?t:(e=ep.mod(t,ep.TWO_PI),Math.abs(e)<ep.EPSILON14&&Math.abs(t)>ep.EPSILON14?ep.TWO_PI:e);throw new Xf("angle is required.")},ep.mod=function(t,e){if(!Yf(t))throw new Xf("m is required.");if(!Yf(e))throw new Xf("n is required.");if(0===e)throw new Xf("divisor cannot be 0.");return ep.sign(t)===ep.sign(e)&&Math.abs(t)<Math.abs(e)?t:(t%e+e)%e},ep.equalsEpsilon=function(t,e,n,i){if(!Yf(t))throw new Xf("left is required.");if(!Yf(e))throw new Xf("right is required.");n=tp(n,0),i=tp(i,n);var r=Math.abs(t-e);return r<=i||r<=n*Math.max(Math.abs(t),Math.abs(e))},ep.lessThan=function(t,e,n){if(!Yf(t))throw new Xf("first is required.");if(!Yf(e))throw new Xf("second is required.");if(Yf(n))return t-e<-n;throw new Xf("absoluteEpsilon is required.")},ep.lessThanOrEquals=function(t,e,n){if(!Yf(t))throw new Xf("first is required.");if(!Yf(e))throw new Xf("second is required.");if(Yf(n))return t-e<n;throw new Xf("absoluteEpsilon is required.")},ep.greaterThan=function(t,e,n){if(!Yf(t))throw new Xf("first is required.");if(!Yf(e))throw new Xf("second is required.");if(Yf(n))return n<t-e;throw new Xf("absoluteEpsilon is required.")},ep.greaterThanOrEquals=function(t,e,n){if(!Yf(t))throw new Xf("first is required.");if(!Yf(e))throw new Xf("second is required.");if(Yf(n))return-n<t-e;throw new Xf("absoluteEpsilon is required.")},[1]),ip=(ep.factorial=function(t){if("number"!=typeof t||t<0)throw new Xf("A number greater than or equal to 0 is required.");var e=np.length;if(e<=t)for(var n=np[e-1],i=e;i<=t;i++){var r=n*i;np.push(r),n=r}return np[t]},ep.incrementWrap=function(t,e,n){if(n=tp(n,0),!Yf(t))throw new Xf("n is required.");if(e<=n)throw new Xf("maximumValue must be greater than minimumValue.");return e<++t?n:t},ep.isPowerOfTwo=function(t){if("number"!=typeof t||t<0||4294967295<t)throw new Xf("A number between 0 and (2^32)-1 is required.");return 0!==t&&0==(t&t-1)},ep.nextPowerOfTwo=function(t){if("number"!=typeof t||t<0||2147483648<t)throw new Xf("A number between 0 and 2^31 is required.");return--t,t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16,++t},ep.previousPowerOfTwo=function(t){if("number"!=typeof t||t<0||4294967295<t)throw new Xf("A number between 0 and (2^32)-1 is required.");return((t=(t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)|t>>32)>>>0)-(t>>>1)},ep.clamp=function(t,e,n){return Jf.typeOf.number("value",t),Jf.typeOf.number("min",e),Jf.typeOf.number("max",n),t<e?e:n<t?n:t},ep.nextRandomNumber=function(){return randomNumberGenerator.random()},ep.randomBetween=function(t,e){return ep.nextRandomNumber()*(e-t)+t},ep.acosClamped=function(t){if(Yf(t))return Math.acos(ep.clamp(t,-1,1));throw new Xf("value is required.")},ep.asinClamped=function(t){if(Yf(t))return Math.asin(ep.clamp(t,-1,1));throw new Xf("value is required.")},ep.chordLength=function(t,e){if(!Yf(t))throw new Xf("angle is required.");if(Yf(e))return 2*e*Math.sin(.5*t);throw new Xf("radius is required.")},ep.logBase=function(t,e){if(!Yf(t))throw new Xf("number is required.");if(Yf(e))return Math.log(t)/Math.log(e);throw new Xf("base is required.")},ep.cbrt=tp(Math.cbrt,function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}),ep.log2=tp(Math.log2,function(t){return Math.log(t)*Math.LOG2E}),ep.fog=function(t,e){return t*=e,1-Math.exp(-t*t)},ep.fastApproximateAtan=function(t){return Jf.typeOf.number("x",t),t*(-.1784*Math.abs(t)-.0663*t*t+1.0301)},ep.fastApproximateAtan2=function(t,e){Jf.typeOf.number("x",t),Jf.typeOf.number("y",e);var n=Math.abs(t),i=Math.abs(e),r=Math.max(n,i);i=Math.min(n,i)/r;if(isNaN(i))throw new Xf("either x or y must be nonzero");return n=ep.fastApproximateAtan(i),n=Math.abs(e)>Math.abs(t)?ep.PI_OVER_TWO-n:n,n=t<0?ep.PI-n:n,e<0?-n:n},ep);function rp(t,e,n){this.x=tp(t,0),this.y=tp(e,0),this.z=tp(n,0)}rp.fromSpherical=function(t,e){Jf.typeOf.object("spherical",t),Yf(e)||(e=new rp);var n=t.clock,i=t.cone,r=(t=tp(t.magnitude,1))*Math.sin(i);return e.x=r*Math.cos(n),e.y=r*Math.sin(n),e.z=t*Math.cos(i),e},rp.fromElements=function(t,e,n,i){return Yf(i)?(i.x=t,i.y=e,i.z=n,i):new rp(t,e,n)},rp.fromCartesian4=rp.clone=function(t,e){if(Yf(t))return Yf(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e):new rp(t.x,t.y,t.z)},rp.packedLength=3,rp.pack=function(t,e,n){return Jf.typeOf.object("value",t),Jf.defined("array",e),n=tp(n,0),e[n++]=t.x,e[n++]=t.y,e[n]=t.z,e},rp.unpack=function(t,e,n){return Jf.defined("array",t),e=tp(e,0),(n=Yf(n)?n:new rp).x=t[e++],n.y=t[e++],n.z=t[e],n},rp.packArray=function(t,e){Jf.defined("array",t);var n=t.length,i=3*n;if(Yf(e)){if(!Array.isArray(e)&&e.length!==i)throw new Xf("If result is a typed array, it must have exactly array.length * 3 elements");e.length!==i&&(e.length=i)}else e=new Array(i);for(var r=0;r<n;++r)rp.pack(t[r],e,3*r);return e},rp.unpackArray=function(t,e){if(Jf.defined("array",t),Jf.typeOf.number.greaterThanOrEquals("array.length",t.length,3),t.length%3!=0)throw new Xf("array length must be a multiple of 3.");var n=t.length;Yf(e)?e.length=n/3:e=new Array(n/3);for(var i=0;i<n;i+=3){var r=i/3;e[r]=rp.unpack(t,i,e[r])}return e},rp.fromArray=rp.unpack,rp.maximumComponent=function(t){return Jf.typeOf.object("cartesian",t),Math.max(t.x,t.y,t.z)},rp.minimumComponent=function(t){return Jf.typeOf.object("cartesian",t),Math.min(t.x,t.y,t.z)},rp.minimumByComponent=function(t,e,n){return Jf.typeOf.object("first",t),Jf.typeOf.object("second",e),Jf.typeOf.object("result",n),n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.z=Math.min(t.z,e.z),n},rp.maximumByComponent=function(t,e,n){return Jf.typeOf.object("first",t),Jf.typeOf.object("second",e),Jf.typeOf.object("result",n),n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.z=Math.max(t.z,e.z),n},rp.clamp=function(t,e,n,i){Jf.typeOf.object("value",t),Jf.typeOf.object("min",e),Jf.typeOf.object("max",n),Jf.typeOf.object("result",i);var r=ip.clamp(t.x,e.x,n.x),o=ip.clamp(t.y,e.y,n.y);t=ip.clamp(t.z,e.z,n.z);return i.x=r,i.y=o,i.z=t,i},rp.magnitudeSquared=function(t){return Jf.typeOf.object("cartesian",t),t.x*t.x+t.y*t.y+t.z*t.z},rp.magnitude=function(t){return Math.sqrt(rp.magnitudeSquared(t))};var op=new rp,sp=(rp.distance=function(t,e){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),rp.subtract(t,e,op),rp.magnitude(op)},rp.distanceSquared=function(t,e){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),rp.subtract(t,e,op),rp.magnitudeSquared(op)},rp.normalize=function(t,e){Jf.typeOf.object("cartesian",t),Jf.typeOf.object("result",e);var n=rp.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,isNaN(e.x)||isNaN(e.y)||isNaN(e.z))throw new Xf("normalized result is not a number");return e},rp.dot=function(t,e){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),t.x*e.x+t.y*e.y+t.z*e.z},rp.multiplyComponents=function(t,e,n){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),Jf.typeOf.object("result",n),n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n},rp.divideComponents=function(t,e,n){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),Jf.typeOf.object("result",n),n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n},rp.add=function(t,e,n){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),Jf.typeOf.object("result",n),n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},rp.subtract=function(t,e,n){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),Jf.typeOf.object("result",n),n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},rp.multiplyByScalar=function(t,e,n){return Jf.typeOf.object("cartesian",t),Jf.typeOf.number("scalar",e),Jf.typeOf.object("result",n),n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},rp.divideByScalar=function(t,e,n){return Jf.typeOf.object("cartesian",t),Jf.typeOf.number("scalar",e),Jf.typeOf.object("result",n),n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n},rp.negate=function(t,e){return Jf.typeOf.object("cartesian",t),Jf.typeOf.object("result",e),e.x=-t.x,e.y=-t.y,e.z=-t.z,e},rp.abs=function(t,e){return Jf.typeOf.object("cartesian",t),Jf.typeOf.object("result",e),e.x=Math.abs(t.x),e.y=Math.abs(t.y),e.z=Math.abs(t.z),e},new rp),ap=(rp.lerp=function(t,e,n,i){return Jf.typeOf.object("start",t),Jf.typeOf.object("end",e),Jf.typeOf.number("t",n),Jf.typeOf.object("result",i),rp.multiplyByScalar(e,n,sp),i=rp.multiplyByScalar(t,1-n,i),rp.add(sp,i,i)},new rp),Ap=new rp,lp=(rp.angleBetween=function(t,e){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),rp.normalize(t,ap),rp.normalize(e,Ap),t=rp.dot(ap,Ap),e=rp.magnitude(rp.cross(ap,Ap,ap)),Math.atan2(e,t)},new rp),up=(rp.mostOrthogonalAxis=function(t,e){return Jf.typeOf.object("cartesian",t),Jf.typeOf.object("result",e),t=rp.normalize(t,lp),rp.abs(t,t),t.x<=t.y?t.x<=t.z?rp.clone(rp.UNIT_X,e):rp.clone(rp.UNIT_Z,e):t.y<=t.z?rp.clone(rp.UNIT_Y,e):rp.clone(rp.UNIT_Z,e)},rp.projectVector=function(t,e,n){return Jf.defined("a",t),Jf.defined("b",e),Jf.defined("result",n),t=rp.dot(t,e)/rp.dot(e,e),rp.multiplyByScalar(e,t,n)},rp.equals=function(t,e){return t===e||Yf(t)&&Yf(e)&&t.x===e.x&&t.y===e.y&&t.z===e.z},rp.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]&&t.z===e[n+2]},rp.equalsEpsilon=function(t,e,n,i){return t===e||Yf(t)&&Yf(e)&&ip.equalsEpsilon(t.x,e.x,n,i)&&ip.equalsEpsilon(t.y,e.y,n,i)&&ip.equalsEpsilon(t.z,e.z,n,i)},rp.cross=function(t,e,n){Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),Jf.typeOf.object("result",n);var i=t.x,r=t.y,o=(t=t.z,e.x),s=e.y,a=t*o-i*(e=e.z);i=i*s-r*o;return n.x=r*e-t*s,n.y=a,n.z=i,n},rp.midpoint=function(t,e,n){return Jf.typeOf.object("left",t),Jf.typeOf.object("right",e),Jf.typeOf.object("result",n),n.x=.5*(t.x+e.x),n.y=.5*(t.y+e.y),n.z=.5*(t.z+e.z),n},rp.fromDegrees=function(t,e,n,i,r){return Jf.typeOf.number("longitude",t),Jf.typeOf.number("latitude",e),t=ip.toRadians(t),e=ip.toRadians(e),rp.fromRadians(t,e,n,i,r)},new rp),hp=new rp,cp=new rp(40680631590769,40680631590769,40408299984661.445),fp=(rp.fromRadians=function(t,e,n,i,r){Jf.typeOf.number("longitude",t),Jf.typeOf.number("latitude",e),n=tp(n,0);i=Yf(i)?i.radiiSquared:cp;var o=Math.cos(e);up.x=o*Math.cos(t),up.y=o*Math.sin(t),up.z=Math.sin(e),up=rp.normalize(up,up),rp.multiplyComponents(i,up,hp),o=Math.sqrt(rp.dot(up,hp));return hp=rp.divideByScalar(hp,o,hp),up=rp.multiplyByScalar(up,n,up),Yf(r)||(r=new rp),rp.add(hp,up,r)},rp.fromDegreesArray=function(t,e,n){if(Jf.defined("coordinates",t),t.length<2||t.length%2!=0)throw new Xf("the number of coordinates must be a multiple of 2 and at least 2");var i=t.length;Yf(n)?n.length=i/2:n=new Array(i/2);for(var r=0;r<i;r+=2){var o=t[r],s=t[r+1],a=r/2;n[a]=rp.fromDegrees(o,s,0,e,n[a])}return n},rp.fromRadiansArray=function(t,e,n){if(Jf.defined("coordinates",t),t.length<2||t.length%2!=0)throw new Xf("the number of coordinates must be a multiple of 2 and at least 2");var i=t.length;Yf(n)?n.length=i/2:n=new Array(i/2);for(var r=0;r<i;r+=2){var o=t[r],s=t[r+1],a=r/2;n[a]=rp.fromRadians(o,s,0,e,n[a])}return n},rp.fromDegreesArrayHeights=function(t,e,n){if(Jf.defined("coordinates",t),t.length<3||t.length%3!=0)throw new Xf("the number of coordinates must be a multiple of 3 and at least 3");var i=t.length;Yf(n)?n.length=i/3:n=new Array(i/3);for(var r=0;r<i;r+=3){var o=t[r],s=t[r+1],a=t[r+2],A=r/3;n[A]=rp.fromDegrees(o,s,a,e,n[A])}return n},rp.fromRadiansArrayHeights=function(t,e,n){if(Jf.defined("coordinates",t),t.length<3||t.length%3!=0)throw new Xf("the number of coordinates must be a multiple of 3 and at least 3");var i=t.length;Yf(n)?n.length=i/3:n=new Array(i/3);for(var r=0;r<i;r+=3){var o=t[r],s=t[r+1],a=t[r+2],A=r/3;n[A]=rp.fromRadians(o,s,a,e,n[A])}return n},rp.ZERO=Object.freeze(new rp(0,0,0)),rp.ONE=Object.freeze(new rp(1,1,1)),rp.UNIT_X=Object.freeze(new rp(1,0,0)),rp.UNIT_Y=Object.freeze(new rp(0,1,0)),rp.UNIT_Z=Object.freeze(new rp(0,0,1)),rp.prototype.clone=function(t){return rp.clone(this,t)},rp.prototype.equals=function(t){return rp.equals(this,t)},rp.prototype.equalsEpsilon=function(t,e,n){return rp.equalsEpsilon(this,t,e,n)},rp.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,", ").concat(this.z,")")},rp),pp=new fp,dp=new fp;function yp(t,e,n){this.longitude=tp(t,0),this.latitude=tp(e,0),this.height=tp(n,0)}yp.fromRadians=function(t,e,n,i){return Jf.typeOf.number("longitude",t),Jf.typeOf.number("latitude",e),n=tp(n,0),Yf(i)?(i.longitude=t,i.latitude=e,i.height=n,i):new yp(t,e,n)},yp.fromDegrees=function(t,e,n,i){return Jf.typeOf.number("longitude",t),Jf.typeOf.number("latitude",e),t=ip.toRadians(t),e=ip.toRadians(e),yp.fromRadians(t,e,n,i)};var mp=new fp,gp=new fp,vp=new fp,bp=new fp(1/6378137,1/6378137,1/6356752.314245179),xp=new fp(1/40680631590769,1/40680631590769,1/40408299984661.445),wp=ip.EPSILON1,Bp=(yp.fromCartesian=function(t,e,n){var i=Yf(e)?e.oneOverRadii:bp,r=Yf(e)?e.oneOverRadiiSquared:xp;i=function(t,e,n,i,r){if(!Yf(t))throw new Xf("cartesian is required.");if(!Yf(e))throw new Xf("oneOverRadii is required.");if(!Yf(n))throw new Xf("oneOverRadiiSquared is required.");if(!Yf(i))throw new Xf("centerToleranceSquared is required.");var o=t.x,s=t.y,a=t.z,A=o*o*(h=e.x)*h,l=s*s*(c=e.y)*c,u=a*a*(e=e.z)*e,h=A+l+u,c=Math.sqrt(1/h);e=fp.multiplyByScalar(t,c,pp);if(h<i)return isFinite(c)?fp.clone(e,r):void 0;var f=n.x,p=n.y,d=n.z,y=((h=dp).x=e.x*f*2,h.y=e.y*p*2,h.z=e.z*d*2,(1-c)*fp.magnitude(t)/(.5*fp.magnitude(h))),m=0;do{var g,v,b,x,w,B,M;m=(M=A*(x=(g=1/(1+(y-=m)*f))*g)+l*(w=(v=1/(1+y*p))*v)+u*(B=(b=1/(1+y*d))*b)-1)/(-2*(A*(x*g)*f+l*(w*v)*p+u*(B*b)*d))}while(Math.abs(M)>ip.EPSILON12);return Yf(r)?(r.x=o*g,r.y=s*v,r.z=a*b,r):new fp(o*g,s*v,a*b)}(t,i,r,e=Yf(e)?e._centerToleranceSquared:wp,gp);if(Yf(i))return e=fp.multiplyComponents(i,r,mp),e=fp.normalize(e,e),r=fp.subtract(t,i,vp),i=Math.atan2(e.y,e.x),e=Math.asin(e.z),t=ip.sign(fp.dot(r,t))*fp.magnitude(r),Yf(n)?(n.longitude=i,n.latitude=e,n.height=t,n):new yp(i,e,t)},yp.toCartesian=function(t,e,n){return Jf.defined("cartographic",t),fp.fromRadians(t.longitude,t.latitude,t.height,e,n)},yp.clone=function(t,e){if(Yf(t))return Yf(e)?(e.longitude=t.longitude,e.latitude=t.latitude,e.height=t.height,e):new yp(t.longitude,t.latitude,t.height)},yp.equals=function(t,e){return t===e||Yf(t)&&Yf(e)&&t.longitude===e.longitude&&t.latitude===e.latitude&&t.height===e.height},yp.equalsEpsilon=function(t,e,n){return n=tp(n,0),t===e||Yf(t)&&Yf(e)&&Math.abs(t.longitude-e.longitude)<=n&&Math.abs(t.latitude-e.latitude)<=n&&Math.abs(t.height-e.height)<=n},yp.ZERO=Object.freeze(new yp(0,0,0)),yp.prototype.clone=function(t){return yp.clone(this,t)},yp.prototype.equals=function(t){return yp.equals(this,t)},yp.prototype.equalsEpsilon=function(t,e){return yp.equalsEpsilon(this,t,e)},yp.prototype.toString=function(){return"(".concat(this.longitude,", ").concat(this.latitude,", ").concat(this.height,")")},yp);function Mp(t){this.Wi=6378137,this.Ki=1/this.Wi}Object.defineProperties(Mp.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),Mp.mercatorAngleToGeodeticLatitude=function(t){return ip.PI_OVER_TWO-2*Math.atan(Math.exp(-t))},Mp.geodeticLatitudeToMercatorAngle=function(t){return Mp.MaximumLatitude<t?t=Mp.MaximumLatitude:t<-Mp.MaximumLatitude&&(t=-Mp.MaximumLatitude),t=Math.sin(t),.5*Math.log((1+t)/(1-t))},Mp.MaximumLatitude=Mp.mercatorAngleToGeodeticLatitude(Math.PI),Mp.prototype.project=function(t,e){var n=this.Wi,i=t.longitude*n;n=Mp.geodeticLatitudeToMercatorAngle(t.latitude)*n,t=t.height;return Yf(e)?(e.x=i,e.y=n,e.z=t,e):new fp(i,n,t)},Mp.prototype.unproject=function(t,e){var n,i;if(Yf(t))return i=this.Ki,n=t.x*i,i=Mp.mercatorAngleToGeodeticLatitude(t.y*i),t=t.z,Yf(e)?(e.longitude=n,e.latitude=i,e.height=t,e):new Bp(n,i,t);throw new Xf("cartesian is required")};var Sp=Mp;function _p(t){return(_p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ep(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===_p(t=function(t,e){if("object"!==_p(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==_p(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Tp(t,e,n,i){t=t||10,e=e||10,n=new z(void 0!==n?n:4473924),i=new z(void 0!==i?i:8947848);for(var r=e/2,o=t/e,s=t/2,a=[],A=[],l=0,u=0,h=-s;l<=e;l++,h+=o){a.push(-s,0,h,s,0,h),a.push(h,0,-s,h,0,s);var c=l===r?n:i;c.toArray(A,u),u+=3,c.toArray(A,u),u+=3,c.toArray(A,u),u+=3,c.toArray(A,u),u+=3}var f=((t=new Wt).setAttribute("position",new Dt(a,3)),t.setAttribute("color",new Dt(A,3)),new Ru({vertexColors:!0,toneMapped:!1}));sh.call(this,t,f)}function Cp(t){return(Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Fp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Cp(t=function(t,e){if("object"!==Cp(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Cp(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Eo=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Qi=void 0!==(e=e||{}).url?e.url:"",this.L=null!=e.offset?parseFloat(e.offset):1,this.nt=this.L,this.$i=null==e.isClamp||e.isClamp,this.Ji=e.decoderURL,this.K=null,this.Ci=null,this.tn=null,this.Pt=null,this.$=new k,this.nn=null,this.en=this.en.bind(this),this.st=this.st.bind(this),this.ot=!1,this.rn=null,this.sn=null,this.hn=null,this.an=null,this.cn=null,this.fn=null,this.ln=null,this.vn=null,this.yn=!0,this.dn=null}var e,n;return e=t,(n=[{key:"visible",get:function(){return this.I},set:function(t){this.I=t,this.$.visible=this.I,this.Ci.enableUpdateRender()}},{key:"addTo",value:function(t){this.Ci=t,this.nt=this.Ci.getFloor(this.Ci.getVisibleLevels()[0]).height-this.L,this.Ci.getRenderManager().set3DTilesLayerSceneArr(this.$),this.vt(),this.bn(),this.yn=!0}},{key:"remove",value:function(){for(var t=this.Ci.getRenderManager().get3DTilesLayerSceneArr(),e=t.length-1;0<=e;e--)t[e]===this.$&&t.splice(e,1);0==t.length&&(this.Ci.off("update",this.en),this.Ci.off("viewModeChanged",this.st),this.Ci.off("visibleLevelsLoaded",this.st),this.ot=!1),this.Ci.enableUpdateRender(),0==t.length&&(this.Ci=null),this.sn&&(this.sn.dispose(),this.sn=null),this.dn&&(this.$.remove(this.dn),this.dn.geometry.dispose(),this.dn.material.dispose(),this.dn=void 0)}}])&&Ep(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(Eo.prototype,{vt:function(){this.ot||(this.nn=new If(this.Ci).createLight(this,"FMExternalModelLayer"),this.K=this.Ci.getContainer(),this.Ci.on("update",this.en),this.Ci.on("viewModeChanged",this.st),this.Ci.on("visibleLevelsLoaded",this.st),this.pn(this.Qi),this.ot=!0)},bn:function(){this.$.add(this.Di),this.$.add(this._i),this.$.add(this.Hi)},pn:function(t){var e=this;new Gf({method:"GET",responseType:"json",url:t}).Yi(function(t){t&&(e.hn=t.root.transform,e.ln=new g,e.an=e.mn(),e.cn=new g,e.cn.makeTranslation(e.an.offsetX,e.an.offsetY,e.nt),e.tn=e.Ci.camera,e.Pt=e.Ci.getRenderManager().renderer,e.wn(),e.gn())},function(t){})},wn:function(){this.rn=new tn,this.rn.rotation.set(0,0,0),this.$.add(this.rn)},gn:function(){var t=this,e=this,n=(this.sn=new Cf(this.Qi),new mc(this.sn.manager)),i=(this.Ji&&((i=new Of).setDecoderPath(this.Ji),n.setDRACOLoader(i)),this.sn.fetchOptions.mode="cors",this.sn.manager.addHandler(/\.gltf$/,n),this.sn.manager.addHandler(/\.glb$/,n),this.sn.onLoadModel=function(t){t.traverse(function(t){t.isMesh&&(t.renderOrder=-8,t.material.map.encoding=3e3,t.material.map.wrapS=bt,t.material.map.wrapT=bt,t.material.map.minFilter=xt)}),e.yn=!0},this.sn.onDisposeModel=function(t){t.traverse(function(t){t.isMesh&&t.material.dispose()}),e.yn=!0},this.sn.onLoadTileSet=function(){var n,i,r=new at,o=new g,s=(r=((s=new g).fromArray(e.hn),t.sn.getOrientedBounds(r,o)&&(i=(n=(new u).setFromMatrixPosition(s)).length()),n.normalize()),o=new u(0,1,0),t.rotationBetweenDirections(r,o));t.sn.group.quaternion.x=s.x,t.sn.group.quaternion.y=s.y,t.sn.group.quaternion.z=s.z,t.sn.group.quaternion.w=s.w,t.sn.group.position.y=-i,e.yn=!0},this.rn.add(this.sn.group),this.rn.position.x=e.an.offsetX,this.rn.position.z=e.an.offsetY,this.rn.position.y=e.nt,this.rn.rotation.y=ip.PI-ip.PI/20,this.sn.lruCache.maxSize);this.dn=new Ve(new Zt(i,i),new $t({visible:!1})),this.dn.position.x=e.an.offsetX,this.dn.position.z=e.an.offsetY,this.dn.position.y=e.nt,this.dn.rotation.x=-ip.PI/2,this.$.add(this.dn)},rotationBetweenDirections:function(t,e){var n=new a,i=(new u).crossVectors(t,e);return n.x=i.x,n.y=i.y,n.z=i.z,n.w=1+t.clone().dot(e),n.normalize(),n},mn:function(){var t=this.Ci.getCenter(),e=this.hn[12],n=this.hn[13],i=this.hn[14];e=new fp(e,n,i),n=Bp.fromCartesian(e);return{offsetX:(i=(new Sp).project(n)).x-t.x,offsetY:t.y-i.y}},en:function(){this.sn&&(this.sn.setCamera(this.tn),this.sn.setResolutionFromRenderer(this.tn,this.Pt),this.sn.update(),this.yn)&&(null!=this.Ci&&this.Ci.enableUpdateRender(),this.yn=!1)},st:function(t){"viewModeChanged"==t.type&&(this.sn.deleteCamera(this.tn),this.tn=this.Ci.camera,this.sn.setCamera(this.tn),this.sn.setResolutionFromRenderer(this.tn,this.Pt),this.sn.update()),this.nt=this.Ci.getFloor(this.Ci.getVisibleLevels()[0]).height-this.L,this.$i&&(this.rn.position.y=this.nt)}}),Ph=Eo,Tp.prototype=Object.assign(Object.create(sh.prototype),{constructor:Tp,copy:function(t){return sh.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return(new this.constructor).copy(this)}}),Fh=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.L=e.offset,void 0===this.L&&(this.L=1),this.jn=e.color,void 0===this.jn&&(this.jn="#6E6A62"),this.Mn=e.opacity,void 0===this.Mn&&(this.Mn=1),this.Sn=e.gridColor,void 0===this.Sn&&(this.Sn="#000000"),this.On=e.gridOpacity,void 0===this.On&&(this.On=.1),this.C=1e3,this.$=new k,this.rt=new se(new u(0,1,0),0),this.tt=new Ke,this.En=null,this.kn=null,this.Tn=null,this.Ci=null,this.I=!0,this.St=this.St.bind(this)}var e,n;return e=t,(n=[{key:"color",get:function(){return this.jn},set:function(t){this.jn=t,this.kn.material.color=new z(t),this.Rn()}},{key:"opacity",get:function(){return this.Mn},set:function(t){this.Mn=t,this.kn.material.opacity=t,this.Rn()}},{key:"gridColor",get:function(){return this.Sn},set:function(t){this.Sn=t,this.Tn.material.color=new z(t),this.Rn()}},{key:"gridOpacity",get:function(){return this.On},set:function(t){this.On=t,this.Tn.material.opacity=t,this.Rn()}},{key:"visible",get:function(){return this.I},set:function(t){this.I=t,this.kn.visible=t,this.Tn.visible=t,this.Rn()}},{key:"addTo",value:function(t){this.Ci=t,this.En=this.Ci.getBuilding(this.Ci.getMapOptions().mapID).bound,this.C=20*Math.ceil(Math.max(this.En.size.x,this.En.size.y)),this.Ci.getRenderManager().setGroundLayerScene(this.$),this.An(),this.Rn()}},{key:"remove",value:function(){this.$.remove(this.kn),this.$.remove(this.Tn),this.kn.geometry.dispose(),this.kn=void 0,this.Tn.material.dispose(),this.Tn=void 0,this.Ci.off("levelChanged",this.St),this.Ci.getRenderManager().setGroundLayerScene(void 0),this.Ci.enableUpdateRender()}}])&&Fp(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(Fh.prototype,{An:function(){this.kn=new Ve(new Zt(this.C,this.C),new $t({color:new z(this.jn),opacity:this.Mn,transparent:!0,depthWrite:!1})),this.kn.renderOrder=-9,this.kn.material.polygonOffset=!0,this.kn.material.polygonOffsetFactor=1,this.kn.material.polygonOffsetUnits=4;var t=this.Ci.getFloor(this.Ci.getVisibleLevels()[0]).height-this.L;this.kn.position.x=this.En.center.x-this.Ci.x,this.kn.position.y=t,this.kn.position.z=this.Ci.y-this.En.center.y,this.kn.rotation.x=-Math.PI/2,this.$.add(this.kn),this.Tn=new Tp(this.C,40,this.Sn,this.Sn),this.Tn.material.opacity=this.On,this.Tn.material.depthWrite=!1,this.Tn.material.transparent=!0,this.Tn.material.polygonOffset=!0,this.Tn.material.polygonOffsetFactor=1,this.Tn.material.polygonOffsetUnits=4,this.Tn.position.x=this.En.center.x-this.Ci.x,this.Tn.position.y=t,this.Tn.position.z=this.Ci.y-this.En.center.y,this.Tn.renderOrder=-9,this.$.add(this.Tn),this.Ci.on("levelChanged",this.St)},St:function(){var t=this.Ci.getFloor(this.Ci.getVisibleLevels()[0]).height-this.L;this.kn.position.y=t,this.Tn.position.y=t},Rn:function(){this.Ci.enableUpdateRender()}}),n=Fh,(Oh=window.fengmap||{}).FMTileLayer=qe,Oh.FM3DTilesLayer=Ph,Oh.FMTileProvider=Ze,Oh.FMGroundLayer=n,Oh.FMTileFilter=$e,e.default=Oh}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"xn",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.xn)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.xn?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=2).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()},Tvr9:function(t,e,n){var i;i=function(){return e=[function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){return"symbol"===i(t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==i(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(r.key),r)}}n.r(e);for(var o=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isVector2",{value:!0}),this.x=e,this.y=n}var e,n;return e=t,(n=[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"add",value:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this)}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}},{key:"sub",value:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this)}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"applyMatrix3",value:function(t){var e=this.x,n=this.y;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6],this.y=t[1]*e+t[4]*n+t[7],this}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}},{key:"clamp",value:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}},{key:"clampScalar",value:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}},{key:"clampLength",value:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){return Math.atan2(-this.y,-this.x)+Math.PI}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x;return e*e+(t=this.y-t.y)*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}},{key:"lerpVectors",value:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"fromArray",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}},{key:"fromBufferAttribute",value:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this}},{key:"rotateAround",value:function(t,e){var n=Math.cos(e),i=(e=Math.sin(e),this.x-t.x),r=this.y-t.y;return this.x=i*n-r*e+t.x,this.y=i*e+r*n+t.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),s=[],a=0;a<256;a++)s[a]=(a<16?"0":"")+a.toString(16);var A=1234567,l={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(s[255&t]+s[t>>8&255]+s[t>>16&255]+s[t>>24&255]+"-"+s[255&e]+s[e>>8&255]+"-"+s[e>>16&15|64]+s[e>>24&255]+"-"+s[63&n|128]+s[n>>8&255]+"-"+s[n>>16&255]+s[n>>24&255]+s[255&i]+s[i>>8&255]+s[i>>16&255]+s[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return((A=16807*(A=void 0!==t?t%2147483647:A)%2147483647)-1)/2147483646},degToRad:function(t){return t*l.DEG2RAD},radToDeg:function(t){return t*l.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var o=Math.cos,s=Math.sin,a=o(n/2),A=s(n/2),l=o((e+i)/2),u=s((e+i)/2),h=o((e-i)/2),c=s((e-i)/2),f=o((i-e)/2),p=s((i-e)/2);switch(r){case"XYX":t.set(a*u,A*h,A*c,a*l);break;case"YZY":t.set(A*c,a*u,A*h,a*l);break;case"ZXZ":t.set(A*h,A*c,a*u,a*l);break;case"XZX":t.set(a*u,A*p,A*f,a*l);break;case"YXY":t.set(A*f,a*u,A*p,a*l);break;case"ZYZ":t.set(A*p,A*f,a*u,a*l)}}};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===u(t=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==u(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===c(t=function(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==c(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}n=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isQuaternion",{value:!0}),this.h=e,this.u=n,this.v=i,this.M=r}var e,n,i;return e=t,i=[{key:"slerp",value:function(t,e,n,i){return n.copy(t).slerp(e,i)}},{key:"slerpFlat",value:function(t,e,n,i,r,o,s){var a,A,l,u=n[i+0],h=n[i+1],c=n[i+2],f=(n=n[i+3],i=r[o+0],r[o+1]),p=r[o+2];n===(r=r[o+3])&&u===i&&h===f&&c===p||(o=1-s,a=0<=(A=u*i+h*f+c*p+n*r)?1:-1,(l=1-A*A)>Number.EPSILON&&(l=Math.sqrt(l),A=Math.atan2(l,A*a),o=Math.sin(o*A)/l,s=Math.sin(s*A)/l),u=u*o+i*(A=s*a),h=h*o+f*A,c=c*o+p*A,n=n*o+r*A,o===1-s&&(u*=l=1/Math.sqrt(u*u+h*h+c*c+n*n),h*=l,c*=l,n*=l)),t[e]=u,t[e+1]=h,t[e+2]=c,t[e+3]=n}},{key:"multiplyQuaternionsFlat",value:function(t,e,n,i,r,o){var s=n[i],a=n[i+1],A=n[i+2],l=(n=n[i+3],i=r[o],r[o+1]),u=r[o+2];r=r[o+3];return t[e]=s*r+n*i+a*u-A*l,t[e+1]=a*r+n*l+A*i-s*u,t[e+2]=A*r+n*u+s*l-a*i,t[e+3]=n*r-s*i-a*l-A*u,t}}],(n=[{key:"x",get:function(){return this.h},set:function(t){this.h=t,this.k()}},{key:"y",get:function(){return this.u},set:function(t){this.u=t,this.k()}},{key:"z",get:function(){return this.v},set:function(t){this.v=t,this.k()}},{key:"w",get:function(){return this.M},set:function(t){this.M=t,this.k()}},{key:"set",value:function(t,e,n,i){return this.h=t,this.u=e,this.v=n,this.M=i,this.k(),this}},{key:"clone",value:function(){return new this.constructor(this.h,this.u,this.v,this.M)}},{key:"copy",value:function(t){return this.h=t.x,this.u=t.y,this.v=t.z,this.M=t.w,this.k(),this}},{key:"setFromEuler",value:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t.h,i=t.u,r=t.v,o=t._order,s=(t=Math.cos,Math.sin),a=t(n/2),A=t(i/2),l=t(r/2),u=s(n/2),h=s(i/2),c=s(r/2);switch(o){case"XYZ":this.h=u*A*l+a*h*c,this.u=a*h*l-u*A*c,this.v=a*A*c+u*h*l,this.M=a*A*l-u*h*c;break;case"YXZ":this.h=u*A*l+a*h*c,this.u=a*h*l-u*A*c,this.v=a*A*c-u*h*l,this.M=a*A*l+u*h*c;break;case"ZXY":this.h=u*A*l-a*h*c,this.u=a*h*l+u*A*c,this.v=a*A*c+u*h*l,this.M=a*A*l-u*h*c;break;case"ZYX":this.h=u*A*l-a*h*c,this.u=a*h*l+u*A*c,this.v=a*A*c-u*h*l,this.M=a*A*l+u*h*c;break;case"YZX":this.h=u*A*l+a*h*c,this.u=a*h*l+u*A*c,this.v=a*A*c-u*h*l,this.M=a*A*l-u*h*c;break;case"XZY":this.h=u*A*l-a*h*c,this.u=a*h*l-u*A*c,this.v=a*A*c+u*h*l,this.M=a*A*l+u*h*c}return!1!==e&&this.k(),this}},{key:"setFromAxisAngle",value:function(t,e){e/=2;var n=Math.sin(e);return this.h=t.x*n,this.u=t.y*n,this.v=t.z*n,this.M=Math.cos(e),this.k(),this}},{key:"setFromRotationMatrix",value:function(t){var e=(t=t.elements)[0],n=t[4],i=t[8],r=t[1],o=t[5],s=t[9],a=t[2],A=t[6],l=e+o+(t=t[10]);return 0<l?(l=.5/Math.sqrt(l+1),this.M=.25/l,this.h=(A-s)*l,this.u=(i-a)*l,this.v=(r-n)*l):o<e&&t<e?(l=2*Math.sqrt(1+e-o-t),this.M=(A-s)/l,this.h=.25*l,this.u=(n+r)/l,this.v=(i+a)/l):t<o?(l=2*Math.sqrt(1+o-e-t),this.M=(i-a)/l,this.h=(n+r)/l,this.u=.25*l,this.v=(s+A)/l):(l=2*Math.sqrt(1+t-e-o),this.M=(r-n)/l,this.h=(i+a)/l,this.u=(s+A)/l,this.v=.25*l),this.k(),this}},{key:"setFromUnitVectors",value:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.h=-t.y,this.u=t.x,this.v=0):(this.h=0,this.u=-t.z,this.v=t.y)):(this.h=t.y*e.z-t.z*e.y,this.u=t.z*e.x-t.x*e.z,this.v=t.x*e.y-t.y*e.x),this.M=n,this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(l.clamp(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,e){var n=this.angleTo(t);return 0!==n&&(e=Math.min(1,e/n),this.slerp(t,e)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.h*=-1,this.u*=-1,this.v*=-1,this.k(),this}},{key:"dot",value:function(t){return this.h*t.h+this.u*t.u+this.v*t.v+this.M*t.M}},{key:"lengthSq",value:function(){return this.h*this.h+this.u*this.u+this.v*this.v+this.M*this.M}},{key:"length",value:function(){return Math.sqrt(this.h*this.h+this.u*this.u+this.v*this.v+this.M*this.M)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this.h=0,this.u=0,this.v=0,this.M=1):(this.h=this.h*(t=1/t),this.u=this.u*t,this.v=this.v*t,this.M=this.M*t),this.k(),this}},{key:"multiply",value:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,e){var n=t.h,i=t.u,r=t.v,o=(t=t.M,e.h),s=e.u,a=e.v;e=e.M;return this.h=n*e+t*o+i*a-r*s,this.u=i*e+t*s+r*o-n*a,this.v=r*e+t*a+n*s-i*o,this.M=t*e-n*o-i*s-r*a,this.k(),this}},{key:"slerp",value:function(t,e){if(0!==e){if(1===e)return this.copy(t);var n,i=this.h,r=this.u,o=this.v,s=this.M,a=s*t.M+i*t.h+r*t.u+o*t.v;a<0?(this.M=-t.M,this.h=-t.h,this.u=-t.u,this.v=-t.v,a=-a):this.copy(t),1<=a?(this.M=s,this.h=i,this.u=r,this.v=o):((t=1-a*a)<=Number.EPSILON?(this.M=(n=1-e)*s+e*this.M,this.h=n*i+e*this.h,this.u=n*r+e*this.u,this.v=n*o+e*this.v,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,a),a=Math.sin((1-e)*t)/n,e=Math.sin(e*t)/n,this.M=s*a+this.M*e,this.h=i*a+this.h*e,this.u=r*a+this.u*e,this.v=o*a+this.v*e),this.k())}return this}},{key:"equals",value:function(t){return t.h===this.h&&t.u===this.u&&t.v===this.v&&t.M===this.M}},{key:"fromArray",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.h=t[e],this.u=t[e+1],this.v=t[e+2],this.M=t[e+3],this.k(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.h,t[e+1]=this.u,t[e+2]=this.v,t[e+3]=this.M,t}},{key:"fromBufferAttribute",value:function(t,e){return this.h=t.getX(e),this.u=t.getY(e),this.v=t.getZ(e),this.M=t.getW(e),this}},{key:"_onChange",value:function(t){return this.k=t,this}},{key:"_onChangeCallback",value:function(){}}])&&h(e.prototype,n),i&&h(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();var p=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=n,this.z=i}var e,n;return e=t,(n=[{key:"set",value:function(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}},{key:"sub",value:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}},{key:"multiply",value:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}},{key:"applyEuler",value:function(t){return t&&t.isEuler,this.applyQuaternion(y.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,e){return this.applyQuaternion(y.setFromAxisAngle(t,e))}},{key:"applyMatrix3",value:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var e=this.x,n=this.y,i=this.z,r=1/((t=t.elements)[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this}},{key:"applyQuaternion",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=(t=t.w)*e+o*i-s*n,A=t*n+s*e-r*i,l=t*i+r*n-o*e;e=-r*e-o*n-s*i;return this.x=a*t+e*-r+A*-s-l*-o,this.y=A*t+e*-o+l*-r-a*-s,this.z=l*t+e*-s+a*-o-A*-r,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}},{key:"clampScalar",value:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}},{key:"clampLength",value:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}},{key:"lerpVectors",value:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}},{key:"cross",value:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,e){var n=t.x,i=t.y,r=(t=t.z,e.x),o=e.y;e=e.z;return this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this}},{key:"projectOnVector",value:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))}},{key:"projectOnPlane",value:function(t){return d.copy(this).projectOnVector(t),this.sub(d)}},{key:"reflect",value:function(t){return this.sub(d.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(l.clamp(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n+(t=this.z-t.z)*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}},{key:"setFromMatrixPosition",value:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=t,this}},{key:"setFromMatrixColumn",value:function(t,e){return this.fromArray(t.elements,4*e)}},{key:"setFromMatrix3Column",value:function(t,e){return this.fromArray(t.elements,3*e)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),d=new p,y=new n,m=function(t,e,n){n=n||2;var i,r,o,s,a,A=e&&e.length,l=A?e[0]*n:t.length,u=g(t,0,l,n,!0),h=[];if(u&&u.next!==u.prev){if(A&&(u=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=g(t,s=e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(function(t){for(var e=t,n=t;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),(e=e.next)!==t;);return n}(s));for(a.sort(b),r=0;r<a.length;r++)!function(t,e){(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}}while((i=i.next)!==e);if(!n)return null;if(r!==s){var A,l=n,u=n.x,h=n.y,c=1/0;for(i=n;r>=i.x&&i.x>=u&&r!==i.x&&w(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&(A=Math.abs(o-i.y)/(r-i.x),T(i,t))&&(A<c||A===c&&(i.x>n.x||i.x===n.x&&function(t,e){return B(t.prev,t,e.prev)<0&&B(e.next,t,t.next)<0}(n,i)))&&(n=i,c=A),(i=i.next)!==l;);}return n}(t,e))&&(t=C(e,t),v(e,e.next),v(t,t.next))}(a[r],n),n=v(n,n.next);return n}(t,e,u,n)),t.length>80*n){for(var c=i=t[0],f=r=t[1],p=n;p<l;p+=n)(o=t[p])<c&&(c=o),(s=t[p+1])<f&&(f=s),i<o&&(i=o),r<s&&(r=s);a=0!==(a=Math.max(i-c,r-f))?1/a:0}!function t(e,n,i,r,o,s,a){if(e){if(!a&&s){for(var A=e,l=r,u=o,h=s,c=A;null===c.z&&(c.z=x(c.x,c.y,l,u,h)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==A;);c.prevZ.nextZ=null,c.prevZ=null;var f,p,d,y,m,g,b,_,E=c,F=1;do{for(p=E,m=E=null,g=0;p;){for(g++,d=p,f=b=0;f<F&&(b++,d=d.nextZ);f++);for(_=F;0<b||0<_&&d;)0!==b&&(0===_||!d||p.z<=d.z)?(p=(y=p).nextZ,b--):(d=(y=d).nextZ,_--),m?m.nextZ=y:E=y,y.prevZ=m,m=y;p=d}}while(m.nextZ=null,F*=2,1<g)}for(var P,U,R=e;e.prev!==e.next;)if(P=e.prev,U=e.next,s?function(t,e,n,i){var r=t.prev,o=t,s=t.next;if(!(0<=B(r,o,s))){for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,A=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,u=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,h=x(a,A,e,n,i),c=x(l,u,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=c;){if(f!==t.prev&&f!==t.next&&w(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=B(f.prev,f,f.next))return;if(f=f.prevZ,p!==t.prev&&p!==t.next&&w(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=B(p.prev,p,p.next))return;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&w(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=B(f.prev,f,f.next))return;f=f.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&w(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=B(p.prev,p,p.next))return;p=p.nextZ}return 1}}(e,r,o,s):function(t){var e=t.prev,n=t,i=t.next;if(!(0<=B(e,n,i))){for(var r=t.next.next;r!==t.prev;){if(w(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=B(r.prev,r,r.next))return;r=r.next}return 1}}(e))n.push(P.i/i),n.push(e.i/i),n.push(U.i/i),O(e),e=U.next,R=U.next;else if((e=U)===R){a?1===a?t(e=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next}while(!M(r,o)&&S(r,i,i.next,o)&&T(r,o)&&T(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),O(i),O(i.next),i=t=o),(i=i.next)!==t);return v(i)}(v(e),n,i),n,i,r,o,s,2):2===a&&function(e,n,i,r,o,s){var a=e;do{for(var A,l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&S(n,n.next,t,e))return 1}while((n=n.next)!==t)}(t,e)&&(T(t,e)&&T(e,t)&&function(t,e){for(var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!==t;);return i}(t,e)&&(B(t.prev,t,e.prev)||B(t,e.prev,e))||M(t,e)&&0<B(t.prev,t,t.next)&&0<B(e.prev,e,e.next))}(a,l))return A=C(a,l),a=v(a,a.next),A=v(A,A.next),t(a,n,i,r,o,s),t(A,n,i,r,o,s);l=l.next}}while((a=a.next)!==e)}(e,n,i,r,o,s):t(v(e),n,i,r,o,s,1);break}}}(u,h,n,c,f,a)}return h};function g(t,e,n,i,r){var o,s;if(r===0<function(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}(t,e,n,i))for(o=e;o<n;o+=i)s=F(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=F(o,t[o],t[o+1],s);return s&&M(s,s.next)&&(O(s),s=s.next),s}function v(t,e){if(!t)return t;e=e||t;var n,i=t;do{if(n=!1,i.steiner||!M(i,i.next)&&0!==B(i.prev,i,i.next))i=i.next;else{if(O(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function b(t,e){return t.x-e.x}function x(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function w(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function B(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function M(t,e){return t.x===e.x&&t.y===e.y}function S(t,e,n,i){var r=E(B(t,e,n)),o=E(B(t,e,i)),s=E(B(n,i,t)),a=E(B(n,i,e));return r!==o&&s!==a||0===r&&_(t,n,e)||0===o&&_(t,i,e)||0===s&&_(n,t,i)||!(0!==a||!_(n,e,i))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function E(t){return 0<t?1:t<0?-1:0}function T(t,e){return B(t.prev,t,t.next)<0?0<=B(t,e,t.next)&&0<=B(t,t.prev,e):B(t,e,t.prev)<0||B(t,t.next,e)<0}function C(t,e){var n=new P(t.i,t.x,t.y),i=new P(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function F(t,e,n,i){return t=new P(t,e,n),i?(t.next=i.next,(t.prev=i).next.prev=t,i.next=t):(t.prev=t).next=t,t}function O(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function U(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?R(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var I={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return I.area(t)<0},triangulateShape:function(t,e){var n=[],i=[],r=[],o=(L(t),D(n,t),t.length);e.forEach(L);for(var s=0;s<e.length;s++)i.push(o),o+=e[s].length,D(n,e[s]);for(var a=m(n,i),A=0;A<a.length;A+=3)r.push(a.slice(A,A+3));return r},triangulate:function(t){(r=[]).push.apply(r,U(t[0]));for(var e=[],n=1;n<t.length;n++){var i=[];i.push.apply(i,U(t[n])),e.push(i)}if(!I.isClockWise(r))for(var r=r.reverse(),o=0,s=e.length;o<s;o++){var a=e[o];I.isClockWise(a)&&(e[o]=a.reverse())}return I.triangulateShape(r,e)}};function L(t){var e,n=t.length;2<n&&(n=t[n-1],e=t[0],n.x===e.x)&&n.y===e.y&&t.pop()}function D(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Q(t=function(t,e){if("object"!==Q(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Q(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var N=1e-5,j=.001,H=Math.PI/180,z=180/Math.PI;n=function(t,e,n){return e&&k(t.prototype,e),n&&k(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(n.prototype,{g:function(){return N},_:function(){return H},S:function(){return z},j:function(t){return t<N&&-N<t},T:function(t){return N<t},O:function(t){return t<-N},P:function(t,e,n){return e=(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y),Math.abs(e)<N?0:e},distanceOfTwoPoints:function(t,e){return t&&e?Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)):Number.NaN},distance:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},isPolygonContainPoint:function(t,e){for(var n=0,i=0;i<t.length;i++){var r=t[i].x,o=t[i].y,s=0,a=(i<t.length-1?(s=t[i+1].x,t[i+1]):(s=t[0].x,t[0])).y;if(r===e.x&&o===e.y||s===e.x&&a===e.y)return!0;if(a!==o){var A=r+(e.y-o)*(s-r)/(a-o);if(A===e.x)return!0;r!==s?A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&A!==r&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++):A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++)}}return 0<n%2},C:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y))},D:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y)||0===this.P(n,e,t)&&0===this.P(e,i,t)||this.P(n,e,t)*this.P(e,i,t)<0||this.P(t,i,n)*this.P(i,e,n)<0)},A:function(t,e,n){return!(t.x<e.x||t.y<e.y||t.x>n.x||t.y>n.y)},I:function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y);e=Math.max(e.y,n.y);return!(t.x<i||t.x>r||t.y<o||t.y>e)},V:function(t,e,n){var i=Math.min(n.x,e.x),r=Math.max(n.x,e.x),o=Math.min(n.y,e.y);n=Math.max(n.y,e.y);return!(t.x<i||t.x>r||t.y<o||t.y>n)},L:function(t,e,n){for(var i,r,o=!1,s=0;s<n;s++)i=e[s],r=e[(s+1)%n],(i.y<t.y&&r.y>=t.y||r.y<t.y&&i.y>=t.y)&&(i.x<=t.x||r.x<=t.x)&&i.x+(t.y-i.y)/(r.y-i.y)*(r.x-i.x)<t.x&&(o=!o);return o},R:function(t,e,n){return(t.x-e.x)*(n.y-e.y)==(n.x-e.x)*(t.y-e.y)&&Math.min(e.x,n.x)<=t.x&&t.x<=Math.max(e.x,n.x)&&Math.min(e.y,n.y)<=t.y&&t.y<=Math.max(e.y,n.y)},F:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},Z:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)},N:function(t,e,n){var i=e.x,r=(e=e.y,n.x),o=(n=n.y,t.x),s=r-i,a=n-e,A=s*s+a*a,l=o-i,u=(t=t.y)-e,h=l*l+u*u;return this.j(A)?this.j(h)?0:h:(A=Math.sqrt(A),u=this.T(a=(s/=A)*l+(l=a/A)*u)?this.O(a-A)?(u=o-(i+a*s))*u+(A=t-(e+a*l))*A:(i=o-r)*i+(s=t-n)*s:h,this.j(u)?0:u)},Y:function(t,e,n,i){var r,o=e.x,s=e.y,a=n.x,A=n.y,l=t.x,u=(t=t.y,a-o),h=A-s,c=Math.sqrt(u*u+h*h),f=l-o,p=t-s,d=Math.sqrt(f*f+p*p);return this.j(c)?(i.x=e.x,i.y=e.y,this.j(r=d)?0:r):(r=this.T(h=(u/=c)*f+(f=h/c)*p)?this.O(h-c)?(c=l-(p=o+h*u),u=t-(o=s+h*f),s=Math.sqrt(c*c+u*u),i.x=p,i.y=o,s):(h=l-a,f=t-A,c=Math.sqrt(h*h+f*f),i.x=n.x,i.y=n.y,c):(i.x=e.x,i.y=e.y,d),this.j(r)?0:r)},X:function(t,e){for(var n=0,i=0,r=0,o=0;o<e;o++){var s=t[o],a=t[(o+1)%e],A=(s.x*a.y-s.y*a.x)/2;n+=A,i+=A*(s.x+a.x)/3,r+=A*(s.y+a.y)/3}return{x:i/=n,y:r/=n}},H:function(t){for(var e=I.triangulate([t]),n=0,i=0,r=0,o=0;o<e.length;o++){var s=t[e[o][0]],a=t[e[o][1]],A=t[e[o][2]],l=a.x-s.x,u=a.y-s.y,h=A.x-s.x;n+=l=(l*(A.y-s.y)-h*u)/2,i+=(s.x+a.x+A.x)/3*l,r+=(s.y+a.y+A.y)/3*l}return{x:i/n,y:r/n}},U:function(t,e){if(e<3)return 0;for(var n=0,i=0;i<e;++i){var r=t[i],o=t[(i+1)%e];n+=r.x*o.y-r.y*o.x}return Math.abs(n/2)},q:function(t,e,n,i,r){var o,s;return this.D(t,e,n,i)?(o=(i.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-i.y),s=(t.y-n.y)*(e.x-t.x)*(i.x-n.x)+n.x*(i.y-n.y)*(e.x-t.x)-t.x*(e.y-t.y)*(i.x-n.x),r.x=s/o,o=(t.x-e.x)*(i.y-n.y)-(e.y-t.y)*(n.x-i.x),s=e.y*(t.x-e.x)*(i.y-n.y)+(i.x-e.x)*(i.y-n.y)*(t.y-e.y)-i.y*(n.x-i.x)*(e.y-t.y),r.y=s/o,1):0},B:function(t,e,n,i,r){var o=Math.min(n.x,i.x),s=Math.max(n.x,i.x),a=Math.min(n.y,i.y),A=Math.max(n.y,i.y),l=t.x,u=t.y,h=n.x,c=n.y,f=i.x,p=i.y;if(90==e)return!(t.x<o||t.x>s||(Math.abs(s-o<j)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.x<c?(r.x=h,r.y=c,0):!(p<c&&t.x<p)||(r.x=f,r.y=p,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,d<u||!this.V(r,n,i))));if(270==e)return!(t.x<o||t.x>s||(Math.abs(s-o<j)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.y>p?(r.x=f,r.y=p,0):!(p<c&&t.y>c)||(r.x=h,r.y=c,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,u<d||!this.V(r,n,i))));if(270!=e&&90!=e&&Math.abs(s-o<j)){t=o;var d=Math.tan(e/180*Math.PI)*(t-l)+u;if(r.y=d,r.x=t,this.V(r,n,i))return s=d-u,0<(o=t-l)/Math.sqrt(o*o+s*s)*Math.cos(e/180*Math.PI)}return Math.abs(A-a<=j)?(d=a,t=1/Math.tan(e/180*Math.PI)*(d-u)+l,r.x=t,r.y=d,!!this.V(r,n,i)&&(o=d-u,0<(s=t-l)/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI))):(t=u+(A=Math.tan(e/180*Math.PI))*((d=(c-u-((a=(p-c)/(f-h))*h-A*l))/(A-a))-l),r.x=d,r.y=t,!!this.V(r,n,i)&&(s=d-l,o=t-u,Math.abs(s)<=j&&Math.abs(o)<=j||0<s/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI)))},G:function(t,e){return Math.abs(t.x-e.x)<N&&Math.abs(t.y-e.y)<N},W:function(t,e,n,i){var r,o,s,a,A=t.x,l=t.y,u=e.x,h=e.y,c=n.x,f=n.y;return this.G(t,e)||this.G(t,n)?(i.x=A,i.y=l,!0):(s=Math.min(e.x,n.x),a=Math.max(e.x,n.x),r=Math.min(e.y,n.y),o=Math.max(e.y,n.y),Math.abs(u-c)<1e-5?(i.x=u,r<=(i.y=l)&&l<=o):Math.abs(h-f)<1e-5?(i.x=A,i.y=h,s<=A&&A<=a):(a=l+(r=-1/((f-h)/(c-u)))*((s=(h-l-((o=(f-h)/(c-u))*u-r*A))/(r-o))-A),i.x=s,i.y=a,!!this.V(i,e,n)||!(!this.G(t,e)&&!this.G(t,n))))},K:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}},$:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},J:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},tt:function(t,e){return t.x*e.x+t.y*e.y},it:function(t,e){return t.x*e.y-t.y*e.x},nt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},et:function(t,e){var n,i;return 0==t.x&&0==t.y||0==e.x&&0==e.y?0:(n={x:t.x,y:t.y,z:0},i={x:e.x,y:e.y,z:0},n=this.K(n,i),i=this.tt(t,e),i=Math.acos(i/(this.nt(t)*this.nt(e))),0<n.z?i/Math.PI*180:360-i/Math.PI*180)},rt:function(t,e,n,i){for(var r=0;r<n.length;r++){var o=n[r],s=n[(r+1)%n.length];if(1==this.q(t,e,o,s,i))return!0}return!1},st:function(t,e,n,i,r){var o=Math.min(t.x,n.x,i.x),s=Math.max(t.x,n.x,i.x),a=Math.min(t.y,n.y,i.y),A=Math.max(t.y,n.y,i.y);s=Math.sqrt((s-o)*(s-o)+(A-a)*(A-a)),o=e/180*Math.PI,A=s*Math.cos(o)+t.x,a=s*Math.sin(o)+t.y;return 1==this.q(t,{x:A,y:a},n,i,r)},ht:function(t){for(var e={x:null,y:null},n=0,i=0,r=0;r<t.length;r++)n+=t[r].x,i+=t[r].y;return e.x=n/t.length,e.y=i/t.length,e},ut:function(t,e,n,i){var r=[],o=t.x-e,s=t.x+e,a=t.y-e,A=t.y+e,l=Math.min(n.x,i.x),u=Math.max(n.x,i.x),h=Math.min(n.y,i.y),c=Math.max(n.y,i.y);return u<o||s<l||c<a||A<h||(o=i.x-n.x,s=i.y-n.y,(a=(t=(o*(a=t.x-n.x)+s*(A=t.y-n.y))/(i=o*o+s*s))*t-(a*a+A*A-e*e)/i)<0)||(A=Math.sqrt(a),i={x:n.x-o*(e=-t+A),y:n.y-s*e},o={x:n.x-o*(a=-t-A),y:n.y-s*a},e!==a&&(l<=i.x&&i.x<=u&&h<=i.y&&i.y<=c&&r.push(i),l<=o.x)&&o.x<=u&&h<=o.y&&o.y<=c&&r.push(o)),r},ot:function(t,e,n){var i,r={};if(t.x!=e.x)return i=e=(e.y-t.y)/(e.x-t.x),e=t.y-e*t.x,r.x=(+n.x- -1*i*n.y-i*e)/(i*i+1),r.y=(i*i*n.y- -1*i*n.x- -1*e)/(i*i+1),r;r.x=t.x,r.y=n.y},ct:function(t,e,n,i){var r,o,s,a,A={point:null,isintersect:!1};return t==n||t==i?(A.isintersect=!0,A.point=t):e==n||e==i?(A.isintersect=!0,A.point=e):(r={x:e.x-t.x,y:e.y-t.y},o={x:i.x-n.x,y:i.y-n.y},s={x:n.x-t.x,y:n.y-t.y},i={x:i.x-t.x,y:i.y-t.y},e={x:e.x-n.x,y:e.y-n.y},n={x:-s.x,y:-s.y},a=this.it(o,r),Math.abs(a)<=1e-5||this.it(s,r)*this.it(i,r)<=5e-4&&this.it(n,o)*this.it(e,o)<5e-4&&(i=this.it(o,s)/a,A.point={x:t.x+r.x*i,y:t.y+r.y*i},A.isintersect=!0)),A},lt:function(t,e,n){t.x===e.x&&(e.x=e.x+1),t.y===e.y&&(e.y=e.y+1),e.x===n.x&&(n.x=n.x+1),e.y===n.y&&(n.y=n.y+1);var i=e.x-t.x,r=(t=e.y-t.y,n.x-e.x);return!(0<i*(n.y-e.y)-t*r)},getAngle:function(t){var e=t.p1,n=(t=t.p2).x-e.x;t=t.y-e.y,e=Math.sqrt(n*n+t*t),e=Math.asin(Math.abs(t)/e);return 0<n&&0<t?e:n<0&&0<t?Math.PI-e:n<0&&t<0?Math.PI+e:0<n&&t<0?2*Math.PI-e:0==n&&0<t?e:0==n&&t<0?3*Math.PI/2:0<n&&0==t?e:n<0&&0==t?Math.PI:null},ft:function(t){var e=this.distanceOfTwoPoints(t[0],t[1]),n=this.distanceOfTwoPoints(t[1],t[2]),i=(e+n+(t=this.distanceOfTwoPoints(t[0],t[2])))/2;return Math.sqrt(i*(i-e)*(i-n)*(i-t))},vt:function(t,e){var n,i,r,o,s;return this.Y(t,e[0],e[1],{})<1e-4||this.Y(t,e[0],e[2],{})<1e-4||this.Y(t,e[1],e[2],{})<1e-4||(o={x:e[1].x-e[0].x,y:e[1].y-e[0].y},n={x:e[0].x-e[2].x,y:e[0].y-e[2].y},i={x:e[2].x-e[1].x,y:e[2].y-e[1].y},s={x:t.x-e[0].x,y:t.y-e[0].y},r={x:t.x-e[1].x,y:t.y-e[1].y},t={x:t.x-e[2].x,y:t.y-e[2].y},e=this.it(o,s),o=this.it(i,r),s=this.it(n,t),N<e*o&&N<o*s)},yt:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null,type:0,outer:null},o=[];if(this.vt(t,n)&&(r.start=t),this.vt(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0,r.type=1;else{for(var s=(n[1].x+n[2].x)/2,a=(n[1].y+n[2].y)/2,A=1;A<i;A++){var l,u=this.ct(t,e,n[A-1],n[A]);if(u.isintersect){if(null!=r.start)return r.end=u.point,r.isintersect=!0,r.outer="end",l=this.et({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;if(null!=r.end)return r.start=u.point,r.isintersect=!0,r.outer="start",l=this.et({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;o.push(u)}}var h,c=this.ct(t,e,n[0],n[i-1]);if(c.isintersect){if(null!=r.start)return r.end=c.point,r.isintersect=!0,r.outer="end",h=this.et({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;if(null!=r.end)return r.start=c.point,r.isintersect=!0,r.outer="start",h=this.et({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;o.push(c)}2!=o.length||this.distanceOfTwoPoints(o[0].point,o[1].point)<.01||(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?(r.start=o[0].point,r.end=o[1].point):(r.start=o[1].point,r.end=o[0].point),r.isintersect=!0,r.type=4)}return r},Mt:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null},o=[];if(this.vt(t,n)&&(r.start=t),this.vt(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0;else{for(var s=1;s<i;s++){var a=this.ct(t,e,n[s-1],n[s]);if(a.isintersect){if(null!=r.start)return r.end=a.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(a)}}var A=this.ct(t,e,n[0],n[i-1]);if(A.isintersect){if(null!=r.start)return r.end=A.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(A)}2==o.length&&(r.start=(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.end=(this.distanceOfTwoPoints(o[0].point,t)>this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.isintersect=!0)}return r},dt:function(t,e){if(0==e.length)return[t];var n,i,r=this.kt(e),o=[],s=(r.sort(function(e,n){var i=(e.bt.x-t.bt.x)*(e.bt.x-t.bt.x)+(e.bt.y-t.bt.y)*(e.bt.y-t.bt.y),r=(n.bt.x-t.bt.x)*(n.bt.x-t.bt.x)+(n.bt.y-t.bt.y)*(n.bt.y-t.bt.y);e=(e.gt.x-t.bt.x)*(e.gt.x-t.bt.x)+(e.gt.y-t.bt.y)*(e.gt.y-t.bt.y),n=(n.gt.x-t.bt.x)*(n.gt.x-t.bt.x)+(n.gt.y-t.bt.y)*(n.gt.y-t.bt.y);return(i<e?i:e)<(r<n?r:n)}),0);for(s=0;s<r.length;s++)this.distanceOfTwoPoints(r[s].bt,r[s].gt)<.01||(n=this.distanceOfTwoPoints(r[s].bt,t.bt),i=this.distanceOfTwoPoints(r[s].gt,t.bt),n<.01?t.bt=r[s].gt:i<.01?t.bt=r[s].bt:n<i?.1<this.distanceOfTwoPoints(t.bt,r[s].bt)&&(o.push({wt:t.wt,bt:t.bt,gt:r[s].bt,F:t.F,_t:t._t}),t.bt=r[s].gt):.1<this.distanceOfTwoPoints(t.bt,r[s].gt)&&(o.push({wt:t.wt,bt:t.bt,gt:r[s].gt,F:t.F,_t:t._t}),t.bt=r[s].bt),r.splice(s,1));return.1<this.distanceOfTwoPoints(t.bt,t.gt)&&o.push(t),o},kt:function(t){var e=[];if(1==t.length)return t;for(var n=t[0],i=1;0<t.length;){if(i>=t.length){if(e.push(n),t.splice(0,1),t.length<1)break;n=t[0],i=1}if(1===t.length){e.push(n);break}this.St(n.bt,n.gt,t[i].bt)?(this.St(n.bt,n.gt,t[i].gt)||(n.gt=t[i].gt),t.splice(i,1)):this.St(n.bt,n.gt,t[i].gt)?(n.bt=t[i].bt,t.splice(i,1)):this.St(t[i].bt,t[i].gt,n.bt)?(this.St(t[i].bt,t[i].gt,n.gt)||(t[i].gt=n.gt),n=t[i],t.splice(i,1)):this.St(t[i].bt,t[i].gt,n.gt)?(t[i].bt=n.bt,n=t[i],t.splice(i,1)):i++}return e},St:function(t,e,n){var i=t.x-n.x,r=t.y-n.y,o=e.x-n.x,s=e.y-n.y,a=this.distanceOfTwoPoints(t,n);n=this.distanceOfTwoPoints(e,n),t=this.distanceOfTwoPoints(t,e);return i*s-r*o<1e-5&&a+n-t<.001}});var V=new n;function G(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function Y(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?G(Object(n),!0).forEach(function(e){K(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function K(t,e,n){return(e=Z(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Z(i.key),i)}}function Z(t){return"symbol"===X(t=function(t,e){if("object"!==X(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==X(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}var q=window.fengmap,J=(n=function(){function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xt=void 0===n.autoConnectBuilding||n.autoConnectBuilding,this.Et=e,this.jt=!1,this.Tt=null,this.Ot=0,this.Pt=0,this.Ct=0,this.Dt=[],this.At=[],this.It=0,this.Vt=0,this.Lt=1,this.Rt=null,this.Ft=null,this.Zt=0,this.Nt=0,this.Yt=null,this.Xt=null,this.zt=!1,this.Ht=null,this.Ut=null,this.qt=-1,this.Qt=new Map,this.Bt={playing:"playing",complete:"complete"},this.Gt=!0,this.Wt=-1,this.Kt=0,this.$t=0,this.Jt(),this.ti=new Map,this.ii=this.ii.bind(this),this.ni=this.ni.bind(this),this.Et.on("levelChanged",this.ii),this.Et.on("visibleLevelsLoaded",this.ii),this.xt&&this.Et.on("buildingLoaded",this.ni)}var e,n;return e=t,(n=[{key:"setSpeed",value:function(t){this.Lt=t}},{key:"setTracks",value:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];this.ei(t),this.Ut=t,this.ri(e)}},{key:"getMarker",value:function(t){return t===q.FMType.LINE_MARKER?this.Ft:this.Rt}},{key:"getTrackInfo",value:function(){return{totalLength:+this.Zt.toFixed(3),totalTimes:+this.Nt.toFixed(3)}}},{key:"setProgress",value:function(t){for(var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=new Date(t).getTime(),i=-1,r=0;r<this.Ut.length;r++){if(this.Ut[r].timestamp==n){i=r;break}if(this.Ut[r].timestamp>n){i=r-1;break}}-1!==i&&(this.Yt=null,this.Xt=null,this.It=i,this.Pt=this.At[i],this.Ct=this.si[i],this.Ot=n-this.Ut[0].timestamp,this.Yt=new p(this.Ut[i].x,this.Ut[i].y,this.Ut[i].absoluteZ),this.Vt=n,this.ri(e))}},{key:"play",value:function(){this.jt=!0,this.Tt=null,this.It}},{key:"pause",value:function(){this.jt=!1}},{key:"stop",value:function(){this.jt=!1,this.setProgress(this.Ut[this.Ut.length-1].time)}},{key:"start",value:function(){this.setProgress(this.Ut[0].time)}},{key:"render",value:function(){!0!==this.zt&&(this.zt=!0,this.hi(),this.ui())}},{key:"clear",value:function(){0!=this.zt&&(this.Ft&&this.Ft.remove(this.Et),this.zt=!1,this.Rt)&&this.Rt.parent&&this.Rt.remove()}},{key:"on",value:function(t,e){this.Qt.set(t,e)}},{key:"setMarkerStyle",value:function(t,e){this.Ht&&this.Rt&&this.Rt.parent&&this.Rt.remove(),this.Ht=Object.assign({},e,{type:t}),this.Rt=this.ai(this.Ht),this.ui()}},{key:"setTrackStyle",value:function(t){this.oi=t,this.$t=t.height||0;var e=this.ci(this.Ut,this.$t);e=this.li(e);this.Ft=new q.FMLineMarker({color:t.color,width:t.width,animate:t.animate,smooth:!1,segments:e,url:t.url,type:t.type,borderColor:t.borderColor,depth:t.depth,zFighting:void 0===t.zFighting||t.zFighting}),this.hi(),this.Ft.getLineNodes||1!=this.Gt||(this.Gt=!1)}},{key:"dispose",value:function(){this.Et.off("levelChanged",this.ii),this.Et.off("visibleLevelsLoaded",this.ii),this.xt&&this.Et.off("buildingLoaded",this.ni),window.cancelAnimationFrame(this.qt),this.clear(),this.Ft&&this.Ft.dispose(),this.Rt&&this.Rt.parent&&this.Rt.dispose(),this.Ft=null,this.Rt=null,this.Yt=null,this.Ut=null,this.Et=null,this.Dt=null,this.At=null,this.Ht=null}}])&&W(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Object.assign(n.prototype,{ni:function(t){var e=this.ti.get(t.buildingID);e&&!e.hasProcess&&(this.ti.set(t.buildingID,{hasProcess:!0}),this.ii(),e=this.ci(this.Ut,this.$t),t=this.li(e),this.Ft)&&(this.Ft.segments=t)},ii:function(){this.Ut&&(this.setTracks(this.Ut,!1),this.setProgress(this.Vt,!1))},fi:function(){return this.Gt},hi:function(){0!=this.zt&&null!==this.Ft&&(this.Ft&&this.Ft.addTo(this.Et),this.vi())},yi:function(){var t=this.Ut[this.It].level,e=this.Mi(this.Ut[this.It].buildingID);return{floor:this.Et.getBuilding(e).getFloor(t),buildingID:e,level:t}},ui:function(){var t;0!=this.zt&&(t=this.yi().floor,this.Ht.type===q.FMType.LOCATION_MARKER?this.Rt.addTo(this.Et):this.Rt.addTo(t),this.Ht.type!=q.FMType.DYNAMIC_MODEL_MARKER)&&this.di()},ai:function(t){var e=this,n=t.type,i=t.size,r=t.scale,o=t.url,s=t.height,a=(s=(this.Kt=s||0,K(K(K(K({},q.FMType.LOCATION_MARKER,q.FMLocationMarker),q.FMType.DYNAMIC_MODEL_MARKER,q.FMDynamicModel),q.FMType.IMAGE_MARKER,q.FMImageMarker),q.FMType.DOM_MARKER,q.FMDomMarker)),null),A=null;if(s=(null!=this.Ut&&(a=this.Ut[0].level,A=this.Ut[0].buildingID),s[n]))return r=K(K(K(K({},q.FMType.IMAGE_MARKER,{url:o,size:i,x:0,y:0}),q.FMType.DYNAMIC_MODEL_MARKER,{url:o,scale:r,x:0,y:0,callback:function(){e.di()}}),q.FMType.LOCATION_MARKER,{url:o,size:i,x:0,y:0,level:a,buildingID:A}),q.FMType.DOM_MARKER,{x:0,y:0}),new s(Object.assign(r[n],t))},vi:function(){var t,e;this.Ft&&(t=(e=this.ki()).p,e=e.pNoGap,this.fi()?this.mi(t):this.Ft.moveProportion(e))},pi:function(){var t,e=this.yi().floor;if(e)return(t={x:this.Yt.x,y:this.Yt.y,z:this.Yt.z}).z-=e.height,t},di:function(){var t,e,n,i;this.Rt&&this.zt&&(t=(i=this.yi()).buildingID,e=i.level,i=i.floor)&&(n=this.pi(),i=this.Ht.type==q.FMType.LOCATION_MARKER?this.Et:i,this.Rt.level!=e&&(this.Rt.parent&&this.Rt.remove(),this.Rt.addTo(i)),this.Rt.moveTo({x:n.x,y:n.y,animate:!1,level:e,buildingID:t}),this.Rt.height=n.z+this.Kt)},bi:function(t,e){var n=this.Qt.get(t);this.Bt.playing===t&&!0===this.jt?n&&n(e):this.Bt.playing!==t&&n&&n(e)},gi:function(){this.di()},ki:function(){return{p:this.Pt/this.Zt,pNoGap:this.Ct/this.wi}},_i:function(){var t=this.Ot/this.Nt;return Math.min(+t.toFixed(t,3),1)},Si:function(t,e,n){t=new p(t.x,t.y,t.absoluteZ),e=new p(e.x,e.y,e.absoluteZ),t=t.lerp(e,n),null==this.Yt&&(this.Yt=t.clone()),this.Pt+=t.distanceTo(this.Yt),this.Yt.set(t.x,t.y,t.z)},xi:function(t,e,n){var i=new p(t.x,t.y,t.relativeZ),r=new p(e.x,e.y,e.relativeZ);i=i.lerp(r,n);null==this.Xt&&(this.Xt=i.clone()),t.level===e.level&&(this.Ct+=this.Xt.distanceTo(i)),this.Xt.set(i.x,i.y,i.z)},ri:function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],e=this.Ut[this.It],n=this.Ot-this.Dt[this.It],i=(e=e.nextPointTimeGap,-1);if(0==n&&null!=e)i=0;else{if(null==e)return 0==this.jt?(r=this.Ut[this.It],t&&this.bi(this.Bt.playing,{progress:this.Ut[this.It].timestamp,level:this.Ut[this.It].level,buildingID:this.Ut[this.It].buildingID,index:this.It,position:{x:r.x,y:r.y,z:r.z}}),t&&this.bi(this.Bt.complete),null==this.Yt&&(this.Yt=new p(0,0,0)),this.Yt.set(r.x,r.y,r.absoluteZ),this.gi(),this.vi()):t&&this.bi(this.Bt.complete),void(this.jt=!1);i=n/e}i=Math.min(i,1);var r=this.Ut[this.It];t=this.Ut[this.It+1],this.Si(r,t,i),this.xi(r,t,i),this.gi(),this.vi(),1<=i&&(this.It+=1),n=r.timestamp,e=t.timestamp;this.Vt=Number.parseInt(l.lerp(n,e,i)),this.bi(this.Bt.playing,{progress:this.Vt,level:this.Ut[this.It].level,buildingID:this.Ut[this.It].buildingID,index:this.It,position:{x:this.Yt.x,y:this.Yt.y,z:this.Yt.z}})},Jt:function(){var t,e;this.qt=window.requestAnimationFrame(this.Jt.bind(this)),this.jt&&(null==this.Tt&&(this.Tt=(new Date).getTime()),e=(t=(new Date).getTime())-this.Tt,e*=this.Lt,this.Tt=t,this.Ot+=e,this.ri())},ci:function(t,e){for(var n=[],i=-1,r=-1,o={groupId:-1,points:[]},s=0;s<t.length;s++){var a=(h=t[s]).x,A=h.y,l=h.z,u=h.level,h=h.buildingID;i===u&&r===h||(0<o.points.length&&n.push(o),o={groupId:u,buildingID:h,points:[]},i=u,r=h),o.points.push({x:a,y:A,z:l+e}),s===t.length-1&&n.push(o)}return n},Ei:function(t,e,n,i,r){return(r-t)/(e-t)*(i-n)+n},li:function(t){for(var e=[],n=0;n<t.length;n++){var i=(o=t[n]).groupId,r=o.points,o=o.buildingID,s=new q.FMSegment;s.level=i,s.points=r,s.buildingID=o,e.push(s)}return e},ji:function(t){for(var e=this.Ut,n=-1,i=1;i<=e.length-1;i++)t>=this.Dt[i-1]&&t<this.Dt[i]&&(n=i-1);return n},Ti:function(t,e){var n=-1,i=-1,r=-1,s=e[t-1];s&&s.timestamp&&(n=t-1);for(var a,A,l,u=t+1;u<e.length;u++){var h=e[u];if(h&&h.time){i=u;break}}return-1!==i&&-1!==n&&(s=e[n].timestamp,a=new Date(e[i].time).getTime()-s,l=new o(e[n].x,e[n].y),t=new o(e[t].x,e[t].y),A=new o(e[i].x,e[i].y),r=(l=t.distanceTo(l))/(l+t.distanceTo(A))*a+s),-1===(r=-1===r&&-1!==i?new Date(e[i].time).getTime():r)&&-1!==n?e[n].timestamp:r},Oi:function(t,e,n){var i=new Date(t.time).getTime(),r=new Date(n.time).getTime()-i;t=new o(t.x,t.y),e=new o(e.x,e.y),n=new o(n.x,n.y);return(t=e.distanceTo(t))/(t+e.distanceTo(n))*r+i},ei:function(t){this.Dt=[],this.Nt=0,this.At=[],this.si=[],this.Zt=0;for(var e=t[this.wi=0].buildingID,n=t.length,i=0;i<n;i++){void 0===t[i].z&&(t[i].z=0);var r,o,s=(o=t[i]).time,a=o.level;if(!(s=((o=o.buildingID)&&this.ti.set(o,{}),t[i].timestamp=new Date(s).getTime(),!isNaN(t[i].timestamp)&&0!==t[i].timestamp||(t[i].timestamp=this.Ti(i,t)),this.Et.getBuilding(this.Mi(o)).getFloor(a))))return;t[i].absoluteZ=t[i].z+s.height,t[i].relativeZ=t[i].z,e!==o&&this.xt&&(a=Y({},t[i-1]),s=Y({},t[i]),r=t[i-1].buildingID?i-1:i,r=null==(r=this.Et.getBuilding(this.Mi(t[r].buildingID)).getFloor(t[r].level).getLayers(q.FMType.EXTENT_LAYER)[0])||null==(r=r.getFeatures()[0])?void 0:r.coordinates[0])&&V.rt(a,s,r,r={})&&(t.splice(i,0,Y(Y({},a),{},{x:r.x,y:r.y,timestamp:this.Oi(a,r,s)})),t.splice(i+1,0,Y(Y({},s),{},{x:r.x,y:r.y,timestamp:this.Oi(a,r,s)})),n+=2,i+=2),e=o}for(var A=new p(t[0].x,t[0].y,t[0].absoluteZ),l=new p(t[0].x,t[0].y,t[0].relativeZ),u=-1,h=0;h<t.length-1;h++){var c=t[h].level,f=new p(t[h].x,t[h].y,t[h].absoluteZ),d=new p(t[h].x,t[h].y,t[h].relativeZ);this.Zt+=f.clone().distanceTo(A),(u=-1==u?c:u)==c&&(this.wi+=d.clone().distanceTo(l)),u=c,t[h].nextPointTimeGap=t[h+1].timestamp-t[h].timestamp,t[h].nextPointTimeGap<0&&(t[h].nextPointTimeGap=0),this.Dt[h]=this.Nt,this.Nt+=t[h].nextPointTimeGap,this.At[h]=this.Zt,this.si[h]=this.wi,A.copy(f),l.copy(d)}var y=(t[m=t.length-1].nextPointTimeGap=void 0,this.Dt[m]=this.Nt,new p(t[m].x,t[m].y,t[m].absoluteZ)),m=new p(t[m].x,t[m].y,t[m].relativeZ);this.Zt+=y.distanceTo(A),this.wi+=m.distanceTo(l),this.At[t.length-1]=this.Zt,this.si[t.length-1]=this.wi},mi:function(t){for(var e=this.Ft.getLineNodes(),n=0,i=e.length-1;-1<i;i--)n+=e[i].seg.length;for(var r=0,o=e.length-1;-1<o;o--){var s=r/n,a=(r+=e[o].seg.length)/n;a<t?e[o].line.material.uniforms.miny.value=1:t<=a&&(e[o].line.material.uniforms.miny.value=(t-s)/(a-s))}},Mi:function(t){return null==t||""===t?this.Et.getMapOptions().buildingID:t}}),"v3.1.4"),$=window.fengmap||{};$.VERSION=J,$.BUILD=70,$.FMTracksPlayer=n,e.default=$}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"Pi",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.Pi)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.Pi?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=0).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()},Ya8g:function(t,e){},bYmx:function(module,exports,__webpack_require__){var r;r=function(__WEBPACK_EXTERNAL_MODULE__47__){return function(t){var e={};function n(i){var r;return(e[i]||(r=e[i]={i:i,l:!1,exports:{}},t[i].call(r.exports,r,r.exports,n),r.l=!0,r)).exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"u",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.u)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.u?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=50)}([function(t,e,n){"use strict";var i,r,o=t.exports=n(2),s=n(16),a=(o.codegen=n(40),o.fetch=n(41),o.path=n(42),o.fs=o.inquire("fs"),o.toArray=function(t){if(t){for(var e=Object.keys(t),n=new Array(e.length),i=0;i<e.length;)n[i]=t[e[i++]];return n}return[]},o.toObject=function(t){for(var e={},n=0;n<t.length;){var i=t[n++],r=t[n++];void 0!==r&&(e[i]=r)}return e},/\\/g),A=/"/g,l=(o.isReserved=function(t){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(t)},o.safeProp=function(t){return!/^[$\w_]+$/.test(t)||o.isReserved(t)?'["'+t.replace(a,"\\\\").replace(A,'\\"')+'"]':"."+t},o.ucFirst=function(t){return t.charAt(0).toUpperCase()+t.substring(1)},/_([a-z])/g),u=(o.camelCase=function(t){return t.substring(0,1)+t.substring(1).replace(l,function(t,e){return e.toUpperCase()})},o.compareFieldsById=function(t,e){return t.id-e.id},o.decorateType=function(t,e){return t.$type?(e&&t.$type.name!==e&&(o.decorateRoot.remove(t.$type),t.$type.name=e,o.decorateRoot.add(t.$type)),t.$type):(e=new(i=i||n(18))(e||t.name),o.decorateRoot.add(e),e.ctor=t,Object.defineProperty(t,"$type",{value:e,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:e,enumerable:!1}),e)},0);o.decorateEnum=function(t){var e;return t.$type||(e=new(r=r||n(3))("Enum"+u++,t),o.decorateRoot.add(e),Object.defineProperty(t,"$type",{value:e,enumerable:!1}),e)},o.setProperty=function(t,e,n){if("object"!=typeof t)throw TypeError("dst must be an object");if(e)return function t(e,n,i){var r=n.shift();return"__proto__"!==r&&"prototype"!==r&&(0<n.length?e[r]=t(e[r]||{},n,i):((n=e[r])&&(i=[].concat(n).concat(i)),e[r]=i)),e}(t,e=e.split("."),n);throw TypeError("path must be specified")},Object.defineProperty(o,"decorateRoot",{get:function(){return s.decorated||(s.decorated=new(n(26)))}})},function(t,e,n){"use strict";(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){return"symbol"===n(t=function(t,e){if("object"!==n(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0===i)return String(t);if("object"!==n(i=i.call(t,e)))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(r.key),r)}}var r=null,o=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function")}var n,o,s;function a(){return s.apply(this,arguments)}return n=e,null,(o=[{key:"global",value:(s=function(){if("undefined"!=typeof self&&null!==self&&0!==Object.keys(self).length)return self;if("undefined"!=typeof window&&null!==window&&0!==Object.keys(window).length)return window;if(null!=t&&0!==Object.keys(t).length)return t;var e;if("undefined"!=typeof my)return r||(e=my.getAppIdSync(),r={location:{host:e.appId+".hybrid.alipay-eco.com"}}),r;throw new Error("unable to locate global object")},a.toString=function(){return s.toString()},a)}])&&i(n,o),Object.defineProperty(n,"prototype",{writable:!1}),e}();e.a=o}).call(this,n(9))},function(t,e,n){"use strict";(function(t){var i=e;function r(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;++r)void 0!==t[i[r]]&&n||(t[i[r]]=e[i[r]]);return t}function o(t){function e(t,n){if(!(this instanceof e))return new e(t,n);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}i.asPromise=n(13),i.base64=n(31),i.EventEmitter=n(32),i.float=n(33),i.inquire=n(14),i.utf8=n(34),i.pool=n(35),i.LongBits=n(36),i.isNode=Boolean(void 0!==t&&t&&t.process&&t.process.versions&&t.process.versions.node),i.global=i.isNode&&t||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},i.isString=function(t){return"string"==typeof t||t instanceof String},i.isObject=function(t){return t&&"object"==typeof t},i.isset=i.isSet=function(t,e){var n=t[e];return!(null==n||!t.hasOwnProperty(e))&&("object"!=typeof n||0<(Array.isArray(n)?n:Object.keys(n)).length)},i.Buffer=function(){try{var t=i.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),i.v=null,i._=null,i.newBuffer=function(t){return"number"==typeof t?i.Buffer?i._(t):new i.Array(t):i.Buffer?i.v(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(t){return t?i.LongBits.from(t).toHash():i.LongBits.zeroHash},i.longFromHash=function(t,e){return t=i.LongBits.fromHash(t),i.Long?i.Long.fromBits(t.lo,t.hi,e):t.toNumber(Boolean(e))},i.merge=r,i.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},i.newError=o,i.ProtocolError=o("ProtocolError"),i.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var t=Object.keys(this),n=t.length-1;-1<n;--n)if(1===e[t[n]]&&void 0!==this[t[n]]&&null!==this[t[n]])return t[n]}},i.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i.j=function(){var t=i.Buffer;t?(i.v=t.from!==Uint8Array.from&&t.from||function(e,n){return new t(e,n)},i._=t.allocUnsafe||function(e){return new t(e)}):i.v=i._=null}}).call(this,n(9))},function(t,e,n){"use strict";t.exports=s;var i=n(4),r=(((s.prototype=Object.create(i.prototype)).constructor=s).className="Enum",n(6)),o=n(0);function s(t,e,n,r,o){if(i.call(this,t,n),e&&"object"!=typeof e)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=o||{},this.reserved=void 0,e)for(var s=Object.keys(e),a=0;a<s.length;++a)"number"==typeof e[s[a]]&&(this.valuesById[this.values[s[a]]=e[s[a]]]=s[a])}s.fromJSON=function(t,e){return(t=new s(t,e.values,e.options,e.comment,e.comments)).reserved=e.reserved,t},s.prototype.toJSON=function(t){return t=!!t&&Boolean(t.keepComments),o.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},s.prototype.add=function(t,e,n){if(!o.isString(t))throw TypeError("name must be a string");if(!o.isInteger(e))throw TypeError("id must be an integer");if(void 0!==this.values[t])throw Error("duplicate name '"+t+"' in "+this);if(this.isReservedId(e))throw Error("id "+e+" is reserved in "+this);if(this.isReservedName(t))throw Error("name '"+t+"' is reserved in "+this);if(void 0!==this.valuesById[e]){if(!this.options||!this.options.allow_alias)throw Error("duplicate id "+e+" in "+this);this.values[t]=e}else this.valuesById[this.values[t]=e]=t;return this.comments[t]=n||null,this},s.prototype.remove=function(t){if(!o.isString(t))throw TypeError("name must be a string");var e=this.values[t];if(null==e)throw Error("name '"+t+"' does not exist in "+this);return delete this.valuesById[e],delete this.values[t],delete this.comments[t],this},s.prototype.isReservedId=function(t){return r.isReservedId(this.reserved,t)},s.prototype.isReservedName=function(t){return r.isReservedName(this.reserved,t)}},function(t,e,n){"use strict";(t.exports=o).className="ReflectionObject";var i,r=n(0);function o(t,e){if(!r.isString(t))throw TypeError("name must be a string");if(e&&!r.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(o.prototype,{root:{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}}),o.prototype.toJSON=function(){throw Error()},o.prototype.onAdd=function(t){this.parent&&this.parent!==t&&this.parent.remove(this),this.parent=t,this.resolved=!1,(t=t.root)instanceof i&&t.S(this)},o.prototype.onRemove=function(t){(t=t.root)instanceof i&&t.O(this),this.parent=null,this.resolved=!1},o.prototype.resolve=function(){return this.resolved||this.root instanceof i&&(this.resolved=!0),this},o.prototype.getOption=function(t){if(this.options)return this.options[t]},o.prototype.setOption=function(t,e,n){return n&&this.options&&void 0!==this.options[t]||((this.options||(this.options={}))[t]=e),this},o.prototype.setParsedOption=function(t,e,n){this.parsedOptions||(this.parsedOptions=[]);var i,o,s=this.parsedOptions;return n?(i=s.find(function(e){return Object.prototype.hasOwnProperty.call(e,t)}))?(o=i[t],r.setProperty(o,n,e)):((i={})[t]=r.setProperty({},n,e),s.push(i)):((o={})[t]=e,s.push(o)),this},o.prototype.setOptions=function(t,e){if(t)for(var n=Object.keys(t),i=0;i<n.length;++i)this.setOption(n[i],t[n[i]],e);return this},o.prototype.toString=function(){var t=this.constructor.className,e=this.fullName;return e.length?t+" "+e:t},o.j=function(t){i=t}},function(t,e,n){"use strict";t.exports=l;var i,r=n(4),o=(((l.prototype=Object.create(r.prototype)).constructor=l).className="Field",n(3)),s=n(7),a=n(0),A=/^required|optional|repeated$/;function l(t,e,n,i,o,l,u){if(a.isObject(i)?(u=o,l=i,i=o=void 0):a.isObject(o)&&(u=l,l=o,o=void 0),r.call(this,t,l),!a.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!a.isString(n))throw TypeError("type must be a string");if(void 0!==i&&!A.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==o&&!a.isString(o))throw TypeError("extend must be a string");this.rule=(i="proto3_optional"===i?"optional":i)&&"optional"!==i?i:void 0,this.type=n,this.id=e,this.extend=o||void 0,this.required="required"===i,this.optional=!this.required,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!a.Long&&void 0!==s.long[n],this.bytes="bytes"===n,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.T=null,this.comment=u}l.fromJSON=function(t,e){return new l(t,e.id,e.type,e.rule,e.extend,e.options,e.comment)},Object.defineProperty(l.prototype,"packed",{get:function(){return null===this.T&&(this.T=!1!==this.getOption("packed")),this.T}}),l.prototype.setOption=function(t,e,n){return"packed"===t&&(this.T=null),r.prototype.setOption.call(this,t,e,n)},l.prototype.toJSON=function(t){return t=!!t&&Boolean(t.keepComments),a.toObject(["rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},l.prototype.resolve=function(){var t;return this.resolved?this:(void 0===(this.typeDefault=s.defaults[this.type])&&(this.resolvedType=(this.declaringField||this).parent.lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof o)&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault]),this.options&&(!0!==this.options.packed&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof o)||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long?(this.typeDefault=a.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault)):this.bytes&&"string"==typeof this.typeDefault&&(a.base64.test(this.typeDefault)?a.base64.decode(this.typeDefault,t=a.newBuffer(a.base64.length(this.typeDefault)),0):a.utf8.write(this.typeDefault,t=a.newBuffer(a.utf8.length(this.typeDefault)),0),this.typeDefault=t),this.map?this.defaultValue=a.emptyObject:this.repeated?this.defaultValue=a.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),r.prototype.resolve.call(this))},l.d=function(t,e,n,i){return"function"==typeof e?e=a.decorateType(e).name:e&&"object"==typeof e&&(e=a.decorateEnum(e).name),function(r,o){a.decorateType(r.constructor).add(new l(o,t,e,n,{default:i}))}},l.j=function(t){i=t}},function(t,e,n){"use strict";t.exports=h;var i,r,o,s=n(4),a=(((h.prototype=Object.create(s.prototype)).constructor=h).className="Namespace",n(5)),A=n(8),l=n(0);function u(t,e){if(t&&t.length){for(var n={},i=0;i<t.length;++i)n[t[i].name]=t[i].toJSON(e);return n}}function h(t,e){s.call(this,t,e),this.nested=void 0,this.R=null}function c(t){return t.R=null,t}h.fromJSON=function(t,e){return new h(t,e.options).addJSON(e.nested)},h.arrayToJSON=u,h.isReservedId=function(t,e){if(t)for(var n=0;n<t.length;++n)if("string"!=typeof t[n]&&t[n][0]<=e&&t[n][1]>e)return!0;return!1},h.isReservedName=function(t,e){if(t)for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1},Object.defineProperty(h.prototype,"nestedArray",{get:function(){return this.R||(this.R=l.toArray(this.nested))}}),h.prototype.toJSON=function(t){return l.toObject(["options",this.options,"nested",u(this.nestedArray,t)])},h.prototype.addJSON=function(t){if(t)for(var e,n=Object.keys(t),s=0;s<n.length;++s)e=t[n[s]],this.add((void 0!==e.fields?i:void 0!==e.values?o:void 0!==e.methods?r:void 0!==e.id?a:h).fromJSON(n[s],e));return this},h.prototype.get=function(t){return this.nested&&this.nested[t]||null},h.prototype.getEnum=function(t){if(this.nested&&this.nested[t]instanceof o)return this.nested[t].values;throw Error("no such enum: "+t)},h.prototype.add=function(t){if(!(t instanceof a&&void 0!==t.extend||t instanceof i||t instanceof o||t instanceof r||t instanceof h||t instanceof A))throw TypeError("object must be a valid nested object");if(this.nested){var e=this.get(t.name);if(e){if(!(e instanceof h&&t instanceof h)||e instanceof i||e instanceof r)throw Error("duplicate name '"+t.name+"' in "+this);for(var n=e.nestedArray,s=0;s<n.length;++s)t.add(n[s]);this.remove(e),this.nested||(this.nested={}),t.setOptions(e.options,!0)}}else this.nested={};return(this.nested[t.name]=t).onAdd(this),c(this)},h.prototype.remove=function(t){if(!(t instanceof s))throw TypeError("object must be a ReflectionObject");if(t.parent!==this)throw Error(t+" is not a member of "+this);return delete this.nested[t.name],Object.keys(this.nested).length||(this.nested=void 0),t.onRemove(this),c(this)},h.prototype.define=function(t,e){if(l.isString(t))t=t.split(".");else if(!Array.isArray(t))throw TypeError("illegal path");if(t&&t.length&&""===t[0])throw Error("path must be relative");for(var n=this;0<t.length;){var i=t.shift();if(n.nested&&n.nested[i]){if(!((n=n.nested[i])instanceof h))throw Error("path conflicts with non-namespace objects")}else n.add(n=new h(i))}return e&&n.addJSON(e),n},h.prototype.resolveAll=function(){for(var t=this.nestedArray,e=0;e<t.length;)t[e]instanceof h?t[e++].resolveAll():t[e++].resolve();return this.resolve()},h.prototype.lookup=function(t,e,n){if("boolean"==typeof e?(n=e,e=void 0):e&&!Array.isArray(e)&&(e=[e]),l.isString(t)&&t.length){if("."===t)return this.root;t=t.split(".")}else if(!t.length)return this;if(""===t[0])return this.root.lookup(t.slice(1),e);var i=this.get(t[0]);if(i){if(1===t.length){if(!e||-1<e.indexOf(i.constructor))return i}else if(i instanceof h&&(i=i.lookup(t.slice(1),e,!0)))return i}else for(var r=0;r<this.nestedArray.length;++r)if(this.R[r]instanceof h&&(i=this.R[r].lookup(t,e,!0)))return i;return null===this.parent||n?null:this.parent.lookup(t,e)},h.prototype.lookupType=function(t){var e=this.lookup(t,[i]);if(e)return e;throw Error("no such type: "+t)},h.prototype.lookupEnum=function(t){var e=this.lookup(t,[o]);if(e)return e;throw Error("no such Enum '"+t+"' in "+this)},h.prototype.lookupTypeOrEnum=function(t){var e=this.lookup(t,[i,o]);if(e)return e;throw Error("no such Type or Enum '"+t+"' in "+this)},h.prototype.lookupService=function(t){var e=this.lookup(t,[r]);if(e)return e;throw Error("no such Service '"+t+"' in "+this)},h.j=function(t,e,n){i=t,r=e,o=n}},function(t,e,n){"use strict";n=n(0);var i=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function r(t,e){var n=0,r={};for(e|=0;n<t.length;)r[i[n+e]]=t[n++];return r}e.basic=r([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),e.defaults=r([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",n.emptyArray,null]),e.long=r([0,0,0,1,1],7),e.mapKey=r([0,0,0,5,5,0,0,0,1,1,0,2],2),e.packed=r([1,5,0,0,0,5,5,0,0,0,1,1,0])},function(t,e,n){"use strict";t.exports=s;var i=n(4),r=(((s.prototype=Object.create(i.prototype)).constructor=s).className="OneOf",n(5)),o=n(0);function s(t,e,n,r){if(Array.isArray(e)||(n=e,e=void 0),i.call(this,t,n),void 0!==e&&!Array.isArray(e))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}function a(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}s.fromJSON=function(t,e){return new s(t,e.oneof,e.options,e.comment)},s.prototype.toJSON=function(t){return t=!!t&&Boolean(t.keepComments),o.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},s.prototype.add=function(t){if(t instanceof r)return t.parent&&t.parent!==this.parent&&t.parent.remove(t),this.oneof.push(t.name),this.fieldsArray.push(t),a(t.partOf=this),this;throw TypeError("field must be a Field")},s.prototype.remove=function(t){if(!(t instanceof r))throw TypeError("field must be a Field");var e=this.fieldsArray.indexOf(t);if(e<0)throw Error(t+" is not a member of "+this);return this.fieldsArray.splice(e,1),-1<(e=this.oneof.indexOf(t.name))&&this.oneof.splice(e,1),t.partOf=null,this},s.prototype.onAdd=function(t){i.prototype.onAdd.call(this,t);for(var e=0;e<this.oneof.length;++e){var n=t.get(this.oneof[e]);n&&!n.partOf&&(n.partOf=this).fieldsArray.push(n)}a(this)},s.prototype.onRemove=function(t){for(var e,n=0;n<this.fieldsArray.length;++n)(e=this.fieldsArray[n]).parent&&e.parent.remove(e);i.prototype.onRemove.call(this,t)},s.d=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;)t[e]=arguments[e++];return function(e,n){o.decorateType(e.constructor).add(new s(n,t)),Object.defineProperty(e,n,{get:o.oneOfGetter(t),set:o.oneOfSetter(t)})}}},function(t,e){var n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";t.exports=u;var i,r=n(2),o=r.LongBits,s=r.base64,a=r.utf8;function A(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function l(){}function u(){this.len=0,this.head=new A(l,0,0),this.tail=this.head,this.states=null}function h(){return r.Buffer?function(){return(u.create=function(){return new i})()}:function(){return new u}}function c(t,e,n){e[n]=255&t}function f(t,e){this.len=t,this.next=void 0,this.val=e}function p(t,e,n){for(;t.hi;)e[n++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;127<t.lo;)e[n++]=127&t.lo|128,t.lo=t.lo>>>7;e[n++]=t.lo}function d(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}u.create=h(),u.alloc=function(t){return new r.Array(t)},r.Array!==Array&&(u.alloc=r.pool(u.alloc,r.Array.prototype.subarray)),u.prototype.M=function(t,e,n){return this.tail=this.tail.next=new A(t,e,n),this.len+=e,this},(f.prototype=Object.create(A.prototype)).fn=function(t,e,n){for(;127<t;)e[n++]=127&t|128,t>>>=7;e[n]=t},u.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new f((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},u.prototype.int32=function(t){return t<0?this.M(p,10,o.fromNumber(t)):this.uint32(t)},u.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},u.prototype.int64=u.prototype.uint64=function(t){return t=o.from(t),this.M(p,t.length(),t)},u.prototype.sint64=function(t){return t=o.from(t).zzEncode(),this.M(p,t.length(),t)},u.prototype.bool=function(t){return this.M(c,1,t?1:0)},u.prototype.sfixed32=u.prototype.fixed32=function(t){return this.M(d,4,t>>>0)},u.prototype.sfixed64=u.prototype.fixed64=function(t){return t=o.from(t),this.M(d,4,t.lo).M(d,4,t.hi)},u.prototype.float=function(t){return this.M(r.float.writeFloatLE,4,t)},u.prototype.double=function(t){return this.M(r.float.writeDoubleLE,8,t)};var y=r.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};u.prototype.bytes=function(t){var e,n=t.length>>>0;return n?(r.isString(t)&&(e=u.alloc(n=s.length(t)),s.decode(t,e,0),t=e),this.uint32(n).M(y,n,t)):this.M(c,1,0)},u.prototype.string=function(t){var e=a.length(t);return e?this.uint32(e).M(a.write,e,t):this.M(c,1,0)},u.prototype.fork=function(){return this.states=new function(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}(this),this.head=this.tail=new A(l,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new A(l,0,0),this.len=0),this},u.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this},u.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e},u.j=function(t){i=t,u.create=h(),i.j()}},function(t,e,n){"use strict";t.exports=A;var i,r=n(2),o=r.LongBits,s=r.utf8;function a(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function A(t){this.buf=t,this.pos=0,this.len=t.length}function l(){return r.Buffer?function(t){return(A.create=function(t){return r.Buffer.isBuffer(t)?new i(t):h(t)})(t)}:h}var u,h="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new A(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new A(t);throw Error("illegal buffer")};function c(){var t=new o(0,0),e=0;if(!(4<this.len-this.pos)){for(;e<3;++e){if(this.pos>=this.len)throw a(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,4<this.len-this.pos){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw a(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function f(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new o(f(this.buf,this.pos+=4),f(this.buf,this.pos+=4))}A.create=l(),A.prototype.N=r.Array.prototype.subarray||r.Array.prototype.slice,A.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)||!((this.pos+=5)>this.len))return u;throw this.pos=this.len,a(this,10)}),A.prototype.int32=function(){return 0|this.uint32()},A.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},A.prototype.bool=function(){return 0!==this.uint32()},A.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return f(this.buf,this.pos+=4)},A.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|f(this.buf,this.pos+=4)},A.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var t=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},A.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var t=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},A.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw a(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this.N.call(this.buf,e,n)},A.prototype.string=function(){var t=this.bytes();return s.read(t,0,t.length)},A.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw a(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},A.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},A.j=function(t){i=t,A.create=l(),i.j();var e=r.Long?"toLong":"toNumber";r.merge(A.prototype,{int64:function(){return c.call(this)[e](!1)},uint64:function(){return c.call(this)[e](!0)},sint64:function(){return c.call(this).zzDecode()[e](!1)},fixed64:function(){return p.call(this)[e](!0)},sfixed64:function(){return p.call(this)[e](!1)}})}},function(t,e,n){"use strict";t.exports=r;var i=n(2);function r(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)this[e[n]]=t[e[n]]}r.create=function(t){return this.$type.create(t)},r.encode=function(t,e){return this.$type.encode(t,e)},r.encodeDelimited=function(t,e){return this.$type.encodeDelimited(t,e)},r.decode=function(t){return this.$type.decode(t)},r.decodeDelimited=function(t){return this.$type.decodeDelimited(t)},r.verify=function(t){return this.$type.verify(t)},r.fromObject=function(t){return this.$type.fromObject(t)},r.toObject=function(t,e){return this.$type.toObject(t,e)},r.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)}},function(t,e,n){"use strict";t.exports=function(t,e){for(var n=new Array(arguments.length-1),i=0,r=2,o=!0;r<arguments.length;)n[i++]=arguments[r++];return new Promise(function(r,s){n[i]=function(t){if(o)if(o=!1,t)s(t);else{for(var e=new Array(arguments.length-1),n=0;n<e.length;)e[n++]=arguments[n];r.apply(null,e)}};try{t.apply(e||null,n)}catch(t){o&&(o=!1,s(t))}})}},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},function(t,e,n){"use strict";e.Service=n(39)},function(t,e,n){"use strict";t.exports={}},function(t,e,n){"use strict";t.exports=function(t){for(var e,n=o.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),a=t.fieldsArray.slice().sort(o.compareFieldsById),A=0;A<a.length;++A){var l=a[A].resolve(),u=t.k.indexOf(l),h=l.resolvedType instanceof i?"int32":l.type,c=r.basic[h];e="m"+o.safeProp(l.name),l.map?(n("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",e,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",e)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|r.mapKey[l.keyType],l.keyType),void 0===c?n("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,e):n(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|c,h,e),n("}")("}")):l.repeated?(n("if(%s!=null&&%s.length){",e,e),l.packed&&void 0!==r.packed[h]?n("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",e)("w.%s(%s[i])",h,e)("w.ldelim()"):(n("for(var i=0;i<%s.length;++i)",e),void 0===c?s(n,l,u,e+"[i]"):n("w.uint32(%i).%s(%s[i])",(l.id<<3|c)>>>0,h,e)),n("}")):(l.optional&&n("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",e,l.name),void 0===c?s(n,l,u,e):n("w.uint32(%i).%s(%s)",(l.id<<3|c)>>>0,h,e))}return n("return w")};var i=n(3),r=n(7),o=n(0);function s(t,e,n,i){e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,i,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,i,(e.id<<3|2)>>>0)}},function(t,e,n){"use strict";t.exports=g;var i=n(6),r=(((g.prototype=Object.create(i.prototype)).constructor=g).className="Type",n(3)),o=n(8),s=n(5),a=n(19),A=n(20),l=n(12),u=n(11),h=n(10),c=n(0),f=n(17),p=n(22),d=n(23),y=n(24),m=n(25);function g(t,e){i.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this.A=null,this.k=null,this.I=null,this.P=null}function v(t){return t.A=t.k=t.I=null,delete t.encode,delete t.decode,delete t.verify,t}Object.defineProperties(g.prototype,{fieldsById:{get:function(){if(!this.A){this.A={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var n=this.fields[t[e]],i=n.id;if(this.A[i])throw Error("duplicate id "+i+" in "+this);this.A[i]=n}}return this.A}},fieldsArray:{get:function(){return this.k||(this.k=c.toArray(this.fields))}},oneofsArray:{get:function(){return this.I||(this.I=c.toArray(this.oneofs))}},ctor:{get:function(){return this.P||(this.ctor=g.generateConstructor(this)())},set:function(t){for(var e=t.prototype,n=(e instanceof l||((t.prototype=new l).constructor=t,c.merge(t.prototype,e)),t.$type=t.prototype.$type=this,c.merge(t,l,!0),this.P=t,0);n<this.fieldsArray.length;++n)this.k[n].resolve();var i={};for(n=0;n<this.oneofsArray.length;++n)i[this.I[n].resolve().name]={get:c.oneOfGetter(this.I[n].oneof),set:c.oneOfSetter(this.I[n].oneof)};n&&Object.defineProperties(t.prototype,i)}}}),g.generateConstructor=function(t){for(var e,n=c.codegen(["p"],t.name),i=0;i<t.fieldsArray.length;++i)(e=t.k[i]).map?n("this%s={}",c.safeProp(e.name)):e.repeated&&n("this%s=[]",c.safeProp(e.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},g.fromJSON=function(t,e){for(var n=new g(t,e.options),l=(n.extensions=e.extensions,n.reserved=e.reserved,Object.keys(e.fields)),u=0;u<l.length;++u)n.add((void 0!==e.fields[l[u]].keyType?a:s).fromJSON(l[u],e.fields[l[u]]));if(e.oneofs)for(l=Object.keys(e.oneofs),u=0;u<l.length;++u)n.add(o.fromJSON(l[u],e.oneofs[l[u]]));if(e.nested)for(l=Object.keys(e.nested),u=0;u<l.length;++u){var h=e.nested[l[u]];n.add((void 0!==h.id?s:void 0!==h.fields?g:void 0!==h.values?r:void 0!==h.methods?A:i).fromJSON(l[u],h))}return e.extensions&&e.extensions.length&&(n.extensions=e.extensions),e.reserved&&e.reserved.length&&(n.reserved=e.reserved),e.group&&(n.group=!0),e.comment&&(n.comment=e.comment),n},g.prototype.toJSON=function(t){var e=i.prototype.toJSON.call(this,t),n=!!t&&Boolean(t.keepComments);return c.toObject(["options",e&&e.options||void 0,"oneofs",i.arrayToJSON(this.oneofsArray,t),"fields",i.arrayToJSON(this.fieldsArray.filter(function(t){return!t.declaringField}),t)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",e&&e.nested||void 0,"comment",n?this.comment:void 0])},g.prototype.resolveAll=function(){for(var t=this.fieldsArray,e=0;e<t.length;)t[e++].resolve();var n=this.oneofsArray;for(e=0;e<n.length;)n[e++].resolve();return i.prototype.resolveAll.call(this)},g.prototype.get=function(t){return this.fields[t]||this.oneofs&&this.oneofs[t]||this.nested&&this.nested[t]||null},g.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);if(t instanceof s&&void 0===t.extend){if((this.A||this.fieldsById)[t.id])throw Error("duplicate id "+t.id+" in "+this);if(this.isReservedId(t.id))throw Error("id "+t.id+" is reserved in "+this);if(this.isReservedName(t.name))throw Error("name '"+t.name+"' is reserved in "+this);return t.parent&&t.parent.remove(t),(this.fields[t.name]=t).message=this,t.onAdd(this),v(this)}return t instanceof o?(this.oneofs||(this.oneofs={}),(this.oneofs[t.name]=t).onAdd(this),v(this)):i.prototype.add.call(this,t)},g.prototype.remove=function(t){if(t instanceof s&&void 0===t.extend){if(this.fields&&this.fields[t.name]===t)return delete this.fields[t.name],t.parent=null,t.onRemove(this),v(this);throw Error(t+" is not a member of "+this)}if(t instanceof o){if(this.oneofs&&this.oneofs[t.name]===t)return delete this.oneofs[t.name],t.parent=null,t.onRemove(this),v(this);throw Error(t+" is not a member of "+this)}return i.prototype.remove.call(this,t)},g.prototype.isReservedId=function(t){return i.isReservedId(this.reserved,t)},g.prototype.isReservedName=function(t){return i.isReservedName(this.reserved,t)},g.prototype.create=function(t){return new this.ctor(t)},g.prototype.setup=function(){for(var t=this.fullName,e=[],n=0;n<this.fieldsArray.length;++n)e.push(this.k[n].resolve().resolvedType);var i;return this.encode=f(this)({Writer:h,types:e,util:c}),this.decode=p(this)({Reader:u,types:e,util:c}),this.verify=d(this)({types:e,util:c}),this.fromObject=y.fromObject(this)({types:e,util:c}),this.toObject=y.toObject(this)({types:e,util:c}),(t=m[t])&&((i=Object.create(this)).fromObject=this.fromObject,this.fromObject=t.fromObject.bind(i),i.toObject=this.toObject,this.toObject=t.toObject.bind(i)),this},g.prototype.encode=function(t,e){return this.setup().encode(t,e)},g.prototype.encodeDelimited=function(t,e){return this.encode(t,e&&e.len?e.fork():e).ldelim()},g.prototype.decode=function(t,e){return this.setup().decode(t,e)},g.prototype.decodeDelimited=function(t){return t instanceof u||(t=u.create(t)),this.decode(t,t.uint32())},g.prototype.verify=function(t){return this.setup().verify(t)},g.prototype.fromObject=function(t){return this.setup().fromObject(t)},g.prototype.toObject=function(t,e){return this.setup().toObject(t,e)},g.d=function(t){return function(e){c.decorateType(e,t)}}},function(t,e,n){"use strict";t.exports=s;var i=n(5),r=(((s.prototype=Object.create(i.prototype)).constructor=s).className="MapField",n(7)),o=n(0);function s(t,e,n,r,s,a){if(i.call(this,t,e,r,void 0,void 0,s,a),!o.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}s.fromJSON=function(t,e){return new s(t,e.id,e.keyType,e.type,e.options,e.comment)},s.prototype.toJSON=function(t){return t=!!t&&Boolean(t.keepComments),o.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},s.prototype.resolve=function(){if(this.resolved)return this;if(void 0===r.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)},s.d=function(t,e,n){return"function"==typeof n?n=o.decorateType(n).name:n&&"object"==typeof n&&(n=o.decorateEnum(n).name),function(i,r){o.decorateType(i.constructor).add(new s(r,t,e,n))}}},function(t,e,n){"use strict";t.exports=a;var i=n(6),r=(((a.prototype=Object.create(i.prototype)).constructor=a).className="Service",n(21)),o=n(0),s=n(15);function a(t,e){i.call(this,t,e),this.methods={},this.D=null}function A(t){return t.D=null,t}a.fromJSON=function(t,e){var n=new a(t,e.options);if(e.methods)for(var i=Object.keys(e.methods),o=0;o<i.length;++o)n.add(r.fromJSON(i[o],e.methods[i[o]]));return e.nested&&n.addJSON(e.nested),n.comment=e.comment,n},a.prototype.toJSON=function(t){var e=i.prototype.toJSON.call(this,t),n=!!t&&Boolean(t.keepComments);return o.toObject(["options",e&&e.options||void 0,"methods",i.arrayToJSON(this.methodsArray,t)||{},"nested",e&&e.nested||void 0,"comment",n?this.comment:void 0])},Object.defineProperty(a.prototype,"methodsArray",{get:function(){return this.D||(this.D=o.toArray(this.methods))}}),a.prototype.get=function(t){return this.methods[t]||i.prototype.get.call(this,t)},a.prototype.resolveAll=function(){for(var t=this.methodsArray,e=0;e<t.length;++e)t[e].resolve();return i.prototype.resolve.call(this)},a.prototype.add=function(t){if(this.get(t.name))throw Error("duplicate name '"+t.name+"' in "+this);return t instanceof r?A((this.methods[t.name]=t).parent=this):i.prototype.add.call(this,t)},a.prototype.remove=function(t){if(t instanceof r){if(this.methods[t.name]!==t)throw Error(t+" is not a member of "+this);return delete this.methods[t.name],t.parent=null,A(this)}return i.prototype.remove.call(this,t)},a.prototype.create=function(t,e,n){for(var i,r=new s.Service(t,e,n),a=0;a<this.methodsArray.length;++a){var A=o.lcFirst((i=this.D[a]).resolve().name).replace(/[^$\w_]/g,"");r[A]=o.codegen(["r","c"],o.isReserved(A)?A+"_":A)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return r}},function(t,e,n){"use strict";t.exports=o;var i=n(4),r=(((o.prototype=Object.create(i.prototype)).constructor=o).className="Method",n(0));function o(t,e,n,o,s,a,A,l,u){if(r.isObject(s)?(A=s,s=a=void 0):r.isObject(a)&&(A=a,a=void 0),void 0!==e&&!r.isString(e))throw TypeError("type must be a string");if(!r.isString(n))throw TypeError("requestType must be a string");if(!r.isString(o))throw TypeError("responseType must be a string");i.call(this,t,A),this.type=e||"rpc",this.requestType=n,this.requestStream=!!s||void 0,this.responseType=o,this.responseStream=!!a||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=l,this.parsedOptions=u}o.fromJSON=function(t,e){return new o(t,e.type,e.requestType,e.responseType,e.requestStream,e.responseStream,e.options,e.comment,e.parsedOptions)},o.prototype.toJSON=function(t){return t=!!t&&Boolean(t.keepComments),r.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},o.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),i.prototype.resolve.call(this))}},function(t,e,n){"use strict";t.exports=function(t){var e=o.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(t){return t.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var n=0;n<t.fieldsArray.length;++n){var s=t.k[n].resolve(),a=s.resolvedType instanceof i?"int32":s.type,A="m"+o.safeProp(s.name);e("case %i:",s.id),s.map?(e("if(%s===util.emptyObject)",A)("%s={}",A)("var c2 = r.uint32()+r.pos"),void 0!==r.defaults[s.keyType]?e("k=%j",r.defaults[s.keyType]):e("k=null"),void 0!==r.defaults[a]?e("value=%j",r.defaults[a]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",s.keyType)("case 2:"),void 0===r.basic[a]?e("value=types[%i].decode(r,r.uint32())",n):e("value=r.%s()",a),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==r.long[s.keyType]?e('%s[typeof k==="object"?util.longToHash(k):k]=value',A):e("%s[k]=value",A)):s.repeated?(e("if(!(%s&&%s.length))",A,A)("%s=[]",A),void 0!==r.packed[a]&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",A,a)("}else"),void 0===r.basic[a]?e(s.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",A,n):e("%s.push(r.%s())",A,a)):void 0===r.basic[a]?e(s.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",A,n):e("%s=r.%s()",A,a),e("break")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<t.k.length;++n){var l=t.k[n];l.required&&e("if(!m.hasOwnProperty(%j))",l.name)("throw util.ProtocolError(%j,{instance:m})","missing required '"+l.name+"'")}return e("return m")};var i=n(3),r=n(7),o=n(0)},function(t,e,n){"use strict";t.exports=function(t){var e=r.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n={};t.oneofsArray.length&&e("var p={}");for(var i=0;i<t.fieldsArray.length;++i){var a,A=t.k[i].resolve(),l="m"+r.safeProp(A.name);A.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",l,A.name),A.map?(e("if(!util.isObject(%s))",l)("return%j",o(A,"object"))("var k=Object.keys(%s)",l)("for(var i=0;i<k.length;++i){"),function(t,e,n){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",n)("return%j",o(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",n)("return%j",o(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",n)("return%j",o(e,"boolean key"))}}(e,A,"k[i]"),s(e,A,i,l+"[k[i]]")("}")):A.repeated?(e("if(!Array.isArray(%s))",l)("return%j",o(A,"array"))("for(var i=0;i<%s.length;++i){",l),s(e,A,i,l+"[i]")("}")):(A.partOf&&(a=r.safeProp(A.partOf.name),1===n[A.partOf.name]&&e("if(p%s===1)",a)("return%j",A.partOf.name+": multiple values"),n[A.partOf.name]=1,e("p%s=1",a)),s(e,A,i,l)),A.optional&&e("}")}return e("return null")};var i=n(3),r=n(0);function o(t,e){return t.name+": "+e+(t.repeated&&"array"!==e?"[]":t.map&&"object"!==e?"{k:"+t.keyType+"}":"")+" expected"}function s(t,e,n,r){if(e.resolvedType)if(e.resolvedType instanceof i){t("switch(%s){",r)("default:")("return%j",o(e,"enum value"));for(var s=Object.keys(e.resolvedType.values),a=0;a<s.length;++a)t("case %i:",e.resolvedType.values[s[a]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",n,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",r)("return%j",o(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",o(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',r)("return%j",o(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',r)("return%j",o(e,"boolean"));break;case"string":t("if(!util.isString(%s))",r)("return%j",o(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",o(e,"buffer"))}return t}},function(t,e,n){"use strict";var i=n(3),r=n(0);function o(t,e,n,r){if(e.resolvedType)if(e.resolvedType instanceof i){t("switch(d%s){",r);for(var o=e.resolvedType.values,s=Object.keys(o),a=0;a<s.length;++a)e.repeated&&o[s[a]]===e.typeDefault&&t("default:"),t("case%j:",s[a])("case %i:",o[s[a]])("m%s=%j",r,o[s[a]])("break");t("}")}else t('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var A=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",r,r);break;case"uint64":A=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,A)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,A?"true":"");break;case"bytes":t('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":t("m%s=String(d%s)",r,r);break;case"bool":t("m%s=Boolean(d%s)",r,r)}}return t}function s(t,e,n,r){if(e.resolvedType)e.resolvedType instanceof i?t("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,n,r,r):t("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var o=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":o=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,o?"true":"",r);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:t("d%s=m%s",r,r)}}return t}e.fromObject=function(t){var e=t.fieldsArray,n=r.codegen(["d"],t.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!e.length)return n("return new this.ctor");n("var m=new this.ctor");for(var s=0;s<e.length;++s){var a=e[s].resolve(),A=r.safeProp(a.name);a.map?(n("if(d%s){",A)('if(typeof d%s!=="object")',A)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",A)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",A),o(n,a,s,A+"[ks[i]]")("}")("}")):a.repeated?(n("if(d%s){",A)("if(!Array.isArray(d%s))",A)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",A)("for(var i=0;i<d%s.length;++i){",A),o(n,a,s,A+"[i]")("}")("}")):(a.resolvedType instanceof i||n("if(d%s!=null){",A),o(n,a,s,A),a.resolvedType instanceof i||n("}"))}return n("return m")},e.toObject=function(t){var e=t.fieldsArray.slice().sort(r.compareFieldsById);if(!e.length)return r.codegen()("return {}");for(var n=r.codegen(["m","o"],t.name+"$toObject")("if(!o)")("o={}")("var d={}"),o=[],a=[],A=[],l=0;l<e.length;++l)e[l].partOf||(e[l].resolve().repeated?o:e[l].map?a:A).push(e[l]);if(o.length){for(n("if(o.arrays||o.defaults){"),l=0;l<o.length;++l)n("d%s=[]",r.safeProp(o[l].name));n("}")}if(a.length){for(n("if(o.objects||o.defaults){"),l=0;l<a.length;++l)n("d%s={}",r.safeProp(a[l].name));n("}")}if(A.length){for(n("if(o.defaults){"),l=0;l<A.length;++l){var u,h=A[l],c=r.safeProp(h.name);h.resolvedType instanceof i?n("d%s=o.enums===String?%j:%j",c,h.resolvedType.valuesById[h.typeDefault],h.typeDefault):h.long?n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",h.typeDefault.low,h.typeDefault.high,h.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,h.typeDefault.toString(),h.typeDefault.toNumber()):h.bytes?(u="["+Array.prototype.slice.call(h.typeDefault).join(",")+"]",n("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,h.typeDefault))("else{")("d%s=%s",c,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")):n("d%s=%j",c,h.typeDefault)}n("}")}var f=!1;for(l=0;l<e.length;++l){h=e[l];var p=t.k.indexOf(h);c=r.safeProp(h.name);h.map?(f||(f=!0,n("var ks2")),n("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),s(n,h,p,c+"[ks2[j]]")("}")):h.repeated?(n("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),s(n,h,p,c+"[j]")("}")):(n("if(m%s!=null&&m.hasOwnProperty(%j)){",c,h.name),s(n,h,p,c),h.partOf&&n("if(o.oneofs)")("d%s=%j",r.safeProp(h.partOf.name),h.name)),n("}")}return n("return d")}},function(t,e,n){"use strict";var i=n(12);e[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e,n=t["@type"].substring(t["@type"].lastIndexOf("/")+1);if(n=this.lookup(n))return-1===(e="."===t["@type"].charAt(0)?t["@type"].substr(1):t["@type"]).indexOf("/")&&(e="/"+e),this.create({type_url:e,value:n.encode(n.fromObject(t)).finish()})}return this.fromObject(t)},toObject:function(t,e){var n,r,o="",s="";return!((t=e&&e.json&&t.type_url&&t.value&&(s=t.type_url.substring(t.type_url.lastIndexOf("/")+1),o=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1),n=this.lookup(s))?n.decode(t.value):t)instanceof this.ctor)&&t instanceof i?(n=t.$type.toObject(t,e),r="."===t.$type.fullName[0]?t.$type.fullName.substr(1):t.$type.fullName,n["@type"]=s=(o=""===o?"type.googleapis.com/":o)+r,n):this.toObject(t,e)}}},function(t,e,n){"use strict";t.exports=h;var i,r,o,s=n(6),a=(((h.prototype=Object.create(s.prototype)).constructor=h).className="Root",n(5)),A=n(3),l=n(8),u=n(0);function h(t){s.call(this,"",t),this.deferred=[],this.files=[]}function c(){}h.fromJSON=function(t,e){return e=e||new h,t.options&&e.setOptions(t.options),e.addJSON(t.nested)},h.prototype.resolvePath=u.path.resolve,h.prototype.fetch=u.fetch,h.prototype.load=function t(e,n,i){"function"==typeof n&&(i=n,n=void 0);var s=this;if(!i)return u.asPromise(t,s,e,n);var a=i===c;function A(t,e){if(i){var n=i;if(i=null,a)throw t;n(t,e)}}function l(t){var e=t.lastIndexOf("google/protobuf/");return-1<e&&(t=t.substring(e))in o?t:null}function h(t,e){try{if(u.isString(e)&&"{"===e.charAt(0)&&(e=JSON.parse(e)),u.isString(e)){r.filename=t;var i,o=r(e,s,n),h=0;if(o.imports)for(;h<o.imports.length;++h)(i=l(o.imports[h])||s.resolvePath(t,o.imports[h]))&&f(i);if(o.weakImports)for(h=0;h<o.weakImports.length;++h)(i=l(o.weakImports[h])||s.resolvePath(t,o.weakImports[h]))&&f(i,!0)}else s.setOptions(e.options).addJSON(e.nested)}catch(t){A(t)}a||p||A(null,s)}function f(t,e){if(!(-1<s.files.indexOf(t)))if(s.files.push(t),t in o)a?h(t,o[t]):(++p,setTimeout(function(){--p,h(t,o[t])}));else if(a){var n;try{n=u.fs.readFileSync(t).toString("utf8")}catch(n){return void(e||A(n))}h(t,n)}else++p,s.fetch(t,function(n,r){--p,i&&(n?e?p||A(null,s):A(n):h(t,r))})}var p=0;u.isString(e)&&(e=[e]);for(var d,y=0;y<e.length;++y)(d=s.resolvePath("",e[y]))&&f(d);if(a)return s;p||A(null,s)},h.prototype.loadSync=function(t,e){if(u.isNode)return this.load(t,e,c);throw Error("not supported")},h.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(t){return"'extend "+t.extend+"' in "+t.parent.fullName}).join(", "));return s.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(t,e){var n,i=e.parent.lookup(e.extend);if(i)return((n=new a(e.fullName,e.id,e.type,e.rule,void 0,e.options)).declaringField=e).extensionField=n,i.add(n),1}h.prototype.S=function(t){if(t instanceof a)void 0===t.extend||t.extensionField||p(0,t)||this.deferred.push(t);else if(t instanceof A)f.test(t.name)&&(t.parent[t.name]=t.values);else if(!(t instanceof l)){if(t instanceof i)for(var e=0;e<this.deferred.length;)p(0,this.deferred[e])?this.deferred.splice(e,1):++e;for(var n=0;n<t.nestedArray.length;++n)this.S(t.R[n]);f.test(t.name)&&(t.parent[t.name]=t)}},h.prototype.O=function(t){var e;if(t instanceof a)void 0!==t.extend&&(t.extensionField?(t.extensionField.parent.remove(t.extensionField),t.extensionField=null):-1<(e=this.deferred.indexOf(t))&&this.deferred.splice(e,1));else if(t instanceof A)f.test(t.name)&&delete t.parent[t.name];else if(t instanceof s){for(var n=0;n<t.nestedArray.length;++n)this.O(t.R[n]);f.test(t.name)&&delete t.parent[t.name]}},h.j=function(t,e,n){i=t,r=e,o=n}},function(t,e,n){"use strict";t.exports=n(29)},function(t,e,n){"use strict";(function(t){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){return"symbol"===i(t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==i(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(r.key),r)}}var o=n(47),s=(n(48),function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.L=null,this.F=400,this.C=null,this.B=null,this.U=new Map}var n,i;return n=e,(i=[{key:"url",get:function(){return this.L}},{key:"status",get:function(){return this.F}},{key:"responseType",get:function(){return this.C},set:function(t){this.C=t}},{key:"response",get:function(){return this.B}},{key:"open",value:function(t,e){"GET"==t&&(this.L=e)}},{key:"addEventListener",value:function(t,e){var n=this.U.get(t);n||this.U.set(t,n=[]),n.push(e)}},{key:"send",value:function(){var e=this,n=this.L,i=o.createReadStream(n),r=[],s=0;this.B=null,i.on("readable",function(){var n=i.read();null!=n&&(r.push(n),s+=n.length,e.B?e.B=t.concat([e.B,new t(n)],s):e.B=new t(n))}),i.on("end",function(){e.F=200,e.G("load")}),i.on("error",function(t){e.F=400,e.G("error",t)})}}])&&r(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),e}());Object.assign(s.prototype,{G:function(t,e){if(0!=this.U.size){var n=this.U.get(t);if(n)for(var i=0;i<n.length;i++)n[i]&&n[i](e)}}}),e.a=s}).call(this,n(43).Buffer)},function(t,e,n){"use strict";var i=t.exports=n(30);i.build="light",i.load=function(t,e,n){return(e="function"==typeof e?(n=e,new i.Root):e||new i.Root).load(t,n)},i.loadSync=function(t,e){return(e=e||new i.Root).loadSync(t)},i.encoder=n(17),i.decoder=n(22),i.verifier=n(23),i.converter=n(24),i.ReflectionObject=n(4),i.Namespace=n(6),i.Root=n(26),i.Enum=n(3),i.Type=n(18),i.Field=n(5),i.OneOf=n(8),i.MapField=n(19),i.Service=n(20),i.Method=n(21),i.Message=n(12),i.wrappers=n(25),i.types=n(7),i.util=n(0),i.ReflectionObject.j(i.Root),i.Namespace.j(i.Type,i.Service,i.Enum),i.Root.j(i.Type),i.Field.j(i.Type)},function(t,e,n){"use strict";var i=e;function r(){i.util.j(),i.Writer.j(i.BufferWriter),i.Reader.j(i.BufferReader)}i.build="minimal",i.Writer=n(10),i.BufferWriter=n(37),i.Reader=n(11),i.BufferReader=n(38),i.util=n(2),i.rpc=n(15),i.roots=n(16),i.configure=r,r()},function(t,e,n){"use strict";e.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;1<--e%4&&"="===t.charAt(e);)++n;return Math.ceil(3*t.length)/4-n};for(var i=new Array(64),r=new Array(123),o=0;o<64;)r[i[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;e.encode=function(t,e,n){for(var r,o=null,s=[],a=0,A=0;e<n;){var l=t[e++];switch(A){case 0:s[a++]=i[l>>2],r=(3&l)<<4,A=1;break;case 1:s[a++]=i[r|l>>4],r=(15&l)<<2,A=2;break;case 2:s[a++]=i[r|l>>6],s[a++]=i[63&l],A=0}8191<a&&((o=o||[]).push(String.fromCharCode.apply(String,s)),a=0)}return A&&(s[a++]=i[r],s[a++]=61,1===A)&&(s[a++]=61),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var s="invalid encoding";e.decode=function(t,e,n){for(var i,o=n,a=0,A=0;A<t.length;){var l=t.charCodeAt(A++);if(61===l&&1<a)break;if(void 0===(l=r[l]))throw Error(s);switch(a){case 0:i=l,a=1;break;case 1:e[n++]=i<<2|(48&l)>>4,i=l,a=2;break;case 2:e[n++]=(15&i)<<4|(60&l)>>2,i=l,a=3;break;case 3:e[n++]=(3&i)<<6|l,a=0}}if(1===a)throw Error(s);return n-o},e.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},function(t,e,n){"use strict";function i(){this.U={}}(t.exports=i).prototype.on=function(t,e,n){return(this.U[t]||(this.U[t]=[])).push({fn:e,ctx:n||this}),this},i.prototype.off=function(t,e){if(void 0===t)this.U={};else if(void 0===e)this.U[t]=[];else for(var n=this.U[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this},i.prototype.emit=function(t){var e=this.U[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this}},function(t,e,n){"use strict";function i(t){function e(t,e,n,i){var r=e<0?1:0;0===(e=r?-e:e)?t(0<1/e?0:2147483648,n,i):isNaN(e)?t(2143289344,n,i):t(3.4028234663852886e38<e?(r<<31|2139095040)>>>0:e<1.1754943508222875e-38?(r<<31|Math.round(e/1.401298464324817e-45))>>>0:(r<<31|(t=Math.floor(Math.log(e)/Math.LN2))+127<<23|8388607&Math.round(e*Math.pow(2,-t)*8388608))>>>0,n,i)}function n(t,e,n){return e=2*((t=t(e,n))>>31)+1,n=t>>>23&255,t&=8388607,255==n?t?NaN:1/0*e:0==n?1.401298464324817e-45*e*t:e*Math.pow(2,n-150)*(8388608+t)}function i(t,e,n){h[0]=t,e[n]=c[0],e[n+1]=c[1],e[n+2]=c[2],e[n+3]=c[3]}function A(t,e,n){h[0]=t,e[n]=c[3],e[n+1]=c[2],e[n+2]=c[1],e[n+3]=c[0]}function l(t,e){return c[0]=t[e],c[1]=t[e+1],c[2]=t[e+2],c[3]=t[e+3],h[0]}function u(t,e){return c[3]=t[e],c[2]=t[e+1],c[1]=t[e+2],c[0]=t[e+3],h[0]}var h,c,f,p,d;function y(t,e,n,i,r,o){var s,a,A=i<0?1:0;0===(i=A?-i:i)?(t(0,r,o+e),t(0<1/i?0:2147483648,r,o+n)):isNaN(i)?(t(0,r,o+e),t(2146959360,r,o+n)):1.7976931348623157e308<i?(t(0,r,o+e),t((A<<31|2146435072)>>>0,r,o+n)):i<2.2250738585072014e-308?(t((s=i/5e-324)>>>0,r,o+e),t((A<<31|s/4294967296)>>>0,r,o+n)):(1024===(a=Math.floor(Math.log(i)/Math.LN2))&&(a=1023),t(4503599627370496*(s=i*Math.pow(2,-a))>>>0,r,o+e),t((A<<31|a+1023<<20|1048576*s&1048575)>>>0,r,o+n))}function m(t,e,n,i,r){return e=t(i,r+e),i=2*((t=t(i,r+n))>>31)+1,n=4294967296*(1048575&t)+e,2047==(r=t>>>20&2047)?n?NaN:1/0*i:0==r?5e-324*i*n:i*Math.pow(2,r-1075)*(n+4503599627370496)}function g(t,e,n){f[0]=t,e[n]=p[0],e[n+1]=p[1],e[n+2]=p[2],e[n+3]=p[3],e[n+4]=p[4],e[n+5]=p[5],e[n+6]=p[6],e[n+7]=p[7]}function v(t,e,n){f[0]=t,e[n]=p[7],e[n+1]=p[6],e[n+2]=p[5],e[n+3]=p[4],e[n+4]=p[3],e[n+5]=p[2],e[n+6]=p[1],e[n+7]=p[0]}function b(t,e){return p[0]=t[e],p[1]=t[e+1],p[2]=t[e+2],p[3]=t[e+3],p[4]=t[e+4],p[5]=t[e+5],p[6]=t[e+6],p[7]=t[e+7],f[0]}function x(t,e){return p[7]=t[e],p[6]=t[e+1],p[5]=t[e+2],p[4]=t[e+3],p[3]=t[e+4],p[2]=t[e+5],p[1]=t[e+6],p[0]=t[e+7],f[0]}return"undefined"!=typeof Float32Array?(h=new Float32Array([-0]),d=128===(c=new Uint8Array(h.buffer))[3],t.writeFloatLE=d?i:A,t.writeFloatBE=d?A:i,t.readFloatLE=d?l:u,t.readFloatBE=d?u:l):(t.writeFloatLE=e.bind(null,r),t.writeFloatBE=e.bind(null,o),t.readFloatLE=n.bind(null,s),t.readFloatBE=n.bind(null,a)),"undefined"!=typeof Float64Array?(f=new Float64Array([-0]),d=128===(p=new Uint8Array(f.buffer))[7],t.writeDoubleLE=d?g:v,t.writeDoubleBE=d?v:g,t.readDoubleLE=d?b:x,t.readDoubleBE=d?x:b):(t.writeDoubleLE=y.bind(null,r,0,4),t.writeDoubleBE=y.bind(null,o,4,0),t.readDoubleLE=m.bind(null,s,0,4),t.readDoubleBE=m.bind(null,a,4,0)),t}function r(t,e,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function o(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=255&t}function s(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function a(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=i(i)},function(t,e,n){"use strict";e.length=function(t){for(var e,n=0,i=0;i<t.length;++i)(e=t.charCodeAt(i))<128?n+=1:e<2048?n+=2:55296==(64512&e)&&56320==(64512&t.charCodeAt(i+1))?(++i,n+=4):n+=3;return n},e.read=function(t,e,n){if(n-e<1)return"";for(var i,r=null,o=[],s=0;e<n;)(i=t[e++])<128?o[s++]=i:191<i&&i<224?o[s++]=(31&i)<<6|63&t[e++]:239<i&&i<365?(i=((7&i)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[s++]=55296+(i>>10),o[s++]=56320+(1023&i)):o[s++]=(15&i)<<12|(63&t[e++])<<6|63&t[e++],8191<s&&((r=r||[]).push(String.fromCharCode.apply(String,o)),s=0);return r?(s&&r.push(String.fromCharCode.apply(String,o.slice(0,s))),r.join("")):String.fromCharCode.apply(String,o.slice(0,s))},e.write=function(t,e,n){for(var i,r,o=n,s=0;s<t.length;++s)(i=t.charCodeAt(s))<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&56320==(64512&(r=t.charCodeAt(s+1)))?(++s,e[n++]=(i=65536+((1023&i)<<10)+(1023&r))>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128);return n-o}},function(t,e,n){"use strict";t.exports=function(t,e,n){var i=n||8192,r=i>>>1,o=null,s=i;return function(n){return n<1||r<n?t(n):(i<s+n&&(o=t(i),s=0),n=e.call(o,s,s+=n),7&s&&(s=1+(7|s)),n)}}},function(t,e,n){"use strict";t.exports=r;var i=n(2);function r(t,e){this.lo=t>>>0,this.hi=e>>>0}var o=r.zero=new r(0,0),s=(o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1},r.zeroHash="\0\0\0\0\0\0\0\0",r.fromNumber=function(t){var e,n;return 0===t?o:(n=(t=(e=t<0)?-t:t)>>>0,t=(t-n)/4294967296>>>0,e&&(t=~t>>>0,n=~n>>>0,4294967295<++n)&&(n=0,4294967295<++t)&&(t=0),new r(n,t))},r.from=function(t){if("number"==typeof t)return r.fromNumber(t);if(i.isString(t)){if(!i.Long)return r.fromNumber(parseInt(t,10));t=i.Long.fromString(t)}return t.low||t.high?new r(t.low>>>0,t.high>>>0):o},r.prototype.toNumber=function(t){var e;return!t&&this.hi>>>31?(t=1+~this.lo>>>0,e=~this.hi>>>0,-(t+4294967296*(e=t?e:e+1>>>0))):this.lo+4294967296*this.hi},r.prototype.toLong=function(t){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}},String.prototype.charCodeAt);r.fromHash=function(t){return"\0\0\0\0\0\0\0\0"===t?o:new r((s.call(t,0)|s.call(t,1)<<8|s.call(t,2)<<16|s.call(t,3)<<24)>>>0,(s.call(t,4)|s.call(t,5)<<8|s.call(t,6)<<16|s.call(t,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},r.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},r.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0==n?0==e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}},function(t,e,n){"use strict";t.exports=o;var i=n(10),r=((o.prototype=Object.create(i.prototype)).constructor=o,n(2));function o(){i.call(this)}function s(t,e,n){t.length<40?r.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}o.j=function(){o.alloc=r._,o.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&"set"===r.Buffer.prototype.set.name?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}},o.prototype.bytes=function(t){var e=(t=r.isString(t)?r.v(t,"base64"):t).length>>>0;return this.uint32(e),e&&this.M(o.writeBytesBuffer,e,t),this},o.prototype.string=function(t){var e=r.Buffer.byteLength(t);return this.uint32(e),e&&this.M(s,e,t),this},o.j()},function(t,e,n){"use strict";t.exports=o;var i=n(11),r=((o.prototype=Object.create(i.prototype)).constructor=o,n(2));function o(t){i.call(this,t)}o.j=function(){r.Buffer&&(o.prototype.N=r.Buffer.prototype.slice)},o.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},o.j()},function(t,e,n){"use strict";t.exports=r;var i=n(2);function r(t,e,n){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(n)}((r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r).prototype.rpcCall=function t(e,n,r,o,s){if(!o)throw TypeError("request must be specified");var a=this;if(!s)return i.asPromise(t,a,e,n,r,o);if(a.rpcImpl)try{return a.rpcImpl(e,n[a.requestDelimited?"encodeDelimited":"encode"](o).finish(),function(t,n){if(t)return a.emit("error",t,e),s(t);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(t){return a.emit("error",t,e),s(t)}return a.emit("data",n,e),s(null,n)}a.end(!0)})}catch(t){a.emit("error",t,e),setTimeout(function(){s(t)},0)}else setTimeout(function(){s(Error("already ended"))},0)},r.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(t,e,n){"use strict";(t.exports=function(t,e){"string"==typeof t&&(e=t,t=void 0);var n=[];function i(t){if("string"!=typeof t){var e="return "+r();if(t){for(var o=Object.keys(t),s=new Array(o.length+1),a=new Array(o.length),A=0;A<o.length;)s[A]=o[A],a[A]=t[o[A++]];return s[A]=e,Function.apply(null,s).apply(null,a)}return Function(e)()}for(var l=new Array(arguments.length-1),u=0;u<l.length;)l[u]=arguments[++u];if(u=0,t=t.replace(/%([%dfijs])/g,function(t,e){var n=l[u++];switch(e){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"}),u!==l.length)throw Error("parameter count mismatch");return n.push(t),i}function r(i){return"function "+(i||e||"")+"("+(t&&t.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}return i.toString=r,i}).verbose=!1},function(t,e,n){"use strict";t.exports=o;var i=n(13),r=n(14)("fs");function o(t,e,n){return e="function"==typeof e?(n=e,{}):e||{},n?!e.xhr&&r&&r.readFile?r.readFile(t,function(i,r){return i&&"undefined"!=typeof XMLHttpRequest?o.xhr(t,e,n):i?n(i):n(null,e.binary?r:r.toString("utf8"))}):o.xhr(t,e,n):i(o,this,t,e)}o.xhr=function(t,e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){if(0!==i.status&&200!==i.status)return n(Error("status "+i.status));if(e.binary){if(!(t=i.response))for(var t=[],r=0;r<i.responseText.length;++r)t.push(255&i.responseText.charCodeAt(r));return n(null,"undefined"!=typeof Uint8Array?new Uint8Array(t):t)}return n(null,i.responseText)}},e.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",t),i.send()}},function(t,e,n){"use strict";var i=e.isAbsolute=function(t){return/^(?:\/|\w+:)/.test(t)},r=e.normalize=function(t){var e=(t=t.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),n=i(t);t="";n&&(t=e.shift()+"/");for(var r=0;r<e.length;)".."===e[r]?0<r&&".."!==e[r-1]?e.splice(--r,2):n?e.splice(r,1):++r:"."===e[r]?e.splice(r,1):++r;return t+e.join("/")};e.resolve=function(t,e,n){return n||(e=r(e)),!i(e)&&(t=(t=n?t:r(t)).replace(/(?:\/|^)[^/]+$/,"")).length?r(t+"/"+e):e}},function(t,e,n){"use strict";(function(t){var i=n(44),r=n(45),o=n(46);function s(){return A.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return A.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=A.prototype:(t=null===t?new A(e):t).length=e,t}function A(t,e,n){if(!(A.TYPED_ARRAY_SUPPORT||this instanceof A))return new A(t,e,n);if("number"!=typeof t)return l(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}function l(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer){var r=t,s=e,l=n;if(s.byteLength,l<0||s.byteLength<l)throw new RangeError("'offset' is out of bounds");if(s.byteLength<l+(i||0))throw new RangeError("'length' is out of bounds");return s=void 0===l&&void 0===i?new Uint8Array(s):void 0===i?new Uint8Array(s,l):new Uint8Array(s,l,i),A.TYPED_ARRAY_SUPPORT?(r=s).__proto__=A.prototype:r=c(r,s),r}if("string"!=typeof e){if(l=t,i=e,A.isBuffer(i))return 0!==(l=a(l,s=0|f(i.length))).length&&i.copy(l,0,0,s),l;if(i){if("undefined"!=typeof ArrayBuffer&&i.buffer instanceof ArrayBuffer||"length"in i)return"number"!=typeof i.length||function(t){return t!=t}(i.length)?a(l,0):c(l,i);if("Buffer"===i.type&&o(i.data))return c(l,i.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}if(r=t,i=e,t=n,A.isEncoding(t="string"==typeof t&&""!==t?t:"utf8"))return(i=(r=a(r,e=0|p(i,t))).write(i,t))!==e?r.slice(0,i):r;throw new TypeError('"encoding" must be a valid string encoding')}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=a(t,e<0?0:0|f(e)),!A.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function c(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function f(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function p(t,e){if(A.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;var n=(t="string"!=typeof t?""+t:t).length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return O(t).length;default:if(i)return F(t).length;e=(""+e).toLowerCase(),i=!0}}function d(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function y(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,(n=(n=isNaN(n)?r?0:t.length-1:n)<0?t.length+n:n)>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=A.from(e,i)),A.isBuffer(e))return 0===e.length?-1:m(t,e,n,i,r);if("number"==typeof e)return e&=255,A.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?(r?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(t,e,n):m(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,i,r){var o=1,s=t.length,a=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;s/=o=2,a/=2,n/=2}function A(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r)for(var l=-1,u=n;u<s;u++)if(A(t,u)===A(e,-1===l?0:u-l)){if(u-(l=-1===l?u:l)+1===a)return l*o}else-1!==l&&(u-=u-l),l=-1;else for(u=n=s<n+a?s-a:n;0<=u;u--){for(var h=!0,c=0;c<a;c++)if(A(t,u+c)!==A(e,c)){h=!1;break}if(h)return u}return-1}function g(t,e,n,i){return P(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function v(t,e,n,i){return P(function(t,e){for(var n,i,r=[],o=0;o<t.length&&!((e-=2)<0);++o)i=(n=t.charCodeAt(o))>>8,r.push(n%256),r.push(i);return r}(e,t.length-n),t,n,i)}function b(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var o,s,a,A,l=t[r],u=null,h=239<l?4:223<l?3:191<l?2:1;if(r+h<=n)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(o=t[r+1]))&&127<(A=(31&l)<<6|63&o)&&(u=A);break;case 3:o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&2047<(A=(15&l)<<12|(63&o)<<6|63&s)&&(A<55296||57343<A)&&(u=A);break;case 4:o=t[r+1],s=t[r+2],a=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&65535<(A=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)&&A<1114112&&(u=A)}null===u?(u=65533,h=1):65535<u&&(i.push((u-=65536)>>>10&1023|55296),u=56320|1023&u),i.push(u),r+=h}var c=i,f=c.length;if(f<=x)return String.fromCharCode.apply(String,c);for(var p="",d=0;d<f;)p+=String.fromCharCode.apply(String,c.slice(d,d+=x));return p}e.Buffer=A,e.SlowBuffer=function(t){return+t!=t&&(t=0),A.alloc(+t)},e.INSPECT_MAX_BYTES=50,A.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),A.poolSize=8192,A.W=function(t){return t.__proto__=A.prototype,t},A.from=function(t,e,n){return l(null,t,e,n)},A.TYPED_ARRAY_SUPPORT&&(A.prototype.__proto__=Uint8Array.prototype,A.__proto__=Uint8Array,"undefined"!=typeof Symbol)&&Symbol.species&&A[Symbol.species]===A&&Object.defineProperty(A,Symbol.species,{value:null,configurable:!0}),A.alloc=function(t,e,n){return i=null,e=e,n=n,u(t=t),t<=0||void 0===e?a(i,t):"string"==typeof n?a(i,t).fill(e,n):a(i,t).fill(e);var i},A.allocUnsafe=function(t){return h(null,t)},A.allocUnsafeSlow=function(t){return h(null,t)},A.isBuffer=function(t){return!(null==t||!t.Z)},A.compare=function(t,e){if(!A.isBuffer(t)||!A.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},A.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},A.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return A.alloc(0);if(void 0===e)for(r=e=0;r<t.length;++r)e+=t[r].length;for(var n=A.allocUnsafe(e),i=0,r=0;r<t.length;++r){var s=t[r];if(!A.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},A.byteLength=p,A.prototype.Z=!0,A.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)d(this,e,e+1);return this},A.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},A.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},A.prototype.toString=function(){var t=0|this.length;return 0==t?"":0===arguments.length?b(this,0,t):function(t,e,n){var r,o=!1;if((e=void 0===e||e<0?0:e)>this.length)return"";if((n=void 0===n||n>this.length?this.length:n)<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t=t||"utf8";;)switch(t){case"hex":var s=e,a=n,A=this.length;(!a||a<0||A<a)&&(a=A);for(var l="",u=s=!s||s<0?0:s;u<a;++u)l+=function(t){return t<16?"0"+t.toString(16):t.toString(16)}(this[u]);return l;case"utf8":case"utf-8":return b(this,e,n);case"ascii":A=e;var h=n,c="";h=Math.min(this.length,h);for(var f=A;f<h;++f)c+=String.fromCharCode(127&this[f]);return c;case"latin1":case"binary":s=e;var p=n,d="";p=Math.min(this.length,p);for(var y=s;y<p;++y)d+=String.fromCharCode(this[y]);return d;case"base64":return m=this,r=n,0===(g=e)&&r===m.length?i.fromByteArray(m):i.fromByteArray(m.slice(g,r));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var m=e,g=n,v=this.slice(m,g),x="",w=0;w<v.length;w+=2)x+=String.fromCharCode(v[w]+256*v[w+1]);return x;default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}.apply(this,arguments)},A.prototype.equals=function(t){if(A.isBuffer(t))return this===t||0===A.compare(this,t);throw new TypeError("Argument must be a Buffer")},A.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n)&&(t+=" ... "),"<Buffer "+t+">"},A.prototype.compare=function(t,e,n,i,r){if(!A.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),(e=void 0===e?0:e)<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(r<=i&&n<=e)return 0;if(r<=i)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),l=this.slice(i,r),u=t.slice(e,n),h=0;h<a;++h)if(l[h]!==u[h]){o=l[h],s=u[h];break}return o<s?-1:s<o?1:0},A.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},A.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},A.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},A.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||r<n)&&(n=r),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(var o,s,a,A=!1;;)switch(i=i||"utf8"){case"hex":var l=t,u=e,h=n,c=(u=Number(u)||0,this.length-u);if((!h||c<(h=Number(h)))&&(h=c),(c=l.length)%2!=0)throw new TypeError("Invalid hex string");c/2<h&&(h=c/2);for(var f=0;f<h;++f){var p=parseInt(l.substr(2*f,2),16);if(isNaN(p))return f;this[u+f]=p}return f;case"utf8":case"utf-8":return c=e,a=n,P(F(t,(s=this).length-c),s,c,a);case"ascii":return g(this,t,e,n);case"latin1":case"binary":return g(this,t,e,n);case"base64":return s=this,a=e,o=n,P(O(t),s,a,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,t,e,n);default:if(A)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),A=!0}},A.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function w(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,i,r,o){if(!A.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function M(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,o=Math.min(t.length-n,2);r<o;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function S(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,o=Math.min(t.length-n,4);r<o;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function _(t,e,n,i){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function E(t,e,n,i,o){return o||_(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function T(t,e,n,i,o){return o||_(t,0,n,8),r.write(t,e,n,i,52,8),n+8}A.prototype.slice=function(t,e){var n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):n<t&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),e<t&&(e=t),A.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=A.prototype;else for(var i=e-t,r=new A(i,void 0),o=0;o<i;++o)r[o]=this[o+t];return r},A.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||w(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return i},A.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||w(t,e,this.length);for(var i=this[t+--e],r=1;0<e&&(r*=256);)i+=this[t+--e]*r;return i},A.prototype.readUInt8=function(t,e){return e||w(t,1,this.length),this[t]},A.prototype.readUInt16LE=function(t,e){return e||w(t,2,this.length),this[t]|this[t+1]<<8},A.prototype.readUInt16BE=function(t,e){return e||w(t,2,this.length),this[t]<<8|this[t+1]},A.prototype.readUInt32LE=function(t,e){return e||w(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},A.prototype.readUInt32BE=function(t,e){return e||w(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},A.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||w(t,e,this.length);for(var i=this[t],r=1,o=0;++o<e&&(r*=256);)i+=this[t+o]*r;return(r*=128)<=i&&(i-=Math.pow(2,8*e)),i},A.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||w(t,e,this.length);for(var i=e,r=1,o=this[t+--i];0<i&&(r*=256);)o+=this[t+--i]*r;return(r*=128)<=o&&(o-=Math.pow(2,8*e)),o},A.prototype.readInt8=function(t,e){return e||w(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},A.prototype.readInt16LE=function(t,e){return e||w(t,2,this.length),32768&(e=this[t]|this[t+1]<<8)?4294901760|e:e},A.prototype.readInt16BE=function(t,e){return e||w(t,2,this.length),32768&(e=this[t+1]|this[t]<<8)?4294901760|e:e},A.prototype.readInt32LE=function(t,e){return e||w(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},A.prototype.readInt32BE=function(t,e){return e||w(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},A.prototype.readFloatLE=function(t,e){return e||w(t,4,this.length),r.read(this,t,!0,23,4)},A.prototype.readFloatBE=function(t,e){return e||w(t,4,this.length),r.read(this,t,!1,23,4)},A.prototype.readDoubleLE=function(t,e){return e||w(t,8,this.length),r.read(this,t,!0,52,8)},A.prototype.readDoubleBE=function(t,e){return e||w(t,8,this.length),r.read(this,t,!1,52,8)},A.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||B(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},A.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||B(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[e+r]=255&t;0<=--r&&(o*=256);)this[e+r]=t/o&255;return e+n},A.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,255,0),A.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},A.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),A.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},A.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},A.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),A.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):S(this,t,e,!0),e+4},A.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):S(this,t,e,!1),e+4},A.prototype.writeIntLE=function(t,e,n,i){t=+t,e|=0,i||B(this,t,e,n,(i=Math.pow(2,8*n-1))-1,-i);var r=0,o=1,s=0;for(this[e]=255&t;++r<n&&(o*=256);)t<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(t/o>>0)-s&255;return e+n},A.prototype.writeIntBE=function(t,e,n,i){t=+t,e|=0,i||B(this,t,e,n,(i=Math.pow(2,8*n-1))-1,-i);var r=n-1,o=1,s=0;for(this[e+r]=255&t;0<=--r&&(o*=256);)t<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(t/o>>0)-s&255;return e+n},A.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,127,-128),A.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&(t=t<0?255+t+1:t),e+1},A.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),A.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):M(this,t,e,!0),e+2},A.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):M(this,t,e,!1),e+2},A.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),A.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):S(this,t,e,!0),e+4},A.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),A.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):S(this,t,e,!1),e+4},A.prototype.writeFloatLE=function(t,e,n){return E(this,t,e,!0,n)},A.prototype.writeFloatBE=function(t,e,n){return E(this,t,e,!1,n)},A.prototype.writeDoubleLE=function(t,e,n){return T(this,t,e,!0,n)},A.prototype.writeDoubleBE=function(t,e,n){return T(this,t,e,!1,n)},A.prototype.copy=function(t,e,n,i){if(n=n||0,i||0===i||(i=this.length),e>=t.length&&(e=t.length),(i=0<i&&i<n?n:i)===n)return 0;if(0===t.length||0===this.length)return 0;if((e=e||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length);var r,o=(i=t.length-e<i-n?t.length-e+n:i)-n;if(this===t&&n<e&&e<i)for(r=o-1;0<=r;--r)t[r+e]=this[r+n];else if(o<1e3||!A.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},A.prototype.fill=function(t,e,n,i){if("string"==typeof t){var r;if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length&&(r=t.charCodeAt(0))<256&&(t=r),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!A.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(!(n<=e))if(e>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(t=t||0))for(a=e;a<n;++a)this[a]=t;else for(var o=A.isBuffer(t)?t:F(new A(t,i).toString()),s=o.length,a=0;a<n-e;++a)this[a+e]=o[a%s];return this};var C=/[^+\/0-9A-Za-z-_]/g;function F(t,e){e=e||1/0;for(var n,i=t.length,r=null,o=[],s=0;s<i;++s){if(55295<(n=t.charCodeAt(s))&&n<57344){if(!r){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(s+1===i){-1<(e-=3)&&o.push(239,191,189);continue}r=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&-1<(e-=3)&&o.push(239,191,189);if(r=null,n<128){if(--e<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function O(t){return i.toByteArray(function(t){var e;if((t=((e=t).trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(C,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function P(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}}).call(this,n(9))},function(t,e,n){"use strict";e.byteLength=function(t){return 3*((t=l(t))[0]+(t=t[1]))/4-t},e.toByteArray=function(t){var e,n,i=(s=l(t))[0],s=s[1],a=new o(3*(i+s)/4-s),A=0,u=0<s?i-4:i;for(n=0;n<u;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],a[A++]=e>>16&255,a[A++]=e>>8&255,a[A++]=255&e;return 2===s&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,a[A++]=255&e),1===s&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,a[A++]=e>>8&255,a[A++]=255&e),a},e.fromByteArray=function(t){for(var e,n=t.length,r=n%3,o=[],s=0,a=n-r;s<a;s+=16383)o.push(function(t,e,n){for(var r,o=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(function(t){return i[t>>18&63]+i[t>>12&63]+i[t>>6&63]+i[63&t]}(r));return o.join("")}(t,s,a<s+16383?a:s+16383));return 1==r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2==r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"=")),o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,A=s.length;a<A;++a)i[a]=s[a],r[s.charCodeAt(a)]=a;function l(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");return e=(t=-1===(t=t.indexOf("="))?e:t)===e?0:4-t%4,[t,e]}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,i,r){var o,s,a=8*r-i-1,A=(1<<a)-1,l=A>>1,u=-7,h=n?r-1:0,c=n?-1:1;r=t[e+h];for(h+=c,o=r&(1<<-u)-1,r>>=-u,u+=a;0<u;o=256*o+t[e+h],h+=c,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;0<u;s=256*s+t[e+h],h+=c,u-=8);if(0===o)o=1-l;else{if(o===A)return s?NaN:1/0*(r?-1:1);s+=Math.pow(2,i),o-=l}return(r?-1:1)*s*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var s,a,A=8*o-r-1,l=(1<<A)-1,u=l>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,c=i?0:o-1,f=i?1:-1;o=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(i=Math.pow(2,-s))<1&&(s--,i*=2),2<=(e+=1<=s+u?h/i:h*Math.pow(2,1-u))*i&&(s++,i/=2),l<=s+u?(a=0,s=l):1<=s+u?(a=(e*i-1)*Math.pow(2,r),s+=u):(a=e*Math.pow(2,u-1)*Math.pow(2,r),s=0));8<=r;t[n+c]=255&a,c+=f,a/=256,r-=8);for(s=s<<r|a,A+=r;0<A;t[n+c]=255&s,c+=f,s/=256,A-=8);t[n+c-f]|=128*o}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__47__},function(t,e,n){(function(t){function n(t,e){for(var n=0,i=t.length-1;0<=i;i--){var r=t[i];"."===r?t.splice(i,1):".."===r?(t.splice(i,1),n++):n&&(t.splice(i,1),n--)}if(e)for(;n--;)t.unshift("..");return t}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],i=0;i<t.length;i++)e(t[i],i,t)&&n.push(t[i]);return n}e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;-1<=o&&!r;o--){var s=0<=o?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(e=s+"/"+e,r="/"===s.charAt(0))}return(r?"/":"")+(e=n(i(e.split("/"),function(t){return!!t}),!r).join("/"))||"."},e.normalize=function(t){var o=e.isAbsolute(t),s="/"===r(t,-1);return(t=(t=n(i(t.split("/"),function(t){return!!t}),!o).join("/"))||o?t:".")&&s&&(t+="/"),(o?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},e.relative=function(t,n){function i(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;0<=n&&""===t[n];n--);return n<e?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var r=i(t.split("/")),o=i(n.split("/")),s=Math.min(r.length,o.length),a=s,A=0;A<s;A++)if(r[A]!==o[A]){a=A;break}var l=[];for(A=a;A<r.length;A++)l.push("..");return(l=l.concat(o.slice(a))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=47===t.charCodeAt(0),n=-1,i=!0,r=t.length-1;1<=r;--r)if(47===t.charCodeAt(r)){if(!i){n=r;break}}else i=!1;return-1===n?e?"/":".":e&&1===n?"/":t.slice(0,n)},e.basename=function(t,e){return t=function(t){"string"!=typeof t&&(t+="");for(var e=0,n=-1,i=!0,r=t.length-1;0<=r;--r)if(47===t.charCodeAt(r)){if(!i){e=r+1;break}}else-1===n&&(i=!1,n=r+1);return-1===n?"":t.slice(e,n)}(t),e&&t.substr(-1*e.length)===e?t.substr(0,t.length-e.length):t},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,i=-1,r=!0,o=0,s=t.length-1;0<=s;--s){var a=t.charCodeAt(s);if(47===a){if(r)continue;n=s+1;break}-1===i&&(r=!1,i=s+1),46===a?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1)}return-1===e||-1===i||0===o||1===o&&e===i-1&&e===n+1?"":t.slice(e,i)};var r="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(49))},function(t,e){var n,i;t=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return(n=setTimeout)(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}var a,A=[],l=!1,u=-1;function h(){l&&a&&(l=!1,a.length?A=a.concat(A):u=-1,A.length)&&c()}function c(){if(!l){for(var t=s(h),e=(l=!0,A.length);e;){for(a=A,A=[];++u<e;)a&&a[u].run();u=-1,e=A.length}a=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return(i=clearTimeout)(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];A.push(new f(t,e)),1!==A.length||l||s(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=p,t.addListener=p,t.once=p,t.off=p,t.removeListener=p,t.removeAllListeners=p,t.emit=p,t.prependListener=p,t.prependOnceListener=p,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e,n){"use strict";n.r(e);var i="v3.1.4",r=((f={NONE:0,EXTRUDE_MARKER:2,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30}).LAYER_NODE_TYPE=new Map,f.LAYER_NODE_TYPE.set(f.EXTENT_LAYER,f.EXTENT),f.LAYER_NODE_TYPE.set(f.EXTERNAL_MODEL_LAYER,f.EXTERNAL_MODEL),f.LAYER_NODE_TYPE.set(f.MODEL_LAYER,f.MODEL),f.LAYER_NODE_TYPE.set(f.FACILITY_LAYER,f.FACILITY),f.LAYER_NODE_TYPE.set(f.LABEL_LAYER,f.LABEL),f.LAYER_NODE_TYPE.set(f.DOM_MARKER,f.DOM_MARKER),f.LAYER_NODE_TYPE.set(f.DYNAMIC_MODEL_MARKER,f.DYNAMIC_MODEL_MARKER),f.LAYER_NODE_TYPE.set(f.EXTRUDE_MARKER,f.EXTRUDE_MARKER),f.LAYER_NODE_TYPE.set(f.HEAT_MAP_MARKER,f.HEAT_MAP_MARKER),f.LAYER_NODE_TYPE.set(f.LINE_MARKER,f.LINE_MARKER),f.LAYER_NODE_TYPE.set(f.LOCATION_MARKER,f.LOCATION_MARKER),f.LAYER_NODE_TYPE.set(f.POLYGON_MARKER,f.POLYGON_MARKER),f.LAYER_NODE_TYPE.set(f.TEXT_MARKER,f.TEXT_MARKER),f.LAYER_NODE_TYPE.set(f.IMAGE_MARKER,f.IMAGE_MARKER),f.LAYER_NODE_TYPE.set(f.FLOW_LINE_LAYER,f.FLOW_LINE_MARKER),f.LAYER_NODE_TYPE.set(f.FIRE_MARKER,f.FIRE_MARKER),f.LAYER_NODE_TYPE.set(f.WALL_MARKER,f.WALL_MARKER),f.LAYER_NODE_TYPE.set(f.TUBE_MARKER,f.TUBE_MARKER),f.LAYER_NODE_TYPE.set(f.LINE3D_MARKER,f.LINE3D_MARKER),f.LAYER_NODE_TYPE.set(f.SPHERE_MARKER,f.SPHERE_MARKER),f),o={MODULE_SHORTEST:1,MODULE_BEST:2},s={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},a={ROUTE_SUCCESS:1,ROUTE_FAILED_NO_DATA_START:2,ROUTE_FAILED_NO_DATA_DEST:3,ROUTE_FAILED_CANNOT_ARRIVE:4,ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR:5,ROUTE_FAILED_NO_START_ARRIVAL:6,ROUTE_FAILED_NO_DEST_ARRIVAL:7,ROUTE_FAILED_OUTLINE:8,ROUTE_FAILED_ENTRANCE:9},A={ZH:"zh",EN:"en"},l={TRANSFER_LIFT:1,TRANSFER_STAIR:2,TRANSFER_ESCALATOR:3,TRANSFER_ACCESSIBLE:4,TRANSFER_RAMP:5,TRANSFER_ENTRANCE:6},u={NONE_RODE_NETWORK:1,NONE_WALK_RODE_NETWORK:2,NONE_DRIVE_RODE_NETWORK:4};function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===h(t=function(t,e){if("object"!==h(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==h(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var f=function(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.V=e,this.Y=n}),p=(Object.assign(f.prototype,{X:function(t){return!1},H:function(t,e){}}),f);function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=m(t);if(n=e?(n=m(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===d(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return n.call(this,t,e);throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var g=(Object.assign(f.prototype,{X:function(t){return this.Y==t.fid}}),f);function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){return(b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=x(t);if(n=e?(n=x(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===v(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).K=null,"object"==v(t.Y)?(t.J=t.Y.text,t.$=t.Y.fuzzy,t.tt=void 0===t.Y.matchCase||t.Y.matchCase):(t.J=t.Y,t.tt=!0),t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var w=(Object.assign(f.prototype,{X:function(t){var e=null;if(e="ename"===this.K?t.ename:t.name)if(this.$){if(this.tt){if(-1!=e.indexOf(this.J))return!0}else if(-1!=e.toLocaleLowerCase().indexOf(this.J.toLocaleLowerCase()))return!0}else if(this.tt){if(this.J==e)return!0}else if(this.J.toLocaleLowerCase()==e.toLocaleLowerCase())return!0;return!1}}),f);function B(t){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){return(M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var _=function(){var t=i,e=w;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=S(t);if(n=e?(n=S(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===B(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).K="name",t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function E(t){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var F=function(){var t=i,e=w;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&T(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=C(t);if(n=e?(n=C(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===E(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).K="ename",t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function O(t){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function P(t,e){return(P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function U(t){return(U=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=U(t);if(n=e?(n=U(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===O(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t)).Y=Array.isArray(e)?e:[e],t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var R=(Object.assign(f.prototype,{X:function(t){return-1!=this.Y.indexOf(t.type)}}),f);function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(t,e){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function D(t){return(D=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&L(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=D(t);if(n=e?(n=D(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===I(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return"object"==I((t=n.call(this,t,e)).Y)?(t.J=t.Y.text,t.$=void 0===t.Y.fuzzy||t.Y.fuzzy,t.tt=void 0===t.Y.matchCase||t.Y.matchCase):(t.J=t.Y,t.$=!0,t.tt=!0),t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Q=(Object.assign(f.prototype,{X:function(t){if(this.$){if(this.tt){if(t.name&&-1!=t.name.indexOf(this.J)||t.ename&&-1!=t.ename.indexOf(this.J))return!0}else if(t.name&&-1!=t.name.toLocaleLowerCase().indexOf(this.J.toLocaleLowerCase())||t.ename&&-1!=t.ename.toLocaleLowerCase().indexOf(this.J.toLocaleLowerCase()))return!0}else if(this.tt){if(t.name&&t.name==this.J||t.ename&&t.ename==this.J)return!0}else if(t.name&&t.name.toLocaleLowerCase()==this.J.toLocaleLowerCase()||t.ename&&t.ename.toLocaleLowerCase()==this.J.toLocaleLowerCase())return!0;return!1}}),f),k=(f={NONE:0,POINT:1,LINE:2,POLYGON:4,MULTIPOINT:8,MULTILINE:16,MULTIPOLYGON:32,GROUP:64,EXTENT:1024,EXTERNALMODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,EXTENTGROUP:1<<20,EXTERNALMODELGROUP:1<<21,MODELGROUP:1<<22,FACILITYGROUP:1<<23,LABELGROUP:1<<24},Object.freeze(f),f),N=function(t,e,n){n=n||2;var i,r,o,s,a,A=e&&e.length,l=A?e[0]*n:t.length,u=j(t,0,l,n,!0),h=[];if(u&&u.next!==u.prev){if(A&&(u=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=j(t,s=e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(function(t){for(var e=t,n=t;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),(e=e.next)!==t;);return n}(s));for(a.sort(z),r=0;r<a.length;r++)!function(t,e){(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}}while((i=i.next)!==e);if(!n)return null;if(r!==s){var A,l=n,u=n.x,h=n.y,c=1/0;for(i=n;r>=i.x&&i.x>=u&&r!==i.x&&G(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&(A=Math.abs(o-i.y)/(r-i.x),q(i,t))&&(A<c||A===c&&(i.x>n.x||i.x===n.x&&function(t,e){return Y(t.prev,t,e.prev)<0&&Y(e.next,t,t.next)<0}(n,i)))&&(n=i,c=A),(i=i.next)!==l;);}return n}(t,e))&&(t=J(e,t),H(e,e.next),H(t,t.next))}(a[r],n),n=H(n,n.next);return n}(t,e,u,n)),t.length>80*n){for(var c=i=t[0],f=r=t[1],p=n;p<l;p+=n)(o=t[p])<c&&(c=o),(s=t[p+1])<f&&(f=s),i<o&&(i=o),r<s&&(r=s);a=0!==(a=Math.max(i-c,r-f))?1/a:0}!function t(e,n,i,r,o,s,a){if(e){if(!a&&s){for(var A=e,l=r,u=o,h=s,c=A;null===c.z&&(c.z=V(c.x,c.y,l,u,h)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==A;);c.prevZ.nextZ=null,c.prevZ=null;var f,p,d,y,m,g,v,b,x=c,w=1;do{for(p=x,m=x=null,g=0;p;){for(g++,d=p,f=v=0;f<w&&(v++,d=d.nextZ);f++);for(b=w;0<v||0<b&&d;)0!==v&&(0===b||!d||p.z<=d.z)?(p=(y=p).nextZ,v--):(d=(y=d).nextZ,b--),m?m.nextZ=y:x=y,y.prevZ=m,m=y;p=d}}while(m.nextZ=null,w*=2,1<g)}for(var B,M,S=e;e.prev!==e.next;)if(B=e.prev,M=e.next,s?function(t,e,n,i){var r=t.prev,o=t,s=t.next;if(!(0<=Y(r,o,s))){for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,A=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,u=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,h=V(a,A,e,n,i),c=V(l,u,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=c;){if(f!==t.prev&&f!==t.next&&G(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=Y(f.prev,f,f.next))return;if(f=f.prevZ,p!==t.prev&&p!==t.next&&G(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=Y(p.prev,p,p.next))return;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&G(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=Y(f.prev,f,f.next))return;f=f.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&G(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=Y(p.prev,p,p.next))return;p=p.nextZ}return 1}}(e,r,o,s):function(t){var e=t.prev,n=t,i=t.next;if(!(0<=Y(e,n,i))){for(var r=t.next.next;r!==t.prev;){if(G(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=Y(r.prev,r,r.next))return;r=r.next}return 1}}(e))n.push(B.i/i),n.push(e.i/i),n.push(M.i/i),tt(e),e=M.next,S=M.next;else if((e=M)===S){a?1===a?t(e=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next}while(!K(r,o)&&X(r,i,i.next,o)&&q(r,o)&&q(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),tt(i),tt(i.next),i=t=o),(i=i.next)!==t);return H(i)}(H(e),n,i),n,i,r,o,s,2):2===a&&function(e,n,i,r,o,s){var a=e;do{for(var A,l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&X(n,n.next,t,e))return 1}while((n=n.next)!==t)}(t,e)&&(q(t,e)&&q(e,t)&&function(t,e){for(var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!==t;);return i}(t,e)&&(Y(t.prev,t,e.prev)||Y(t,e.prev,e))||K(t,e)&&0<Y(t.prev,t,t.next)&&0<Y(e.prev,e,e.next))}(a,l))return A=J(a,l),a=H(a,a.next),A=H(A,A.next),t(a,n,i,r,o,s),t(A,n,i,r,o,s);l=l.next}}while((a=a.next)!==e)}(e,n,i,r,o,s):t(H(e),n,i,r,o,s,1);break}}}(u,h,n,c,f,a)}return h};function j(t,e,n,i,r){var o,s;if(r===0<function(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}(t,e,n,i))for(o=e;o<n;o+=i)s=$(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=$(o,t[o],t[o+1],s);return s&&K(s,s.next)&&(tt(s),s=s.next),s}function H(t,e){if(!t)return t;e=e||t;var n,i=t;do{if(n=!1,i.steiner||!K(i,i.next)&&0!==Y(i.prev,i,i.next))i=i.next;else{if(tt(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function z(t,e){return t.x-e.x}function V(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function G(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function Y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function K(t,e){return t.x===e.x&&t.y===e.y}function X(t,e,n,i){var r=Z(Y(t,e,n)),o=Z(Y(t,e,i)),s=Z(Y(n,i,t)),a=Z(Y(n,i,e));return r!==o&&s!==a||0===r&&W(t,n,e)||0===o&&W(t,i,e)||0===s&&W(n,t,i)||!(0!==a||!W(n,e,i))}function W(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Z(t){return 0<t?1:t<0?-1:0}function q(t,e){return Y(t.prev,t,t.next)<0?0<=Y(t,e,t.next)&&0<=Y(t,t.prev,e):Y(t,e,t.prev)<0||Y(t,t.next,e)<0}function J(t,e){var n=new et(t.i,t.x,t.y),i=new et(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function $(t,e,n,i){return t=new et(t,e,n),i?(t.next=i.next,(t.prev=i).next.prev=t,i.next=t):(t.prev=t).next=t,t}function tt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function et(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nt(t){return function(t){if(Array.isArray(t))return it(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?it(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var rt={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return rt.area(t)<0},triangulateShape:function(t,e){var n=[],i=[],r=[],o=(ot(t),st(n,t),t.length);e.forEach(ot);for(var s=0;s<e.length;s++)i.push(o),o+=e[s].length,st(n,e[s]);for(var a=N(n,i),A=0;A<a.length;A+=3)r.push(a.slice(A,A+3));return r},triangulate:function(t){(r=[]).push.apply(r,nt(t[0]));for(var e=[],n=1;n<t.length;n++){var i=[];i.push.apply(i,nt(t[n])),e.push(i)}if(!rt.isClockWise(r))for(var r=r.reverse(),o=0,s=e.length;o<s;o++){var a=e[o];rt.isClockWise(a)&&(e[o]=a.reverse())}return rt.triangulateShape(r,e)}};function ot(t){var e,n=t.length;2<n&&(n=t[n-1],e=t[0],n.x===e.x)&&n.y===e.y&&t.pop()}function st(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function At(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===at(t=function(t,e){if("object"!==at(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==at(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var lt=1e-5,ut=.001,ht=Math.PI/180,ct=180/Math.PI;f=function(t,e,n){return e&&At(t.prototype,e),n&&At(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(f.prototype,{rt:function(){return lt},nt:function(){return ht},it:function(){return ct},et:function(t){return t<lt&&-lt<t},ot:function(t){return lt<t},st:function(t){return t<-lt},ut:function(t,e,n){return e=(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y),Math.abs(e)<lt?0:e},distanceOfTwoPoints:function(t,e){return t&&e?Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)):Number.NaN},distance:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},isPolygonContainPoint:function(t,e){for(var n=0,i=0;i<t.length;i++){var r=t[i].x,o=t[i].y,s=0,a=(i<t.length-1?(s=t[i+1].x,t[i+1]):(s=t[0].x,t[0])).y;if(r===e.x&&o===e.y||s===e.x&&a===e.y)return!0;if(a!==o){var A=r+(e.y-o)*(s-r)/(a-o);if(A===e.x)return!0;r!==s?A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&A!==r&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++):A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++)}}return 0<n%2},ft:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y))},ht:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y)||0===this.ut(n,e,t)&&0===this.ut(e,i,t)||this.ut(n,e,t)*this.ut(e,i,t)<0||this.ut(t,i,n)*this.ut(i,e,n)<0)},ct:function(t,e,n){return!(t.x<e.x||t.y<e.y||t.x>n.x||t.y>n.y)},lt:function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y);e=Math.max(e.y,n.y);return!(t.x<i||t.x>r||t.y<o||t.y>e)},vt:function(t,e,n){var i=Math.min(n.x,e.x),r=Math.max(n.x,e.x),o=Math.min(n.y,e.y);n=Math.max(n.y,e.y);return!(t.x<i||t.x>r||t.y<o||t.y>n)},yt:function(t,e,n){for(var i,r,o=!1,s=0;s<n;s++)i=e[s],r=e[(s+1)%n],(i.y<t.y&&r.y>=t.y||r.y<t.y&&i.y>=t.y)&&(i.x<=t.x||r.x<=t.x)&&i.x+(t.y-i.y)/(r.y-i.y)*(r.x-i.x)<t.x&&(o=!o);return o},bt:function(t,e,n){return(t.x-e.x)*(n.y-e.y)==(n.x-e.x)*(t.y-e.y)&&Math.min(e.x,n.x)<=t.x&&t.x<=Math.max(e.x,n.x)&&Math.min(e.y,n.y)<=t.y&&t.y<=Math.max(e.y,n.y)},dt:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},wt:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)},xt:function(t,e,n){var i=e.x,r=(e=e.y,n.x),o=(n=n.y,t.x),s=r-i,a=n-e,A=s*s+a*a,l=o-i,u=(t=t.y)-e,h=l*l+u*u;return this.et(A)?this.et(h)?0:h:(A=Math.sqrt(A),u=this.ot(a=(s/=A)*l+(l=a/A)*u)?this.st(a-A)?(u=o-(i+a*s))*u+(A=t-(e+a*l))*A:(i=o-r)*i+(s=t-n)*s:h,this.et(u)?0:u)},_t:function(t,e,n,i){var r,o=e.x,s=e.y,a=n.x,A=n.y,l=t.x,u=(t=t.y,a-o),h=A-s,c=Math.sqrt(u*u+h*h),f=l-o,p=t-s,d=Math.sqrt(f*f+p*p);return this.et(c)?(i.x=e.x,i.y=e.y,this.et(r=d)?0:r):(r=this.ot(h=(u/=c)*f+(f=h/c)*p)?this.st(h-c)?(c=l-(p=o+h*u),u=t-(o=s+h*f),s=Math.sqrt(c*c+u*u),i.x=p,i.y=o,s):(h=l-a,f=t-A,c=Math.sqrt(h*h+f*f),i.x=n.x,i.y=n.y,c):(i.x=e.x,i.y=e.y,d),this.et(r)?0:r)},gt:function(t,e){for(var n=0,i=0,r=0,o=0;o<e;o++){var s=t[o],a=t[(o+1)%e],A=(s.x*a.y-s.y*a.x)/2;n+=A,i+=A*(s.x+a.x)/3,r+=A*(s.y+a.y)/3}return{x:i/=n,y:r/=n}},jt:function(t){for(var e=rt.triangulate([t]),n=0,i=0,r=0,o=0;o<e.length;o++){var s=t[e[o][0]],a=t[e[o][1]],A=t[e[o][2]],l=a.x-s.x,u=a.y-s.y,h=A.x-s.x;n+=l=(l*(A.y-s.y)-h*u)/2,i+=(s.x+a.x+A.x)/3*l,r+=(s.y+a.y+A.y)/3*l}return{x:i/n,y:r/n}},St:function(t,e){if(e<3)return 0;for(var n=0,i=0;i<e;++i){var r=t[i],o=t[(i+1)%e];n+=r.x*o.y-r.y*o.x}return Math.abs(n/2)},Ot:function(t,e,n,i,r){var o,s;return this.ht(t,e,n,i)?(o=(i.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-i.y),s=(t.y-n.y)*(e.x-t.x)*(i.x-n.x)+n.x*(i.y-n.y)*(e.x-t.x)-t.x*(e.y-t.y)*(i.x-n.x),r.x=s/o,o=(t.x-e.x)*(i.y-n.y)-(e.y-t.y)*(n.x-i.x),s=e.y*(t.x-e.x)*(i.y-n.y)+(i.x-e.x)*(i.y-n.y)*(t.y-e.y)-i.y*(n.x-i.x)*(e.y-t.y),r.y=s/o,1):0},Et:function(t,e,n,i,r){var o=Math.min(n.x,i.x),s=Math.max(n.x,i.x),a=Math.min(n.y,i.y),A=Math.max(n.y,i.y),l=t.x,u=t.y,h=n.x,c=n.y,f=i.x,p=i.y;if(90==e)return!(t.x<o||t.x>s||(Math.abs(s-o<ut)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.x<c?(r.x=h,r.y=c,0):!(p<c&&t.x<p)||(r.x=f,r.y=p,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,d<u||!this.vt(r,n,i))));if(270==e)return!(t.x<o||t.x>s||(Math.abs(s-o<ut)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.y>p?(r.x=f,r.y=p,0):!(p<c&&t.y>c)||(r.x=h,r.y=c,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,u<d||!this.vt(r,n,i))));if(270!=e&&90!=e&&Math.abs(s-o<ut)){t=o;var d=Math.tan(e/180*Math.PI)*(t-l)+u;if(r.y=d,r.x=t,this.vt(r,n,i))return s=d-u,0<(o=t-l)/Math.sqrt(o*o+s*s)*Math.cos(e/180*Math.PI)}return Math.abs(A-a<=ut)?(d=a,t=1/Math.tan(e/180*Math.PI)*(d-u)+l,r.x=t,r.y=d,!!this.vt(r,n,i)&&(o=d-u,0<(s=t-l)/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI))):(t=u+(A=Math.tan(e/180*Math.PI))*((d=(c-u-((a=(p-c)/(f-h))*h-A*l))/(A-a))-l),r.x=d,r.y=t,!!this.vt(r,n,i)&&(s=d-l,o=t-u,Math.abs(s)<=ut&&Math.abs(o)<=ut||0<s/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI)))},Tt:function(t,e){return Math.abs(t.x-e.x)<lt&&Math.abs(t.y-e.y)<lt},Rt:function(t,e,n,i){var r,o,s,a,A=t.x,l=t.y,u=e.x,h=e.y,c=n.x,f=n.y;return this.Tt(t,e)||this.Tt(t,n)?(i.x=A,i.y=l,!0):(s=Math.min(e.x,n.x),a=Math.max(e.x,n.x),r=Math.min(e.y,n.y),o=Math.max(e.y,n.y),Math.abs(u-c)<1e-5?(i.x=u,r<=(i.y=l)&&l<=o):Math.abs(h-f)<1e-5?(i.x=A,i.y=h,s<=A&&A<=a):(a=l+(r=-1/((f-h)/(c-u)))*((s=(h-l-((o=(f-h)/(c-u))*u-r*A))/(r-o))-A),i.x=s,i.y=a,!!this.vt(i,e,n)||!(!this.Tt(t,e)&&!this.Tt(t,n))))},Mt:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}},Nt:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},kt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},At:function(t,e){return t.x*e.x+t.y*e.y},It:function(t,e){return t.x*e.y-t.y*e.x},Pt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},Dt:function(t,e){var n,i;return 0==t.x&&0==t.y||0==e.x&&0==e.y?0:(n={x:t.x,y:t.y,z:0},i={x:e.x,y:e.y,z:0},n=this.Mt(n,i),i=this.At(t,e),i=Math.acos(i/(this.Pt(t)*this.Pt(e))),0<n.z?i/Math.PI*180:360-i/Math.PI*180)},Lt:function(t,e,n,i){for(var r=0;r<n.length;r++){var o=n[r],s=n[(r+1)%n.length];if(1==this.Ot(t,e,o,s,i))return!0}return!1},Ft:function(t,e,n,i,r){var o=Math.min(t.x,n.x,i.x),s=Math.max(t.x,n.x,i.x),a=Math.min(t.y,n.y,i.y),A=Math.max(t.y,n.y,i.y);s=Math.sqrt((s-o)*(s-o)+(A-a)*(A-a)),o=e/180*Math.PI,A=s*Math.cos(o)+t.x,a=s*Math.sin(o)+t.y;return 1==this.Ot(t,{x:A,y:a},n,i,r)},Ct:function(t){for(var e={x:null,y:null},n=0,i=0,r=0;r<t.length;r++)n+=t[r].x,i+=t[r].y;return e.x=n/t.length,e.y=i/t.length,e},Bt:function(t,e,n,i){var r=[],o=t.x-e,s=t.x+e,a=t.y-e,A=t.y+e,l=Math.min(n.x,i.x),u=Math.max(n.x,i.x),h=Math.min(n.y,i.y),c=Math.max(n.y,i.y);return u<o||s<l||c<a||A<h||(o=i.x-n.x,s=i.y-n.y,(a=(t=(o*(a=t.x-n.x)+s*(A=t.y-n.y))/(i=o*o+s*s))*t-(a*a+A*A-e*e)/i)<0)||(A=Math.sqrt(a),i={x:n.x-o*(e=-t+A),y:n.y-s*e},o={x:n.x-o*(a=-t-A),y:n.y-s*a},e!==a&&(l<=i.x&&i.x<=u&&h<=i.y&&i.y<=c&&r.push(i),l<=o.x)&&o.x<=u&&h<=o.y&&o.y<=c&&r.push(o)),r},Ut:function(t,e,n){var i,r={};if(t.x!=e.x)return i=e=(e.y-t.y)/(e.x-t.x),e=t.y-e*t.x,r.x=(+n.x- -1*i*n.y-i*e)/(i*i+1),r.y=(i*i*n.y- -1*i*n.x- -1*e)/(i*i+1),r;r.x=t.x,r.y=n.y},Gt:function(t,e,n,i){var r,o,s,a,A={point:null,isintersect:!1};return t==n||t==i?(A.isintersect=!0,A.point=t):e==n||e==i?(A.isintersect=!0,A.point=e):(r={x:e.x-t.x,y:e.y-t.y},o={x:i.x-n.x,y:i.y-n.y},s={x:n.x-t.x,y:n.y-t.y},i={x:i.x-t.x,y:i.y-t.y},e={x:e.x-n.x,y:e.y-n.y},n={x:-s.x,y:-s.y},a=this.It(o,r),Math.abs(a)<=1e-5||this.It(s,r)*this.It(i,r)<=5e-4&&this.It(n,o)*this.It(e,o)<5e-4&&(i=this.It(o,s)/a,A.point={x:t.x+r.x*i,y:t.y+r.y*i},A.isintersect=!0)),A},Wt:function(t,e,n){t.x===e.x&&(e.x=e.x+1),t.y===e.y&&(e.y=e.y+1),e.x===n.x&&(n.x=n.x+1),e.y===n.y&&(n.y=n.y+1);var i=e.x-t.x,r=(t=e.y-t.y,n.x-e.x);return!(0<i*(n.y-e.y)-t*r)},getAngle:function(t){var e=t.p1,n=(t=t.p2).x-e.x;t=t.y-e.y,e=Math.sqrt(n*n+t*t),e=Math.asin(Math.abs(t)/e);return 0<n&&0<t?e:n<0&&0<t?Math.PI-e:n<0&&t<0?Math.PI+e:0<n&&t<0?2*Math.PI-e:0==n&&0<t?e:0==n&&t<0?3*Math.PI/2:0<n&&0==t?e:n<0&&0==t?Math.PI:null},Zt:function(t){var e=this.distanceOfTwoPoints(t[0],t[1]),n=this.distanceOfTwoPoints(t[1],t[2]),i=(e+n+(t=this.distanceOfTwoPoints(t[0],t[2])))/2;return Math.sqrt(i*(i-e)*(i-n)*(i-t))},Vt:function(t,e){var n,i,r,o,s;return this._t(t,e[0],e[1],{})<1e-4||this._t(t,e[0],e[2],{})<1e-4||this._t(t,e[1],e[2],{})<1e-4||(o={x:e[1].x-e[0].x,y:e[1].y-e[0].y},n={x:e[0].x-e[2].x,y:e[0].y-e[2].y},i={x:e[2].x-e[1].x,y:e[2].y-e[1].y},s={x:t.x-e[0].x,y:t.y-e[0].y},r={x:t.x-e[1].x,y:t.y-e[1].y},t={x:t.x-e[2].x,y:t.y-e[2].y},e=this.It(o,s),o=this.It(i,r),s=this.It(n,t),lt<e*o&&lt<o*s)},Yt:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null,type:0,outer:null},o=[];if(this.Vt(t,n)&&(r.start=t),this.Vt(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0,r.type=1;else{for(var s=(n[1].x+n[2].x)/2,a=(n[1].y+n[2].y)/2,A=1;A<i;A++){var l,u=this.Gt(t,e,n[A-1],n[A]);if(u.isintersect){if(null!=r.start)return r.end=u.point,r.isintersect=!0,r.outer="end",l=this.Dt({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;if(null!=r.end)return r.start=u.point,r.isintersect=!0,r.outer="start",l=this.Dt({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;o.push(u)}}var h,c=this.Gt(t,e,n[0],n[i-1]);if(c.isintersect){if(null!=r.start)return r.end=c.point,r.isintersect=!0,r.outer="end",h=this.Dt({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;if(null!=r.end)return r.start=c.point,r.isintersect=!0,r.outer="start",h=this.Dt({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;o.push(c)}2!=o.length||this.distanceOfTwoPoints(o[0].point,o[1].point)<.01||(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?(r.start=o[0].point,r.end=o[1].point):(r.start=o[1].point,r.end=o[0].point),r.isintersect=!0,r.type=4)}return r},zt:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null},o=[];if(this.Vt(t,n)&&(r.start=t),this.Vt(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0;else{for(var s=1;s<i;s++){var a=this.Gt(t,e,n[s-1],n[s]);if(a.isintersect){if(null!=r.start)return r.end=a.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(a)}}var A=this.Gt(t,e,n[0],n[i-1]);if(A.isintersect){if(null!=r.start)return r.end=A.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(A)}2==o.length&&(r.start=(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.end=(this.distanceOfTwoPoints(o[0].point,t)>this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.isintersect=!0)}return r},Xt:function(t,e){if(0==e.length)return[t];var n,i,r=this.qt(e),o=[],s=(r.sort(function(e,n){var i=(e.Ht.x-t.Ht.x)*(e.Ht.x-t.Ht.x)+(e.Ht.y-t.Ht.y)*(e.Ht.y-t.Ht.y),r=(n.Ht.x-t.Ht.x)*(n.Ht.x-t.Ht.x)+(n.Ht.y-t.Ht.y)*(n.Ht.y-t.Ht.y);e=(e.Qt.x-t.Ht.x)*(e.Qt.x-t.Ht.x)+(e.Qt.y-t.Ht.y)*(e.Qt.y-t.Ht.y),n=(n.Qt.x-t.Ht.x)*(n.Qt.x-t.Ht.x)+(n.Qt.y-t.Ht.y)*(n.Qt.y-t.Ht.y);return(i<e?i:e)<(r<n?r:n)}),0);for(s=0;s<r.length;s++)this.distanceOfTwoPoints(r[s].Ht,r[s].Qt)<.01||(n=this.distanceOfTwoPoints(r[s].Ht,t.Ht),i=this.distanceOfTwoPoints(r[s].Qt,t.Ht),n<.01?t.Ht=r[s].Qt:i<.01?t.Ht=r[s].Ht:n<i?.1<this.distanceOfTwoPoints(t.Ht,r[s].Ht)&&(o.push({Kt:t.Kt,Ht:t.Ht,Qt:r[s].Ht,dt:t.dt,Jt:t.Jt}),t.Ht=r[s].Qt):.1<this.distanceOfTwoPoints(t.Ht,r[s].Qt)&&(o.push({Kt:t.Kt,Ht:t.Ht,Qt:r[s].Qt,dt:t.dt,Jt:t.Jt}),t.Ht=r[s].Ht),r.splice(s,1));return.1<this.distanceOfTwoPoints(t.Ht,t.Qt)&&o.push(t),o},qt:function(t){var e=[];if(1==t.length)return t;for(var n=t[0],i=1;0<t.length;){if(i>=t.length){if(e.push(n),t.splice(0,1),t.length<1)break;n=t[0],i=1}if(1===t.length){e.push(n);break}this.$t(n.Ht,n.Qt,t[i].Ht)?(this.$t(n.Ht,n.Qt,t[i].Qt)||(n.Qt=t[i].Qt),t.splice(i,1)):this.$t(n.Ht,n.Qt,t[i].Qt)?(n.Ht=t[i].Ht,t.splice(i,1)):this.$t(t[i].Ht,t[i].Qt,n.Ht)?(this.$t(t[i].Ht,t[i].Qt,n.Qt)||(t[i].Qt=n.Qt),n=t[i],t.splice(i,1)):this.$t(t[i].Ht,t[i].Qt,n.Qt)?(t[i].Ht=n.Ht,n=t[i],t.splice(i,1)):i++}return e},$t:function(t,e,n){var i=t.x-n.x,r=t.y-n.y,o=e.x-n.x,s=e.y-n.y,a=this.distanceOfTwoPoints(t,n);n=this.distanceOfTwoPoints(e,n),t=this.distanceOfTwoPoints(t,e);return i*s-r*o<1e-5&&a+n-t<.001}});var ft=new f;function pt(t){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===pt(t=function(t,e){if("object"!==pt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==pt(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}f=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.tr={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.rr={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}var e,n;return e=t,(n=[{key:"min",get:function(){return this.tr}},{key:"max",get:function(){return this.rr}},{key:"center",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}},{key:"size",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}},{key:"copy",value:function(t){return this.rr.x=t.max.x,this.rr.y=t.max.y,this.tr.x=t.min.x,this.tr.y=t.min.y,this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"reset",value:function(){this.tr={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.rr={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}},{key:"toObject",value:function(){return{min:this.min,max:this.max,center:this.center,size:this.size}}},{key:"expand",value:function(t){this.nr(t)}},{key:"expandByCoords",value:function(t){this.ir(t)}},{key:"valid",value:function(){return this.er()}},{key:"isCross",value:function(t){var e=!0;return t.max.x<this.min.x&&(e=!1),t.min.x>this.max.x&&(e=!1),t.max.y<this.min.y&&(e=!1),!(t.min.y>this.max.y)&&e}}])&&dt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var yt=(Object.assign(f.prototype,{er:function(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},nr:function(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},ir:function(t){var e=this;t&&0!=t.length&&t.forEach(function(t){t.x<e.min.x&&(e.min.x=t.x),t.y<e.min.y&&(e.min.y=t.y),t.x>e.max.x&&(e.max.x=t.x),t.y>e.max.y&&(e.max.y=t.y)})}}),f);function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gt(t,e){return(gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function vt(t){return(vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gt(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=vt(t);if(n=e?(n=vt(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===mt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).sr=new yt,t.ur=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var bt=(Object.assign(f.prototype,{X:function(t){return t.getType()!=k.MODEL?this.ar(t):this.hr(t)},hr:function(t){return!0},cr:function(t){return t=t.getBound(),!!ft.ft(this.sr.tr,this.sr.rr,t.min,t.max)},H:function(t,e){var n=t.getCoordinates();if(t.getType()!==k.MODEL)e.dt=Math.sqrt(ft.wt(n[0],this.lr));else{for(var i=Number.MAX_VALUE,r=0,o=n.length;r<o;r++)for(var s=1,a=n[r].length;s<a;s++){var A=n[r][s-1],l=n[r][s];(A=ft.xt(this.lr,A,l))<i&&(i=A)}e.dt=Math.sqrt(i)}},ar:function(t){return t=t.getCoordinates()[0],!!ft.ct(t,this.sr.tr,this.sr.rr)&&("circle"===this.ur?ft.wt(t,this.lr)<this.vr:ft.yt(t,this.yr,this.yr.length-1))}}),f);function xt(t){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wt(t,e){return(wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Bt(t){return(Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=bt;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&wt(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Bt(t);if(n=e?(n=Bt(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===xt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).ur="circle",t.lr=t.Y.center,t.br=t.Y.radius,t.vr=t.Y.radius*t.Y.radius,t.sr.ir([{x:t.lr.x-t.br,y:t.lr.y-t.br},{x:t.lr.x+t.br,y:t.lr.y+t.br}]),t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Mt=(Object.assign(f.prototype,{hr:function(t){if(this.cr(t))for(var e=t.getCoordinates(),n=0,i=e.length;n<i;n++)for(var r=1,o=e[n].length;r<o;r++){var s=e[n][r];if(ft.wt(s,this.lr)<this.vr)return!0;var a=e[n][r-1];if(1==r&&ft.wt(a,this.lr)<this.vr)return!0;if(ft.xt(this.lr,a,s)<this.vr)return!0}return!1}}),f);function St(t){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _t(t,e){return(_t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Et(t){return(Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=bt;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Et(t);if(n=e?(n=Et(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===St(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).ur="polygon",t.yr=t.Y,t.dr=t.yr.length-1,t.lr=ft.jt(t.yr),t.sr.ir(t.yr),t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Tt=(Object.assign(f.prototype,{hr:function(t){if(this.cr(t)){for(var e=t.getCoordinates(),n=0,i=e.length;n<i;n++)for(var r=0,o=e[n].length-1;r<o;r++)if(ft.yt(e[n][r],this.yr,this.yr.length))return!0;for(var s=0;s<this.dr;s++){for(var a=!1,A=0,l=e.length;A<l;A++)ft.yt(this.yr[s],e[A],e[A].length-1)&&(a=0==A);if(a)return!0}for(var u=0;u<=this.dr;u++)for(var h=null,c=u===this.dr?(h=this.yr[0],this.yr[u]):(h=this.yr[u],this.yr[u+1]),f=0,p=e.length;f<p;f++)for(var d=0,y=e[f].length-1;d<y;d++){var m=e[f][d],g=e[f][d+1];if(ft.ht(h,c,m,g))return!0}}return!1}}),f);function Ct(t){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){return(Ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ot(t){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ft(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ot(t);if(n=e?(n=Ot(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ct(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return n.call(this,t,e);throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Pt=(Object.assign(f.prototype,{X:function(t){return!1}}),f);function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e){return(Rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function It(t){return(It=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}f=function(){var t=i,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Rt(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=It(t);if(n=e?(n=It(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ut(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e){if(this instanceof i)return(t=n.call(this,t,e)).pr=t.Y.point,t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Lt=(Object.assign(f.prototype,{X:function(t){return t.getType()==k.MODEL&&this.hr(t)},hr:function(t){var e=t.getBound();if(!ft.ct(this.pr,e.min,e.max))return!1;for(var n=t.getCoordinates(),i=0,r=0,o=n.length;r<o&&(ft.yt(this.pr,n[r],n[r].length-1)&&i++,!(1<i));r++);return 1==i}}),f);function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Dt(t=function(t,e){if("object"!==Dt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Dt(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var kt=new(function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var e,n;return e=t,(n=[{key:"create",value:function(t){if(!t||"object"!=Dt(t))return null;var e,n=[];for(e in t)switch(e){case"FID":n.push(new g(e,t[e]));break;case"name":n.push(new _(e,t[e]));break;case"ename":n.push(new F(e,t[e]));break;case"keyword":n.push(new Q(e,t[e]));break;case"typeID":n.push(new R(e,t[e]));break;case"circle":n.push(new Mt(e,t[e]));break;case"polygon":n.push(new Tt(e,t[e]));break;case"buffer":n.push(new Pt(e,t[e]));break;case"contain":n.push(new Lt(e,t[e]))}return n}}])&&Qt(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function Nt(t){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Nt(t=function(t,e){if("object"!==Nt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Nt(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}f=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.mr=null,this.wr=r.MODEL,this._r=null,this.gr=[],this.jr=[],this.Sr=!1,this.Or=null}var e,n;return e=t,(n=[{key:"levels",get:function(){return this.mr},set:function(t){this.mr=t}},{key:"type",get:function(){return this.wr},set:function(t){this.wr=t}},{key:"addCondition",value:function(t){var e,n=kt.create(t);(e=this.jr).push.apply(e,function(t){return function(t){if(Array.isArray(t))return jt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?jt(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n)),this.gr.push(t)}},{key:"onlyInBuilding",get:function(){return this.Sr},set:function(t){this.Sr=t}},{key:"buildings",get:function(){return this.Or},set:function(t){this.Or=t}},{key:"buildingID",get:function(){return this._r},set:function(t){this._r=t}}])&&Ht(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var zt=n(1),Vt=0,Gt=2,Yt=4,Kt=8,Xt=404,Wt=64;function Zt(t){return(Zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qt(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function Jt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,$t(i.key),i)}}function $t(t){return"symbol"===Zt(t=function(t,e){if("object"!==Zt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Zt(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}var te=function(t,e,n){return e&&Jt(t.prototype,e),n&&Jt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Er=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qt(Object(n),!0).forEach(function(e){var i,r;i=t,r=n[e=e],(e=$t(e))in i?Object.defineProperty(i,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qt(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({data:null,method:"GET",responseType:"json"},e),this.Tr=null}),ee=(Object.assign(te.prototype,{Rr:function(t,e,n){var i=this.Er,r=i.data,o=i.method,s=i.url,a=i.responseType,A=i.header,l=null;if((l=new("undefined"!=typeof XMLHttpRequest?XMLHttpRequest:zt.a.global().fengmap.XMLHttpRequest)).responseType=a,l.open(o,s),"object"==Zt(A))for(var u in A)l.setRequestHeader(u,A[u]);l.addEventListener("load",function(){200===l.status||0===l.status||201===l.status?t&&t(l.response):e&&(404===l.status?e(Xt):2069===l.response.error_code?e(Vt):2063===l.response.error_code?e(Gt):400===l.response.error_code?e(Yt):e(l.response))}),l.addEventListener("timeout",function(t){n&&n(t)}),l.addEventListener("error",function(t){e&&e(t)}),l.send(JSON.stringify(r)),this.Tr=l},Mr:function(){this.Tr&&this.Tr.abort&&(this.Tr.abort(),this.Tr=null)}}),te),ne=(te=n(27),n.n(te));function ie(t){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function re(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ie(t=function(t,e){if("object"!==ie(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ie(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}for(var oe=["TmF2aVNlZ21lbg==","YWNjZXNzaWJsZQ==","Zmlk","bmZv","Rmxvb3JHZW8=","bGlmdFR5cGU=","bGVu","dmVs","ZXh0ZW50TGF5ZQ==","RXh0ZW50Qml6SQ==","cmVhZE9ubHk=","LnByb3RvYnVm","aW50MzI=","ZG9vcnR5cGU=","R0VPUE9JTlRfTQ==","TmF2aVpvbmU=","ZW50cmFuY2VGbA==","bGVuZ3Ro","ZWxCaXpJbmZv","c3RhaXJMYXllcg==","dG9CaWQ=","R2F0ZQ==","b2Zmc2V0WQ==","Zmlkcw==","aXNTZWxlY3RhYg==","ZmxhZw==","ZXh0ZXJuYWxNbw==","bGlmdEVudHJ5","VklTRUdNRU5U","SW5kZXhJbmZv","ZGF0YQ==","ZGVsQml6SW5mbw==","bWlk","cG9pTGF5ZXI=","bW9kZWxpZA==","cGFja2Vk","dGhyb3VnaA==","bmF2aVNlZ21lbg==","bGlmdExheWVy","cmVwZWF0ZWQ=","ZGVmQ2VuWQ==","b29y","bm9kZUlk","TmF2aU1vZGVs","cmFuaw==","c25vZGU=","cHRz","ZGVmR2lk","aGFzaENvZGU=","bmVzdGVk","Ymlk","cmVxdWlyZWQ=","R0VPTElORV9OQQ==","b2Zmc2V0WA==","TmF2aU5vZGU=","bHR5cGU=","T1ZFUkxBWURBVA==","ZGVmQ2VuWA==","b3B0aW9ucw==","YmFzZUxldmVs","YXJlYQ==","TGF5ZXJHcm91cA==","ZmllbGRz","cGFzcw==","Zmxvb3Jz","SUZU","Rmxvb3JOYXZp","amF2YV9vdXRlcg==","UG9seWdvbkxhYg==","ZW50cmFuY2VUeQ==","VHlwZQ==","bmF2aVpvbmVz","ZWxMYXllcg==","YWxpYXM=","d2lkdGg=","YXllcg==","ZW50cnl0eXBlcw==","TGlmdEJpekluZg==","bm9kZXR5cGVz","amF2YV9wYWNrYQ==","bmF2aVR5cGU=","ZGF0ZVZlcg==","bGlmdEZsYWc=","Z2lk","bWF4WA==","bW5hbWU=","bWluU2NhbGVMZQ==","Zmxvb3JJZA==","X2NsYXNzbmFtZQ==","TW9kZWxCaXpJbg==","Zmxvb3I=","bmFtZQ==","c2NhbGVMZXZlbA==","RXh0ZXJuYWxNbw==","cGdpZA==","ZmlsZVZlcg==","VEFJUg==","bWlubGV2ZWw=","Rmxvb3JDb25maQ==","R2VuZXJhbEdlbw==","ZHJpdmU=","Ym9vbA==","a2V5","R0VPUE9MWUdPTg==","dG9HaWQ=","ZGVmQ2VuWg==","YnR5cGU=","R0VPUE9JTlRfUw==","cC5wbGF0Zm9ybQ==","TmF2aUZsb29y","ZmxvYXQ=","bmF2aUV4dGVudA==","UE9JQml6SW5mbw==","TGFiZWxCaXpJbg==","TGF5ZXI=","cnVsZQ==","bGlk","Y29tLmZlbmdtYQ==","c2NhbGU=","c2VnbWVudElk","ZGVzYw==","ZGVsTGF5ZXI=","R0VPUE9JTlRfUA==","cm90YXRlQW5nbA==","X0xBQkVM","cG9seWdvbkxheQ==","ZmlsZURhdGU=","R0VPUE9JTlRfTA==","U3RhaXJCaXpJbg==","ZXNjYWxhdG9yTA==","bGlua1NlZw==","QnVmZmVy","TmF2aUV4dGVudA==","Z2Vv","R0VPTElORQ==","bmF2aU5vZGVz","cmVqZWN0cw==","UG9seWdvbkJpeg==","aXNWaXNpYmxl","b25zaGlw","YnVmZmVycw==","bWF4bGV2ZWw=","ZG91Ymxl","R0VPUE9JTlRfRQ==","bmF2aQ==","Rmxvb3JCaXo=","Z1Byb3RvQnVm","T0RFTA==","ZW5hbWU=","bW9kZWxMYXllcg==","a2V5cw==","ZWlk","bGF5ZXJz","QU5PUkFNQQ==","UkRFUg==","R0VPUE9JTlQ=","QnVpbGRpbmc=","bWluWA==","TWFw","aGVpZ2h0","c3RyaW5n","dHlwZQ==","ZGVmYXVsdA==","cG9seWdvbkxhYg==","TmF2aVJlbGF0aQ==","dWludDY0","aWR4cw==","SW5mbw==","X0VYVEVOVA=="],se=oe,ae=218;--ae;)se.push(se.shift());function Ae(t,e){var n=oe[t=+t],i=(void 0===Ae.ngQRZk&&((i=function(){var t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(e){t=window}return t}()).atob||(i.atob=function(t){for(var e,n,i=String(t).replace(/=+$/,""),r="",o=0,s=0;n=i.charAt(s++);~n&&(e=o%4?64*e+n:n,o++%4)&&(r+=String.fromCharCode(255&e>>(-2*o&6))))n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return r}),Ae.bOCUYG=function(t){for(var e=atob(t),n=[],i=0,r=e.length;i<r;i++)n+="%"+("00"+e.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(n)},Ae.TcYoxp={},Ae.ngQRZk=!0),Ae.TcYoxp[t]);return void 0===i?(n=Ae.bOCUYG(n),Ae.TcYoxp[t]=n):n=i,n}var le=function(t,e,n){return e&&re(t.prototype,e),n&&re(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");var e,n,i,r,o,s,a,A,l,u,h,c,f,p,d,y,m,g,v,b,x,w={},B=((r=((x=((M=((g=((l=((a=((d=((y=((b=(w[Ae("0x1f")+"ge"]=Ae("0x45")+Ae("0x3c")+Ae("0x84"),w[Ae("0x13")+Ae("0x28")]=Ae("0x32")+Ae("0x62"),{}))[Ae("0x43")]="required",b[Ae("0x71")]=Ae("0x70"),b.id=1,{})).rule=Ae("0x3"),y[Ae("0x71")]=Ae("0x85"),y.id=2,{})).rule=Ae("0x3"),d.type=Ae("0x75"),d.id=3,{}))[Ae("0x43")]=Ae("0x3"),a[Ae("0x71")]=Ae("0x70"),a.id=4,{}))[Ae("0x43")]=Ae("0x3"),l[Ae("0x71")]=Ae("0x70"),l.id=5,{}))[Ae("0x71")]=Ae("0x70"),g.id=6,{}))[Ae("0x71")]=Ae("0x70"),M.id=7,{}))[Ae("0x71")]=Ae("0x70"),x.id=8,{}))[Ae("0x72")]=!1,{}),M=((g=((l=((a=((d=((y=((b=((A=((C=((r=(B.type="bool",B.id=9,B[Ae("0xa")]=r,{}))[Ae("0x43")]="repeated",r[Ae("0x71")]=Ae("0x53"),r.id=10,{})).rule="repeated",C.type=Ae("0x70"),C.id=11,{}))[Ae("0x99")]=b,A.fileVer=y,A[Ae("0x21")]=d,A[Ae("0x25")]=a,A.hashCode=l,A[Ae("0x36")]=g,A[Ae("0x4e")]=M,A.desc=x,A.readOnly=B,A[Ae("0x5c")]=r,A[Ae("0x66")]=C,{}))[Ae("0x43")]=Ae("0x3"),b[Ae("0x71")]="int32",b.id=1,{}))[Ae("0x43")]=Ae("0x3"),y.type=Ae("0x85"),y.id=2,{}))[Ae("0x43")]="required",d[Ae("0x71")]="int32",d.id=3,{})).rule="required",a[Ae("0x71")]=Ae("0x75"),a.id=4,{})).rule=Ae("0x3"),l[Ae("0x71")]="bytes",l.id=5,{}))[Ae("0x23")]=b,g[Ae("0x2f")]=y,g[Ae("0x3a")]=d,g[Ae("0x7f")]=a,g[Ae("0x97")]=l,{}),S=(M=((g=((l=((a=((d=((y=((b=((C=((r=((B=((x=(M[Ae("0xe")]=g,{})).Buffer=M,{}))[Ae("0xe")]=A,B.nested=x,{}))[Ae("0x43")]=Ae("0x3"),r[Ae("0x71")]="string",r.id=19,{})).rule=Ae("0x3"),C.type=Ae("0x85"),C.id=20,{}))[Ae("0x43")]=Ae("0x3"),b[Ae("0x71")]="uint64",b.id=21,{}))[Ae("0x43")]=Ae("0x3"),y[Ae("0x71")]=Ae("0x70"),y.id=22,{})).rule=Ae("0x3"),d[Ae("0x71")]=Ae("0x70"),d.id=23,{})).type="string",a.id=24,{}))[Ae("0x71")]=Ae("0x70"),l.id=25,{}))[Ae("0x72")]=!1,{}),(f=((O=((_=((m=((n=((o=((e=((E=((g=((x=((A=(M[Ae("0x71")]=Ae("0x35"),M.id=26,M[Ae("0xa")]=g,{}))[Ae("0x71")]=Ae("0x3e"),A.id=1,{}))[Ae("0x71")]="float",x.id=2,{}))[Ae("0x71")]="float",g.id=3,{}))[Ae("0x71")]=Ae("0x3e"),E.id=4,{})).type=Ae("0x3e"),e.id=5,{})).type=Ae("0x3e"),o.id=6,{})).type=Ae("0x3e"),n.id=7,{}))[Ae("0x71")]=Ae("0x70"),m.id=8,{})).type=Ae("0x3e"),_.id=9,{}))[Ae("0x71")]=Ae("0x3e"),O.id=10,{}))[Ae("0x71")]=Ae("0x3e"),f.id=11,{}),_=(S=((f=((O=((_=((m=((n=((o=((e=((E=((g=((x=((A=((M=((l=((a=((d=((y=((b=((C=((r=((v=((T=((s=((F=((p=((u=((c=((i=((h=(S.type=Ae("0x3e"),S.id=12,{}))[Ae("0x71")]=Ae("0x3e"),h.id=13,{}))[Ae("0x71")]=Ae("0x3e"),i.id=14,{})).type=Ae("0x3e"),c.id=15,{}))[Ae("0x71")]=Ae("0x3e"),u.id=16,{}))[Ae("0x71")]=Ae("0x70"),p.id=17,{}))[Ae("0x71")]="int32",F.id=28,{})).rule=Ae("0xa0"),s[Ae("0x71")]="LayerGroup",s.id=18,{}))[Ae("0x43")]="repeated",T[Ae("0x71")]=Ae("0x6c"),T.id=27,{})).mid=r,v.fileVer=C,v[Ae("0x21")]=b,v[Ae("0x25")]=y,v[Ae("0x0")]=d,v[Ae("0x36")]=a,v[Ae("0x48")]=l,v[Ae("0x83")]=M,v.x=A,v.y=x,v.z=g,v[Ae("0x6d")]=E,v.minY=e,v[Ae("0x24")]=o,v.maxY=n,v[Ae("0xa8")]=m,v[Ae("0x9")]=_,v[Ae("0xa1")]=O,v[Ae("0x39")]=f,v[Ae("0x6f")]=S,v[Ae("0x4b")+"eX"]=h,v.rotateAngleY=i,v[Ae("0x4b")+"eZ"]=c,v[Ae("0x46")]=u,v[Ae("0x2c")]=p,v[Ae("0x20")]=F,v.layerGroups=s,v.buildings=T,{}))[Ae("0x71")]=Ae("0x85"),r.id=1,{}))[Ae("0x71")]=Ae("0x70"),C.id=2,{}))[Ae("0x71")]=Ae("0x70"),b.id=3,{}))[Ae("0x71")]=Ae("0x16"),y.id=4,{})).type=Ae("0x3e"),d.id=5,{}))[Ae("0x71")]=Ae("0x3e"),a.id=6,{}))[Ae("0x71")]=Ae("0x3e"),l.id=7,{}))[Ae("0x71")]=Ae("0x3e"),M.id=8,{}))[Ae("0x71")]=Ae("0x3e"),A.id=9,{}))[Ae("0x71")]=Ae("0x3e"),x.id=10,{}))[Ae("0x71")]=Ae("0x3e"),g.id=11,{}))[Ae("0x71")]=Ae("0x3e"),E.id=12,{}))[Ae("0x71")]=Ae("0x35"),e.id=13,{}))[Ae("0x71")]=Ae("0x35"),o.id=14,{}))[Ae("0x71")]=Ae("0x35"),n.id=15,{})).type=Ae("0x70"),m.id=16,{}))[Ae("0x44")]=r,_.lname=C,_[Ae("0x19")]=b,_[Ae("0x7")]=y,_[Ae("0x5")]=d,_[Ae("0x8f")]=a,_[Ae("0x6f")]=l,_[Ae("0x4b")+"eX"]=M,_.rotateAngleY=A,_[Ae("0x4b")+"eZ"]=x,_[Ae("0x26")+Ae("0x80")]=g,_["maxScaleLe"+Ae("0x80")]=E,_[Ae("0x5a")]=e,_[Ae("0x91")+"le"]=o,_.isEditable=n,_[Ae("0x48")]=m,{}))[Ae("0x6b")]=1,O[Ae("0x5f")+"SCALATOR"]=2,O[Ae("0x4f")+Ae("0x11")]=3,O[Ae("0x3b")+Ae("0x30")]=4,O[Ae("0x4a")+Ae("0x69")]=5,O[Ae("0x4a")+"OI"]=6,O[Ae("0x3b")+"TORELABEL"]=7,O.GEOPOINT_NAVINODE=8,O[Ae("0x87")+Ae("0x63")]=9,O[Ae("0x56")]=20,O[Ae("0x4")+Ae("0x95")]=21,O["GEOLINE_BO"+Ae("0x6a")]=22,O[Ae("0x37")]=30,O[Ae("0x37")+Ae("0x78")]=31,O.GEOPOLYGON_STORE=32,O[Ae("0x37")+Ae("0x4c")]=33,O.RASTERATA=40,O[Ae("0x8")+"A"]=50,{})).values=O,{}),(f=((O=((m=((n=((o=((e=((E=((g=((x=((A=((M=((l=((a=((d=((y=((b=((C=((r=((T=((s=((F=((p=((u=((c=((i=((h=(S[Ae("0x16")]=f,{}))[Ae("0xe")]=_,h[Ae("0x1")]=S,{}))[Ae("0x71")]="int32",i.id=1,{}))[Ae("0x71")]="string",c.id=2,{}))[Ae("0x71")]="string",u.id=3,{}))[Ae("0x71")]=Ae("0x3e"),p.id=4,{}))[Ae("0x71")]=Ae("0x70"),F.id=5,{}))[Ae("0x43")]="repeated",s[Ae("0x71")]=Ae("0x42"),s.id=6,{}))[Ae("0x71")]=Ae("0x70"),T.id=7,{}))[Ae("0x71")]="int32",r.id=8,{})).gid=i,C.gname=c,C[Ae("0x19")]=u,C[Ae("0x6f")]=p,C[Ae("0x48")]=F,C[Ae("0x68")]=s,C[Ae("0x27")]=T,C[Ae("0x20")]=r,{}))[Ae("0xe")]=C,{}))[Ae("0x71")]=Ae("0x85"),y.id=1,{}))[Ae("0x71")]=Ae("0x3e"),d.id=2,{}))[Ae("0x71")]=Ae("0x3e"),a.id=3,{})).type=Ae("0x3e"),l.id=4,{})).type=Ae("0x3e"),M.id=5,{}))[Ae("0x71")]="float",A.id=6,{}))[Ae("0x71")]=Ae("0x3e"),x.id=7,{}))[Ae("0x43")]=Ae("0xa0"),g.type=Ae("0x70"),g.id=8,{})).type=Ae("0x85"),E.id=9,{})).type="bool",e.id=10,{}))[Ae("0x71")]=Ae("0x85"),o.id=11,{}))[Ae("0x71")]="int32",n.id=12,{}))[Ae("0x71")]=Ae("0x70"),m.id=13,{})).rule="repeated",O[Ae("0x71")]=Ae("0x96"),O.id=14,{}))[Ae("0x9c")]=!1,{}),E=((g=((x=((A=((M=((l=((a=((d=((y=((f=((C=((r=((T=((s=((F=((p=((u=((c=((i=((S=(_[Ae("0x43")]=Ae("0xa0"),_.type=Ae("0x5e"),_.id=15,_[Ae("0xa")]=f,{}))[Ae("0x23")]=y,S.x=d,S.y=a,S.offsetX=l,S[Ae("0x8f")]=M,S.angle=A,S.scale=x,S[Ae("0x90")]=g,S[Ae("0x2e")]=E,S[Ae("0xb")]=e,S.minlevel=o,S[Ae("0x5d")]=n,S.floorId=m,S.idxs=O,S[Ae("0xa7")]=_,{}))[Ae("0x9c")]=!1,{})).rule=Ae("0xa0"),c[Ae("0x71")]=Ae("0x85"),c.id=1,c[Ae("0xa")]=i,{}))[Ae("0x76")]=c,{}))[Ae("0xe")]=u,{})).IndexInfo=p,{}))[Ae("0xe")]=S,s[Ae("0x1")]=F,{}))[Ae("0x71")]=Ae("0x70"),T.id=1,{})).type="string",r.id=2,{})).type=Ae("0x70"),C.id=3,{}))[Ae("0x71")]=Ae("0x70"),f.id=4,{})).type="float",y.id=5,{}))[Ae("0x71")]=Ae("0x3e"),d.id=6,{})).type=Ae("0x70"),a.id=7,{}))[Ae("0x71")]=Ae("0x85"),l.id=8,{}))[Ae("0x43")]="repeated",M[Ae("0x71")]="Floor",M.id=9,{}))[Ae("0x71")]="int32",A.id=10,{}))[Ae("0x2")]=T,x[Ae("0x2b")]=r,x[Ae("0x64")]=C,x[Ae("0x19")]=f,x.x=y,x.y=d,x.mid=a,x.version=l,x.floors=M,x.bcode=A,{})).fields=x,{}),T=(E=((v=((g=((s=((b=((h=((x=((A=((M=((l=((a=((d=((y=((f=((C=((r=((T=((F=((S=((p=((u=((c=((i=((_=((O=((m=((n=((o=((e=(E[Ae("0x42")]=h,E[Ae("0xd")]=b,E.Floor=s,E[Ae("0x6c")]=g,{}))[Ae("0xe")]=v,e[Ae("0x1")]=E,{}))[Ae("0x43")]=Ae("0x3"),o[Ae("0x71")]=Ae("0x70"),o.id=1,{}))[Ae("0x43")]="repeated",n[Ae("0x71")]=Ae("0x3d"),n.id=2,{})).mid=o,m[Ae("0x10")]=n,{}))[Ae("0x71")]="int32",O.id=1,{}))[Ae("0x71")]="string",_.id=2,{}))[Ae("0x71")]=Ae("0x70"),i.id=3,{}))[Ae("0x71")]=Ae("0x70"),c.id=4,{}))[Ae("0x43")]=Ae("0xa0"),u.type=Ae("0x74")+Ae("0x5b"),u.id=5,{}))[Ae("0x43")]=Ae("0xa0"),p[Ae("0x71")]=Ae("0x74")+Ae("0x5b"),p.id=6,{}))[Ae("0x43")]=Ae("0xa0"),S[Ae("0x71")]=Ae("0x74")+Ae("0x5b"),S.id=7,{})).gid=O,F[Ae("0x27")]=_,F[Ae("0x2")]=i,F[Ae("0x99")]=c,F[Ae("0x60")]=u,F[Ae("0x34")]=p,F.accessible=S,{}))[Ae("0xe")]=F,{}))[Ae("0x43")]=Ae("0x3"),r[Ae("0x71")]="int32",r.id=1,{}))[Ae("0x71")]=Ae("0x85"),C.id=2,{}))[Ae("0x71")]=Ae("0x85"),f.id=3,{}))[Ae("0x43")]=Ae("0xa0"),y[Ae("0x71")]="IndexInfo",y.id=4,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),a[Ae("0x71")]=Ae("0x5e"),a.id=5,a.options=d,{})).type=Ae("0x85"),l.id=6,{}))[Ae("0x43")]=Ae("0xa0"),M.type=Ae("0x70"),M.id=7,{}))[Ae("0x43")]="repeated",A[Ae("0x71")]="string",A.id=8,{}))[Ae("0x67")]=r,x[Ae("0x71")]=C,x[Ae("0x7a")]=f,x[Ae("0x76")]=y,x[Ae("0xa7")]=a,x[Ae("0x92")]=l,x[Ae("0x8d")]=M,x[Ae("0x38")]=A,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),b[Ae("0x71")]=Ae("0x85"),b.id=1,b.options=h,{}))[Ae("0x76")]=b,{}))[Ae("0xe")]=s,{}))[Ae("0x96")]=g,{}),(v=((x=((g=((s=((b=((h=((A=((M=((l=((a=((y=((f=((C=((r=((d=((F=((S=((p=((u=((c=((i=((_=((O=((n=((o=(E[Ae("0xe")]=x,E.nested=v,{}))[Ae("0x3d")]=T,o[Ae("0x74")+Ae("0x5b")]=E,{})).fields=m,n[Ae("0x1")]=o,{}))[Ae("0x43")]=Ae("0x3"),O[Ae("0x71")]=Ae("0x70"),O.id=1,{}))[Ae("0x43")]="required",_[Ae("0x71")]=Ae("0x85"),_.id=2,{})).type=Ae("0x3e"),i.id=3,{}))[Ae("0x43")]=Ae("0xa0"),c[Ae("0x71")]=Ae("0x33")+Ae("0x77"),c.id=4,{})).rule=Ae("0xa0"),u[Ae("0x71")]=Ae("0x33")+"Info",u.id=5,{})).rule="repeated",p[Ae("0x71")]="GeneralGeo"+Ae("0x77"),p.id=6,{}))[Ae("0x43")]="repeated",S[Ae("0x71")]="GeneralGeoInfo",S.id=7,{}))[Ae("0x43")]="repeated",F[Ae("0x71")]=Ae("0x33")+Ae("0x77"),F.id=8,{})).rule=Ae("0xa0"),d[Ae("0x71")]=Ae("0x33")+"Info",d.id=9,{}))[Ae("0x43")]=Ae("0xa0"),r[Ae("0x71")]="GeneralGeoInfo",r.id=10,{}))[Ae("0x43")]=Ae("0xa0"),C.type=Ae("0x33")+Ae("0x77"),C.id=11,{}))[Ae("0x43")]=Ae("0xa0"),f[Ae("0x71")]=Ae("0x33")+"Info",f.id=12,{}))[Ae("0x43")]=Ae("0xa0"),y[Ae("0x71")]=Ae("0x33")+Ae("0x77"),y.id=13,{}))[Ae("0x99")]=O,a[Ae("0x23")]=_,a[Ae("0x6f")]=i,a[Ae("0x81")+"r"]=c,a[Ae("0x65")]=u,a.labelLayer=p,a[Ae("0x9a")]=S,a[Ae("0x4d")+"er"]=F,a[Ae("0x73")+"elLayer"]=d,a[Ae("0x9f")]=r,a[Ae("0x8c")]=C,a[Ae("0x51")+Ae("0x1b")]=f,a[Ae("0x93")+Ae("0x49")]=y,{}))[Ae("0x43")]=Ae("0x3"),l[Ae("0x71")]=Ae("0x85"),l.id=1,{}))[Ae("0x71")]="string",M.id=2,{}))[Ae("0x71")]=Ae("0x3e"),A.id=3,{})).type="float",h.id=4,{}))[Ae("0x43")]="repeated",b[Ae("0x71")]=Ae("0x96"),b.id=5,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),g.type=Ae("0x5e"),g.id=6,g[Ae("0xa")]=s,{})).eid=l,x[Ae("0x55")]=M,x[Ae("0x6f")]=A,x[Ae("0xc")]=h,x.idxs=b,x[Ae("0xa7")]=g,{})).packed=!1,{}),C=(T=((v=((g=((b=((h=((A=((M=((l=((s=((y=((f=((C=((r=((d=((F=((S=((p=((u=((c=((i=((_=((O=((o=((m=((E=(T[Ae("0x43")]=Ae("0xa0"),T.type=Ae("0x85"),T.id=1,T[Ae("0xa")]=v,{}))[Ae("0x76")]=T,{}))[Ae("0xe")]=E,{}))[Ae("0x96")]=m,{})).fields=x,O[Ae("0x1")]=o,{}))["GeneralGeo"+Ae("0x77")]=O,{}))[Ae("0xe")]=a,i[Ae("0x1")]=_,{})).rule=Ae("0x3"),c[Ae("0x71")]=Ae("0x70"),c.id=1,{}))[Ae("0x43")]=Ae("0x3"),u[Ae("0x71")]=Ae("0x85"),u.id=2,{}))[Ae("0x43")]="repeated",p[Ae("0x71")]=Ae("0x82")+Ae("0x7c"),p.id=3,{})).rule="repeated",S.type=Ae("0x29")+"fo",S.id=4,{}))[Ae("0x43")]=Ae("0xa0"),F.type=Ae("0x41")+"fo",F.id=5,{})).rule=Ae("0xa0"),d.type=Ae("0x40"),d.id=6,{}))[Ae("0x43")]=Ae("0xa0"),r.type=Ae("0x59")+"Info",r.id=7,{}))[Ae("0x43")]=Ae("0xa0"),C[Ae("0x71")]=Ae("0x1d")+"o",C.id=8,{}))[Ae("0x43")]=Ae("0xa0"),f.type=Ae("0x50")+"fo",f.id=9,{}))[Ae("0x43")]=Ae("0xa0"),y[Ae("0x71")]=Ae("0x14")+Ae("0x8b"),y.id=10,{}))[Ae("0x43")]=Ae("0xa0"),s[Ae("0x71")]=Ae("0x2d")+Ae("0x98"),s.id=11,{}))[Ae("0x99")]=c,l[Ae("0x23")]=u,l[Ae("0x81")+"r"]=p,l[Ae("0x65")]=S,l.labelLayer=F,l[Ae("0x9a")]=d,l[Ae("0x4d")+"er"]=r,l.liftLayer=C,l[Ae("0x8c")]=f,l["polygonLab"+Ae("0x18")]=y,l[Ae("0x93")+"delLayer"]=s,{})).rule=Ae("0x3"),M[Ae("0x71")]=Ae("0x85"),M.id=1,{})).type=Ae("0x70"),A.id=2,{}))[Ae("0x71")]=Ae("0x85"),h.id=3,{}))[Ae("0x71")]=Ae("0x70"),b.id=4,{})).type=Ae("0x70"),g.id=5,{}))[Ae("0x71")]="int32",v.id=6,{}),T=((v=((g=((b=((h=((A=((M=((s=((y=((f=((C=((r=((d=((F=((S=((p=((u=((c=((_=((a=((O=((o=((x=((m=((E=(T[Ae("0x71")]="int32",T.id=7,{})).eid=M,E[Ae("0x7b")]=A,E.type=h,E[Ae("0x2b")]=b,E[Ae("0x64")]=g,E[Ae("0x31")]=v,E[Ae("0x5d")]=T,{})).fields=E,{}))[Ae("0x43")]="required",x[Ae("0x71")]=Ae("0x85"),x.id=1,{}))[Ae("0x71")]="string",o.id=2,{}))[Ae("0x71")]="int32",O.id=3,{}))[Ae("0x71")]=Ae("0x70"),a.id=4,{}))[Ae("0x71")]=Ae("0x70"),_.id=5,{})).type=Ae("0x85"),c.id=6,{}))[Ae("0x71")]=Ae("0x85"),u.id=7,{}))[Ae("0x71")]="int32",p.id=8,{}))[Ae("0x67")]=x,S[Ae("0x7b")]=o,S[Ae("0x71")]=O,S[Ae("0x2b")]=a,S[Ae("0x64")]=_,S[Ae("0x31")]=c,S[Ae("0x5d")]=u,S[Ae("0xf")]=p,{}))[Ae("0xe")]=S,{}))[Ae("0x43")]=Ae("0x3"),d[Ae("0x71")]=Ae("0x85"),d.id=1,{}))[Ae("0x71")]=Ae("0x70"),r.id=2,{}))[Ae("0x71")]=Ae("0x85"),C.id=3,{}))[Ae("0x71")]=Ae("0x70"),f.id=4,{})).type=Ae("0x70"),y.id=5,{}))[Ae("0x71")]=Ae("0x85"),s.id=6,{})).type=Ae("0x85"),M.id=7,{}))[Ae("0x67")]=d,A[Ae("0x7b")]=r,A[Ae("0x71")]=C,A[Ae("0x2b")]=f,A[Ae("0x64")]=y,A[Ae("0x31")]=s,A.maxlevel=M,{})).fields=A,{}))[Ae("0x43")]=Ae("0x3"),b[Ae("0x71")]=Ae("0x85"),b.id=1,{}))[Ae("0x71")]=Ae("0x70"),g.id=2,{}))[Ae("0x71")]="int32",v.id=3,{}),T=((v=((g=((b=((A=((M=((s=((y=((f=((C=((r=((d=((S=((p=((u=((c=((_=((a=((O=((o=((x=((E=(T[Ae("0x71")]=Ae("0x70"),T.id=4,{}))[Ae("0x71")]=Ae("0x70"),E.id=5,{})).type="int32",x.id=6,{}))[Ae("0x71")]=Ae("0x85"),o.id=7,{}))[Ae("0x67")]=b,O.fid=g,O[Ae("0x71")]=v,O[Ae("0x2b")]=T,O[Ae("0x64")]=E,O[Ae("0x31")]=x,O[Ae("0x5d")]=o,{}))[Ae("0xe")]=O,{}))[Ae("0x43")]=Ae("0x3"),_.type=Ae("0x85"),_.id=1,{})).type=Ae("0x70"),c.id=2,{}))[Ae("0x71")]=Ae("0x85"),u.id=3,{}))[Ae("0x71")]=Ae("0x70"),p.id=4,{})).type=Ae("0x70"),S.id=5,{}))[Ae("0x71")]="int32",d.id=6,{})).type="int32",r.id=7,{})).eid=_,C[Ae("0x7b")]=c,C[Ae("0x71")]=u,C.name=p,C[Ae("0x64")]=S,C[Ae("0x31")]=d,C[Ae("0x5d")]=r,{}))[Ae("0xe")]=C,{}))[Ae("0x43")]="required",y[Ae("0x71")]=Ae("0x85"),y.id=1,{})).type=Ae("0x70"),s.id=2,{})).type=Ae("0x85"),M.id=3,{})).type=Ae("0x85"),A.id=4,{}))[Ae("0x71")]=Ae("0x70"),b.id=5,{})).type=Ae("0x85"),g.id=6,{}))[Ae("0x71")]=Ae("0x85"),v.id=7,{}),T=((v=((g=((b=((A=((M=((s=((y=((C=((r=((d=((S=((p=((u=((c=((_=((O=((o=((x=((E=(T[Ae("0x67")]=y,T[Ae("0x7b")]=s,T[Ae("0x71")]=M,T[Ae("0x92")]=A,T[Ae("0x2a")]=b,T[Ae("0x31")]=g,T[Ae("0x5d")]=v,{}))[Ae("0xe")]=T,{}))[Ae("0x43")]=Ae("0x3"),x[Ae("0x71")]="int32",x.id=1,{}))[Ae("0x71")]=Ae("0x70"),o.id=2,{}))[Ae("0x71")]=Ae("0x85"),O.id=3,{}))[Ae("0x71")]=Ae("0x85"),_.id=4,{}))[Ae("0x71")]="int32",c.id=5,{}))[Ae("0x71")]=Ae("0x85"),u.id=6,{}))[Ae("0x67")]=x,p[Ae("0x7b")]=o,p[Ae("0x71")]=O,p[Ae("0x92")]=_,p[Ae("0x31")]=c,p.maxlevel=u,{}))[Ae("0xe")]=p,{})).rule=Ae("0x3"),d[Ae("0x71")]=Ae("0x85"),d.id=1,{})).type=Ae("0x70"),r.id=2,{}))[Ae("0x71")]="int32",C.id=3,{}))[Ae("0x71")]="float",y.id=4,{}))[Ae("0x71")]=Ae("0x70"),s.id=5,{}))[Ae("0x71")]="string",M.id=6,{}))[Ae("0x71")]=Ae("0x3e"),A.id=7,{}))[Ae("0x67")]=d,b[Ae("0x7b")]=r,b[Ae("0x71")]=C,b[Ae("0x1a")]=y,b[Ae("0x2b")]=s,b[Ae("0x64")]=M,b.angle=A,{})).fields=b,{}))[Ae("0x43")]=Ae("0x3"),v[Ae("0x71")]="int32",v.id=1,{}),T=((v=((b=((A=((M=((s=((y=((C=((r=((d=((p=((u=((c=((_=((O=((o=((x=(T.type="string",T.id=2,{}))[Ae("0x71")]=Ae("0x85"),x.id=3,{}))[Ae("0x71")]=Ae("0x70"),o.id=4,{}))[Ae("0x71")]=Ae("0x70"),O.id=5,{}))[Ae("0x71")]="int32",_.id=6,{})).type=Ae("0x85"),c.id=7,{}))[Ae("0x67")]=v,u[Ae("0x7b")]=T,u[Ae("0x71")]=x,u.name=o,u[Ae("0x64")]=O,u[Ae("0x31")]=_,u[Ae("0x5d")]=c,{}))[Ae("0xe")]=u,{}))[Ae("0x82")+"nfo"]=m,d[Ae("0x29")+"fo"]=F,d[Ae("0x41")+"fo"]=h,d[Ae("0x59")+Ae("0x77")]=a,d.POIBizInfo=f,d[Ae("0x1d")+"o"]=E,d[Ae("0x50")+"fo"]=S,d[Ae("0x14")+Ae("0x8b")]=g,d[Ae("0x2d")+"delBizInfo"]=p,{}))[Ae("0xe")]=l,r.nested=d,{}))[Ae("0x43")]="required",C.type=Ae("0x70"),C.id=1,{}))[Ae("0x43")]="required",y.type=Ae("0x85"),y.id=2,{}))[Ae("0x43")]=Ae("0xa0"),s[Ae("0x71")]=Ae("0x6"),s.id=3,{}))[Ae("0x43")]="repeated",M[Ae("0x71")]=Ae("0x79")+"t",M.id=4,{}))[Ae("0x43")]=Ae("0xa0"),A[Ae("0x71")]=Ae("0x88"),A.id=5,{}))[Ae("0x43")]=Ae("0xa0"),b[Ae("0x71")]="NaviModel",b.id=6,{}))[Ae("0x9c")]=!1,{}),(v=((d=((l=((p=((g=((S=((E=((f=((a=((h=((F=((m=((u=((c=((_=((O=((o=((x=(T[Ae("0x43")]=Ae("0xa0"),T[Ae("0x71")]=Ae("0x85"),T.id=7,T[Ae("0xa")]=v,{}))[Ae("0x43")]=Ae("0xa0"),x[Ae("0x71")]="NaviExtent",x.id=8,{}))[Ae("0x99")]=C,o[Ae("0x23")]=y,o[Ae("0x57")]=s,o[Ae("0x9e")+"ts"]=M,o[Ae("0x17")]=A,o.naviModels=b,o.nextFloors=T,o[Ae("0x3f")+"s"]=x,{}))[Ae("0x71")]="int32",O.id=1,{})).type=Ae("0x85"),_.id=2,{}))[Ae("0x71")]=Ae("0x85"),c.id=3,{}))[Ae("0x71")]=Ae("0x85"),u.id=4,{}))[Ae("0x71")]="int32",m.id=5,{}))[Ae("0x71")]=Ae("0x70"),F.id=6,{})).type="string",h.id=7,{}))[Ae("0x71")]=Ae("0x70"),a.id=8,{}))[Ae("0x71")]="int32",f.id=9,{}))[Ae("0x71")]=Ae("0x70"),E.id=10,{}))[Ae("0x71")]=Ae("0x85"),S.id=11,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),p.type=Ae("0x85"),p.id=12,p[Ae("0xa")]=g,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),d[Ae("0x71")]=Ae("0x5e"),d.id=13,d[Ae("0xa")]=l,{})).default=0,{}),F=((m=((u=((c=((_=((O=((v=((l=((g=((x=((T=((b=((A=((M=((s=((y=(C.type="int32",C.id=14,C[Ae("0xa")]=v,{}))[Ae("0xa3")]=O,y.nodeType=_,y[Ae("0x7e")]=c,y[Ae("0x22")]=u,y[Ae("0x94")]=m,y.liftFloor=F,y[Ae("0x52")]=h,y[Ae("0x55")]=a,y[Ae("0x15")+"pe"]=f,y[Ae("0x89")+Ae("0xa2")]=E,y[Ae("0x86")]=S,y[Ae("0x76")]=p,y.pts=d,y[Ae("0x7a")]=C,{}))[Ae("0xe")]=y,{}))[Ae("0x71")]=Ae("0x85"),M.id=1,{}))[Ae("0x71")]="int32",A.id=2,{}))[Ae("0x71")]=Ae("0x85"),b.id=3,{}))[Ae("0x71")]=Ae("0x5e"),T.id=4,{}))[Ae("0x71")]=Ae("0x85"),x.id=5,{}))[Ae("0x71")]=Ae("0x70"),g.id=6,{}))[Ae("0x71")]=Ae("0x85"),l.id=7,{}))[Ae("0x71")]=Ae("0x70"),v.id=8,{}))[Ae("0x71")]=Ae("0x70"),O.id=9,{}))[Ae("0x71")]=Ae("0x85"),_.id=10,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]="repeated",u[Ae("0x71")]=Ae("0x85"),u.id=11,u[Ae("0xa")]=c,{}))[Ae("0x9c")]=!1,{}),O=((v=((l=((g=((x=((T=((b=((A=((M=((m=((c=((y=((C=((d=((p=((S=((E=((f=((a=((h=(F[Ae("0x43")]=Ae("0xa0"),F[Ae("0x71")]=Ae("0x5e"),F.id=12,F[Ae("0xa")]=m,{}))[Ae("0x47")]=M,h[Ae("0xa6")]=A,h.enode=b,h[Ae("0x8a")]=T,h[Ae("0xa5")]=x,h[Ae("0x2b")]=g,h.entry=l,h[Ae("0x48")]=v,h[Ae("0x55")]=O,h[Ae("0x9d")]=_,h[Ae("0x76")]=u,h[Ae("0xa7")]=F,{}))[Ae("0xe")]=h,{})).rule=Ae("0x3"),f[Ae("0x71")]=Ae("0x85"),f.id=1,{}))[Ae("0x72")]=0,{}))[Ae("0x43")]=Ae("0x3"),S.type=Ae("0x85"),S.id=2,S[Ae("0xa")]=E,{})).type=Ae("0x70"),p.id=3,{}))[Ae("0x43")]=Ae("0xa0"),d[Ae("0x71")]=Ae("0x70"),d.id=4,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),y[Ae("0x71")]="int32",y.id=5,y[Ae("0xa")]=C,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]="repeated",m[Ae("0x71")]=Ae("0x5e"),m.id=6,m[Ae("0xa")]=c,{})).id=f,M[Ae("0x71")]=S,M[Ae("0x55")]=p,M[Ae("0x58")]=d,M[Ae("0x76")]=y,M.pts=m,{}))[Ae("0xe")]=M,{}))[Ae("0x43")]="required",b[Ae("0x71")]=Ae("0x85"),b.id=1,{}))[Ae("0x9c")]=!1,{}))[Ae("0x43")]=Ae("0xa0"),x.type=Ae("0x85"),x.id=2,x.options=T,{})).packed=!1,{}))[Ae("0x43")]=Ae("0xa0"),l[Ae("0x71")]="int32",l.id=3,l[Ae("0xa")]=g,{}))[Ae("0x9c")]=!1,{});(x=((b=((v=((g=((T=((M=((m=((y=((d=((p=((S=((f=((c=((C=((E=((h=((F=((u=((_=(O[Ae("0x43")]=Ae("0xa0"),O.type=Ae("0x85"),O.id=4,O[Ae("0xa")]=v,{}))[Ae("0x9b")]=b,_.doorids=x,_[Ae("0x1e")]=l,_[Ae("0x1c")]=O,{}))[Ae("0xe")]=_,{}))[Ae("0x43")]=Ae("0x3"),F[Ae("0x71")]=Ae("0x85"),F.id=1,{}))[Ae("0x9c")]=!1,{})).rule=Ae("0xa0"),E[Ae("0x71")]="double",E.id=2,E.options=h,{}))[Ae("0x43")]="repeated",C[Ae("0x71")]=Ae("0x96"),C.id=3,{})).id=F,c[Ae("0xa7")]=E,c[Ae("0x76")]=C,{})).packed=!1,{}))[Ae("0x43")]=Ae("0xa0"),S[Ae("0x71")]=Ae("0x85"),S.id=1,S.options=f,{}))[Ae("0x76")]=S,{}))[Ae("0xe")]=p,{}))[Ae("0x96")]=d,{}))[Ae("0xe")]=c,m[Ae("0x1")]=y,{}))[Ae("0x6")]=s,M[Ae("0x79")+"t"]=a,M[Ae("0x88")]=A,M[Ae("0xa4")]=u,M[Ae("0x54")]=m,{})).fields=o,T[Ae("0x1")]=M,{}))[Ae("0x6e")]=B,g.Scene=e,g[Ae("0x8e")]=n,g[Ae("0x7d")]=i,g[Ae("0x61")]=r,g[Ae("0x12")]=T,{}))[Ae("0xa")]=w,v[Ae("0x1")]=g,{})).protobuf=v,{}))[Ae("0x1")]=b,this.id=x});function ue(t){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function he(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ue(t=function(t,e){if("object"!==ue(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ue(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(t,e,n){return e&&he(t.prototype,e),n&&he(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Nr=null});var ce=(Object.assign(te.prototype,{kr:function(){this.Nr||(this.Nr=ne.a.Root.fromJSON((new("undefined"!=typeof KjWzhWlSj&&KjWzhWlSj.ProtoDef?KjWzhWlSj.ProtoDef:le)).id))},Ar:function(t){return this.kr(),this.Nr.lookup("Map").decode(t)},Ir:function(t){for(var e=0;e<t.buffers.length;e++){var n=t.buffers[e];if(1==n.btype)return this.Pr(n.data)}return null},Dr:function(t){for(var e=0;e<t.buffers.length;e++){var n=t.buffers[e];if(7==n.btype)return this.Lr(n.data)}return null},Fr:function(t,e){for(var n=0;n<t.buffers.length;n++){var i=t.buffers[n];if(2==i.btype&&i.gid==e)return this.Cr(i.data)}return null},Br:function(t,e){for(var n=0;n<t.buffers.length;n++){var i=t.buffers[n];if(3==i.btype&&i.gid==e)return this.Ur(i.data)}return null},Gr:function(t,e){for(var n=0;n<t.buffers.length;n++){var i=t.buffers[n];if(4==i.btype&&i.gid==e)return this.Wr(i.data)}return null},Zr:function(t,e){for(var n=0;n<t.buffers.length;n++){var i=t.buffers[n];if(5===i.btype&&i.gid===e)return this.Wr(i.data)}return null},Vr:function(t,e){for(var n=0;n<t.buffers.length;n++){var i=t.buffers[n];if(6===i.btype&&i.gid===e)return this.Wr(i.data)}return null},Pr:function(t){this.kr();var e=this.Nr.lookup("Scene").decode(t);return e.levels=[],e.layerGroups.forEach(function(t){e.levels.push(t.gid)}),e},Lr:function(t){return this.kr(),this.Nr.lookup("Gate").decode(t)},Cr:function(t){return this.kr(),this.Nr.lookup("FloorGeo").decode(t)},Ur:function(t){return this.kr(),this.Nr.lookup("FloorBiz").decode(t)},Wr:function(t){return this.kr(),this.Nr.lookup("FloorNavi").decode(t)}}),te);function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===fe(t=function(t,e){if("object"!==fe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==fe(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(t,e,n){return e&&pe(t.prototype,e),n&&pe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){var e;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");void 0!==zt.a.global().KjWzhWlSj&&zt.a.global().KjWzhWlSj.ProtoReaderStatic?(e=zt.a.global().KjWzhWlSj.ProtoReaderStatic,this.Yr=new e):this.Yr=new ce});var de,ye,me,ge,ve,be=(Object.assign(te.prototype,{Ar:function(t){return this.Yr.Ar(t)},Ir:function(t){return this.Yr.Ir(t)},Dr:function(t){return this.Yr.Dr(t)},Fr:function(t,e){return this.Yr.Fr(t,e)},Br:function(t,e){return this.Yr.Br(t,e)},Gr:function(t,e){return this.Yr.Gr(t,e)},Zr:function(t,e){return this.Yr.Zr(t,e)},Vr:function(t,e){return this.Yr.Vr(t,e)},Pr:function(t){return this.Yr.Pr(t)},Lr:function(t){return this.Yr.Lr(t)},Cr:function(t){return this.Yr.Cr(t)},Ur:function(t){return this.Yr.Ur(t)},Wr:function(t){return this.Yr.Wr(t)}}),te),xe={domain:te="https://console.fengmap.com/api-s/",online:te+"sdk/check",check:te+"sdk/auth/web",download:te+"sdk/auth/obtainMapRoute",downloadTile:te+"sdk/authLayered/obtainMapRoute",collect:te+"sdk/collect",themeUrl:te+"webtheme/",externalModelURL:te+"webmodel/"};function we(t,e){var n,i=0,r=0;for(r=0;r<8;r++)1&e&&(i^=t),n=128&t,t<<=1,n&&(t^=27),e>>=1;return i}function Be(t,e,n){for(var i=0;i<4;i++)t[0+i]^=e[16*n+4*i],t[4+i]^=e[16*n+4*i+1],t[8+i]^=e[16*n+4*i+2],t[12+i]^=e[16*n+4*i+3]}function Me(t){for(var e,n,i,r=1;r<4;r++)for(n=0;n<r;){for(i=t[4*r+4-1],e=3;0<e;e--)t[4*r+e]=t[4*r+e-1];t[4*r+0]=i,n++}}function Se(t){for(var e,n,i,r=0;r<4;r++)for(e=0;e<4;e++)n=(240&t[4*r+e])>>4,i=15&t[4*r+e],t[4*r+e]=ye[16*n+i]}function _e(t){for(var e=0;e<4;e++)t[e]=de[16*((240&t[e])>>4)+(15&t[e])]}function Ee(t){return parseInt(t,16)}de=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],ye=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],ve=[2,ge=me=0,0,0];var Te=function(t,e){for(var n=Array(16),i=0;i<16;i++)n[i]=16*Ee(e.substr(2*i,1))+Ee(e.substr(2*i+1,1));var r=Array(16);for(i=0;i<16;i++)r[i]=16*Ee(t.substr(2*i,1))+Ee(t.substr(2*i+1,1));var o=Array(16);switch(i=[],n.length){default:case 16:me=4,ge=10;break;case 24:me=6,ge=12;break;case 32:me=8,ge=14}for(var s=i=Array(16*(ge+1)),a=Array(4),A=4*(ge+1),l=0;l<me;l++)s[4*l+0]=n[4*l+0],s[4*l+1]=n[4*l+1],s[4*l+2]=n[4*l+2],s[4*l+3]=n[4*l+3];for(l=me;l<A;l++){if(a[0]=s[4*(l-1)+0],a[1]=s[4*(l-1)+1],a[2]=s[4*(l-1)+2],a[3]=s[4*(l-1)+3],0==l%me){var u=void 0,h=void 0;for(u=(n=a)[0],h=0;h<3;h++)n[h]=n[h+1];if(n[3]=u,_e(a),1==(n=l/me))ve[0]=1;else if(1<n)for(ve[0]=2,n--;0<n-1;)ve[0]=we(ve[0],2),n--;(h=n=a)[0]=n[0]^(u=ve)[0],h[1]=n[1]^u[1],h[2]=n[2]^u[2],h[3]=n[3]^u[3]}else 6<me&&4==l%me&&_e(a);s[4*l+0]=s[4*(l-me)+0]^a[0],s[4*l+1]=s[4*(l-me)+1]^a[1],s[4*l+2]=s[4*(l-me)+2]^a[2],s[4*l+3]=s[4*(l-me)+3]^a[3]}for(s=Array(16),a=0;a<4;a++)for(l=0;l<4;l++)s[4*a+l]=r[a+4*l];for(Be(s,i,ge),r=ge-1;1<=r;r--)for(Me(s),Se(s),Be(s,i,r),a=s,l=[14,9,13,11],A=h=void 0,n=Array(4),u=Array(4),A=0;A<4;A++){for(h=0;h<4;h++)n[h]=a[4*h+A];h=l;var c=n,f=u;for(f[0]=we(h[0],c[0])^we(h[3],c[1])^we(h[2],c[2])^we(h[1],c[3]),f[1]=we(h[1],c[0])^we(h[0],c[1])^we(h[3],c[2])^we(h[2],c[3]),f[2]=we(h[2],c[0])^we(h[1],c[1])^we(h[0],c[2])^we(h[3],c[3]),f[3]=we(h[3],c[0])^we(h[2],c[1])^we(h[1],c[2])^we(h[0],c[3]),h=0;h<4;h++)a[4*h+A]=u[h]}for(Me(s),Se(s),Be(s,i,0),a=0;a<4;a++)for(l=0;l<4;l++)o[a+4*l]=s[4*a+l];for(r="",i=0;i<16;++i)r+=s=(s=o[i].toString(16)).length<2?"0"+s:s;return r};function Ce(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function Fe(t,e,n,i,r,o){return Ce((e=Ce(Ce(e,t),Ce(i,o)))<<r|e>>>32-r,n)}function Oe(t,e,n,i,r,o,s){return Fe(e&n|~e&i,t,e,r,o,s)}function Pe(t,e,n,i,r,o,s){return Fe(e&i|n&~i,t,e,r,o,s)}function Ue(t,e,n,i,r,o,s){return Fe(e^n^i,t,e,r,o,s)}function Re(t,e,n,i,r,o,s){return Fe(n^(e|~i),t,e,r,o,s)}function Ie(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var n,i,r,o,s=1732584193,a=-271733879,A=-1732584194,l=271733878,u=0;u<t.length;u+=16)s=Re(s=Ue(s=Ue(s=Ue(s=Ue(s=Pe(s=Pe(s=Pe(s=Pe(s=Oe(s=Oe(s=Oe(s=Oe(n=s,i=a,r=A,o=l,t[u],7,-680876936),a=Oe(a,A=Oe(A,l=Oe(l,s,a,A,t[u+1],12,-389564586),s,a,t[u+2],17,606105819),l,s,t[u+3],22,-1044525330),A,l,t[u+4],7,-176418897),a=Oe(a,A=Oe(A,l=Oe(l,s,a,A,t[u+5],12,1200080426),s,a,t[u+6],17,-1473231341),l,s,t[u+7],22,-45705983),A,l,t[u+8],7,1770035416),a=Oe(a,A=Oe(A,l=Oe(l,s,a,A,t[u+9],12,-1958414417),s,a,t[u+10],17,-42063),l,s,t[u+11],22,-1990404162),A,l,t[u+12],7,1804603682),a=Oe(a,A=Oe(A,l=Oe(l,s,a,A,t[u+13],12,-40341101),s,a,t[u+14],17,-1502002290),l,s,t[u+15],22,1236535329),A,l,t[u+1],5,-165796510),a=Pe(a,A=Pe(A,l=Pe(l,s,a,A,t[u+6],9,-1069501632),s,a,t[u+11],14,643717713),l,s,t[u],20,-373897302),A,l,t[u+5],5,-701558691),a=Pe(a,A=Pe(A,l=Pe(l,s,a,A,t[u+10],9,38016083),s,a,t[u+15],14,-660478335),l,s,t[u+4],20,-405537848),A,l,t[u+9],5,568446438),a=Pe(a,A=Pe(A,l=Pe(l,s,a,A,t[u+14],9,-1019803690),s,a,t[u+3],14,-187363961),l,s,t[u+8],20,1163531501),A,l,t[u+13],5,-1444681467),a=Pe(a,A=Pe(A,l=Pe(l,s,a,A,t[u+2],9,-51403784),s,a,t[u+7],14,1735328473),l,s,t[u+12],20,-1926607734),A,l,t[u+5],4,-378558),a=Ue(a,A=Ue(A,l=Ue(l,s,a,A,t[u+8],11,-2022574463),s,a,t[u+11],16,1839030562),l,s,t[u+14],23,-35309556),A,l,t[u+1],4,-1530992060),a=Ue(a,A=Ue(A,l=Ue(l,s,a,A,t[u+4],11,1272893353),s,a,t[u+7],16,-155497632),l,s,t[u+10],23,-1094730640),A,l,t[u+13],4,681279174),a=Ue(a,A=Ue(A,l=Ue(l,s,a,A,t[u],11,-358537222),s,a,t[u+3],16,-722521979),l,s,t[u+6],23,76029189),A,l,t[u+9],4,-640364487),a=Ue(a,A=Ue(A,l=Ue(l,s,a,A,t[u+12],11,-421815835),s,a,t[u+15],16,530742520),l,s,t[u+2],23,-995338651),A,l,t[u],6,-198630844),a=Re(a=Re(a=Re(a=Re(a,A=Re(A,l=Re(l,s,a,A,t[u+7],10,1126891415),s,a,t[u+14],15,-1416354905),l,s,t[u+5],21,-57434055),A=Re(A,l=Re(l,s=Re(s,a,A,l,t[u+12],6,1700485571),a,A,t[u+3],10,-1894986606),s,a,t[u+10],15,-1051523),l,s,t[u+1],21,-2054922799),A=Re(A,l=Re(l,s=Re(s,a,A,l,t[u+8],6,1873313359),a,A,t[u+15],10,-30611744),s,a,t[u+6],15,-1560198380),l,s,t[u+13],21,1309151649),A=Re(A,l=Re(l,s=Re(s,a,A,l,t[u+4],6,-145523070),a,A,t[u+11],10,-1120210379),s,a,t[u+2],15,718787259),l,s,t[u+9],21,-343485551),s=Ce(s,n),a=Ce(a,i),A=Ce(A,r),l=Ce(l,o);return[s,a,A,l]}function Le(t){for(var e="",n=32*t.length,i=0;i<n;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e}function De(t){var e=[];for(e[(t.length>>2)-1]=void 0,i=0;i<e.length;i+=1)e[i]=0;for(var n=8*t.length,i=0;i<n;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e}function Qe(t){for(var e,n="0123456789abcdef",i="",r=0;r<t.length;r+=1)e=t.charCodeAt(r),i+=n.charAt(e>>>4&15)+n.charAt(15&e);return i}function ke(t){return unescape(encodeURIComponent(t))}function Ne(t){return Le(Ie(De(t=ke(t)),8*t.length))}function je(t,e){t=ke(t),e=ke(e);var n,i=De(t),r=[],o=[];for(r[15]=o[15]=void 0,16<i.length&&(i=Ie(i,8*t.length)),n=0;n<16;n+=1)r[n]=909522486^i[n],o[n]=1549556828^i[n];return t=Ie(r.concat(De(e)),512+8*e.length),Le(Ie(o.concat(t),640))}var He=function(t){return function(t,e,n){return e?n?je(e,t):Qe(je(e,t)):n?Ne(t):Qe(Ne(t))}(t)};function ze(t){return(ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ve(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ze(t=function(t,e){if("object"!==ze(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ze(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var Ge="0.0.0.0";te=function(t,e,n){return e&&Ve(t.prototype,e),n&&Ve(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(te.prototype,{zr:function(t,e,n,i,r){"undefined"==typeof KjWzhWlSj||!KjWzhWlSj.license||"string"==typeof e&&0!=e.length&&(e=Te(e,"026685bf295f587b5dffc1f18d5dc27c"),n=He(n),e=Te(e,n),-1!==t.indexOf(e))?i&&i():r&&r()},Xr:function(t,e,n,i){var r;-1!==e.indexOf("")||-1!==e.indexOf("aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa")?n&&n():(r=He("fengmap.localhost:"+t.appName),r=Te(t.key,r),-1!==e.indexOf(r)?this.zr(e,t.license,t.buildingID,function(){n&&n()},function(){i&&i(Kt)}):i&&i(Vt))},qr:function(t,e,n){var i=this;void 0!==t.mapURL?e&&e():(t.enableCollect&&this.Hr(t),this.Qr(function(){new ee({method:"POST",url:xe.check,header:{"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"},data:i.Kr(t)}).Rr(function(){e&&e()},function(t){n&&n(t)},function(){e&&e()})},function(){e&&e()}))},Qr:function(t,e){new ee({method:"GET",url:xe.online}).Rr(function(){t&&t()},function(){e&&e()},function(){e&&e()})},Kr:function(t,e){var n=zt.a.global().location.host,i=(-1!==(i=n.indexOf(":"))&&(n=n.slice(0,i)),{mapId:t.buildingID,appName:t.appName});return e?i.keyValue=t.key:i.appKey=t.key,e?i.webUrl=n||Ge:i.webURL=n||Ge,i},Hr:function(t){if("undefined"!=typeof navigator&&"undefined"!=typeof document){var e={};-1!==navigator.userAgent.indexOf("Opera")?e.userAgent="Opera":-1!==navigator.userAgent.indexOf("Firefox")?e.userAgent="FF":-1!==navigator.userAgent.indexOf("Chrome")?e.userAgent="Chrome":-1!==navigator.userAgent.indexOf("Safari")&&0===navigator.userAgent.indexOf("Chrome")?e.userAgent="Safari":-1!==navigator.userAgent.indexOf("compatible")&&-1!==navigator.userAgent.indexOf("MSIE")?e.userAgent="IE":-1!==navigator.userAgent.indexOf("Trident")&&(e.userAgent="Edge"),e.product="JS",e.sdkVersion=i+".70",e.appName=t.appName,e.appkey=t.key;for(var n=(t=document.createElement("canvas").getContext("experimental-webgl")).getExtension("WEBGL_debug_renderer_info"),r=(e.gpu=n?t.getParameter(n.UNMASKED_RENDERER_WEBGL):null,e.os=navigator.platform,!0),o=navigator.userAgent,s=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],a=0;a<s.length;a++)if(0<o.indexOf(s[a])){r=!1;break}e.device=r?"pc":"mobile",new ee({method:"POST",url:xe.collect,header:{"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"},data:e}).Rr()}}});var Ye=new te;function Ke(t){return(Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xe(t){return function(t){if(Array.isArray(t))return We(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?We(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?We(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function We(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ze(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ke(t=function(t,e){if("object"!==Ke(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ke(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(t,e,n){return e&&Ze(t.prototype,e),n&&Ze(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Yr=new be,this.Jr=[]});var qe=(Object.assign(te.prototype,{Mr:function(){this.Jr.forEach(function(t){t.Mr()}),this.Jr.length=0},$r:function(t,e,n,i){var r;t.mapURL?(r=t.isPreview?t.isOutdoor?t.tile?t.mapURL+t.buildingID+"/separate/"+t.buildingID+e+".fmap":t.mapURL+t.buildingID+"/"+t.buildingID+e+".fmap":t.tile?t.mapURL+t.mapID+"/"+t.bid+"/"+t.buildingID+"/separate/"+t.buildingID+e+".fmap":t.mapURL+t.mapID+"/"+t.bid+"/"+t.buildingID+"/"+t.buildingID+e+".fmap":t.mapURLAbsolute?t.mapURL+t.buildingID+e+".fmap":t.isOutdoor?t.mapURL+t.buildingID+"/"+t.buildingID+e+".fmap":t.mapURL+t.mapID+"/"+t.bid+"/"+t.buildingID+"/"+t.buildingID+e+".fmap",n&&n(r)):(r={newFlag:"2",keyType:3,isSeparate:!1},t.isOutdoor||(r.bId=t.bid,r.rootMid=t.mapID),e=new ee({method:"POST",url:""===e?xe.download:xe.downloadTile+"/"+t.buildingID+e+".fmap",header:{"X-Requested-With":"XMLHttpRequest","Content-type":"application/json;charset=utf-8"},data:Object.assign(r,Ye.Kr(t,!0))}),this.Jr.push(e),e.Rr(function(t){n&&n(t.replace('"',"").replace('"',""))},function(t){i&&i(t)},function(t){i&&i(t)}))},tn:function(t,e,n){var i=this;t.enableCollect=!0,Ye.qr(t,function(){i.$r(t,"",function(r){r=new ee({method:"GET",responseType:"arraybuffer",url:r}),i.Jr.push(r),r.Rr(function(r){r=new Uint8Array(r);var o=i.Yr.Ar(r);!t.isOutdoor||(r=[],o.keys&&0!==o.keys.length?r.push.apply(r,Xe(o.keys)):r.push(o.key),t.isPreview)?e&&e(o):Ye.Xr(t,r,function(){e&&e(o)},function(t){n&&n(t)})},function(t){n&&n(t===Xt?Gt:t)},function(t){n&&n(t)})},function(t){n&&n(t)})},function(t){n&&n(t)})},rn:function(t,e,n){var i=this;t.enableCollect=!0,Ye.qr(t,function(){i.$r(t,".scene",function(r){r=new ee({method:"GET",responseType:"arraybuffer",url:r}),i.Jr.push(r),r.Rr(function(r){r=new Uint8Array(r);var o=i.Yr.Pr(r);!t.isOutdoor||(r=[],o.keys&&0!==o.keys.length?r.push.apply(r,Xe(o.keys)):r.push(o.key),t.isPreview)?e&&e(o):Ye.Xr(t,r,function(){e&&e(o)},function(t){n&&n(t)})},function(t){n&&n(t)},function(t){n&&n(t)})},function(t){n&&n(t)})},function(t){n&&n(t)})},nn:function(t,e,n){var i=this;this.$r(t,".gate",function(t){t=new ee({method:"GET",responseType:"arraybuffer",url:t}),i.Jr.push(t),t.Rr(function(t){t=new Uint8Array(t),t=i.Yr.Lr(t),e&&e(t)},function(t){n&&n(t)},function(t){n&&n(t)})},function(t){n&&n(t)})},sn:function(t,e,n,i){var r=this;this.$r(t,".floor."+e+".geo",function(t){t=new ee({method:"GET",responseType:"arraybuffer",url:t}),r.Jr.push(t),t.Rr(function(t){t=new Uint8Array(t),t=r.Yr.Cr(t),n&&n(t)},function(t){i&&i(t)},function(t){i&&i(t)})},function(t){i&&i(t)})},un:function(t,e,n,i){var r=this;this.$r(t,".floor."+e+".biz",function(t){t=new ee({method:"GET",responseType:"arraybuffer",url:t}),r.Jr.push(t),t.Rr(function(t){t=new Uint8Array(t),t=r.Yr.Ur(t),n&&n(t)},function(t){i&&i(t)},function(t){i&&i(t)})},function(t){i&&i(t)})},an:function(t,e,n,i){var r=this;this.$r(t,e,function(t){t=new ee({method:"GET",responseType:"arraybuffer",url:t}),r.Jr.push(t),t.Rr(function(t){t=new Uint8Array(t),t=r.Yr.Wr(t),n&&n(t)},function(t){i&&i(t)})},function(t){i&&i(t)},function(t){i&&i(t)})},hn:function(t,e,n,i){this.an(t,".floor."+e+".navi",n,i)},cn:function(t,e,n,i){this.an(t,".floor."+e+".drive.navi",n,i)},ln:function(t,e,n,i){this.an(t,".floor."+e+".accessible.navi",n,i)}}),te);function Je(t){for(var e=[],n=t.length,i=0;i<n;i++){for(var r=t[i],o={x:this.vn(r.x),y:this.vn(r.y)},s=e.length,a=!1,A=0;A<s;A++){var l=e[A];if(l.x==o.x&&l.y==o.y){a=!0;break}}a||e.push(o)}return e}function $e(t){return+t.toFixed(2)}function tn(t){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function en(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===tn(t=function(t,e){if("object"!==tn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==tn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(t,e,n){return e&&en(t.prototype,e),n&&en(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}),Object.assign(te.prototype,{yn:function(t,e){for(var n=[],i=0,r=0;r<t.length;r++){var o=t[r].idxs;if("number"==typeof(o=o||t[r]))for(;i<o;)n.push({x:e[i],y:e[i+1]}),i+=2;else for(var s=0;s<o.length;s++)for(var a=o[s];i<a;)n.push({x:e[i],y:e[i+1]}),i+=2}return n},bn:function(t,e){for(var n=[],i=0,r=0;r<t.length;r++){var o=t[r].idxs;if("number"==typeof(o=o||t[r])){for(var s=[];i<o;)s.push({x:e[i],y:e[i+1]}),i+=2;n.push(s)}else for(var a=0;a<o.length;a++){for(var A=o[a],l=[];i<A;)l.push({x:e[i],y:e[i+1]}),i+=2;n.push(l)}}return n},dn:function(t,e){for(var n=[],i=[],r=0,o=0;o<t.length;o++){var s=t[o].idxs;if("number"==typeof(s=s||t[o]))for(;r<s;)n.push({x:e[r],y:e[r+1]}),r+=2;else for(var a=0;a<s.length;a++)if(0===a)for(var A=s[a];r<A;)n.push({x:e[r],y:e[r+1]}),r+=2;else{for(var l=[],u=s[a];r<u;)l.push({x:e[r],y:e[r+1]}),r+=2;i.push(l)}}var h=[];return h.push(n),h.push.apply(h,i),h},pn:function(t){return Je(t)},vn:$e});var nn=new te;function rn(t){return(rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function on(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===rn(t=function(t,e){if("object"!==rn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==rn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var sn={G1:"MULTIPOLYGON(((",G2:"POINT(",G3:"MULTILINESTRING(("};sn.GLEN1="MULTIPOLYGON(((".length,sn.GLEN2="POINT(".length,sn.GLEN3="MULTILINESTRING((".length,te=function(t,e,n){return e&&on(t.prototype,e),n&&on(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(te.prototype,{yn:function(t){var e=[];return 0!=t.indexOf(sn.G2)?[]:(t=t.substring(sn.GLEN2,t.length-1).split(" "),e.push({x:parseFloat(t[0]),y:parseFloat(t[1])}),e)},mn:function(t,e){for(var n=0;n<t.length;n++){var i=t[n].split(" ");e.push({x:parseFloat(i[0]),y:parseFloat(i[1])})}},bn:function(t){return 0!=t.indexOf(sn.G3)?[]:(t=t.substring(sn.GLEN3,t.length-2).split(","),this.mn(t,t=[]),[t])},dn:function(t){var e=[],n=[];if(0!=t.indexOf(sn.G1))return[];for(var i=t.substring(sn.GLEN1,t.length-3).split(/\),\(/),r=0;r<i.length;r++){var o=i[r].split(/,/);if(0==r)this.mn(o,e);else{for(var s=[],a=0;a<o.length;a++){var A=o[a].split(" ");s.push({x:parseFloat(A[0]),y:parseFloat(A[1])})}n.push(s)}}return(t=[]).push(e),t.push.apply(t,n),t},pn:function(t){return Je(t)},vn:$e});var an=new te,An=(te={STOP:0,PASS:1,PUSH:2},Object.freeze(te),te);function ln(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function un(t){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===un(t=function(t,e){if("object"!==un(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==un(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.wr=k.GROUP,this.wn=new Map,this.xn=-1,this.sr=null,Object.assign(this,e)}var e,n;return e=t,(n=[{key:"getType",value:function(){return this.wr}},{key:"getBound",value:function(){return this.sr||this._n(),this.sr}},{key:"getChildren",value:function(){return this.wn}}])&&hn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var cn=(Object.assign(te.prototype,{Mr:function(){var t,e=function(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=function(t,e){var n;if(t)return"string"==typeof t?ln(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ln(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.wn.values());try{for(e.s();!(t=e.n()).done;){var n=t.value;n.Mr&&n.Mr()}}catch(t){e.e(t)}finally{e.f()}this.wn.clear()},gn:function(t){var e=t._support(this);e==An.PASS?this.wn.forEach(function(e){e.gn(t)}):e==An.PUSH&&t.jn.push(this)},_n:function(){var t=this;this.sr=new yt,0!=this.wn.size&&this.wn.forEach(function(e){t.sr.nr(e.getBound())})}}),te);function fn(t){return(fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===fn(t=function(t,e){if("object"!==fn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==fn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xn=-1,this.wr=k.NONE,this.Sn=null,this.sr=null}var e,n;return e=t,(n=[{key:"getType",value:function(){return this.wr}},{key:"getCoordinates",value:function(){return this.Sn}},{key:"getBound",value:function(){return this.sr||this._n(),this.sr}}])&&pn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var dn=(Object.assign(te.prototype,{Mr:function(){},gn:function(t){t._support(this)==An.PUSH&&t.jn.push(this)}}),te);function yn(t){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mn(t,e){return(mn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function gn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vn(t){return(vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}te=function(){var t=i,e=dn;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mn(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=vn(t);if(n=e?(n=vn(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===yn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return gn(i)}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this)).xn=t.eid,e.wr=k.POINT,Object.assign(gn(e),t),e;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var bn=(Object.assign(te.prototype,{_n:function(){this.sr=new yt,this.Sn&&this.sr.ir(this.Sn)},gn:function(t){t._support(this)==An.PUSH&&t.jn.push(this)}}),te);function xn(t){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function wn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===xn(t=function(t,e){if("object"!==xn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==xn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function Bn(t,e){return(Bn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Mn(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Sn(t){return(Sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}te=function(){var t=i,e=dn;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bn(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Sn(t);if(n=e?(n=Sn(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===xn(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return Mn(i)}}(i);function i(t){var e;if(this instanceof i)return(e=n.call(this)).xn=t.eid,e.wr=k.POLYGON,Object.assign(Mn(e),t),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"getCenter",value:function(){return this.lr}}])&&wn(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();var _n=(Object.assign(te.prototype,{_n:function(){var t=this;this.sr=new yt,this.Sn&&this.Sn.forEach(function(e){t.sr.ir(e)})},gn:function(t){t._support(this)==An.PUSH&&t.jn.push(this)}}),te);function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Tn=["layerGroups"],Cn=["layers"];function Fn(t,e){if(null==t)return{};var n,i=function(t,e){if(null==t)return{};var n,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)n=o[i],0<=e.indexOf(n)||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(t),o=0;o<r.length;o++)n=r[o],0<=e.indexOf(n)||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n]);return i}function On(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===En(t=function(t,e){if("object"!==En(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==En(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(t,e,n){return e&&On(t.prototype,e),n&&On(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.On=[1,2,3,4],this.En=[6,7,9],this.Tn=[31,32],this.Rn=new Map,this.Rn.set(31,k.EXTENTGROUP),this.Rn.set(32,k.MODELGROUP),this.Rn.set(6,k.FACILITYGROUP),this.Rn.set(7,k.LABELGROUP),this.Rn.set(9,k.EXTERNALMODELGROUP),this.Mn=new Map,this.Mn.set(31,["extentLayer",null]),this.Mn.set(32,["modelLayer","labelLayer"]),this.Mn.set(6,["poiLayer",null]),this.Mn.set(7,["labelLayer",null]),this.Mn.set(9,["externalModelLayer",null]),this.Yr=new be});var Pn=(Object.assign(te.prototype,{Nn:function(t){var e;return t?(e=t.scene,this.kn(e,t)):null},kn:function(t,e){var n=this,i=t.layerGroups,r=Fn(t,Tn),o=t.fileVer,s=new cn(r);return i.forEach(function(t){var i=n.An(t,e,o);s.wn.set(t.gid,i)}),s},An:function(t,e,n){var i=this,r=t.layers,o=Fn(t,Cn),s=new cn(o),a=e&&e.floors?e.floors.get(t.gid).geo[0]:null,A=e&&e.floors?e.floors.get(t.gid).biz[0]:null;return r.forEach(function(t){6===t.ltype&&-1!==t.lname.indexOf("storelabel")&&(t.ltype=7);var e=i.In(t,a,A,n);null!==e&&s.wn.set(i.Rn.get(t.ltype),e)}),this.Pn(s),s},Pn:function(t){var e=Array.from(t.wn);e.sort(function(t,e){return t[0]-e[0]}),t.wn=new Map(e)},In:function(t,e,n,i){var r;return-1===this.On.indexOf(t.ltype)&&this.Mn.get(t.ltype)?(r=new cn(t),this.Dn(r,e,n,i),r&&(r.wr=this.Rn.get(t.ltype)),r):null},Dn:function(t,e,n,i){if(t){var r=this.Mn.get(t.ltype);if(r){var o=e?e[r[0]]:[],s=n?n[r[0]]:[];switch(t.ltype){case 6:this.Ln(t,o,s,i,k.FACILITY);break;case 7:this.Ln(t,o,s,i,k.LABEL);break;case 9:this.Ln(t,o,s,i,k.EXTERNALMODEL);break;case 31:this.Fn(t,o,s,i,k.EXTENT,null);break;case 32:this.Fn(t,o,s,i,k.MODEL,e?e[r[1]]:null)}}}},Ln:function(t,e,n,i,r){for(var o=0;o<e.length;o++){var s=this.Cn(e[o],n[o],i);s.wr=r,t.wn.set(e[o].eid,s)}},Cn:function(t,e,n){return e=Object.assign({},e,{area:t.area,eid:t.eid,height:t.height}),e=new bn(e),t.coordinates?e.Sn=t.coordinates:(e.Sn=1==n?an.yn(t.geo):nn.yn(t.idxs,t.pts),t.coordinates=e.Sn),e},Fn:function(t,e,n,i,r,o){for(var s=0;s<e.length;s++){var a=this.Bn(e[s],n[s],i,o?o[s]:null);a.wr=r,t.wn.set(e[s].eid,a)}},Bn:function(t,e,n,i){return e=Object.assign({},e,{area:t.area,eid:t.eid,height:t.height}),(e=new _n(e)).Sn=1===n?an.dn(t.geo):nn.dn(t.idxs,t.pts),i&&(i.coordinates||(i.coordinates=1===n?an.yn(i.geo):nn.yn(i.idxs,i.pts)),e.lr=i.coordinates[0]),e}}),te),Un=2,Rn=4,In=8;function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Dn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ln(t=function(t,e){if("object"!==Ln(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ln(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(t,e,n){return e&&Dn(t.prototype,e),n&&Dn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Un=e.disposeCallback,this.Gn=!1,this.Wn=!1,this.Zn=void 0!==e.enable&&e.enable,this.name=void 0!==e.name?e.name:"",this.Vn=new Map,this.Yn=e.mapCreateTime});for(var Qn=(Object.assign(te.prototype,{zn:function(){!this.Zn||this.Wn||this.Gn&&0===this.Vn.size&&(this.Un({mapCreateTime:this.Yn}),this.Wn=!0)},Xn:function(t){this.Zn&&(this.Gn=t,this.zn())},qn:function(t){this.Zn&&(this.Vn.has(t),this.Vn.set(t,0))},Hn:function(t){this.Zn&&this.Vn.has(t)&&(this.Vn.delete(t),this.zn())}}),te),kn=[],Nn=0;Nn<256;Nn++)kn[Nn]=(Nn<16?"0":"")+Nn.toString(16);var jn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(kn[255&t]+kn[t>>8&255]+kn[t>>16&255]+kn[t>>24&255]+"-"+kn[255&e]+kn[e>>8&255]+"-"+kn[e>>16&15|64]+kn[e>>24&255]+"-"+kn[63&n|128]+kn[n>>8&255]+"-"+kn[n>>16&255]+kn[n>>24&255]+kn[255&i]+kn[i>>8&255]+kn[i>>16&255]+kn[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*jn.DEG2RAD},radToDeg:function(t){return t*jn.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var o=Math.cos,s=Math.sin,a=o(n/2),A=(n=s(n/2),o((e+i)/2)),l=s((e+i)/2),u=o((e-i)/2),h=s((e-i)/2);o=o((i-e)/2),s=s((i-e)/2);"XYX"===r?t.set(a*l,n*u,n*h,a*A):"YZY"===r?t.set(n*h,a*l,n*u,a*A):"ZXZ"===r?t.set(n*u,n*h,a*l,a*A):"XZX"===r?t.set(a*l,n*s,n*o,a*A):"YXY"===r?t.set(n*o,a*l,n*s,a*A):"ZYZ"===r&&t.set(n*s,n*o,a*l,a*A)}};function Hn(t){return(Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Hn(t=function(t,e){if("object"!==Hn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Hn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Qn=new Map,this.Kn=new Map,this.Er=new Map,this.Jn=new Map,this.$n=new Map,this.ti=new Map,this.ri=[2,3],this.ni=!1,this.Yr=new be,this.ii=new Pn,this.ei=new qe,this.oi=null,this.si=this.si.bind(this),this.ui=new Qn({disposeCallback:this.si,enable:!0,name:"DataManager",mapCreateTime:e?e.mapCreateTime:(new Date).getTime()})}var e,n;return e=t,(n=[{key:"load",value:function(t,e){this.fi(t,e)}},{key:"loadWhole",value:function(t,e){this.ai(t,e)}},{key:"getDecode",value:function(t){return t=void 0!==t.buildingID?t.buildingID:t.mapID,this.ci({buildingID:t})}},{key:"getData",value:function(t){return t=void 0!==t.buildingID?t.buildingID:t.mapID,this.Qn.get(t)}},{key:"setCache",value:function(t){this.Qn=t[0],this.Kn=t[1]}},{key:"getCache",value:function(){return[this.Qn,this.Kn]}}])&&zn(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Vn=(Object.assign(te.prototype,{Mr:function(t){this.oi=t,this.ei.Mr(),this.ui.Xn(!0)},si:function(){this.Qn.clear(),this.Qn=null,this.Kn.clear(),this.Kn=null,this.Er.clear(),this.Er=null,this.Jn.clear(),this.Jn=null,this.$n.clear(),this.$n=null,this.ti.clear(),this.ti=null,this.oi&&this.oi({name:"DataManager"})},li:function(t){this.Jn.set(t.buildingID+t.uuid,null),this.$n.set(t.buildingID+t.uuid,null),this.ti.set(t.buildingID+t.uuid,0)},fi:function(t,e){var n=this;this.li(t),this.rn(t,function(i,r){e&&e(i,r);var o=n.vi(t);r=t.loadNavi&&o.buildings&&0<o.buildings.length;n.nn(t,r,function(i,r){e&&e(i,r);for(var s=void 0!==t.level?t.level:parseInt(o.defGid),a=(n.yi(t,s,e),t.visibleLevels||o.levels),A=0;A<a.length;A++)a[A]===s||o.levels.indexOf(a[A])<0||n.yi(t,a[A],e);if(t.preLoad)for(var l=0;l<o.levels.length;l++)o.levels[l]!==s&&-1===a.indexOf(o.levels[l])&&n.yi(t,o.levels[l],e)},function(t){e&&e(i,t)})},function(t,n){e&&e(t,n)})},nn:function(t,e,n,i){var r,o=this;e?(e=this.bi(t))?n&&n("gate",e):(r="_sendGate"+jn.generateUUID(),this.ui.qn(r),this.ei.nn(t,function(e){o.Kn.get(t.buildingID).gate=e,n&&n("gate",e),o.ui.Hn(r)},function(e){var s;t.navigationData?((s=o.Kn.get(t.buildingID)).gate=t.navigationData,n&&n("gate",s.gate)):i("error",e),o.ui.Hn(r)})):n&&n("gate",null)},rn:function(t,e,n){var i,r=this,o=this.vi(t);o?(e&&e("scene",o),t.justDecode||(o=this.Qn.get(t.buildingID),e&&e("building",o))):(i="_sendScene"+jn.generateUUID(),this.ui.qn(i),this.ei.rn(t,function(n){t.isOutdoor&&r.di(n),r.Kn.set(t.buildingID,{scene:n}),e&&e("scene",n),t.justDecode||(n=r.ii.kn(n),r.Qn.set(t.buildingID,n),e&&e("building",n)),r.ui.Hn(i)},function(t){n&&n("error",t===Xt?Gt:t),r.ui.Hn(i)}))},di:function(t){var e=t.fileVer;t.buildings&&1<e&&t.buildings.forEach(function(t){t.floors&&(t.levelChart=[],t.fids=[],t.floors.forEach(function(e){e.Sn=nn.dn(e.idxs,e.pts),e.pgid&&t.levelChart.push(e.pgid,e.gid),e.baseLevel&&(t.minlevel=e.minlevel,t.maxlevel=e.maxlevel),e.fids&&t.fids.push.apply(t.fids,e.fids)}))})},yi:function(t,e,n,i){var r=this.Jn.get(t.buildingID+t.uuid);r||this.Jn.set(t.buildingID+t.uuid,r=[]),i?r.unshift(e):r.push(e),this.ni&&1!==r.length||this.pi(t,n)},pi:function(t,e){var n,i,r,o=this,s=this.vi(t);s&&(n=this.Jn.get(t.buildingID+t.uuid))&&0!==n.length&&((i=this.$n.get(t.buildingID+t.uuid))||this.$n.set(t.buildingID+t.uuid,i=[]),r=n[0],-1!==i.indexOf(r)?(n.splice(n.indexOf(r),1),this.pi(t,e)):(i.push(r),this.mi(t,r,function(i,a){var A=o.ti.get(t.buildingID+t.uuid);"layerGroup"===i&&(e&&e(i,a),o.ti.set(t.buildingID+t.uuid,++A),A===s.layerGroups.length&&e&&e("decode",o.ci(t)),n.splice(n.indexOf(r),1),o.pi(t,e)),"layer"===i&&e&&e(i,a),"floor"===i&&(e&&e(i,a),A===s.layerGroups.length)&&e&&e("complete",o.wi(t))},function(t,n){e&&e(t,n)})))},mi:function(t,e,n,i){var r,o,s,a,A,l,u=this,h=this.vi(t),c=this.xi(h,e);c?(r=c.gname,c=c.naviType||0,o=this.ri[0],s=0,a=new Map,A=t.merge,l=function(i){var r,l,u;o===++s&&(r=a.get("geo"),l=a.get("biz"),A&&A.merge(e,r,l,h.fileVer),n&&n("layerGroup",a),t.justDecode||((u=i._i(t,e)).wn.forEach(function(t){i.ii.Dn(t,r,l,h.fileVer),n&&n("layer",t)}),n&&n("floor",u)))},t.loadNavi&&((0!=(c&Un)||h.fileVer<3)&&(o++,this.hn(t,e,r,function(t,e){a.set(t,e),n&&n(t,e),l(u)},function(t){i&&i(t)})),0!=(c&Rn)&&(o++,this.cn(t,e,r,function(t,e){a.set(t,e),n&&n(t,e),l(u)},function(t){i&&i(t)})),0!=(c&In))&&(o++,this.ln(t,e,r,function(t,e){a.set(t,e),n&&n(t,e),l(u)},function(t){i&&i(t)})),this.sn(t,e,r,function(t,e){a.set(t,e),n&&n(t,e),l(u)},function(t){i&&i(t)}),this.un(t,e,r,function(t,e){a.set(t,e),n&&n(t,e),l(u)},function(t){i&&i(t)})):i&&i("error",Wt)},sn:function(t,e,n,i,r){var o,s=this,a=this.gi(t,e,"geo");a?i&&i("geo",a):(o="_sendFloorGeo"+jn.generateUUID(),this.ui.qn(o),this.ei.sn(t,n,function(n){s.ji(t,e,"geo",n),i&&i("geo",n),s.ui.Hn(o)},function(t){r&&r("error",t),s.ui.Hn(o)}))},un:function(t,e,n,i,r){var o,s=this,a=this.gi(t,e,"biz");a?i&&i("biz",a):(o="_sendFloorBiz"+jn.generateUUID(),this.ui.qn(o),this.ei.un(t,n,function(n){s.ji(t,e,"biz",n),i&&i("biz",n),s.ui.Hn(o)},function(t){r&&r("error",t),s.ui.Hn(o)}))},hn:function(t,e,n,i,r){var o,s=this,a=this.gi(t,e,"navi");a?i&&i("navi",a):(o="_sendFloorNavi"+jn.generateUUID(),this.ui.qn(o),this.ei.hn(t,n,function(n){s.ji(t,e,"navi",n),i&&i("navi",n),s.ui.Hn(o)},function(t){r&&r("error",t),s.ui.Hn(o)}))},cn:function(t,e,n,i,r){var o,s=this,a=this.gi(t,e,"drive_navi");a?i&&i("drive_navi",a):(o="_sendFloorNaviDrive"+jn.generateUUID(),this.ui.qn(o),this.ei.cn(t,n,function(n){s.ji(t,e,"drive_navi",n),i&&i("drive_navi",n),s.ui.Hn(o)},function(t){r&&r("error",t),s.ui.Hn(o)}))},ln:function(t,e,n,i,r){var o,s=this,a=this.gi(t,e,"accessible_navi");a?i&&i("drive_navi",a):(o="_sendFloorNaviAccessible"+jn.generateUUID(),this.ui.qn(o),this.ei.ln(t,n,function(n){s.ji(t,e,"accessible_navi",n),i&&i("accessible_navi",n),s.ui.Hn(o)},function(t){r&&r("error",t),s.ui.Hn(o)}))},ai:function(t,e){this.tn(t,function(t,n){e&&e(t,n)},function(t,n){e&&e(t,n)})},tn:function(t,e,n){var i,r=this,o=this.ci(t);o?e&&e("decode",o):(i="_sendWhole"+jn.generateUUID(),this.ui.qn(i),this.ei.tn(t,function(n){r.Si(t,n),o=r.ci(t),e&&e("decode",o),t.justDecode||(n=r.ii.Nn(o),r.Qn.set(t.buildingID,n),e&&e("complete",n)),r.ui.Hn(i)},function(t){n&&n("error",t),r.ui.Hn(i)}))},wi:function(t){if(this.Qn)return this.Qn.get(t.buildingID)||null},_i:function(t,e){return(t=this.Qn.get(t.buildingID))?t.wn.get(e):null},Si:function(t,e){var n={scene:null,floors:new Map},i=this.Yr.Ir(e);t.isOutdoor&&this.di(i),n.scene=i,n.gate=this.Yr.Dr(e);for(var r=0;r<i.layerGroups.length;r++){var o=i.layerGroups[r],s=this.Yr.Fr(e,o.gid),a=this.Yr.Br(e,o.gid),A=this.Yr.Gr(e,o.gid),l=this.Yr.Zr(e,o.gid),u=this.Yr.Vr(e,o.gid),h=(t.merge&&t.merge.merge(o.gid,s,a,i.fileVer),new Map);h.set("geo",s),h.set("biz",a),h.set("navi",A),h.set("drive_navi",l),h.set("accessible_navi",u),n.floors.set(o.gid,h)}this.Kn.set(t.buildingID,n)},ci:function(t){if(!(n=this.Kn.get(t.buildingID)))return null;for(var e=n.scene,n=n.gate,i=new Map,r=(n={scene:e,floors:i,gate:n},0);r<e.layerGroups.length;r++){var o,s=e.layerGroups[r],a=s.gid,A={gid:a,gname:s.gname,level:a,geo:[],biz:[],navi:[],naviDrive:[],naviAccessible:[]};(o=((o=((o=(A.geo.push(this.gi(t,a,"geo")),A.biz.push(this.gi(t,a,"biz")),this.gi(t,a,"navi")))&&A.navi.push(o),this.gi(t,a,"drive_navi")))&&A.naviDrive.push(o),this.gi(t,a,"accessible_navi")))&&A.naviAccessible.push(o),i.set(s.gid,A)}return n},vi:function(t){return(t=this.Kn.get(t.buildingID))?t.scene:null},bi:function(t){return(t=this.Kn.get(t.buildingID))?t.gate:null},ji:function(t,e,n,i){var r;(t=this.Kn.get(t.buildingID))&&((r=t.floors)||(r=new Map,t.floors=r),(t=r.get(e))||(t=new Map,r.set(e,t)),t.set(n,i))},gi:function(t,e,n){return(t=(t=this.Kn.get(t.buildingID))&&t.floors)&&(t=t.get(e))?t.get(n):null},xi:function(t,e){if(null!=t)for(var n=t.layerGroups,i=0;i<n.length;i++)if(n[i].gid==e)return n[i];return null}}),te),Gn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yn={h:0,s:0,l:0},Kn={h:0,s:0,l:0};function Xn(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function Wn(t,e,n){return n<0&&(n+=1),1<n&&--n,n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Zn(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function qn(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function Jn(t){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Jn(t=function(t,e){if("object"!==Jn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Jn(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}Object.assign(Xn.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(t,e,n){return t=jn.euclideanModulo(t,1),e=jn.clamp(e,0,1),n=jn.clamp(n,0,1),0===e?this.r=this.g=this.b=n:(this.r=Wn(e=2*n-(n=n<=.5?n*(1+e):n+e-n*e),n,t+1/3),this.g=Wn(e,n,t),this.b=Wn(e,n,t-1/3)),this},setStyle:function(t){function e(t){void 0!==t&&parseFloat(t)}if(A=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,i,r,o,s=A[1],a=A[2];switch(s){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return i=parseFloat(n[1])/360,r=parseInt(n[2],10)/100,o=parseInt(n[3],10)/100,e(n[5]),this.setHSL(i,r,o)}}else if(A=/^\#([A-Fa-f0-9]+)$/.exec(t)){var A=(s=A[1]).length;if(3===A)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,this;if(6===A)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var e=Gn[t];return void 0!==e&&this.setHex(e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){return e=0<(e=void 0===e?2:e)?1/e:1,this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Zn(t.r),this.g=Zn(t.g),this.b=Zn(t.b),this},copyLinearToSRGB:function(t){return this.r=qn(t.r),this.g=qn(t.g),this.b=qn(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(t={h:0,s:0,l:0});var e,n=this.r,i=this.g,r=this.b,o=Math.max(n,i,r),s=Math.min(n,i,r),a=(s+o)/2;if(s===o)l=e=0;else{var A=o-s,l=a<=.5?A/(o+s):A/(2-o-s);switch(o){case n:e=(i-r)/A+(i<r?6:0);break;case i:e=(r-n)/A+2;break;case r:e=(n-i)/A+4}e/=6}return t.h=e,t.s=l,t.l=a,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,n){return this.getHSL(Yn),Yn.h+=t,Yn.s+=e,Yn.l+=n,this.setHSL(Yn.h,Yn.s,Yn.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},lerpHSL:function(t,e){this.getHSL(Yn),t.getHSL(Kn);t=jn.lerp(Yn.h,Kn.h,e);var n=jn.lerp(Yn.s,Kn.s,e);e=jn.lerp(Yn.l,Kn.l,e);return this.setHSL(t,n,e),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return this.r=t[e=void 0===e?0:e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return(t=void 0===t?[]:t)[e=void 0===e?0:e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}}),Xn.NAMES=Gn;var ti=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var e,n;return e=t,n=[{key:"round",value:function(t){return 0<t.toFixed(2)?Math.ceil(t.toFixed(2)):Math.floor(t.toFixed(2))}},{key:"generateUUID",value:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);var n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=4294967295*Math.random()|0;n=t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&o]+t[o>>8&255]+t[o>>16&255]+t[o>>24&255];return t.length=0,n.toUpperCase()}},{key:"findNearNthPowerOfTwo",value:function(t){return t-=1,(t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)<0?1:1+t}},{key:"rgbToArray",value:function(t){var e=new Xn;return e.setStyle(t),[e.r,e.g,e.b]}},{key:"toRgba",value:function(t){var e;return void 0===t?t:"number"!=typeof t?3<=(e=t.split(",")).length?"rgba("+parseInt(e[0])+","+parseInt(e[1])+","+parseInt(e[2])+",1)":t:"rgba("+parseInt(255*new Xn(t).r)+","+parseInt(255*new Xn(t).g)+","+parseInt(255*new Xn(t).b)+",1)"}},{key:"toColor",value:function(t){var e;return"number"==typeof t?t:3<=(e=t.split(",")).length?parseInt(e[0])<<16|parseInt(e[1])<<8|parseInt(e[2]):0}}],null&&$n(e.prototype,null),n&&$n(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ei(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=function(t,e){var n;if(t)return"string"==typeof t?ni(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ni(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ni(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function ii(t){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ri(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ii(t=function(t,e){if("object"!==ii(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ii(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}te=function(){function t(e,n,i){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Er=Object.assign({tile:!0,isPreview:!1},e),this.Er.buildingID=e.mapID,this.Oi=!!e.map,this.Ei=e.map?e.map.getDataManager():new Vn,this.Or=[],this.Ti={},this.Ri=e.statistics||null,this.Mi=n,this.Ni=i,this.ki=ti.generateUUID(),this.Ai()}var e,n;return e=t,(n=[{key:"dispose",value:function(){this.Er=null,this.Oi||this.Ei.Mr(),this.Ei=null,this.Mi=null,this.Ni=null}},{key:"query",value:function(t,e){if(this.Ii(),null===t.buildings){for(var n=[],i=0;i<this.Or.length;i++)n.push({buildingID:this.Or[i].bid});t.buildings=n}var r=[];if(!t.onlyInBuilding){t.buildingID=this.Er.mapID,null===t.buildingID&&(t.buildingID=this.Er.mapID);for(var o=this.Pi(t),s=0;s<o.length;s++)o[s].buildingID=null,r.push(o[s])}for(var a=t.buildings,A=0;A<a.length;A++)for(var l=this.Di(a[A].buildingID),u=(t.buildingID=l,t.levels=a[A].levels,this.Pi(t)),h=0;h<u.length;h++)u[h].buildingID=a[A].buildingID,r.push(u[h]);e&&e(r)}}])&&ri(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var oi=(Object.assign(te.prototype,{Ai:function(){this.Or=[],this.Oi&&(t=this.Er.map.getMapOptions(),this.Er.mapID=t.mapID,this.Er.buildingID=t.mapID,this.Er.appName=t.appName,this.Er.key=t.key,this.Er.license=t.license,this.Er.mapURL=t.mapURL,this.Er.mapURLAbsolute=t.mapURLAbsolute,this.Er.buildings=t.buildings,this.Er.buildingOptions=t.buildingOptions,this.Er.isPreview="undefined"!=typeof KjWzhWlSj&&!!KjWzhWlSj.ProtoDef,this.Er.tile=t.tile);var t={mapID:this.Er.mapID,buildingID:this.Er.mapID,appName:this.Er.appName,key:this.Er.key,buildings:this.Er.buildings,license:this.Er.license,mapURL:this.Er.mapURL,mapURLAbsolute:this.Er.mapURLAbsolute,merge:this.Er.merge,tile:this.Er.tile,preLoad:!0,isPreview:"undefined"!=typeof KjWzhWlSj&&!!KjWzhWlSj.ProtoDef,uuid:this.ki,bid:this.Er.buildingID||null,isOutdoor:!0};this.Li(t)},Li:function(t){var e=this;setTimeout(function(){e.Er.tile?e.Ei.load(t,function(n,i){e.Fi(n,i,t.isOutdoor),e.Ri&&e.Ri._analyse(n,i,t)}):e.Ei.loadWhole(t,function(n,i){e.Fi(n,i,t.isOutdoor),e.Ri&&e.Ri._analyse(n,i,t)})},0)},Ii:function(){if(!(0<this.Or.length)){var t=this.Er.mapID,e=this.Ei.getData({buildingID:t});if(e&&e.buildings)for(var n=0;n<e.buildings.length;n++)this.Or.push(e.buildings[n])}},Fi:function(t,e,n){if("error"==t&&this.Ni&&this.Ni(e),"decode"===t){if(n&&(this.Ti[""+e.scene.mid]=!1,e.scene.buildings)&&0<e.scene.buildings.length)for(var i=0;i<e.scene.buildings.length;i++){var r=e.scene.buildings[i],o=((o={mapID:this.Er.mapID,buildingID:null,appName:this.Er.appName,key:this.Er.key,license:this.Er.license,mapURL:this.Er.mapURL,mapURLAbsolute:this.Er.mapURLAbsolute,merge:this.Er.merge,loadNavi:!0,preLoad:!0,isPreview:"undefined"!=typeof KjWzhWlSj,tile:this.Er.tile,type:this.Er.type,bid:null,isOutdoor:!1,uuid:this.ki}).buildingID=r.mid,o.bid=r.bid,Object.assign({},o));this.Ti[""+r.mid]=!1,this.Li(o)}if(this.Oi&&!this.Er.tile){var s,a=this.Ti[""+e.scene.mid]=!0;for(s in this.Ti)this.Ti[s]||(a=!1);a&&this.Mi&&this.Mi()}}if("complete"==t){var A,l=this.Ti[""+e.mid]=!0;for(A in this.Ti)this.Ti[A]||(l=!1);l&&this.Mi&&this.Mi()}},Ci:function(t){var e=k.NONE;return 0!=(t.wr&k.MODEL)&&(e|=k.MODELGROUP),0!=(t.wr&k.LABEL)&&(e|=k.LABELGROUP),0!=(t.wr&k.FACILITY)&&(e|=k.FACILITYGROUP),0!=(t.wr&k.EXTERNALMODEL)&&(e|=k.EXTERNALMODELGROUP),e},Bi:function(t){if(Array.isArray(t.mr))return t.mr;var e=this.Er;if(!(t=(null!==t.buildingID&&(e={buildingID:t.buildingID,mapID:t.buildingID}),this.Ei.getData(e))))return[];var n,i=[],r=ei(t.getChildren());try{for(r.s();!(n=r.n()).done;){var o=n.value;i.push(o[1].gid)}}catch(t){r.e(t)}finally{r.f()}return i},Ui:function(t,e,n,i){if(0!=e)for(var r=0;r<e;r++){if(!t[r].X(n))return!1;t[r].H(n,i)}return!0},Gi:function(t,e,n){return{level:t,type:e.getType(),FID:e.fid,name:e.name,ename:e.ename,eid:e.eid,typeID:e.type,center:void 0!==e.getCenter?Object.assign({z:e.height},e.getCenter()):Object.assign({z:e.height},e.getCoordinates()[0]),distance:n.dt}},Wi:function(t){t.sort(function(t,e){return t.level==e.level&&t.type==e.type&&t.distance&&e.distance?t.distance-e.distance:0})},Pi:function(t,e,n){var i=this.Er;if(!(i=(null!==t.buildingID&&(i={buildingID:t.buildingID,mapID:t.buildingID}),this.Ei.getData(i))))return[];var r=this.Bi(t),o=this.Ci(t);if(o===k.NONE)return[];var s,a=t.jr,A=a.length,l=[],u=ei(i.getChildren());try{for(u.s();!(s=u.n()).done;){var h=s.value,c=h[0];if(-1!==r.indexOf(c)){var f,p=ei(h[1].getChildren());try{for(p.s();!(f=p.n()).done;){var d=f.value[1];if(0!=(d.getType()&o)){var y,m=ei(d.getChildren());try{for(m.s();!(y=m.n()).done;){var g=y.value[1],v={dt:void 0};this.Ui(a,A,g,v)&&l.push(this.Gi(c,g,v))}}catch(t){m.e(t)}finally{m.f()}}}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){u.e(t)}finally{u.f()}return l},Di:function(t){for(var e=null,n=this.Or,i=0;i<n.length;i++)if(n[i].bid===t){e=n[i].mid;break}return e}}),{NaviNodeType_NULL:-1,NaviNodeType_COMMON:0,NaviNodeType_SIDE:1,NaviNodeType_FLOOR:2,NaviNodeType_EXTENT:3,NaviLiftType_NULL:0,NaviLiftType_Lift:1,NaviLiftType_Stair:2,NaviLiftType_Escalator:3,NaviLiftType_Accessible:4,NaviLiftType_Ramp:5,NaviLiftEntry_BOTH:0,NaviLiftEntry_UP:1,NaviLiftEntry_DOWN:2,NaviLiftEntry_FORBID:3,NaviEntranceType_NULL:0,NaviEntranceType_EXIT:1,NaviEntranceType_ENTRANCE:2,NaviEntranceType_ACCESS:3,NaviRoadRank_MAIN:1,NaviRoadRank_MINOR:2,NaviRoadRank_NARROW:3,NaviRoadEntry_BOTH:0,NaviRoadEntry_FORWARD:1,NaviRoadEntry_BACK:2,NaviRoadEntry_FORBID:3,NaviRoadPass_NULL:-1,NaviRoadPass_NOT_THROUGH:0,NaviRoadPass_THROUGH:1,NaviZoneType_NULL:-1,NaviZoneType_PASS_UNRESTRAINT:0,NaviZoneType_PASS_THROUGH:1,NaviZoneType_PASS_NOT_THROUGH:2,NaviZoneType_NO_ENTRY:3,NaviZoneType_CORRIDOR:4,NaviModelPassType_PASS_THROUGH:0,NaviModelPassType_PASS_NOT_THROUGH:1,NaviModelPassType_NOT_PASS:2,NaviModelPassType_DECORATE:3,NaviRoadHinderType_HINDER_GENERAL:0,NaviRoadHinderType_HINDER_HIGH:1,NaviObstructType_MODEL:0,NaviObstructType_EXTENT:1}),si={Drive:1,Walk:0},ai=0,Ai=1,li=2;function ui(t){return(ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ui(t=function(t,e){if("object"!==ui(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ui(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var ci=function(){function t(e,n,i,r){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Zi=e,this.Vi=n,this.Yi=i||[],this.zi=r||[]}var e,n;return e=t,(n=[{key:"level",get:function(){return this.Zi}},{key:"length",get:function(){return this.Vi}},{key:"pointList",get:function(){for(var t=[],e=0,n=this.Yi.length;e<n;e++)t.push({x:this.Yi[e].x,y:this.Yi[e].y,level:this.Zi});return t}}])&&hi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),fi=(Object.assign(ci.prototype,{Mr:function(){this.Yi=[],this.zi=[]}}),ci);function pi(t){return(pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function di(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===pi(t=function(t,e){if("object"!==pi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==pi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var yi=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=n,this.z=i}var e,n;return e=t,(n=[{key:"set",value:function(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"sub",value:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"cross",value:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,e){var n=t.x,i=t.y,r=(t=t.z,e.x),o=e.y;e=e.z;return this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this}},{key:"angleTo",value:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,e=Math.max(-1,Math.min(1,t)),Math.acos(e))}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}}])&&di(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function mi(t){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===mi(t=function(t,e){if("object"!==mi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==mi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&gi(t.prototype,e),n&&gi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xn=0,this.pr={},this.wr=0,this.Xi=[],this.qi=[],this.Hi=0,this.Qi=[],this.Ki=!1,this.Ji=!1,this.$i=0,this.te=!1,this.re=[]});var vi=(Object.assign(ci.prototype,{set ne(t){-1!=t&&(this.wr|=t)},get ne(){return 3&this.wr},set ie(t){this.wr|=t<<2},get ie(){return this.wr>>2&7},set ee(t){this.wr|=t<<5},get ee(){return this.wr>>5&3},Ai:function(t){this.xn=t,this.pr={x:0,y:0},this.wr=0,this.Hi=0,this.Ki=!1,this.Ji=!1},oe:function(t){return this.xn==t.xn},se:function(t){this.xn=t.xn,this.pr=Object.assign({},t.pr),this.wr=t.wr,this.Xi=[];for(var e=0;e<t.Xi.length;e++)this.Xi[e]=t.Xi[e];this.qi=[];for(var n=0;n<t.qi.length;n++)this.qi[n]=t.qi[n];this.Hi=t.Hi,this.Qi=[];for(var i=0;i<t.Qi.length;i++)this.Qi[i]=t.Qi[i];this.Ki=t.Ki,this.Ji=t.Ji}}),ci);function bi(t){return(bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xi(t,e){return(xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function wi(t){return(wi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bi=function(){var t=i,e=vi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xi(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=wi(t);if(n=e?(n=wi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===bi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t;if(this instanceof i)return(t=n.call(this)).ue=0,t.Zi=0,t.fe=null,t.$i=0,t.ae=null,t.ie=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function Mi(t){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Si(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Mi(t=function(t,e){if("object"!==Mi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Mi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&Si(t.prototype,e),n&&Si(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xn=0,this.he=-1,this.Ht={},this.ce=-1,this.Qt={},this.Vi=0,this.wr=0,this.le=[],this.ve=-1,this.ye=!1,this.be=0});var _i=(Object.assign(ci.prototype,{set de(t){this.wr|=t},get de(){return 3&this.wr},set pe(t){this.wr|=t<<2},get pe(){return this.wr>>2&3},set me(t){this.wr|=t<<4},get me(){return this.wr>>4&3},set we(t){t?this.wr|=16:this.wr&=-17},get we(){return 16&this.wr?1:0},xe:function(t){this.xn=t.xn,this.he=t.he,this.Ht=Object.assign({},t.Ht),this.ce=t.ce,this.Qt=Object.assign({},t.Qt),this.Vi=t.Vi,this.wr=t.wr,this.le=[],this.ve=t.ve;for(var e=0;e<t.le.Vi;e++)this.le[e]=t.le[e]},_e:function(){this.Vi=ft.distanceOfTwoPoints(this.Ht,this.Qt)},ge:function(){var t=this.Ht.x-this.Qt.x,e=this.Ht.y-this.Qt.y;this.Vi=Math.abs(t)+Math.abs(e)},je:function(){var t={};return t.x=(this.Ht.x+this.Qt.x)/2,t.y=(this.Ht.y+this.Qt.y)/2,t}}),ci);function Ei(t){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Ei(t=function(t,e){if("object"!==Ei(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Ei(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(){function t(e,n,i,r){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xn=e,this.Zi=n||-1,this.wr=i,this.Se=r,this.Oe=r&&r.length?r.length-1:0,this.Ee=0,this.Te=null,this.Re=null,this.Me=[],this.Ne=[],this.ke=null,this.sr=new yt,this.sr.ir(this.Se)}var e,n;return e=t,(n=[{key:"_pass",get:function(){return 3&this.wr},set:function(t){this.wr|=t}},{key:"_area",get:function(){return null==this.ke&&(this.ke=ft.St(this.Se,this.Oe)),this.ke}}])&&Ti(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Ci=(Object.assign(ci.prototype,{Ae:function(t){return!!ft.ct(t,this.sr.tr,this.sr.rr)&&ft.yt(this.Se,t,this.Oe)},Ot:function(t,e){for(var n={},i=0;i<this.Oe;i++){var r=this.Se[i],o=this.Se[(i+1)%this.Oe];if(1==ft.Ot(r,o,t,e,n))break}return n}}),ci);function Fi(t){return(Fi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Oi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Fi(t=function(t,e){if("object"!==Fi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Fi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(){function t(e,n,i,r,o,s){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xn=e,this.Ie="",this.Se=r,this.Oe=r&&r.length?r.length-1:0,this.lr=o,this.Pe=s,this.wr=i,this.Zi=n,this.De=[],this.Le=[],this.Fe=[],this.Te=null,this.Re=null,this.Me=[],this.Ce=0,this.Ee=0,this.ke=null,this.Be=!1,this.sr=new yt,this.sr.ir(this.Se)}var e,n;return e=t,(n=[{key:"pass",get:function(){return 3&this.wr},set:function(t){this.wr|=t}},{key:"area",get:function(){return null==this.ke&&(this.ke=ft.St(this.Se,this.Oe)),this.ke}}])&&Oi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Pi=(Object.assign(ci.prototype,{Ae:function(t){if(this.Pe)for(var e=0;e<this.Pe.length;e++)if(ft.yt(t,this.Pe[e],this.Pe[e].length-1))return!1;return ft.yt(t,this.Se,this.Oe)}}),ci);function Ui(t){return(Ui="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ri(t,e){return(Ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Ii(t){return(Ii=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}ci=function(){var t=i,e=vi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ri(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Ii(t);if(n=e?(n=Ii(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Ui(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t;if(this instanceof i)return(t=n.call(this)).Zi=0,t.ve=-1,t.Ue=[],t.fe=null,t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Li=(Object.assign(ci.prototype,{Ge:function(t,e,n){if(!t)return[];var i=[];n=n||this.Ue;for(var r=0;r<n.length;r++){var o=n[r];t==o.ie&&(e&&(o.$i=o.$i+e),i.push(o))}return i}}),ci);function Di(t){return(Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Qi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Di(t=function(t,e){if("object"!==Di(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Di(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var ki=function(){function t(e,n,i,r){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Zi=0,this.wr=r,this.We=e,this.Ze=n,this.Ve=[],this.Ye=[],this.ze=[],this.Xe=[],this.qe=new Map,this.He=new Map,this.Qe=[],this.Ke=new Map,this.Je=new Map,this.$e=0,this.ro=0,this.no()}var e,n;return e=t,(n=[{key:"queryContainIdOfExtent",value:function(t){return this.io(t)}},{key:"queryContainExtentID",value:function(t){return this.eo(t)}}])&&Qi(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),Ni=(Object.assign(ki.prototype,{Mr:function(){this.We=null,this.Ze=null,this.Ve=null,this.Ye=null,this.ze=null,(this.Xe=null)!=this.qe&&(this.qe.clear(),this.qe=null),null!=this.He&&(this.He.clear(),this.He=null),(this.Qe=null)!=this.Ke&&(this.Ke.clear(),this.Ke=null),null!=this.Je&&(this.Je.clear(),this.Je=null)},oo:function(){this.Xe=[];for(var t=0;t<this.Ye.length;t++){var e=this.Ye[t].toZone();this.Xe.push(e)}for(var n=0;n<this.Ve.length;n++){var i=this.Ye[n].toZone();this.Xe.push(i)}},so:function(t){for(var e=0;e<this.Xe.length;e++){var n=this.Xe[e];if(n&&n.xn==t)return n}return null},uo:function(t){for(var e=0;e<this.Xe.length;e++){var n=this.Xe[e];if(n&&1==n.contain(t))return n}return null},io:function(t){if(0!==this.Ye.length&&t)for(var e=0,n=this.Ye.length;e<n;e++){var i=this.Ye[e];if(i.Ae(t))return i.xn}return 0},eo:function(t){if(0!==this.Ye.length&&t)for(var e=0,n=this.Ye.length;e<n;e++){var i=this.Ye[e];if(i.Ae(t))return i.ve}return 0},fo:function(t,e){if(0!=this.ze.length&&t&&e)for(var n=0;n<this.ze.length;n++)if(this.ze[n].isCross(t,e))return!0;return!1},no:function(){this.$e=0;for(var t=this.ro=0;t<this.Ze.length;)null==this.Ze[t]?this.Ze.splice(t,1):(this.Ze[t].xn>this.ro&&(this.ro=this.Ze[t].xn),t++);for(var e=0;e<this.We.length;)null==this.We[e]?this.We.splice(e,1):(this.We[e].xn>this.$e&&(this.$e=this.We[e].xn),e++)},ao:function(t){return void 0===(t=this.Ke.get(t))?null:t},ho:function(t){return void 0===(t=this.Je.get(t))?null:t},co:function(t){for(var e=Number.MAX_VALUE,n=null,i=0;i<this.Ye.length;++i){var r=this.Ye[i];r.contain(t)&&r.area<e&&(e=cur_area,n=r)}for(var o=0;o<this.Ve.size();++o){var s=this.Ve[o];s.contain(t)&&s.area<e&&(e=cur_area,n=s)}return n||null},vo:function(t){for(var e=Number.MAX_VALUE,n=null,i=0;i<this.Ve.length;++i){var r=this.Ve[i];r.Ae(t)&&r.area<e&&(e=r.area,n=r)}return n||null},yo:function(){return++this.$e},bo:function(){return++this.ro},do:function(t){this.$e=t},po:function(t){this.ro=t},mo:function(){for(var t=0;t<this.We.length;t++){var e=this.We[t];e&&(e instanceof Li?this.Ke.set(e.ve,t):this.Ke.set(e.xn,t))}},wo:function(){for(var t=0;t<this.Ze.length;t++){var e=this.Ze[t];e&&this.Je.set(e.xn,t)}},xo:function(){for(var t=this,e=(this.He.clear(),0);e<this.Ze.length;e++)!function(){var n=t.Ze[e];if(null!=n){var i,r,o=n.pe;oi.NaviRoadEntry_BOTH!=o&&oi.NaviRoadEntry_FORWARD!=o||(i=n.he,(r=t.He.get(i))||t.He.set(i,r=[]),null==r.find(function(t){return t._o==n.ce})&&r.push({_o:n.ce,Vi:n.Vi})),oi.NaviRoadEntry_BOTH!=o&&oi.NaviRoadEntry_BACK!=o||(i=n.ce,(r=t.He.get(i))||t.He.set(i,r=[]),null==r.find(function(t){return t._o==n.he})&&r.push({_o:n.he,Vi:n.Vi}))}}()},jo:function(t){for(var e=0;e<this.We.length;e++)if(this.We[e].xn==t)return e;return-1},So:function(t){for(var e=9;e<this.Ze.length;e++)if(this.Ze[e].xn==t)return e;return-1},Oo:function(t){for(var e=[],n=this.Ze,i=0;i<n.length;i++){var r=n[i],o=r.Ht,s=r.Qt,a=[];t.Eo([o,s],a)?e.push({road:r,crss:a,index:i}):t.To(o)&&e.push({road:r,crss:[],index:i})}return e},Ro:function(t){for(var e=null,n=Number.MAX_VALUE,i=0;i<this.Ve.length;i++){var r=this.Ve[i];ft.yt(t,r.Se,r.Oe)&&n>r.area&&(n=(e=r).area)}return e},Mo:function(t){for(var e=-1,n=0;n<this.Xe.length;n++){var i=this.Xe[n];if(ft.yt(t,i.Se,i.Oe)){e=i.xn;break}}return e},No:function(){var t=this.Ve.length;t=parseInt(Math.random()*t);return this.Ve[t]},ko:function(){for(var t=0;t<this.Qe.length;t++)this.Qe[t]=!1},Ao:function(){for(var t=[],e=0;e<this.We.length;e++){var n=this.We[e];n.ie!=oi.NaviLiftType_NULL&&t.push(n)}return t},Io:function(t){for(var e=null,n=0;n<this.Ye.length;n++)if(t==this.Ye[n].xn){e=this.Ye[n];break}if(!e)return null;for(var i=[],r=0;r<this.We.length;r++){var o=this.We[r];ft.yt(o.pr,e.Se,e.Oe)&&i.push(o)}for(var s=[],a=0;a<this.Ze.length;a++){var A=this.Ze[a];ft.yt(A.Ht,e.Se,e.Oe)&&s.push(A)}for(var l=[],u=0;u<this.Ve.length;u++){var h=this.Ve[u];ft.yt(h.lr,e.Se,e.Oe)&&l.push(h)}var c=new ki(i,s,!0,1);return c.Ve=l,c.Ye=[e],c}}),ki);function ji(t){return(ji="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Hi(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ji(t=function(t,e){if("object"!==ji(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ji(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&Hi(t.prototype,e),n&&Hi(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Po=null});var zi=(Object.assign(ci.prototype,{Mr:function(){this.Po=null},Do:function(t){this.Po=t},Lo:function(t,e){var n=null;return 0==e?n=an.yn(t):1==e?n=an.bn(t):2==e&&(n=an.dn(t)),{points:n[0],holes:n.slice(1)}},Fo:function(t,e,n){var i=null;return 0==n?i=nn.yn(t,e):1==n?i=nn.bn(t,e):2==n&&(i=nn.dn(t,e)),{points:i[0],holes:i.slice(1)}},Co:function(t){if(t&&"string"!=typeof t)for(var e in t){var n=t[e];if("vertices"==e||"vertex"==e)for(var i in n)i%2==0&&(n[i]=-n[i]);else"scene_data"==e?(n.x=-n.x,n.defCenX=-n.defCenX):this.Co(n)}},Bo:function(t){var e,n;return""!=t&&t?(e=[],n=[],0<=(t=t).indexOf("|")||0<=t.indexOf("-")||0<=t.indexOf(",")?(n=t.split(/[|,-]/),e.push.apply(e,n)):e.push(t),e):[]},Uo:function(t,e,n,i){for(var r={},o=[],s=[],a=[],A=[],l=[],u=this.Po.fileVer,h=i.naviExtents&&0<i.naviExtents.length?i.naviExtents:e.extentLayer,c=0,f=h.length;c<f;c++){var p=h[c],d=1===u?this.Lo(p.geo,2):this.Fo(p.idxs,p.pts,2);p={eid:p.id||p.eid,geoArr:d.points,holes:d.holes};s.push(p)}for(var y=0,m=e.labelLayer.length;y<m;y++)r[e.labelLayer[y].eid]=e.labelLayer[y];for(var g=0,v=e.modelLayer.length;g<v;g++){var b=e.modelLayer[g],x=n.modelLayer[g],w={};x=(w.fid=x.fid,w.eid=b.eid,w.pass=x.pass,w.lr=(1===u?this.Lo(r[b.eid].geo,0):this.Fo(r[b.eid].idxs,r[b.eid].pts,0)).points,null),x=1===u?this.Lo(b.geo,2):this.Fo(b.idxs,b.pts,2);w.geoArr=x.points,w.holes=x.holes,o.push(w)}if(i&&i.naviNodes)for(var B=0,M=i.naviNodes.length;B<M;B++){var S=i.naviNodes[B];S.geoArr=(1===u?this.Lo(S.geo,0):this.Fo(S.idxs,S.pts,0)).points,S.linkSegArr=this.Bo(S.linkSeg),S.liftFloorArr=this.Bo(S.liftFloor),a.push(S)}if(i&&i.naviSegments)for(var _=0,E=i.naviSegments.length;_<E;_++){var T=i.naviSegments[_];T.geoArr=(1===u?this.Lo(T.geo,1):this.Fo(T.idxs,T.pts,1)).points,T.m_Id=i.mid,A.push(T)}if(i&&i.naviZones)for(var C=0,F=i.naviZones.length;C<F;C++){var O=i.naviZones[C],P=1===u?this.Lo(O.geo,2):this.Fo(O.idxs,O.pts,2);O.geoArr=P.points,O.holes=P.holes,O.m_Id=i.mid,l.push(O)}return{level:t,extentLayer:s,modelLayer:o,naviSegments:A,naviNodes:a,naviZones:l}}}),ci);function Vi(t){return(Vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Gi(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=function(t,e){var n;if(t)return"string"==typeof t?Yi(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yi(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Yi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Ki(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Vi(t=function(t,e){if("object"!==Vi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Vi(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&Ki(t.prototype,e),n&&Ki(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Go=e,this.Wo=null,this.Zo=null,this.Vo=-1,this.Yo=-1,this.zo=o.MODULE_SHORTEST,this.Xo=[],this.Go.mo(),this.Go.wo(),this.Go.xo(),this.qo=5e-4,this.Ho=0});var Xi=(Object.assign(ci.prototype,{Qo:function(t,e){if(null!=this.Go.We&&0!=this.Go.We.length&&this.Go.We[0]instanceof Li){this.Ho=10;for(var n={},i=0;i<this.Go.We.length;i++){var r=(a=this.Go.We[i]).Ko.Se,o=r.length-1,s=this.Go.We[i].ve,a=(o=(n[s]=[1,1,Number.MAX_VALUE],ft.yt(t,r,o)&&(n[s][0]=0,t.level==a.Zi)&&a.ve,ft.yt(e,r,o)&&(n[s][1]=0,e.level==a.Zi)&&a.ve,ft.Ct(r)),ft.dt(t,o)+ft.dt(e,o));n[s][2]=a}var A,l=this.Go.He,u=Gi(l.keys());try{for(u.s();!(A=u.n()).done;){var h=A.value;l.get(h).sort(function(t,e){var i=n[t._o][0]+n[t._o][1]-(n[e._o][0]+n[e._o][1]);return 0==i?n[t._o][2]-n[e._o][2]:i})}}catch(t){u.e(t)}finally{u.f()}}},Jo:function(t,e,n,i,r){return this.$o(n),this.Wo=t,this.Zo=e,this.Qo(i,r),this.Vo=t.xn,this.Yo=e.xn,null!=(n=this.Go.ao(this.Vo))&&null!=(i=this.Go.ao(e.xn))&&((r=[]).push(i),this.ts(this.Go,n,r))?a.ROUTE_SUCCESS:a.ROUTE_FAILED_CANNOT_ARRIVE},rs:function(t,e,n,i){return n&&i&&this.Qo(n,i),this.Vo=t,this.Yo=e,null!=(n=this.Go.ao(t))&&null!=(i=this.Go.ao(e))&&((t=[]).push(i),this.ts(this.Go,n,t))?a.ROUTE_SUCCESS:a.ROUTE_FAILED_CANNOT_ARRIVE},ns:function(){var t=[],e=this.Go.ao(this.Yo),n=[];n.push(e),e=[];return this.es(n,this.Go.We,e,[]),t.push.apply(t,e),t},Mr:function(){this.Go.Mr(),this.Go=null,this.Wo=null,this.Zo=null},ts:function(t,e,n){if(null==t)return!1;var i=t.We.length;if(e<0||i<=e)return!1;this.ss(n,e);for(var r=0;r<i;++r)t.We[r].$i=Number.MAX_VALUE,t.We[r].te=!1,t.We[r].re=[];t.We[e].$i=0;for(var o=n.length,s=0,a=[],A=(a.push(t.We[e]),this.us.bind(this));0<a.length;){var l=a[0]instanceof Li?a[0].ve:a[0].xn,u=(a.splice(0,1),t.ao(l));if(null!=u){var h=t.We[u];if(!h.te){if(h.te=!0,-1!=n.indexOf(u)&&++s==o)return!0;if(0!=t.He.size){var c=t.He.get(l);if(c)for(var f=0;f<c.length;f++){var p,d,y=c[f],m=y._o;null==(m=t.ao(m))||(y=y.Vi,p=t.We[m],d=this.Ho+y+h.$i,d=Number(d.toFixed(3)),p.te)||(p.$i>d?(p.$i=d,p.re=[],p.re.push(u),a.push(t.We[m]),a.sort(A)):Math.abs(p.$i-(y+h.$i))<1e-12&&-1==p.re.indexOf(u)&&p.re.push(u))}}}}}return!(s<o)},us:function(t,e){return t.$i-e.$i},ss:function(t,e){for(var n=t.indexOf(e);-1!=n;)t.splice(n,1),n=t.indexOf(e)},$o:function(t){if(this.zo!=t){for(var e={},n=0;n<this.Go.Ze.length;n++){var i=(s=this.Go.Ze[n]).he,r=s.ce,s=s.de;e.hasOwnProperty(i)||(e[i]={}),e[i][r]=s,e.hasOwnProperty(r)||(e[r]={}),e[r][i]=s}if(o.MODULE_SHORTEST==t){var a,A=Gi(this.Go.He.keys());try{for(A.s();!(a=A.n()).done;){var l,u=a.value,h=Gi(this.Go.He.get(u));try{for(h.s();!(l=h.n()).done;){var c=l.value,f=c._o,p=e[u][f];c.Vi=c.Vi/p}}catch(t){h.e(t)}finally{h.f()}}}catch(t){A.e(t)}finally{A.f()}}else if(o.MODULE_BEST==t){var d,y=Gi(this.Go.He.keys());try{for(y.s();!(d=y.n()).done;){var m,g=d.value,v=Gi(this.Go.He.get(g));try{for(v.s();!(m=v.n()).done;){var b=m.value,x=b._o,w=e[g][x];b.Vi=b.Vi*w}}catch(t){v.e(t)}finally{v.f()}}}catch(t){y.e(t)}finally{y.f()}}this.zo=t}},hs:function(t,e,n,i){0!=e[t].re.length&&(t=e[t].re[0],n.push(e[t]),i.count++,this.hs(t,e,n,i))},es:function(t,e,n,i){for(var r=0;r<t.length;r++){var o=t[r],s=(n.push(e[o]),{count:1});this.hs(o,e,n,s),i.push(s.count)}}}),ci);function Wi(t){return(Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zi(t,e){return(Zi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function qi(t){return(qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ji=function(){var t=i,e=Pi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zi(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=qi(t);if(n=e?(n=qi(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Wi(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(){var t;if(this instanceof i)return(t=n.call(this)).xn=-1,t.cs=[],t;throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();function $i(t){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===$i(t=function(t,e){if("object"!==$i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==$i(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var er=function(t,e,n){return e&&tr(t.prototype,e),n&&tr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.ut=null,this.Jt=null,this.ls=null,this.dt=0,this.vs=!1,this.ys=oi.NaviObstructType_MODEL});function nr(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=rr(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ir(t){return function(t){if(Array.isArray(t))return or(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||rr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rr(t,e){var n;if(t)return"string"==typeof t?or(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?or(t,e):void 0}function or(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function sr(t){return(sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===sr(t=function(t,e){if("object"!==sr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==sr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.xn=null,this.bs=null,this.ds=null,this.Go=e,this.ps=new Map,this.ws=new Map,this.xs=new Map,this._s=new Map,this.gs=new Map,this.js=[],this.Ss=Number.INT_MIN,this.Os=Number.INT_MIN,this.Es=-1,this.Wo=null,this.Zo=null,this.zo=o.MODULE_SHORTEST,this.Ts=new Map,this.Rs=new Map,this.Ms=new Map,this.Ns=[],this.ks=[],this.As=[],this.Is=[],this.Ps=100,this.Ds=-1,this.Ls=15,this.Fs=.1,this.Cs=[],this.Bs=[],this.Us=[],this.Gs=[],this.Ws=!0,this.Zs=[],this.wr=null,this.Vs(),this.Ys(),this.zs(),this.Xs(),this.qs(),this.te=!1,this.Hs=[],this.wr=null}var e,n;return e=t,(n=[{key:"assignedPts",get:function(){return this.Bs},set:function(t){this.Bs=t}},{key:"obstruct",get:function(){return this.Ws},set:function(t){this.Ws=t}},{key:"level",get:function(){return this.Zi},set:function(t){this.Zi=t}}])&&ar(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Ar=(Object.assign(ci.prototype,{Qs:function(t){var e,n=null==t.Ks?null:t.Ks;t instanceof vi?this.Wo=t:(e=new vi,this.Js(t,e,n)||this._failedInsertPts.push(t),this.Wo=e)},$s:function(t){var e,n=null==t.Ks?null:t.Ks;t instanceof vi?this.Zo=t:(e=new vi,this.Js(t,e,n)||this._failedInsertPts.push(t),this.Zo=e)},tu:function(t){var e=this.Go.Ye[0].Se;return!!ft.yt(t,e,e.length-1)},Jo:function(t,e,n){this.Ss=t instanceof vi?this.ru(t.pr):this.ru(t),this.Os=e instanceof vi?this.ru(e.pr):this.ru(e),n&&(this.zo=n),this.nu(this.Ss),this.nu(this.Os),this.Is=[];n=this.ws.get(this.Ss);var i=this.ws.get(this.Os);if(t instanceof vi)if(null!=t.iu){if(t=t.pr,a.ROUTE_FAILED_NO_START_ARRIVAL==this.eu(t,n))return a.ROUTE_FAILED_NO_START_ARRIVAL}else this.Wo=t;else if(a.ROUTE_FAILED_NO_START_ARRIVAL==this.eu(t,n))return a.ROUTE_FAILED_NO_START_ARRIVAL;if(e instanceof vi)if(null!=e.iu){if(e=e.pr,a.ROUTE_FAILED_NO_DEST_ARRIVAL==this.ou(e,i))return a.ROUTE_FAILED_NO_DEST_ARRIVAL}else this.Zo=e;else if(a.ROUTE_FAILED_NO_DEST_ARRIVAL==this.ou(e,i))return a.ROUTE_FAILED_NO_DEST_ARRIVAL;return null==this.Wo?a.ROUTE_FAILED_NO_DATA_START:null==this.Zo?a.ROUTE_FAILED_NO_DATA_DEST:this.su()},uu:function(){var t;this.Gs=[];for(var e=0;e<this.Bs.length;e++){var n={x:(n=this.Bs[e])[0],y:n[1]},i=this.ru(n);i=this.fu(i,n);this.Gs.push(i)}(t=this.js).push.apply(t,ir(this.Gs))},ns:function(){return this.js},Mr:function(){this.bs=null,this.ds=null,this.Go.Mr(),this.Go=null,this.ps.clear(),this.ps=null;var t,e=nr(this.ws);try{for(e.s();!(t=e.n()).done;)t.value[1].Mr()}catch(t){e.e(t)}finally{e.f()}this.ws.clear(),this.ws=null;var n,i=nr(this._s);try{for(i.s();!(n=i.n()).done;)n.value[1].Mr()}catch(t){i.e(t)}finally{i.f()}this._s.clear(),this._s=null;var r,o=nr(this.xs);try{for(o.s();!(r=o.n()).done;)r.value[1].Mr()}catch(t){o.e(t)}finally{o.f()}this.xs.clear(),this.xs=null;var s,a=nr(this.gs);try{for(a.s();!(s=a.n()).done;)s.value[1].Mr()}catch(t){a.e(t)}finally{a.f()}this.gs.clear(),this.gs=null,this.js=[],this.Wo=null,this.Zo=null,this.Ts.clear(),this.Ts=null,this.Rs.clear(),this.Rs=null,this.Ms.clear(),this.Ns=[],this.ks=[],this.As=[],this.Is=[],this.Zs=[],this.Ws=!1},li:function(){this.js=[],this.au(-1),this.au(this.Ss),this.Ss=Number.INT_MIN,this.au(this.Os),this.Os=Number.INT_MIN,this.hu(),this.Cs=[];var t=this.Go.Ze.length;this.Es<-2*t&&(this.Es=-1);for(var e=0;e<this.Ns.length;e++){var n=this.Ns[e];this.cu(n.lu,n.ls,oi.NaviRoadHinderType_HINDER_HIGH)}this.Ns=[],this.ks=[],this.As=[],this.Is=[]},vu:function(t){this.Zs=t,this.xs.clear(),this.gs.clear();for(var e=0;e<this.Zs.length;e++)for(var n=this.Zs[e],i=this.yu(n),r=0;r<i.length;r++){var o=i[r],s=this.xs.get(o);s||(s=this.bu(this.ws.get(o)),this.xs.set(o,s)),this.du(s,n)}var a,A=nr(this.xs);try{for(A.s();!(a=A.n()).done;){var l=a.value;this.gs.set(l[0],new Xi(l[1]))}}catch(t){A.e(t)}finally{A.f()}},du:function(t,e){for(var n=t.Oo(e),i=0;i<n.length;i++){var r=n[i],o=new _i,s=(o.xe(r.road),o.pe);o.pe=oi.NaviRoadEntry_FORBID,t.Ze[r.index]=o,1==r.crss.length&&(e.To(o.Ht)?this.pu(r.crss[0],this.yo(),o.Qt,this.yo(),s,t):this.pu(o.Ht,this.yo(),r.crss[0],this.yo(),s,t)),2<=r.crss.length&&(this.pu(o.Ht,this.yo(),r.crss[0],this.yo(),s,t),this.pu(r.crss[r.crss.length-1],this.yo(),o.Qt,this.yo(),s,t))}var a=new Ji;a.xn=this.mu(),a.Se=e.Se,a.pass=oi.NaviModelPassType_NOT_PASS,t.Ve.push(a)},pu:function(t,e,n,i,r,o){var s,a;t instanceof vi?s=t:((s=new vi).xn=e,s.pr=t,o.We.push(s)),n instanceof vi?a=n:((a=new vi).xn=i,a.pr=n,o.We.push(a)),(e=new _i).xn=this.bo(),e.he=s.xn,e.Ht=s.pr,e.ce=a.xn,e.Qt=a.pr,e.pe=r,e.xn,e.he,e.Ht.x.toFixed(3),e.Ht.y.toFixed(3),e.ce,e.Qt.x.toFixed(3),e.Qt.y.toFixed(3),o.Ze.push(e)},mu:function(){return this.Es--},wu:function(t){var e={ls:null};if(1!==this.wr){var n=this.ru(t),i=this.xu(n).vo(t,-0);if(i&&(e.ls=i).pass!=oi.NaviModelPassType_NOT_PASS&&(i.pass===oi.NaviModelPassType_PASS_THROUGH||i.pass===oi.NaviModelPassType_PASS_NOT_THROUGH)){if(0<i.De.length)return e;for(var r={},o=[],s=[],a=this.xu(n).Ze,A=!0,l=0;l<i.Oe;l++)for(var u=i.Se[l],h=i.Se[l+1],c=0;c<a.length;c++){var f=a[c];1===ft.Ot(u,h,f.Ht,f.Qt,r)&&oi.NaviRoadEntry_FORBID!==f.pe&&(A=!1,(f={}).x=r.x,f.y=r.y,o.push(f),s.push(a[c]))}if(!A){i.De=[],i.Fe=[],i.Le=[];for(var p=0;p<o.length;p++){var d=s[p],y=this._u(n,o[p],d);y.gu.push(d.xn),y.ne=oi.NaviNodeType_COMMON,d.pe===oi.NaviRoadEntry_BOTH?y.entranceType=oi.NaviEntranceType_ACCESS:ft.yt(d.Ht,i.Se,i.Oe)?(d.pe===oi.NaviRoadEntry_FORWARD&&(y.entranceType=oi.NaviEntranceType_EXIT),d.pe===oi.NaviRoadEntry_BACK&&(y.entranceType=oi.NaviEntranceType_ENTRANCE)):(d.pe===oi.NaviRoadEntry_FORWARD&&(y.entranceType=oi.NaviEntranceType_ENTRANCE),d.pe===oi.NaviRoadEntry_BACK&&(y.entranceType=oi.NaviEntranceType_EXIT)),i.De.push(y),i.Fe.push(y.entranceType),i.Le.push(y.ne)}}}}return e},ju:function(t){var e,n=null,i=Number.MAX_VALUE,r=nr(t.values());try{for(r.s();!(e=r.n()).done;){var o=e.value;0<o.length&&o[0].dt<i&&(n=o[0],i=o[0].dt)}}catch(t){r.e(t)}finally{r.f()}return n},Su:function(t,e){for(var n=[],i=0;i<e.length;i++){Number.MAX_VALUE;var r=ft._t(t,e[i].Ht,e[i].Qt,{});n.push({Kt:e[i].xn,Ht:e[i].Ht,Qt:e[i].Qt,dt:r,Jt:e[i]})}return n.sort(function(t,e){return t.dt-e.dt}),n},Ou:function(t,e,n){var i=[],r=[],o=[],s=[],a=[],A=[],l=(A.push(t),A.push(e.Ht),A.push(e.Qt),[]),u=(l.push(t),1e7/Math.sqrt((e.Ht.x-t.x)*(e.Ht.x-t.x)+(e.Ht.y-t.y)*(e.Ht.y-t.y)));l.push({x:t.x+(e.Ht.x-t.x)*u,y:t.y+(e.Ht.y-t.y)*u}),u=1e7/Math.sqrt((e.Qt.x-t.x)*(e.Qt.x-t.x)+(e.Qt.y-t.y)*(e.Qt.y-t.y));l.push({x:t.x+(e.Qt.x-t.x)*u,y:t.y+(e.Qt.y-t.y)*u});for(var h,c,f,p,d,y=0;y<n.length;y++)n[y].Kt==e.Kt?(n[y].dt=ft._t(t,n[y].Ht,n[y].Qt,{}),o.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:n[y].Qt,dt:n[y].dt,Jt:n[y].Jt})):(d=ft.Yt(n[y].Ht,n[y].Qt,A)).isintersect?1==d.type?.01<ft.distanceOfTwoPoints(d.start,d.end)&&o.push({Kt:n[y].Kt,Ht:d.start,Qt:d.end,dt:n[y].dt,Jt:n[y].Jt}):2==d.type?("start"==d.outer?(n[y].Qt=d.start,n[y].dt=ft.dt(d.start,t)):"end"==d.outer&&(n[y].Ht=d.end,n[y].dt=ft.dt(d.end,t)),.01<ft.distanceOfTwoPoints(d.start,d.end)&&o.push({Kt:n[y].Kt,Ht:d.start,Qt:d.end,dt:n[y].dt,Jt:n[y].Jt}),i.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:n[y].Qt,dt:n[y].dt,Jt:n[y].Jt})):3==d.type?("start"==d.outer?(n[y].Qt=d.start,n[y].dt=ft.dt(d.start,t)):"end"==d.outer&&(n[y].Ht=d.end,n[y].dt=ft.dt(d.end,t)),.01<ft.distanceOfTwoPoints(d.end,d.start)&&o.push({Kt:n[y].Kt,Ht:d.start,Qt:d.end,dt:n[y].dt,Jt:n[y].Jt}),r.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:n[y].Qt,dt:n[y].dt,Jt:n[y].Jt})):4==d.type&&(.01<ft.distanceOfTwoPoints(d.start,d.end)&&o.push({Kt:n[y].Kt,Ht:d.start,Qt:d.end,dt:n[y].dt,Jt:n[y].Jt}),ft.distanceOfTwoPoints(n[y].Ht,d.start)<ft.distanceOfTwoPoints(n[y].Ht,d.end)?(c={x:d.start.x-t.x,y:d.start.y-t.y},h={x:n[y].Ht.x-t.x,y:n[y].Ht.y-t.y},0<(c=(c=ft.Dt(c,h))<180?c:c-360)?(.01<ft.distanceOfTwoPoints(n[y].Ht,d.start)&&i.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:d.start,dt:ft.dt(d.start,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,d.end)&&r.push({Kt:n[y].Kt,Ht:d.end,Qt:n[y].Qt,dt:ft.dt(d.end,t),Jt:n[y].Jt})):(.01<ft.distanceOfTwoPoints(n[y].Ht,d.start)&&r.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:d.start,dt:ft.dt(d.start,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,d.end)&&i.push({Kt:n[y].Kt,Ht:d.end,Qt:n[y].Qt,dt:ft.dt(d.start,t),Jt:n[y].Jt}))):(h={x:d.end.x-t.x,y:d.end.y-t.y},c={x:n[y].Ht.x-t.x,y:n[y].Ht.y-t.y},0<(f=(f=ft.Dt(h,c))<180?f:f-360)?(.01<ft.distanceOfTwoPoints(n[y].Ht,d.end)&&i.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:d.end,dt:ft.dt(d.end,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,d.start)&&r.push({Kt:n[y].Kt,Ht:d.start,Qt:n[y].Qt,dt:ft.dt(d.start,t),Jt:n[y].Jt})):(.01<ft.distanceOfTwoPoints(n[y].Ht,d.end)&&r.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:d.end,dt:ft.dt(d.end,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,d.start)&&i.push({Kt:n[y].Kt,Ht:d.start,Qt:n[y].Qt,dt:ft.dt(d.start,t),Jt:n[y].Jt})))):(f=ft.Yt(n[y].Ht,n[y].Qt,l)).isintersect?1==f.type?.01<ft.distanceOfTwoPoints(f.start,f.end)&&a.push({Kt:n[y].Kt,Ht:f.start,Qt:f.end,dt:n[y].dt,Jt:n[y].Jt}):2==f.type?("start"==f.outer?(n[y].Qt=f.start,n[y].dt=ft.dt(f.start,t)):"end"==f.outer&&(n[y].Ht=f.end,n[y].dt=ft.dt(f.end,t)),.01<ft.distanceOfTwoPoints(f.start,f.end)&&a.push({Kt:n[y].Kt,Ht:f.start,Qt:f.end,dt:n[y].dt,Jt:n[y].Jt}),i.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:n[y].Qt,dt:n[y].dt,Jt:n[y].Jt})):3==f.type?("start"==f.outer?(n[y].Qt=f.start,n[y].dt=ft.dt(f.start,t)):"end"==f.outer&&(n[y].Ht=f.end,n[y].dt=ft.dt(f.end,t)),.01<ft.distanceOfTwoPoints(f.start,f.end)&&a.push({Kt:n[y].Kt,Ht:f.start,Qt:f.end,dt:n[y].dt,Jt:n[y].Jt}),r.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:n[y].Qt,dt:n[y].dt,Jt:n[y].Jt})):4==f.type&&(.01<ft.distanceOfTwoPoints(f.start,f.end)&&a.push({Kt:n[y].Kt,Ht:f.start,Qt:f.end,dt:n[y].dt,Jt:n[y].Jt}),ft.distanceOfTwoPoints(n[y].Ht,f.start)<ft.distanceOfTwoPoints(n[y].Ht,f.end)?(d={x:f.start.x-t.x,y:f.start.y-t.y},p={x:n[y].Ht.x-t.x,y:n[y].Ht.y-t.y},0<(d=(d=ft.Dt(d,p))<180?d:d-360)?(.01<ft.distanceOfTwoPoints(n[y].Ht,f.start)&&i.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:f.start,dt:ft.dt(f.start,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,f.end)&&r.push({Kt:n[y].Kt,Ht:f.end,Qt:n[y].Qt,dt:ft.dt(f.end,t),Jt:n[y].Jt})):(.01<ft.distanceOfTwoPoints(n[y].Ht,f.start)&&r.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:f.start,dt:ft.dt(f.start,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,f.end)&&i.push({Kt:n[y].Kt,Ht:f.end,Qt:n[y].Qt,dt:ft.dt(f.start,t),Jt:n[y].Jt}))):(p={x:f.end.x-t.x,y:f.end.y-t.y},d={x:n[y].Ht.x-t.x,y:n[y].Ht.y-t.y},0<(d=(d=ft.Dt(p,d))<180?d:d-360)?(.01<ft.distanceOfTwoPoints(n[y].Ht,f.end)&&i.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:f.end,dt:ft.dt(f.end,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,f.start)&&r.push({Kt:n[y].Kt,Ht:f,Qt:n[y].Qt,dt:ft.dt(f.start,t),Jt:n[y].Jt})):(.01<ft.distanceOfTwoPoints(n[y].Ht,f.end)&&r.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:f.end,dt:ft.dt(f.end,t),Jt:n[y].Jt}),.01<ft.distanceOfTwoPoints(n[y].Qt,f.start)&&i.push({Kt:n[y].Kt,Ht:f.start,Qt:n[y].Qt,dt:ft.dt(f.start,t),Jt:n[y].Jt})))):s.push({Kt:n[y].Kt,Ht:n[y].Ht,Qt:n[y].Qt,dt:n[y].dt,Jt:n[y].Jt});return{left:i,right:r,inside:o,invalid:a,other:s}},nu:function(t){var e,n=this.ws.get(t),i=nr(n.He.keys());try{for(i.s();!(e=i.n()).done;){var r=e.value;r<0&&n.He.delete(r)}}catch(t){i.e(t)}finally{i.f()}var o,s=nr(n.Ke.keys());try{for(s.s();!(o=s.n()).done;){var a=o.value;a<0&&n.Ke.delete(a)}}catch(t){s.e(t)}finally{s.f()}var A,l=nr(n.Ke.keys());try{for(l.s();!(A=l.n()).done;){var u=A.value;u<0&&n.Ke.delete(u)}}catch(t){l.e(t)}finally{l.f()}for(var h=[],c=0;c<n.We.length&&0<n.We[c].xn;c++)h.push(n.We[c]);n.We=h;for(var f=[],p=0;p<n.Ze.length&&0<n.Ze[p].xn;p++)f.push(n.Ze[p]);n.Ze=f,this.ws.delete(t),this.ws.set(t,n)},Eu:function(t,e){Number.MAX_VALUE;for(var n=this.Su(t,e.Ze),i=[],r=[],o=n[0],s=[],a=0;a<n.length;a++){if(n[a].dt<.01)return s.push(n[a]),s;if(!(n[a].Kt<0)){o=n[a],n.splice(0,a);break}}var A=0,l=0,u={x:null,y:null};ft.Rt(t,o.Ht,o.Qt,u)||(u=ft.dt(t,o.Ht)<=ft.dt(t,o.Qt)?o.Ht:o.Qt);for(var h,c,f=0;f<n.length;f++)n[f].Kt<0||(h=n[f].Ht,c=n[f].Qt,h=(h=ft.Dt({x:u.x-t.x,y:u.y-t.y},{x:h.x-t.x,y:h.y-t.y}))<180?h:h-360,c=(c=ft.Dt({x:u.x-t.x,y:u.y-t.y},{x:c.x-t.x,y:c.y-t.y}))<180?c:c-360,(0<h&&0<c?i:(h<0&&c<0||i.push(n[f]),r)).push(n[f]));for(var p=[],d=[];;){var y=this.Ou(t,o,i);if(y.inside&&0<y.inside.length){y.inside.sort(function(t,e){return t.dt-e.dt});for(var m=0;m<y.inside.length;m++){for(var g,v,b,x,w=[],B=0;B<y.inside.length;B++)m==B||y.inside[B].remain&&0===y.inside[B].remain.length||((g=[]).push(t),g.push(y.inside[m].Ht),g.push(y.inside[m].Qt),ft.Yt(y.inside[B].Ht,y.inside[B].Qt,g).isintersect&&y.inside[B].dt<y.inside[m].dt&&(g=(y.inside[B].Ht.x-t.x)/Math.sqrt((y.inside[B].Ht.x-t.x)*(y.inside[B].Ht.x-t.x)+(y.inside[B].Ht.y-t.y)*(y.inside[B].Ht.y-t.y))*1e7,b=(y.inside[B].Ht.y-t.y)/Math.sqrt((y.inside[B].Ht.x-t.x)*(y.inside[B].Ht.x-t.x)+(y.inside[B].Ht.y-t.y)*(y.inside[B].Ht.y-t.y))*1e7,g={x:t.x+g,y:t.y+b},b=(y.inside[B].Qt.x-t.x)/Math.sqrt((y.inside[B].Qt.x-t.x)*(y.inside[B].Qt.x-t.x)+(y.inside[B].Qt.y-t.y)*(y.inside[B].Qt.y-t.y))*1e7,v=(y.inside[B].Qt.y-t.y)/Math.sqrt((y.inside[B].Qt.x-t.x)*(y.inside[B].Qt.x-t.x)+(y.inside[B].Qt.y-t.y)*(y.inside[B].Qt.y-t.y))*1e7,b={x:t.x+b,y:t.y+v},v={x:null,y:null},ft.Ot(t,g,y.inside[m].Ht,y.inside[m].Qt,g={x:null,y:null}),ft.Ot(t,b,y.inside[m].Ht,y.inside[m].Qt,v),g.x)&&g.y&&v.x&&v.y&&(b=ft.distanceOfTwoPoints(g,y.inside[m].Ht),x=ft.distanceOfTwoPoints(v,y.inside[m].Ht),w.push({Kt:y.inside[m].Kt,Ht:b<x?g:v,Qt:b<x?v:g,dt:y.inside[m].dt,Jt:y.inside[m].Jt})));var M=ft.Xt(y.inside[m],w);y.inside[m].remain=M,p.push.apply(p,ir(M))}}if(i=[],o=null,!(y.left&&0<y.left.length))break;y.left.sort(function(t,e){return t.dt-e.dt});for(var S=0;S<y.left.length;S++){var _={x:y.left[S].Ht.x-t.x,y:y.left[S].Ht.y-t.y},E={x:y.left[S].Qt.x-t.x,y:y.left[S].Qt.y-t.y},T={x:u.x-t.x,y:u.y-t.y};_=ft.Dt(T,_);if(A<(E=(T=(T=ft.Dt(T,E))<180?T:T-360)<(_=_<180?_:_-360)?_:T)){o=y.left[S],A=E;break}}if(!o)break;i.push.apply(i,ir(y.left)),i.push.apply(i,ir(y.other))}for(o=n[0];;){var C=this.Ou(t,o,r);if(C.inside&&0<C.inside.length){C.inside.sort(function(t,e){return t.dt-e.dt});for(var F=0;F<C.inside.length;F++){for(var O,P,U,R,I=[],L=0;L<C.inside.length;L++)F==L||C.inside[L].remain&&0===C.inside[L].remain.length||((O=[]).push(t),O.push(C.inside[F].Ht),O.push(C.inside[F].Qt),ft.Yt(C.inside[L].Ht,C.inside[L].Qt,O).isintersect&&C.inside[L].dt<C.inside[F].dt&&(O=(C.inside[L].Ht.x-t.x)/Math.sqrt((C.inside[L].Ht.x-t.x)*(C.inside[L].Ht.x-t.x)+(C.inside[L].Ht.y-t.y)*(C.inside[L].Ht.y-t.y))*1e7,U=(C.inside[L].Ht.y-t.y)/Math.sqrt((C.inside[L].Ht.x-t.x)*(C.inside[L].Ht.x-t.x)+(C.inside[L].Ht.y-t.y)*(C.inside[L].Ht.y-t.y))*1e7,O={x:t.x+O,y:t.y+U},U=(C.inside[L].Qt.x-t.x)/Math.sqrt((C.inside[L].Qt.x-t.x)*(C.inside[L].Qt.x-t.x)+(C.inside[L].Qt.y-t.y)*(C.inside[L].Qt.y-t.y))*1e7,P=(C.inside[L].Qt.y-t.y)/Math.sqrt((C.inside[L].Qt.x-t.x)*(C.inside[L].Qt.x-t.x)+(C.inside[L].Qt.y-t.y)*(C.inside[L].Qt.y-t.y))*1e7,U={x:t.x+U,y:t.y+P},P={x:null,y:null},ft.Ot(t,O,C.inside[F].Ht,C.inside[F].Qt,O={x:null,y:null}),ft.Ot(t,U,C.inside[F].Ht,C.inside[F].Qt,P),O.x)&&O.y&&P.x&&P.y&&(U=ft.distanceOfTwoPoints(O,C.inside[F].Ht),R=ft.distanceOfTwoPoints(P,C.inside[F].Ht),I.push({Kt:C.inside[F].Kt,Ht:U<R?O:P,Qt:U<R?P:O,dt:C.inside[F].dt,Jt:C.inside[F].Jt})));var D=ft.Xt(C.inside[F],I);C.inside[F].remain=D,d.push.apply(d,ir(D))}}if(r=[],o=null,!(C.right&&0<C.right.length))break;C.right.sort(function(t,e){return t.dt-e.dt});for(var Q=0;Q<C.right.length;Q++){var k={x:C.right[Q].Ht.x-t.x,y:C.right[Q].Ht.y-t.y},N={x:C.right[Q].Qt.x-t.x,y:C.right[Q].Qt.y-t.y},j={x:u.x-t.x,y:u.y-t.y};k=ft.Dt(j,k),j=ft.Dt(j,N);if((N=(k=k<180?k:k-360)<(j=j<180?j:j-360)?k:j)<l){o=C.right[Q],l=N;break}}if(!o)break;r.push.apply(r,ir(C.right)),r.push.apply(r,ir(C.other))}return p.push.apply(p,d),s.push.apply(s,p),s},Tu:function(t,e,n,i,r){if(1!=this.wr)for(var o={},s=0;s<n.Ve.length;s++){var a=n.Ve[s];if(null!=a&&a!=r&&oi.NaviModelPassType_DECORATE!=a.pass&&(null==r||r.pass==oi.NaviModelPassType_DECORATE||!ft.yt(r.lr,a.Se,a.Se.length-1)))for(var A=a.Se.length,l=0;l<A-1;l++){if(ft.Ot(t,e,a.Se[l],a.Se[l+1],o)&&!(ft.distanceOfTwoPoints(t,o)<.01))return!1}}for(var u={},h=n.Ye,c=0;c<h.length;c++){h[c];for(var f=h[c].Pe,p=0;p<f.length;p++)for(var d=f[p],y=0;y<d.length-1;y++)if(ft.Ot(t,e,d[y],d[y+1],u))return!1;for(var m=h[c].Se,g=0;g<m.length-1;g++)if(ft.Ot(t,e,m[g],m[g+1],u))return!1}for(var v=0;v<n.Ze.length;v++){var b=n.Ze[v];if(!(b.xn==i.xn||b.xn<0))if(ft.Ot(t,e,b.Ht,b.Qt,{})&&.01<ft.distanceOfTwoPoints(e,b.Ht)&&.01<ft.distanceOfTwoPoints(e,b.Qt))return!1}return!0},Ru:function(t,e){for(var n=this.xu(this.Ss),i=new Map,r=0;r<e.length;r++){var o=!0,s=new er,a=ft.Ut(e[r].Ht,e[r].Qt,t),A=(ft.Gt(t,a,e[r].Ht,e[r].Qt).isintersect||(a=ft.dt(t,e[r].Ht)<=ft.dt(t,e[r].Qt)?e[r].Ht:e[r].Qt),s.ut=Object.assign({},a),s.Jt=Object.assign({},n.Ze[n.So(e[r].xn)]),ft.dt(t,a));if(1!=this.wr)for(var l=0;l<n.Ve.length;l++){var u=n.Ve[l];if(null!=u&&u!=obstruct&&oi.NaviModelPassType_DECORATE!=u.pass&&(null==obstruct||obstruct.pass==oi.NaviModelPassType_DECORATE||!ft.yt(obstruct.lr,u.Se,u.Se.length-1)))for(var h=u.Se.length,c=0;c<h-1;c++){var f=ft.Gt(t,a,u.Se[c],u.Se[c+1]);f.isintersect&&(f=ft.dt(t,f.point))<A&&(A=f,s.ls=u,s.dt=Number.MAX_VALUE,s.vs=!1,s.ys=oi.NaviObstructType_MODEL,o=!1)}}for(var p,d=n.Ye,y=0;y<d.length;y++){for(var m=d[y],g=d[y].Pe,v=0;v<g.length;v++)for(var b=g[v],x=0;x<b.length-1;x++){var w=ft.Et(t,a,b[x],b[x+1]);w.isintersect&&(w=ft.dt(t,w.point))<A&&(A=w,s.ls=m,s.dt=Number.MAX_VALUE,s.vs=!1,s.ys=oi.NaviObstructType_EXTENT,o=!1)}for(var B=d[y].Se,M=0;M<B.length-1;M++){var S=ft.Et(t,a,B[M],B[M+1]);S.isintersect&&(S=ft.dt(t,S.point))<A&&(A=S,s.ls=m,s.dt=Number.MAX_VALUE,s.vs=!1,s.ys=oi.NaviObstructType_EXTENT,o=!1)}}o&&((p=i.get(s.Jt.xn))?p.push(s):((p=[]).push(s),i.set(s.Jt.xn,p)))}},eu:function(t,e){for(var n,i=0;i<this.Zs.length;i++)if(ft.yt(t,this.Zs[i].Se,this.Zs[i].Mu))return a.ROUTE_FAILED_NO_DEST_ARRIVAL;if(1===this.wr)return(n=this.Nu(t,e)).road?(n=this.ku(this.Ss,n.coords,n.road),void(this.Wo=n)):a.ROUTE_FAILED_NO_START_ARRIVAL;for(var r=this.Eu(t,e),o=new Map,s=0;s<r.length;s++){var A,l={x:null,y:null},u=r[s];if(ft.Rt(t,u.Ht,u.Qt,l)?l.dt=0:(ft.distanceOfTwoPoints(t,u.Ht)<ft.distanceOfTwoPoints(t,u.Qt)?(l.x=u.Ht.x,l.y=u.Ht.y):(l.x=u.Qt.x,l.y=u.Qt.y),h=ft.Rt(t,u.Jt.Ht,u.Jt.Qt,A={x:null,y:null}),l.dt=h?ft.dt(l,A):Number.MAX_VALUE),ft.distanceOfTwoPoints(l,u.Jt.Ht)<.001?(l.id=u.Jt.he,l.newNode=!1):ft.distanceOfTwoPoints(l,u.Jt.Qt)<.001?(l.id=u.Jt.ce,l.newNode=!1):l.newNode=!0,null!=this.bs&&this.bs.pass==oi.NaviModelPassType_PASS_THROUGH&&0==this.bs.De.length?this.Tu(t,l,e,u.Jt,this.bs):this.Tu(t,l,e,u.Jt)){var h={ut:l,Jt:u.Jt,dt:r[s].dt};if(o.has(u.Kt)){for(var c=o.get(u.Kt),f=!1,p=0;p<c.length;p++)if(ft.distanceOfTwoPoints(c[p].ut,l)<.01){f=!0;break}f||o.get(u.Kt).push(h)}else o.set(u.Kt,[h])}}var d,y=!0,m=(this.Wo=this.fu(this.Ss,t),null==this.bs&&(y=!1),new Map),g=new Map,v=nr(o);try{for(v.s();!(d=v.n()).done;){var b,x=d.value,w=!1,B=nr(x[1]);try{for(B.s();!(b=B.n()).done;){var M=b.value;if(M.ut.newNode&&M.ut.dt<.01){m.set(x[0],[M]),w=!0;break}}}catch(t){B.e(t)}finally{B.f()}w||g.set(x[0],x[1])}}catch(t){v.e(t)}finally{v.f()}if(null!=(o=0<m.size?m:g)&&0<o.size){y=!1;var S,_=nr(o);try{for(_.s();!(S=_.n()).done;)for(var E=S.value[1],T=0;T<E.length;T++)0!=E[T].Jt.pe&&(y=!0)}catch(t){_.e(t)}finally{_.f()}var C,F=nr(o);try{for(F.s();!(C=F.n()).done;){var O=C.value[1];if(O.sort(function(t,e){return t.ut.dt-e.ut.dt}),O[0].Jt,O[0].ut.dt==Number.MAX_VALUE){var P,U=nr(O);try{for(U.s();!(P=U.n()).done;){var R=P.value,I=this.ku(this.Ss,R.ut,R.Jt);this.Au(this.Ss,this.Wo,I,R.Jt.pe)}}catch(t){U.e(t)}finally{U.f()}}else{var L=this.ku(this.Ss,O[0].ut,O[0].Jt);this.Au(this.Ss,this.Wo,L,O[0].Jt.pe)}}}catch(t){F.e(t)}finally{F.f()}}if(y&&null!=this.bs&&this.bs.De&&0<this.bs.De.length)for(var D=null,Q=this.ws.get(this.Ss),k=0;k<this.bs.De.length;k++){D=this.bs.De[k];var N=this.bs.Fe[k];if(N==oi.NaviEntranceType_EXIT||N==oi.NaviEntranceType_ACCESS){for(var j=this.bs.Pe,H=!0,z=0;z<j.length;z++){for(var V=j[z],G=0;G<V.length-1;G++)if(ft.ht(t,D.pr,V[G],V[G+1])){H=!1;break}if(0==H)break}if(0!=H){for(var Y=0;Y<Q.Ze.length;Y++){var K=Q.Ze[Y];if(0!=K.pe&&ft.ht(t,D.pr,K.Ht,K.Qt)&&0<K.xn&&0==D.gu.includes(K.xn)){H=!1;break}}0!=H&&this.Au(this.Ss,this.Wo,D)}}}},ou:function(t,e){for(var n,i=0;i<this.Zs.length;i++)if(ft.yt(t,this.Zs[i].Se,this.Zs[i].Mu))return a.ROUTE_FAILED_NO_DEST_ARRIVAL;if(1===this.wr)return(n=this.Nu(t,e)).road?(n=this.ku(this.Os,n.coords,n.road),t.Ks&&(n.Ks=t.Ks),void(this.Zo=n)):a.ROUTE_FAILED_NO_DEST_ARRIVAL;for(var r=this.Eu(t,e),o=new Map,s=0;s<r.length;s++){var A,l={x:null,y:null},u=r[s];if(ft.Rt(t,u.Ht,u.Qt,l)?l.dt=0:(ft.distanceOfTwoPoints(t,u.Ht)<ft.distanceOfTwoPoints(t,u.Qt)?(l.x=u.Ht.x,l.y=u.Ht.y):(l.x=u.Qt.x,l.y=u.Qt.y),h=ft.Rt(t,u.Jt.Ht,u.Jt.Qt,A={x:null,y:null}),l.dt=h?ft.dt(l,A):Number.MAX_VALUE),ft.distanceOfTwoPoints(l,u.Jt.Ht)<.001?(l.id=u.Jt.he,l.newNode=!1):ft.distanceOfTwoPoints(l,u.Jt.Qt)<.001?(l.id=u.Jt.ce,l.newNode=!1):l.newNode=!0,null!=this.ds&&this.ds.pass==oi.NaviModelPassType_PASS_THROUGH&&0==this.ds.De.length?this.Tu(t,l,e,u.Jt,this.ds):this.Tu(t,l,e,u.Jt)){var h={ut:l,Jt:u.Jt};if(o.has(u.Kt)){for(var c=o.get(u.Kt),f=!1,p=0;p<c.length;p++)if(ft.distanceOfTwoPoints(c[p].ut,l)<.01){f=!0;break}f||o.get(u.Kt).push(h)}else o.set(u.Kt,[h])}}var d,y=!0,m=(this.Zo=this.fu(this.Os,t),t.Ks&&(this.Zo.Ks=t.Ks),null==this.ds&&(y=!1),new Map),g=new Map,v=nr(o);try{for(v.s();!(d=v.n()).done;){var b,x=d.value,w=!1,B=nr(x[1]);try{for(B.s();!(b=B.n()).done;){var M=b.value;if(M.ut.newNode&&M.ut.dt<.01){m.set(x[0],[M]),w=!0;break}}}catch(t){B.e(t)}finally{B.f()}w||g.set(x[0],x[1])}}catch(t){v.e(t)}finally{v.f()}if(null!=(o=0<m.size?m:g)&&0<o.size){y=!1;var S,_=nr(o);try{for(_.s();!(S=_.n()).done;)for(var E=S.value[1],T=0;T<E.length;T++)0!=E[T].Jt.pe&&(y=!0)}catch(t){_.e(t)}finally{_.f()}var C,F=nr(o);try{for(F.s();!(C=F.n()).done;){var O=C.value[1];if(O.sort(function(t,e){return t.ut.dt-e.ut.dt}),O[0].Jt,O[0].ut.dt==Number.MAX_VALUE){var P,U=nr(O);try{for(U.s();!(P=U.n()).done;){var R=P.value,I=this.ku(this.Os,R.ut,R.Jt);this.Au(this.Os,this.Zo,I,R.Jt.pe)}}catch(t){U.e(t)}finally{U.f()}}else{var L=this.ku(this.Os,O[0].ut,O[0].Jt);this.Au(this.Os,this.Zo,L,O[0].Jt.pe)}}}catch(t){F.e(t)}finally{F.f()}}if(y&&null!=this.ds&&this.ds.De&&0<this.ds.De.length)for(var D=null,Q=this.ws.get(this.Os),k=0;k<this.ds.De.length;k++){D=this.ds.De[k];var N=this.ds.Fe[k];if(N==oi.NaviEntranceType_ENTRANCE||N==oi.NaviEntranceType_ACCESS){for(var j=this.ds.Pe,H=!0,z=0;z<j.length;z++){for(var V=j[z],G=0;G<V.length-1;G++)if(ft.ht(t,D.pr,V[G],V[G+1])){H=!1;break}if(0==H)break}if(0!=H){for(var Y=0;Y<Q.Ze.length;Y++){var K=Q.Ze[Y];if(0!=K.pe&&ft.ht(t,D.pr,K.Ht,K.Qt)&&0<K.xn&&0==D.gu.includes(K.xn)){H=!1;break}}0!=H&&this.Au(this.Os,this.Zo,D)}}}},Js:function(t,e,n){var i,r,o=this,s=t instanceof Array&&2==t.length&&(t={x:t[0],y:t[1]}),a=!0,A=this.ru(t),l=this.Go.Ro(t),u=this.Go.Mo(t);s=null!=l&&l.pass==oi.NaviModelPassType_PASS_THROUGH&&0==l.De.length?this.Iu(u,t,30,l):this.Iu(u,t);if(1===this.wr)return(h=this.ju(s))?(i=h.Jt,r=null,(r=0==(i=this.Pu(u,t,i,[h],l)).length?this.ku(u,h.ut,h.Jt):this.ku(u,i[0].ut,i[0].Jt)).Ks=void 0!==n&&n,n&&(Object.assign(t,r.pr),r.pr=t),Object.assign(e,r),!0):void 0;var h=this.fu(u,t);if(h.Ks=void 0!==n&&n,Object.assign(e,h),null==l&&(a=!1),0<s.size){a=!1;var c,f=nr(s);try{for(f.s();!(c=f.n()).done;)for(var p=c.value[1],d=0;d<p.length;d++)0!=p[d].Jt.pe&&(a=!0)}catch(t){f.e(t)}finally{f.f()}var y,m=!1,g=[],v=nr(s);try{for(v.s();!(y=v.n()).done;){var b,x=y.value[1],w=x[0].Jt,B=this.Pu(u,t,w,x,l);if(0==B.length){var M,S=nr(x);try{for(S.s();!(M=S.n()).done;){var _=M.value,E=this.ku(u,_.ut,_.Jt);this.Au(u,e,E)}}catch(t){S.e(t)}finally{S.f()}}else Math.abs(B[0].Du)>ft.rt()?g.push.apply(g,ir(B)):(m=!0,b=this.ku(u,B[0].ut,B[0].Jt),this.Au(u,e,b))}}catch(t){v.e(t)}finally{v.f()}m||g.forEach(function(t){t=o.ku(u,t.ut,t.Jt),o.Au(u,e,t)})}if(l&&l.pass!=oi.NaviModelPassType_NOT_PASS){if(l.pass===oi.NaviModelPassType_PASS_THROUGH||l.pass===oi.NaviModelPassType_PASS_NOT_THROUGH){for(var T={},C=[],F=[],O=this.Go.Ze,P=!0,U=0;U<l.Oe;U++)for(var R=l.Se[U],I=l.Se[U+1],L=0;L<O.length;L++){var D=O[L];1===ft.Ot(R,I,D.Ht,D.Qt,T)&&oi.NaviRoadEntry_FORBID!==D.pe&&(P=!1,(D={}).x=T.x,D.y=T.y,C.push(D),F.push(O[L]))}if(!P){l.De=[],l.Fe=[],l.Le=[];for(var Q=0;Q<C.length;Q++){var k=F[Q],N=this._u(A,C[Q],k);N.gu.push(k.xn),N.ne=oi.NaviNodeType_COMMON,k.pe===oi.NaviRoadEntry_BOTH?N.entranceType=oi.NaviEntranceType_ACCESS:ft.yt(k.Ht,l.Se,l.Oe)?(k.pe===oi.NaviRoadEntry_FORWARD&&(N.entranceType=oi.NaviEntranceType_EXIT),k.pe===oi.NaviRoadEntry_BACK&&(N.entranceType=oi.NaviEntranceType_ENTRANCE)):(k.pe===oi.NaviRoadEntry_FORWARD&&(N.entranceType=oi.NaviEntranceType_ENTRANCE),k.pe===oi.NaviRoadEntry_BACK&&(N.entranceType=oi.NaviEntranceType_EXIT)),l.De.push(N),l.Fe.push(N.entranceType),l.Le.push(N.ne)}}}if(a&&null!=l&&l.De&&0<l.De.length){for(var j=!1,H=0;H<l.De.length;H++){var z=l.De[H],V=l.Fe[H];V!=oi.NaviEntranceType_EXIT&&V!=oi.NaviEntranceType_ACCESS||(this.Au(u,e,z),j=!0)}if(!j)return!1}return!0}},su:function(){if((t=((t=this.Lu(this.Wo.pr))&&(this.cu(this.Ss,t,oi.NaviRoadHinderType_HINDER_GENERAL),this.Ns.push({lu:this.Ss,ls:t})),this.Lu(this.Zo.pr)))&&(this.cu(this.Os,t,oi.NaviRoadHinderType_HINDER_GENERAL),this.Ns.push({lu:this.Os,ls:t})),this.js=[],this.Ss===this.Os){if((n=(t=this.Fu(this.Ss)).Jo(this.Wo,this.Zo,this.zo))!==a.ROUTE_SUCCESS)return n;n=t.ns(),this.js=[],n.reverse(),(t=this.js).push.apply(t,ir(n))}else{if(-1!==this.Ss&&-1===this.Os){var t=this.Cu(this.Wo.pr,this.Ss,oi.NaviEntranceType_EXIT);if((i=(n=this._s.get(this.Ss)).Jo(this.Wo,t,this.zo))!=a.ROUTE_SUCCESS)return i;var e=n.ns(e);if((i=(n=this._contain_zoneIdDijkstras.get(-1)).Jo(t,this.Zo,this.zo))!=a.ROUTE_SUCCESS)return i;t=n.ns(),e.reverse(),t.reverse(),(i=this.js).push.apply(i,ir(e)),(n=this.js).push.apply(n,ir(t))}if(-1===this.Ss&&-1!==this.Os){var n,i=this.Cu(this.Zo.pr,this.Os,oi.NaviEntranceType_ENTRANCE);if((n=(e=this._s.get(this.Os)).Jo(i,this.Zo,this.zo))!=a.ROUTE_SUCCESS)return n;if(t=e.ns(),(n=(e=this._s.get(-1)).Jo(this.Wo,i,this.zo))!=a.ROUTE_SUCCESS)return n;(i=e.ns()).reverse(),t.reverse(),(n=this.js).push.apply(n,ir(i)),(e=this.js).push.apply(e,ir(t))}if(-1!==this.Ss&&-1!==this.Os){if(n=this.Cu(this.Wo.pr,this.Ss,oi.NaviEntranceType_EXIT),(e=(i=this._s.get(this.Ss)).Jo(this.Wo,n,this.zo))!=a.ROUTE_SUCCESS)return e;var r=i.ns(r);t=this.Cu(this.Zo.pr,this.Os,oi.NaviEntranceType_ENTRANCE);if((e=(i=this._s(this.Os)).Jo(t,this.Zo,this.zo))!=a.ROUTE_SUCCESS)return e;var o=i.ns(o);if((e=(i=this._s(-1)).Jo(n,t,this.zo))!=a.ROUTE_SUCCESS)return e;n=i.ns(),r.reverse(),n.reverse(),o.reverse(),(t=this.js).push.apply(t,ir(r)),(e=this.js).push.apply(e,ir(n)),(i=this.js).push.apply(i,ir(o))}}return a.ROUTE_SUCCESS},Bu:function(t,e,n){for(var i=0;i<e;i++)if(null!=t[i]&&t[i].xn==n)return i;return-1},ru:function(t){for(var e=this.Go.Xe,n=0;n<e.length;n++){var i=e[n];if(i.Ae(t))return i.xn}return-1},Vs:function(){for(var t=this.Go.Xe,e=0;e<t.length;e++){var n=t[e],i=this.Uu(this.Go,n);this.ws.set(n.xn,i)}this.ws.set(-1,this.Go);var r,o=nr(this.ws);try{for(o.s();!(r=o.n()).done;){var s=r.value;s[1].no(),this._s.set(s[0],new Xi(s[1]))}}catch(t){o.e(t)}finally{o.f()}},Uu:function(t,e){if(t&&e){for(var n,i=0,r=0,o=t.Ze.length,s=t.We.length,a=t.Ze,A=t.We,l=0,u=new Int8Array(o),h=0;h<o;h++)a[h]&&a[h].pe!=oi.NaviRoadEntry_FORBID&&(n=a[h],i=e.contain(n.Ht),r=e.contain(n.Qt),0==i&&0==r||(l=!0),1==i&&1==r&&(u[h]=1),1==i&&0==r&&(u[h]=2),0==i&&1==r&&(u[h]=3),0==i&&0==r&&(u[h]=4),2==i&&0==r&&(u[h]=6),2==i&&1==r&&(u[h]=7),0==i&&2==r&&(u[h]=8),1==i)&&2==r&&(u[h]=9);if(0==l)return null;for(var c,f,p,d,y,m,g=new Array(s),v=new Array(o),b=0,x=new Int8Array(s),w=0,B=T=u.length;w<B;w++)0!=u[w]&&6!=u[w]&&8!=u[w]&&1!=u[w]&&a[w]&&(m=(c=a[w]).pe,y=[c.xn],2==u[w]||9==u[w]?(f=null,f=2==u[w]?e.Ot(c.Ht,c.Qt):Object.assign({},c.Qt),(p=new vi).xn=this.yo(),p.ne=oi.NaviNodeType_COMMON,p.ie=oi.NaviLiftType_NULL,p.entranceType=oi.NaviEntranceType_ACCESS,p.pr=Object.assign({},f),(f=new _i).setRoad(c),f.xn=this.bo(),y.push(f.xn),p.segLinks=y,(d=new vi).setNode(p),m==oi.NaviRoadEntry_FORWARD?d.entranceType=oi.NaviEntranceType_EXIT:m==oi.NaviRoadEntry_BACK&&(d.entranceType=oi.NaviEntranceType_ENTRANCE),e.Ne.push(d),b=this.Bu(A,s,f.ce),f.Qt=Object.assign({},d.pr),f.le[1]=Object.assign({},d.pr),f.ce=d.xn,f._e(),v[w]=f,g[b]=d,g[b=this.Bu(A,s,f.he)]=A[b],g[b].segLinks.splice(g[b].segLinks.indexOf(c.xn),1,f.xn),(d=new vi).setNode(p),c.he=d.xn,c.Ht=Object.assign({},d.pr),c.le[0]=Object.assign({},d.pr),c._e(),A[b].segLinks.splice(A[b].segLinks.indexOf(c.xn),1),A.push(d),x[b]=2):3!=u[w]&&7!=u[w]||(f=null,f=3==u[w]?e.Ot(c.Ht,c.Qt):Object.assign({},c.Ht),(p=new vi).xn=this.yo(),p.ne=oi.NaviNodeType_COMMON,p.ie=oi.NaviLiftType_NULL,p.entranceType=oi.NaviEntranceType_ACCESS,p.pr=Object.assign({},f),(d=new _i).setRoad(c),d.xn=this.bo(),y.push(d.xn),p.segLinks=y,(y=new vi).setNode(p),m==oi.NaviRoadEntry_FORWARD?y.entranceType=oi.NaviEntranceType_ENTRANCE:m==oi.NaviRoadEntry_BACK&&(y.entranceType=oi.NaviEntranceType_EXIT),e.Ne.push(y),b=this.Bu(A,s,d.he),d.Ht=Object.assign({},y.pr),d.le[0]=Object.assign({},y.pr),d.he=y.xn,d._e(),v[w]=d,g[b]=y,g[b=this.Bu(A,s,d.ce)]=A[b],g[b].segLinks.splice(g[b].segLinks.indexOf(c.xn),1,d.xn),(m=new vi).setNode(p),c.ce=m.xn,c.Qt=Object.assign({},m.pr),c.le[1]=Object.assign({},m.pr),c._e(),A[b].segLinks.splice(A[b].segLinks.indexOf(c.xn),1),A.push(m),x[b]=2));for(var M,S=0,_=T;S<_;S++)1==u[S]&&(M=a[S])&&(v[S]=M,2!=x[b=this.Bu(A,s,M.he)]&&(g[b]=A[b],x[b]=1),2!=x[b=this.Bu(A,s,M.ce)]&&(g[b]=A[b],x[b]=1),a[S]=null);for(var E=0;E<s;E++)1==x[E]&&(A[E]=null);for(var T=new Ni(g,v,!0,1),C=[],F=t.Ve,O=0;O<F.length;O++){var P=F[O];P&&this.Gu(P,e)&&C.push(P)}return(t=T.Ve).push.apply(t,C),T}},Ys:function(){var t,e=nr(this.ws);try{for(e.s();!(t=e.n()).done;)for(var n=t.value,i=n[0],r=n[1].Ve,o=0;o<r.length;o++){var s,a=r[o];oi.NaviModelPassType_PASS_NOT_THROUGH==a.pass&&((s=this.Ts.get(i))||(s=[],this.Ts.set(i,s)),s.push(a))}}catch(t){e.e(t)}finally{e.f()}},zs:function(){var t,e=nr(this.ws);try{for(e.s();!(t=e.n()).done;)for(var n=t.value,i=n[0],r=n[1].Ve,o=0;o<r.length;o++){var s,a=r[o];oi.NaviModelPassType_NOT_PASS==a.pass&&((s=this.Rs.get(i))||(s=[],this.Rs.set(i,s)),s.push(a))}}catch(t){e.e(t)}finally{e.f()}},Xs:function(){var t,e=nr(this.Ts);try{for(e.s();!(t=e.n()).done;)for(var n=t.value,i=n[0],r=n[1],o=this.xu(i).Ze,s=0;s<r.length;s++){for(var a=r[s],A=0;A<o.length;A++){var l,u=o[A].je();ft.yt(u,a.Se,a.Oe)&&(o[A].Vi=o[A].Vi*this.Ps,(l=this.Ms.get(a.xn))||(l=[],this.Ms.set(a.xn,l)),l.push(o[A]))}this.cu(i,a,oi.NaviRoadHinderType_HINDER_HIGH)}}catch(t){e.e(t)}finally{e.f()}},qs:function(){var t,e=nr(this.Rs);try{for(e.s();!(t=e.n()).done;)for(var n=t.value,i=n[0],r=n[1],o=this.xu(i).Ze,s=0;s<r.length;s++)for(var a=r[s],A=0;A<o.length;A++){var l=o[A],u=l.pe,h=l.je();if(ft.yt(h,a.Se,a.Oe)){if(l.Vi=Number.MAX_VALUE,u==oi.NaviRoadEntry_BOTH||u==oi.NaviRoadEntry_FORWARD){var c=this.xu(i).He.get(l.he);if(c)for(var f=0;f<c.length;f++)c[f]._o==l.ce&&(c[f].Vi=l.Vi)}if(l.pe==oi.NaviRoadEntry_BOTH||l.pe==oi.NaviRoadEntry_BACK){var p=this.xu(i).He.get(l.ce);if(p)for(var d=0;d<p.length;d++)p[d]._o==l.he&&(p[d].Vi=l.Vi)}}}}catch(t){e.e(t)}finally{e.f()}},cu:function(t,e,n){var i=this.Ms.get(e.xn);if(i){if(oi.NaviRoadHinderType_HINDER_HIGH==n)for(var r=0;r<i.length;r++){var o=i[r];if(o._e(),o.Vi=i.length*this.Ps,o.pe==oi.NaviRoadEntry_BOTH||o.pe==oi.NaviRoadEntry_FORWARD){var s=this.xu(t).He.get(o.he);if(s)for(var a=0;a<s.length;a++)s[a]._o==o.ce&&(s[a].Vi=o.Vi)}if(o.pe==oi.NaviRoadEntry_BOTH||o.pe==oi.NaviRoadEntry_BACK){var A=this.xu(t).He.get(o.ce);if(A)for(var l=0;l<A.length;l++)A[l]._o==o.he&&(A[l].Vi=o.Vi)}}if(oi.NaviRoadHinderType_HINDER_GENERAL==n)for(var u=0;u<i.length;u++){var h=i[u];if(h._e(),h.pe==oi.NaviRoadEntry_BOTH||h.pe==oi.NaviRoadEntry_FORWARD){var c=this.xu(t).He.get(h.he);if(c)for(var f=0;f<c.length;f++)c[f]._o==h.ce&&(c[f].Vi=h.Vi)}if(h.pe==oi.NaviRoadEntry_BOTH||h.pe==oi.NaviRoadEntry_BACK){var p=this.xu(t).He.get(h.ce);if(p)for(var d=0;d<p.length;d++)p[d]._o==h.he&&(p[d].Vi=h.Vi)}}}},Cu:function(t,e,n){var i=this.Go.so(e);if(null==i)return null;for(var r=this.xu(e).vo(t,void 0),o=(r.area,Number.MAX_VALUE),s=null,a=0;a<i.Ne.length;a++){var A,l=i.Ne[a],u=ft.dt(l.pr,t);l.entranceType!=oi.NaviEntranceType_ACCESS&&l.entranceType!=n||u<o&&((A=this.Wu(e,l.pr))==r||A.pass!=oi.NaviModelPassType_PASS_NOT_THROUGH)&&(o=u,s=l)}return s},Wu:function(t,e){for(var n=null,i=(t=this.xu(t),Number.MAX_VALUE),r=Number.MAX_VALUE,o=null,s=t.Ve,a=0;a<s.length;a++){var A,l=s[a];(A=ft._pointToPolygon2d(l.Se,e,l.Se.length-1))<r&&(r=A,o=l),this.Fs>A&&(A=l.area)<i&&(i=A,n=l)}return null==n?o:n},Gu:function(t,e){return!t.bb.isSeparate(e.bb)&&(t=t.lr,!!ft.yt(t,e.Se,e.Oe))},ku:function(t,e,n){for(var i=this.Cs.find(function(t){return t==n.he}),r=this.Cs.find(function(t){return t==n.ce}),o=(null==i&&this.Cs.push(n.he),null==r&&this.Cs.push(n.ce),this.Is),s=null,a=0;a<o.length;a++)if(o[a].Zu==n){s=o[a];break}if(null==s)(s={}).Zu=n,o.push(s);else for(;null!=s.Vu;){var A=s.Vu.Zu;s=ft.lt(e,A.Ht,A.Qt)?s.Vu:s.Yu}n=s.Zu;var l,u,h;i=new vi;return e.id?i.xn=e.id:i.xn=this.mu(),i.pr.x=e.x,i.pr.y=e.y,i.zu=!1!==e.newNode,!i.zu&&1!==this.wr||((r=new _i).xn=this.mu(),r.he=n.he,r.Ht=n.Ht,r.ce=i.xn,r.Qt=i.pr,r.le=[n.Ht,i.pr],r.de=n.de,(l=new _i).xn=this.mu(),l.he=i.xn,l.Ht=i.pr,l.ce=n.ce,l.Qt=n.Qt,l.le=[i.pr,n.Qt],l.de=n.de,this.ks.push(r),this.ks.push(l),(h={}).Zu=r,(u={}).Zu=l,s.Vu=h,s.Yu=u,i.tempType=1,r.tempType=1,l.tempType=1,r._e(),l._e(),r.pe=n.pe,l.pe=n.pe,(h=this.xu(t)).We.push(i),h.Ze.push(r),h.Ze.push(l),(u=this.Fu(t).Go).Ke.set(i.xn,h.We.length-1),n.pe==oi.NaviRoadEntry_BOTH&&((t=[]).push({_o:n.he,Vi:r.Vi}),t.push({_o:n.ce,Vi:l.Vi}),u.He.set(i.xn,t),(t=u.He.get(n.he))||u.He.set(n.he,t=[]),t.push({_o:i.xn,Vi:r.Vi}),(t=u.He.get(n.ce))||u.He.set(n.ce,t=[]),t.push({_o:i.xn,Vi:l.Vi})),n.pe==oi.NaviRoadEntry_FORWARD&&((h=[]).push({_o:n.ce,Vi:l.Vi}),u.He.set(i.xn,h),(h=u.He.get(n.he))||u.He.set(n.he,h=[]),h.push({_o:i.xn,Vi:r.Vi})),n.pe!=oi.NaviRoadEntry_BACK)||((t=[]).push({_o:n.he,Vi:r.Vi}),u.He.set(i.xn,t),(t=u.He.get(n.ce))||u.He.set(n.ce,t=[]),t.push({_o:i.xn,Vi:l.Vi})),i},Xu:function(t,e){for(var n=e.length-1;0<=n;n--)if(e[n].xn&&0<e[n].xn)return e.splice(n+1,0,t),n+1;return-1},_u:function(t,e,n,i){var r,o,s;return i?this.ku(t,e,n):(i=this.xu(t),(t=new vi).xn=this.yo(),t.pr=e,(e=new _i).xn=this.bo(),e.he=n.he,e.Ht=n.Ht,e.ce=t.xn,e.Qt=t.pr,e.de=n.de,e.le=[n.Ht,t.pr],(r=new _i).xn=this.bo(),r.he=t.xn,r.Ht=t.pr,r.ce=n.ce,r.Qt=n.Qt,r.de=n.de,r.le=[t.pr,n.Qt],(o=[]).push(e.xn),o.push(r.xn),t.segLinks=o,e._e(),r._e(),e.pe=n.pe,r.pe=n.pe,o=i.We,s=i.Ze,o=this.Xu(t,o),this.Xu(e,s),this.Xu(r,s),i.Ke.set(t.xn,o),n.pe==oi.NaviRoadEntry_BOTH&&((s=[]).push({_o:n.he,Vi:e.Vi}),s.push({_o:n.ce,Vi:r.Vi}),i.He.set(t.xn,s),(s=i.He.get(n.he))||i.He.set(n.he,s=[]),s.push({_o:t.xn,Vi:e.Vi}),(s=i.He.get(n.ce))||i.He.set(n.ce,s=[]),s.push({_o:t.xn,Vi:r.Vi})),n.pe==oi.NaviRoadEntry_FORWARD&&((o=[]).push({_o:n.ce,Vi:r.Vi}),i.He.set(t.xn,o),(o=i.He.get(n.he))||i.He.set(n.he,o=[]),o.push({_o:t.xn,Vi:e.Vi})),n.pe==oi.NaviRoadEntry_BACK&&((s=[]).push({_o:n.he,Vi:e.Vi}),i.He.set(t.xn,s),(s=i.He.get(n.ce))||i.He.set(n.ce,s=[]),s.push({_o:t.xn,Vi:r.Vi})),t.gu=[],t.gu.push(e.xn),t.gu.push(r.xn),t)},qu:function(t){if(null!=t){for(var e=this.xu(t),n=e.We.length-1;0<=n;n--){var i=e.We[n];if(null==i||0<=i.xn)break;e.We.splice(n,1)}for(var r=e.Ze.length-1;0<=r;r--){var o=e.Ze[r];if(null==o||0<=o.xn)break;e.Ze.splice(r,1)}}},Hu:function(t,e){var n=t.get(e);if(n)for(var i=0;i<n.length;i++)n[i]._o<0&&(n.splice(i,1),i--)},Qu:function(t,e){for(var n=t.get(e),i=0;i<n.length;i++)this.Hu(t,n[i]._o);t.delete(e)},Ku:function(t,e,n,i,r){i.Ju=Number.MAX_VALUE,i.vs=!1,i.Du=n;for(var o=Number.MAX_VALUE,s={},a=this.xu(t),A=Number.MAX_VALUE,l=0;l<a.Ze.length;l++){var u,h=a.Ze[l];null==h||h.xn<0||(h.pe==oi.NaviRoadEntry_FORBID?ft.Et(e,n,h.Ht,h.Qt,s)&&(u=ft.dt(e,s))<=A&&(A=u):ft.Et(e,n,h.Ht,h.Qt,s)&&(u=ft.dt(e,s))<o&&(o=u,i.ut=Object.assign({},s),i.dt=o,i.Jt=h,i.vs=!0))}if(i.dt>=A)return i.dt=Number.MAX_VALUE,i.vs=!1;if(!i.vs)return!1;if(1!=this.wr)for(var c={},f=0;f<a.Ve.length;f++){var p=a.Ve[f];if(null!=p&&p!=r&&oi.NaviModelPassType_DECORATE!=p.pass&&(null==r||r.pass==oi.NaviModelPassType_DECORATE||!ft.yt(r.lr,p.Se,p.Se.length-1)))for(var d=p.Se.length,y=0;y<d-1;y++)if(ft.Et(e,n,p.Se[y],p.Se[y+1],c)){var m=ft.dt(e,c);if(m<o)return o=m,i.ls=p,i.dt=Number.MAX_VALUE,i.vs=!1,i.ys=oi.NaviObstructType_MODEL,!1}}for(var g={},v=a.Ye,b=0;b<v.length;b++){for(var x=v[b],w=v[b].Pe,B=0;B<w.length;B++)for(var M=w[B],S=0;S<M.length-1;S++)if(ft.Et(e,n,M[S],M[S+1],g)){var _=ft.dt(e,g);if(_<o)return o=_,i.ls=x,i.dt=Number.MAX_VALUE,i.vs=!1,i.ys=oi.NaviObstructType_EXTENT,!1}for(var E=v[b].Se,T=0;T<E.length-1;T++)if(ft.Et(e,n,E[T],E[T+1],g)){var C=ft.dt(e,g);if(C<o)return o=C,i.ls=x,i.dt=Number.MAX_VALUE,i.vs=!1,i.ys=oi.NaviObstructType_EXTENT,!1}}return!0},$u:function(t,e){return t.dt-e.dt},tf:function(t,e){return e.Du-t.Du},au:function(t){if(t=this.xu(t)){for(var e=t.We,n=t.Ke,i=e.length-1;0<=i;i--){var r=e[i];if(null==r||0<=r.xn)break;n.delete(r.xn),e.splice(i,1)}for(var o=t.Ze,s=t.Je,a=o.length-1;0<=a;a--){var A=o[a];if(null==A||0<=A.xn)break;s.delete(A.xn),o.splice(a,1)}}},hu:function(){this.rf(this.gs),this.rf(this._s)},rf:function(t){var e,n=nr(t);try{for(n.s();!(e=n.n()).done;){var i,r=e.value[1],o=[],s=r.Go.He,a=nr(s);try{for(a.s();!(i=a.n()).done;){var A=i.value;A[0]<0&&o.push(A[0])}}catch(t){a.e(t)}finally{a.f()}for(var l=0;l<o.length;l++)this.Qu(r.Go.He,o[l]);for(var u=0;u<this.Cs.length;u++)this.Hu(s,this.Cs[u])}}catch(t){n.e(t)}finally{n.f()}},Pu:function(t,e,n,i,r){var o=[],s={x:0,y:0};if(ft.Rt(e,n.Ht,n.Qt,s)&&this.nf(e,s,{},r))(r={}).ut=s,r.vs=!0,r.Jt=n,r.Du=0,r.dt=ft.dt(e,s),o.push(r);else{for(var a={x:s.x-e.x,y:s.y-e.y},A=0;A<i.length;A++){var l=i[A],u={x:l.ut.x-e.x,y:l.ut.y-e.y};u=ft.Dt(u,a);l.Du=270<u?u-360:u}i.sort(this.tf);var h,c=null;if(i[i.length-1].Du<0)c=i[i.length-1],o.push(c);else for(var f=0;f<i.length;f++)if(0<i[f].Du)return c=i[f],0==f?o.push(c):(h=i[f-1],ft.dt(c.ut,n.Ht)>ft.dt(h.ut,n.Ht)?(o.push(h),o.push(c)):(o.push(c),o.push(h))),o}return o},if:function(t,e,n,i,r){for(var o=i||30,s=0;s<360;s+=o){var a=new er;this.Ku(t,e,s,a,r),1==a.vs&&n.push(a)}n.sort(this.$u)},Iu:function(t,e,n,i){var r=new Map,o=[];for(this.if(t,e,o,n,i);0!=o.length;){var s=o[0],a=r.get(s.Jt.xn);a?a.push(s):((a=[]).push(s),r.set(s.Jt.xn,a)),o.splice(0,1)}return r},fu:function(t,e){var n=new vi;return(e=(n.xn=this.mu(),n.pr=Object.assign({},e),this.xu(t))).We.push(n),e.Ke.set(n.xn,e.We.length-1),this.Fu(t).Go=e,n},ef:function(t,e,n){return n?this.fu(t,e):((n=new vi).xn=this.yo(),n.pr=Object.assign({},e),t=(e=this.xu(t)).We,t=this.Xu(n,t),e.Ke.set(n.xn,t),n)},nf:function(t,e,n,i){for(var r,o=this.xu(-1),s=0;s<o.Ve.length;s++)if(null!=(r=o.Ve[s])&&r!=i&&oi.NaviModelPassType_DECORATE!=r.pass)for(var a=r.Se,A=0;A<a.length-1;A++)if(ft.Ot(t,e,a[A],a[A+1],n)){var l=ft.dt(t,n),u=ft.dt(e,n);if(!(l<=ft.rt()||u<=ft.rt()))return!1}for(var h=o.Ye,c=0;c<h.length;c++){for(var f=h[c],p=f.Pe,d=0;d<p.length;d++)for(var y=p[d],m=0;m<y.length-1;m++)if(ft.Ot(t,e,y[m],y[m+1],n))return!1;for(var g=f.Se,v=0;v<g.length-1;v++)if(ft.Ot(t,e,g[v],g[v+1],n))return!1}return!0},Au:function(t,e,n,i,r,o){for(var s=0;s<this.As.length;s++){var a=this.As[s],A={};if(1==ft.Ot(a.Ht,a.Qt,e.pr,n.pr,A)&&.001<ft.dt(e.pr,A)&&.001<ft.dt(n.pr,A))return null}void 0===i&&(i=oi.NaviRoadEntry_BOTH),void 0===r&&(r=!0),void 0===o&&(o=!0);var l=new _i;return l.he=e.xn,l.Ht=e.pr,l.ce=n.xn,l.Qt=n.pr,l.le=[e.pr,n.pr],l.de=1,this.Cs.push(e.xn),this.Cs.push(n.xn),l.xn=r?this.mu():this.bo(),l.pe=i,l._e(),o&&this.As.push(l),this.xu(t).Ze.push(l),r=this.Fu(t),oi.NaviRoadEntry_BOTH==i&&(o={_o:n.xn,Vi:l.Vi},(t=r.Go.He.get(e.xn))?t.push(o):((t=[]).push(o),r.Go.He.set(e.xn,t)),o={_o:e.xn,Vi:l.Vi},(t=r.Go.He.get(n.xn))?t.push(o):((t=[]).push(o),r.Go.He.set(n.xn,t))),oi.NaviRoadEntry_FORWARD==i&&(o={_o:n.xn,Vi:l.Vi},(t=r.Go.He.get(e.xn))?t.push(o):((t=[]).push(o),r.Go.He.set(e.xn,t))),oi.NaviRoadEntry_BACK==i&&(o={_o:e.xn,Vi:l.Vi},(t=r.Go.He.get(n.xn))?t.push(o):((t=[]).push(o),r.Go.He.set(n.xn,t))),l},Lu:function(t){var e=this.ru(t),n=this.Ts.get(e);if(n)for(var i=0;i<n.length;i++){var r=n[i];if(ft.yt(t,r.Se,r.Oe))return r}return null},xu:function(t){var e=null;return(e=this.Ws?this.xs.get(t):e)||this.ws.get(t)},Fu:function(t){var e=null;return(e=this.Ws?this.gs.get(t):e)||this._s.get(t)},sf:function(){return this.Ws?this.gs:this._s},yo:function(){return this.Go.yo()},bo:function(){return this.Go.bo()},bu:function(t){var e,n=((e=[]).push.apply(e,ir(t.We)),[]);return(n=(e=(n.push.apply(n,ir(t.Ze)),new Ni(e,n,!0,1))).Ve).push.apply(n,ir(t.Ve)),e},yu:function(t){for(var e=[-1],n=this.Go.Xe,i=0;i<n.length;i++){var r=n[i];t.uf(r.sr.tr,r.sr.rr)&&e.push(r.xn)}return e},Nu:function(t,e,n){var i=null,r=e.Ze;if(!r||r.length<=0)return null;var o=e.io(t);if(o<=0)return null;var s,a,A={},l=(i={distance:Number.MAX_VALUE,road:null,coords:{level:t.level}},nr(r));try{for(l.s();!(a=l.n()).done;){var u=a.value;u.pe===oi.NaviRoadEntry_FORBID||o!==u.ve||n&&n.indexOf(u.de)<0||(s=ft._t(t,u.Ht,u.Qt,A))<i.distance&&(i.distance=s,i.road=u,Object.assign(i.coords,A))}}catch(t){l.e(t)}finally{l.f()}return i}}),ci);function lr(t){return(lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ur(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=function(t,e){var n;if(t)return"string"==typeof t?hr(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hr(t,e):void 0}(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function hr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function cr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===lr(t=function(t,e){if("object"!==lr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==lr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&cr(t.prototype,e),n&&cr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.ff=[],this.af=new Map,this.wr=n||null,this.hf(e)});var fr=(Object.assign(ci.prototype,{hf:function(t){var e,n=ur(t);try{for(n.s();!(e=n.n()).done;)for(var i=e.value,r=i[1],o=r.Ye,s=0;s<o.length;s++){var a=o[s].xn,A=r.Io(a),l=o[s].ve,u=new Ar(A);u.xn=l,u.wr=this.wr,u.Zi=i[0],this.ff.push(u),this.af.set(l,u)}}catch(t){n.e(t)}finally{n.f()}},Vi:function(){return this.ff.length},cf:function(t){if(this.ff)for(var e=this.ff,n=0;n<e.length;n++){var i=e[n];if(t.level==i.Zi&&i.tu(t))return i}return null},lf:function(t){var e,n=ur(this.ff);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(i.xn==t)return i}}catch(t){n.e(t)}finally{n.f()}return null}}),ci);function pr(t){return function(t){if(Array.isArray(t))return mr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||yr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dr(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=yr(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function yr(t,e){var n;if(t)return"string"==typeof t?mr(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mr(t,e):void 0}function mr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function gr(t){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===gr(t=function(t,e){if("object"!==gr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==gr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Er=e,this.Ht=null,this.Qt=null,this.zo=o.MODULE_SHORTEST,this.vf=s.PRIORITY_DEFAULT,this.yf=new Map,this.bf=new Map,this.df=null,this.pf=null,this.mf=[],this.wf=[],this.xf=[],this._f=[],this.gf=[],this.jf=[],this.jn=[],this.Sf=.1,this.Of=1,this.Ef=10,this.Tf=.1,this.Rf=1,this.Mf=10,this.Nf=.1,this.kf=1,this.Af=10,this.If=1,this.Pf=10,this.Po=null,this.Df=null,this.Lf=null,this.Ff=null,this.bs=null,this.ds=null,this.Cf=null,this.Bf=!1,this.Uf=[],this.Ws=!0,this.Zs=new Map,this.Gf=null,this.wr=e.type,this.barrierFree=!1,this.Wf=!1,this.iu=0,this.Zf=0,this.Vf=[]}var e,n;return e=t,(n=[{key:"assginedInfos",get:function(){return this.Uf},set:function(t){this.Uf=t}},{key:"passPts",set:function(t){this.Yf=t}},{key:"failedInsertedPts",get:function(){return this._failedInsertedPts}},{key:"toDoors",get:function(){return this.Bf},set:function(t){this.Bf=t}},{key:"obstruct",get:function(){return this.Ws},set:function(t){this.Ws=t}}])&&vr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var br=(Object.assign(ci.prototype,{Ai:function(t){if(t&&t.scene&&t.floors&&(this.Po=t.scene,this.Df=new zi,0!=(t=t.floors).size)){this.zf(t),this.Xf(),this.Lf=new fr(this.yf,this.wr),this.Lf.wr=this.wr;var e,n=dr(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(null!=i[1].gid){var r=i[1].naviAccessible;if(r&&r[0]&&0<r[0].naviNodes.length){this.Wf=!0;break}}}}catch(t){n.e(t)}finally{n.f()}this.Wf&&(this.zf(t),this.Xf(),this.Ff=new fr(this.bf,this.wr),this.Ff.wr=this.wr)}},Mr:function(){this.Er=null,this.Po=null,this.Df&&(this.Df.Mr(),this.Df=null);var t,e=dr(this.yf);try{for(e.s();!(t=e.n()).done;)t.value[1].Mr()}catch(t){e.e(t)}finally{e.f()}if(this.yf.clear(),this.yf=null,this.df.Mr(),this.df=null,this.mf=null,this.xf=null,this.Wf){var n,i=dr(this.bf);try{for(i.s();!(n=i.n()).done;)n.value[1].Mr()}catch(t){i.e(t)}finally{i.f()}this.bf.clear(),this.bf=null,this.pf.Mr(),this.pf=null,this.wf=null,this._f=null}this.gf=null,this.jf=null,this.jn=null},qf:function(t,e){if(this.li(),(n=this.Hf([t])).length<1)return a.ROUTE_FAILED_NO_DATA_START;var n=n[0];if((i=(t.extentID=n,this.Hf([e]))).length<1)return a.ROUTE_FAILED_NO_DATA_DEST;for(var i=i[0],r=(e.endExtentID=i,this.Yf),o=0;o<r.length;o++)r[o].Ks=!0;var s=this.Hf(r);if((n=this.Qf(n,i,s)).rst!=a.ROUTE_SUCCESS)return n.rst;for(var A=new Map,l=0;l<s.length;l++)A.has(s[l])?A.get(s[l]).push(r[l]):A.set(s[l],[r[l]]);return i=n.extentPath,n=this.Kf(t,e,A,i),this.Jf(n.nodePath),n.rst},$f:function(t,e,n,i){this.li();var r=null,o=(r=this.Wf&&this.barrierFree?this.Ff:this.Lf).cf(t);if(!o)return a.ROUTE_FAILED_NO_DATA_START;if((u=o.wu(t))&&u.ls&&u.ls.pass==oi.NaviModelPassType_NOT_PASS)return a.ROUTE_FAILED_NO_START_ARRIVAL;if(!(l=r.cf(e)))return a.ROUTE_FAILED_NO_DATA_DEST;if((h=l.wu(e))&&h.ls&&h.ls.pass==oi.NaviModelPassType_NOT_PASS)return a.ROUTE_FAILED_NO_DEST_ARRIVAL;this.zo=n,this.Ht=t,this.bs=u.ls,this.Qt=e,this.ds=h.ls;var s=o.xn,A=l.xn,l=u.ls,u=h.ls,h=a.ROUTE_FAILED_CANNOT_ARRIVE;if(this.jn=[],1!==this.wr&&this.ta(i),s===A)i=t.level,o.bs=l,o.ds=u,(h=o.Jo(t,e,n))===a.ROUTE_SUCCESS&&(l=o.ns(),this.jn.push({Zi:i,jn:l}));else{if(this.ra(s,A,t,e)!=a.ROUTE_SUCCESS&&(h=a.ROUTE_FAILED_OUTLINE),this.gf.reverse(),(u=this.na(r,t,e))==a.ROUTE_SUCCESS)return u;h=u}if(h!=a.ROUTE_SUCCESS)for(;2<this.ia(s,A,t,e).length;){if(this.na(r,t,e)===a.ROUTE_SUCCESS)return this.ea(),a.ROUTE_SUCCESS;s===A&&0<this.gf.length&&(A=this.gf[this.gf.length-1].ve)}return this.ea(),h},ia:function(t,e,n,i){var r=null;if(r=this.Wf&&this.barrierFree?this.pf:this.df,t===e){var o=this.mf.length+1,s=new Li,A=r.Go.ao(t);A=r.Go.We[A],A=(s.xn=A.xn,s.Zi=A.Zi,s.ve=o,s.Ko=A.Ko,s.Ue=A.Ue,s.Hi=A.Hi,s.Xi=A.Xi,this.mf.push(s),this.oa(),new Ni(this.mf,this.xf));if(s=(e=o,(r=new Xi(A)).Go.He.get(t))){var l,u=dr(s.values());try{for(u.s();!(l=u.n()).done;){var h=l.value;h._o===e&&(h.Vi=Number.MAX_VALUE)}}catch(t){u.e(t)}finally{u.f()}}}else for(var c=0;c<this.Vf.length;c++){var f=this.Vf[c].from.ve,p=this.Vf[c].to.ve;if(f=r.Go.He.get(f)){var d,y=dr(f.values());try{for(y.s();!(d=y.n()).done;){var m=d.value;m._o===p&&(m.Vi=Number.MAX_VALUE)}}catch(t){y.e(t)}finally{y.f()}}}return this.df=r,this.ra(t,e,n,i)!=a.ROUTE_SUCCESS&&(this.gf=[]),this.gf.reverse(),this.gf},ea:function(){var t;this.Wf&&this.barrierFree?(this.sa(),this.oa(),t=new Ni(this.wf,this._f),this.pf=new Xi(t)):(this.sa(),this.oa(),t=new Ni(this.mf,this.xf),this.df=new Xi(t)),this.Vf=[]},na:function(t,e,n){this.jn=[];for(var i=[],r=[this.Ht],o=a.ROUTE_FAILED_CANNOT_ARRIVE,s=0;s<this.gf.length-1;s++){var A=[],l=[];if(null==this.wr||0===this.wr){if(!this.ua(this.gf[s],this.gf[s+1],r[r.length-1],A,l))return this.Vf.push({from:this.gf[s],to:this.gf[s+1]}),a.ROUTE_FAILED_CANNOT_ARRIVE}else if(!this.fa(this.gf[s],this.gf[s+1],r[r.length-1],A,l))return this.Vf.push({from:this.gf[s],to:this.gf[s+1]}),a.ROUTE_FAILED_CANNOT_ARRIVE;for(var u=!1,h=0;h<A.length;h++){var c=A[h].ae,f=l[h].ae,p=A[h].Zi,d=l[h].Zi,y={x:c.pr.x,y:c.pr.y,level:p},m={x:f.pr.x,y:f.pr.y,level:d};y=t.cf(y),o=0==s?(y.bs=this.bs,y.Jo(e,c,this.zo)):y.Jo(i[i.length-1],c,this.zo);if(a.ROUTE_SUCCESS==o){if(c=y.ns(),this.jn.push({Zi:p,jn:c}),i.push(f),r.push(f.pr),u=!0,this.gf.length-2==s){if((y=t.cf(m)).ds=this.ds,o=y.Jo(f,n,this.zo),a.ROUTE_SUCCESS!=o){this.jn.splice(this.jn.length-1,1),u=!1,r.splice(r.length-1,1),i.splice(i.length-1,1);continue}p=y.ns(),this.jn.push({Zi:d,jn:p})}if(a.ROUTE_SUCCESS==o)break}}if(!u)return 0==s?this.Vf.push({from:this.gf[s],to:this.gf[s+1]}):this.Vf.push({from:this.gf[s-1],to:this.gf[s]}),a.ROUTE_FAILED_CANNOT_ARRIVE;o!==a.ROUTE_SUCCESS&&this.Vf.push({from:this.gf[s],to:this.gf[s+1]})}return o},aa:function(){if(this.Bf&&(this.Cf=null,this.ds)&&0<this.jn.length){for(var t,e,n=this.jn[this.jn.length-1].jn,i=null,r={x:-1,y:-1},o=n.length-1;0<o;o--){var s=n[o],a=n[o-1];if(ft.Lt(s.pr,a.pr,this.ds.Se,r)){i=o;break}}null!=i&&(t=n[n.length-1],n.splice(i,n.length-i),(e=new vi).xn=-1,e.pr=r,(t.Ks||t.pr.Ks)&&(e.Ks=!0),n.push(e),this.Cf=r)}for(var A=[],l=0;l<this.jn.length;l++)1<this.jn[l].jn.length&&A.push(this.jn[l]);for(var u=[],h=0;h<A.length;h++){this.ha(A[h]);for(var c=(m=A[h]).Zi,f=m.jn,p=[],d=0,y=0;y<f.length;y++)p.push(f[y].pr),y!=f.length-1&&(d+=ft.dt(f[y].pr,f[y+1].pr));var m;(m=new fi).Zi=c,m.zi=f,m.Yi=p,m.Vi=d,u.push(m),h!=A.length-1&&(c=this.ca(A[h]),m=this.la(A[h+1]),u.push(c),u.push(m))}return u},ha:function(t){if(null!=t&&t.jn){var e=t.jn;if((a=e.length)&&!(a<2)){var n=[],i=(n.push(e[0]),e[0]),r=e[a-1];ft.dt(i.pr,r.pr),ft.rt();for(var o=1;o<a-1;o++){var s=e[o];null!=i&&ft.dt(i.pr,s.pr)<ft.rt()||null!=r&&ft.dt(r.pr,s.pr)<ft.rt()||n.push(s)}n.push(r);for(var a=n.length,A=new Array(a),l=0;l<a;l++)A[l]=0;for(var u=1;u<a-1;u++){for(var h=n[u],c=u-1;0!=A[c];)c--;!ft.bt(h.pr,n[c].pr,n[u+1].pr)||h.Ks||(A[u]=1)}for(var f=[],p=0;p<a;p++)0==A[p]&&f.push(n[p]);t.jn=f}}},li:function(){this.gf=[],this.jf=[];var t,e=this.Lf.af,n=dr(e.keys());try{for(n.s();!(t=n.n()).done;){var i=t.value,r=e.get(i);r.li(),r.obstruct=this.Ws}}catch(t){n.e(t)}finally{n.f()}var o,s=this.Lf.af,a=dr(s.keys());try{for(a.s();!(o=a.n()).done;){var A=o.value,l=s.get(A);l.li(),l.obstruct=this.Ws}}catch(t){a.e(t)}finally{a.f()}},va:function(t,e){var n=null,i=null;if(null==(i=(this.Wf&&this.barrierFree?this.Ff:this.Lf).cf(t)))return null;i=i.Go;for(var r=[],o=(r.push.apply(r,pr(i.Ze)),n={distance:Number.MAX_VALUE,road:null,angle:null,coords:{level:t.level}},{}),s=0;s<r.length;s++){var a,A=r[s];A.pe===oi.NaviRoadEntry_FORBID||Array.isArray(e)&&0<e.length&&e.indexOf(A.de)<0||(a=ft._t(t,A.Ht,A.Qt,o))<n.distance&&(n.distance=a,n.road=A,n.angle=this.ya(A.Ht,A.Qt),Object.assign(n.coords,o))}return null!=n.road&&(i={id:(i=n.road).xn,extentID:i.ve,roadEntry:i.pe,roadRank:i.de,startID:i.he,startPoint:i.Ht,endID:i.ce,endPoint:i.Qt},n.road=i),n},ya:function(t,e){var n=new yi(0,0,1);t=new yi(t.x,0,t.y),t=(e=new yi(e.x,0,e.y).clone().sub(t).normalize()).angleTo(n)*ft.it();return 0<e.clone().cross(n).y?360-t:t},zf:function(t){this.Wf?this.bf=new Map:this.yf=new Map,this.Df.Do(this.Po);var e,n=dr(t);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=i[1].gid;if(null!=r){var o=i[1].geo[0],s=i[1].biz[0],a=null;if(1==this.wr?0<i[1].naviDrive.length&&(a=i[1].naviDrive[0]):this.Wf?0<i[1].naviAccessible.length&&(a=i[1].naviAccessible[0]):0<i[1].navi.length&&(a=i[1].navi[0]),a){var A=this.Df.Uo(r,o,s,a);if(0!=A.naviNodes.length&&0!=A.naviSegments.length){var l=new Map,u=this.ba(A,l),h=this.da(A),c=this.pa(A),f=this.ma(A),p=this.wa(A),d=(this.xa(p,u,a,l),new Ni(u,h,!0,1));d.Zi=r,0!=f.length&&(d.Ye=f),0!=c.length&&(d.Xe=c),0!=p.length&&(d.Ve=p);for(var y=0;y<h.length;y++)h[y].ve=d.io(h[y].Ht);(0==this.Wf?this.yf:this.bf).set(A.level,d)}}}}}catch(t){n.e(t)}finally{n.f()}},ba:function(t,e){var n,i=[];for(n in t.naviNodes)!function(){var r=t.naviNodes[n];if(null!=r.nodeId){var o=new vi;o.xn=r.nodeId,o.pr={x:parseFloat(r.geoArr.x.toFixed(3)),y:parseFloat(r.geoArr.y.toFixed(3))},o.ne=r.nodeType,o.ie=r.liftType,o.Hi=r.liftFlag,o.ee=r.liftEntry,r.accessible&&(o._a=r.accessible),r.linkSegArr.forEach(function(t){o.qi.push(parseInt(t))}),r.liftFloorArr.forEach(function(t){o.Xi.push(parseInt(t))}),i.push(o),e.set(r.nodeId,n)}}();return i},da:function(t){var e,n=[];for(e in t.naviSegments){var i,r=t.naviSegments[e],o=r.geoArr;o&&((i=new _i).xn=r.segmentId,i.he=r.snode,i.Ht={x:parseFloat(o[0].x.toFixed(3)),y:parseFloat(o[0].y.toFixed(3))},i.ce=r.enode,i.Qt={x:parseFloat(o[1].x.toFixed(3)),y:parseFloat(o[1].y.toFixed(3))},i.Vi=r.length,i.pe=r.entry,i.de=r.rank,n.push(i))}return n},ma:function(t){for(var e=[],n=0,i=t.extentLayer.length;n<i;n++){var r=t.extentLayer[n],o=(o=r.geoArr)||[];(o=new Pi(r.eid,t.gid,0,o,r.lr,r.holes)).fid=r.fid,e.push(o)}return e},wa:function(t){for(var e=[],n=0,i=t.modelLayer.length;n<i;n++){var r=t.modelLayer[n],o=(o=r.geoArr)||[];(o=new Pi(r.eid,t.gid,0,o,r.lr,r.holes)).fid=r.fid,o.pass=r.pass,e.push(o)}return e},pa:function(t){for(var e=[],n=0,i=t.naviZones.length;n<i;n++){var r=t.naviZones[n];r=new Ci(r.xn,t.gid,r.type,r.geoArr);e.push(r)}return e},xa:function(t,e,n,i){for(var r=new Map,o=0;o<t.length;o++){var s=t[o];r.set(s.xn,o)}for(var a=0;a<n.naviModels.length;a++)for(var A=n.naviModels[a],l=A.modelid,u=t[r.get(l)],h=0;h<A.doorids.length;h++){var c=A.doorids[h],f=(c=e[i.get(c)],c=(u.De.push(c),A.nodetypes[h]),A.entrytypes[h]);u.Le.push(c),u.Fe.push(f)}},Xf:function(){var t;this.Wf?(this.sa(),this.oa(),t=new Ni(this.wf,this._f),this.pf=new Xi(t)):(this.sa(),this.oa(),t=new Ni(this.mf,this.xf),this.df=new Xi(t))},sa:function(){var t,e=0,n=0,i=dr(this.Wf?(this.wf=[],this.bf):(this.mf=[],this.yf));try{for(i.s();!(t=i.n()).done;)for(var r=t.value,o=r[1],s=o.Ye,a=0;a<s.length;a++){var A=s[a],l=new Li;l.xn=A.xn,l.Zi=r[0],l.ve=++e,A.ve=l.ve,l.Ko=A;for(var u=0;u<o.We.length;u++){var h,c,f=o.We[u];f.ie!=oi.NaviLiftType_NULL&&ft.yt(f.pr,A.Se,A.Oe)&&(h=new Bi,c=o.uo(f.pr),h.fe=c,h.se(f),h.ue=++n,h.Zi=r[0],h.ae=f,h.ee=f.ee,h.ie=f.ie,h.Hi=f.Hi,h.ve=l.ve,this.Wf?1===f._a&&(h._a=f._a,l.Ue.push(h)):(1===f._a&&(h._a=f._a),l.Ue.push(h)))}(this.Wf?this.wf:this.mf).push(l)}}catch(t){i.e(t)}finally{i.f()}},oa:function(){for(var t=0,e=this.Wf?this.wf:this.mf,n=[],i=0;i<e.length;i++)for(var r=e[i],o=0;o<e.length;o++){var s,a,A=e[o];i!=o&&(a=void 0,null!=(a=null==this.wr||0==this.wr?this.ga(r,A):this.ja(r,A)))&&(a*=0==(s=Math.abs(r.Zi-A.Zi))?1:s,(s=new _i).he=r.ve,s.ce=A.ve,s.Vi=a,s.pe=oi.NaviRoadEntry_FORWARD,s.xn=t,t+=1,n.push(s))}this.Wf?this._f=n:this.xf=n},ga:function(t,e){for(var n=Number.MAX_VALUE,i=!1,r=t.Zi,o=e.Zi,a=r<o?oi.NaviLiftEntry_DOWN:oi.NaviLiftEntry_UP,A=0;A<t.Ue.length;A++){var l=t.Ue[A],u=l.ee;if(u!=oi.NaviLiftEntry_FORBID&&u!=a){var h=l.ie;if(s.PRIORITY_LIFTONLY==this.vf){if(oi.NaviLiftType_Lift!=h)continue}else if(s.PRIORITY_ESCALATORONLY==this.vf){if(oi.NaviLiftType_Escalator!=h)continue}else if(s.PRIORITY_STAIRONLY==this.vf){if(oi.NaviLiftType_Stair!=h)continue}else if(s.PRIORITY_ACCESSIBLEONLY==this.vf&&oi.NaviLiftType_Accessible!=h)continue;if(h==oi.NaviLiftType_Stair||-1!=l.Xi.indexOf(o))for(var c=0;c<e.Ue.length;c++){var f=e.Ue[c];if(null!=f&&l.Hi==f.Hi)if(s.PRIORITY_LIFTFIRST==this.vf||s.PRIORITY_DEFAULT==this.vf){if(oi.NaviLiftType_Lift==h||oi.NaviLiftType_Accessible==h)return this.Sf;if(oi.NaviLiftType_Escalator==h){(f=this.Rf)<n&&(n=f),i=!0;break}if(oi.NaviLiftType_Stair==h){(f=this.Af)<n&&(n=f),i=!0;break}}else if(s.PRIORITY_ESCALATORFIRST==this.vf){if(oi.NaviLiftType_Lift==h||oi.NaviLiftType_Accessible==h){(f=this.Of)<n&&(n=f),i=!0;break}if(oi.NaviLiftType_Escalator==h)return this.Tf;if(oi.NaviLiftType_Stair==h){(f=this.Af)<n&&(n=f),i=!0;break}}else if(s.PRIORITY_STAIRFIRST==this.vf){if(oi.NaviLiftType_Lift==h){(f=this.Of)<n&&(n=f),i=!0;break}if(oi.NaviLiftType_Escalator==h||oi.NaviLiftType_Accessible==h){(f=this.Mf)<n&&(n=f),i=!0;break}if(oi.NaviLiftType_Stair==h)return this.Nf}else{if(s.PRIORITY_LIFTFIRST1==this.vf||s.PRIORITY_STAIRFIRST1==this.vf||s.PRIORITY_ESCALATORFIRST1==this.vf)return this.If;if(s.PRIORITY_LIFTONLY==this.vf||s.PRIORITY_ESCALATORONLY==this.vf||s.PRIORITY_STAIRONLY==this.vf||s.PRIORITY_ACCESSIBLEONLY==this.vf)return this.If}}}}return i?n:null},ja:function(t,e){for(var n=Number.MAX_VALUE,i=!1,r=t.Zi<e.Zi?oi.NaviLiftEntry_DOWN:oi.NaviLiftEntry_UP,o=0;o<t.Ue.length;o++){var s=t.Ue[o],a=s.ee;if(a!=oi.NaviLiftEntry_FORBID&&a!=r){for(var A=0;A<e.Ue.length;A++){var l=e.Ue[A];if(s.Hi==l.Hi){n=this.Pf,i=!0;break}}if(i)break}}return i?n:null},ta:function(t){this.vf!==t&&(this.vf=t,this.barrierFree?(this.oa(),t=new Ni(this.wf,this._f),this.pf=new Xi(t)):(this.oa(),t=new Ni(this.mf,this.xf),this.df=new Xi(t)))},la:function(t){var e=t.jn,n=new fi;return n.Zi=t.Zi,n.zi.push(e[0]),n.Yi.push(e[0].pr),n.Vi=0,n},ca:function(t){var e=t.jn,n=new fi;return n.Zi=t.Zi,n.zi.push(e[e.length-1]),n.Yi.push(e[e.length-1].pr),n.Vi=0,n},Sa:function(t,e){for(var n=this.Wf&&this.barrierFree?this.wf:this.mf,i=0;i<n.length;i++)if(null!=t&&n[i].Zi==t&&n[i].xn==e)return n[i];return null},Oa:function(t){for(var e=null,n=this.Wf&&this.barrierFree?this.wf:this.mf,i=0;i<n.length;i++)if(n[i].ve==t)return n[i];return e},ra:function(t,e,n,i){var r,o=null;if((t=(o=this.Wf&&this.barrierFree?this.pf:this.df).rs(t,e,n,i))==a.ROUTE_SUCCESS){r=o.ns(),this.gf=[];for(var s=0;s<r.length;s++)this.gf.push(r[s])}return t},ua:function(t,e,n,i,r){var o=null,a=(o=(this.Wf&&this.barrierFree?(o=this.Ff.cf(n),this.Gf=(o||this.Ff.af.get(t.Zi)).Go.uo(n)):(o=this.Lf.cf(n),this.Gf=(o||this.Lf.af.get(t.Zi)).Go.uo(n)),Math.abs(t.Zi-e.Zi)),[]);function A(e,n){e=t.Ge(e,n,l),a.push.apply(a,pr(e))}var l=[];if(0==this.Wf&&1==this.barrierFree)for(var u=0;u<t.Ue.length;u++)1==t.Ue[u]._a&&l.push(t.Ue[u]);else l=t.Ue;for(var h=0;h<l.length;h++){var c=l[h];c.$i=ft.dt(c.pr,this.Qt)+ft.dt(c.pr,n)}var f,p=(p=t.Ko.sr.size).x+p.y,d=(s.PRIORITY_LIFTONLY!==this.vf&&s.PRIORITY_ESCALATORONLY!==this.vf&&s.PRIORITY_STAIRONLY!==this.vf&&s.PRIORITY_ACCESSIBLEONLY!==this.vf||(f=null,s.PRIORITY_LIFTONLY===this.vf&&(f=oi.NaviLiftType_Lift),s.PRIORITY_ESCALATORONLY===this.vf&&(f=oi.NaviLiftType_Escalator),s.PRIORITY_STAIRONLY===this.vf&&(f=oi.NaviLiftType_Stair),s.PRIORITY_ACCESSIBLEONLY===this.vf&&(f=oi.NaviLiftType_Accessible),a=t.Ge(f,null,l)),s.PRIORITY_LIFTFIRST!==this.vf&&s.PRIORITY_ESCALATORFIRST!==this.vf&&s.PRIORITY_STAIRFIRST!==this.vf&&s.PRIORITY_DEFAULT!==this.vf||(s.PRIORITY_LIFTFIRST!==this.vf&&s.PRIORITY_DEFAULT!==this.vf||(A(oi.NaviLiftType_Lift,-15*o),A(oi.NaviLiftType_Escalator,-8*o),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_ESCALATORFIRST===this.vf&&(A(oi.NaviLiftType_Lift,-8*o),A(oi.NaviLiftType_Escalator,-15*o),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_STAIRFIRST===this.vf&&(A(oi.NaviLiftType_Lift,-8*o),A(oi.NaviLiftType_Escalator,0),A(oi.NaviLiftType_Stair,-15*o))),s.PRIORITY_LIFTFIRST1!==this.vf&&s.PRIORITY_ESCALATORFIRST1!==this.vf&&s.PRIORITY_STAIRFIRST1!==this.vf||(s.PRIORITY_LIFTFIRST1===this.vf&&(A(oi.NaviLiftType_Lift,-p),A(oi.NaviLiftType_Escalator,0),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_ESCALATORFIRST1===this.vf&&(A(oi.NaviLiftType_Lift,0),A(oi.NaviLiftType_Escalator,-p),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_STAIRFIRST1===this.vf&&(A(oi.NaviLiftType_Lift,0),A(oi.NaviLiftType_Escalator,0),A(oi.NaviLiftType_Stair,-p))),this);a.sort(function(t,e){if(t.zone!==e.zone){if(t.zone===d.Gf)return-1;if(e.zone===d.Gf)return 1}return t.$i-e.$i});for(var y=0;y<a.length;y++){var m=a[y];if(!(1===m.ee&&e.Zi<t.Zi||2===m.ee&&e.Zi>t.Zi||3===m.ee))for(var g=0;g<e.Ue.length;g++){var v=e.Ue[g];if(m.Hi===v.Hi){i.push(m),r.push(v);break}}}return 0!==i.length},fa:function(t,e,n,i,r){this.Gf=this.Lf.af.get(t.Zi).Go.uo(n);for(var o=[],s=t.Ue,a=0;a<s.length;a++){var A=s[a];A.$i=ft.dt(A.pr,this.Qt)+ft.dt(A.pr,n)}var l=this;(o=t.Ge(oi.NaviLiftType_Ramp)).sort(function(t,e){if(t.zone!==e.zone){if(t.zone===l.Gf)return-1;if(e.zone===l.Gf)return 1}return t.$i-e.$i});for(var u=0;u<o.length;u++){var h=o[u];if(!(1===h.ee&&e.Zi<t.Zi||2===h.ee&&e.Zi>t.Zi||3===h.ee))for(var c=0;c<e.Ue.length;c++){var f=e.Ue[c];if(h.Hi===f.Hi){i.push(h),r.push(f);break}}}return 0!==i.length},Hf:function(t){var e=[],n=null;if(n=this.barrierFree?this.Ff:this.Lf){var i,r=dr(t);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=n.cf(o),a=null==s?void 0:s.xn;a&&e.push(a)}}catch(t){r.e(t)}finally{r.f()}}return e},Qf:function(t,e,n){var i,r=null;if(-1!=(i=(-1!=(i=(n=Array.from(new Set(n))).indexOf(t))&&n.splice(i,1),n.indexOf(e)))&&n.splice(i,1),n.length<=0){if(r={rst:a.ROUTE_FAILED_OUTLINE,extentPath:[]},t==e)return r.extentPath.push(t),r.rst=a.ROUTE_SUCCESS,r;if(r.rst=this.ra(t,e),r.rst!=a.ROUTE_SUCCESS)return r;this.gf.reverse();for(var o=0;o<this.gf.length;o++)r.extentPath.push(this.gf[o].ve)}else r=this.Ea(t,e,n);return r},Ta:function(t){var e=0;if(!(null==t||t.length<=0))for(var n=this.df.Go.He,i=1;i<t.length;i++)for(var r=t[i].xn,o=t[i-1].xn,s=n.get(o),a=0;a<s.length;a++)if(s[a]._o==r){e+=s[a].Vi;break}return e},Ea:function(t,e,n){for(var i={rst:null,extentPath:[]},r=[],o=t;0<n.length;){for(var s=Number.MAX_VALUE,A=null,l=null,u=0;u<n.length;u++){var h,c=n[u];this.df.rs(o,c)==a.ROUTE_SUCCESS&&((c=this.df.ns()).reverse(),(h=this.Ta(c))<s)&&(s=h,A=u,l=c)}if(null==A)return i;o=n[A],l.splice(l.length-1,1),r.push.apply(r,pr(l)),n.splice(A,1)}if(i.rst=this.df.rs(o,e),i.rst==a.ROUTE_SUCCESS){(t=this.df.ns()).reverse(),r.push.apply(r,pr(t));for(var f=0;f<r.length;f++)i.extentPath.push(r[f].ve)}return i},Kf:function(t,e,n,i){this.li();for(var r=[],o=t,s=0;s<i.length;s++){var A=i[s],l=((this.barrierFree?this.Ff:this.Lf).lf(A),[]),u=n.get(i[s]);if(null!=u)for(;0<u.length;){for(var h=null,c=null,f=(this.Ra(o,u),3<=u.length?3:u.length),p=[],d=0;d<f;d++){var y=this.Ma(o,u[d]);y.rst==a.ROUTE_SUCCESS&&p.push({result:y,index:d})}p.sort(function(t,e){return t.result.dist-e.result.dist});var m=this.Na(u,p);if(m&&(h=m.result.nodePath,c=m.index,m.result.dist),null==c)return{rst:a.ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR,nodePath:r};(o=h[h.length-1].pr).level=u[c].level,u.splice(c,1),h.splice(h.length-1,1),l.push.apply(l,pr(h));for(var g=0;g<m.result.naviResult.length;g++)r.push({level:m.result.naviResult[g].Zi,path:m.result.naviResult[g].zi})}if(s==i.length-1){this.Bf&&(A=(this.Wf&&this.barrierFree?this.Ff:this.Lf).cf(e).wu(e))&&(this.ds=A.ls);var v=this.Ma(o,e);if(v.rst!=a.ROUTE_SUCCESS)return{rst:a.ROUTE_FAILED_WAYPOINT_CALCULATE_ERROR,nodePath:r};l.push.apply(l,pr(v.nodePath));for(var b=0;b<v.naviResult.length;b++)r.push({level:v.naviResult[b].Zi,path:v.naviResult[b].zi});for(var x,w=[r[0]],B=1;B<r.length;B++)r[B].level==w[w.length-1].level?(x=w[w.length-1].path).push.apply(x,pr(r[B].path)):w.push(r[B]);return{rst:a.ROUTE_SUCCESS,nodePath:w}}}return{rst:a.ROUTE_SUCCESS,nodePath:r}},Jf:function(t){for(var e=[],n=0;n<t.length;n++)e.push({Zi:t[n].level,jn:t[n].path});this.jn=e},Ma:function(t,e){this.li(),this.jn=[];var n=null,i=Number.MAX_VALUE,r=[],o=(n=this.Wf&&this.barrierFree?this.Ff:this.Lf).cf(t);if(!o)return a.ROUTE_FAILED_NO_DATA_START;if(!(l=n.cf(e)))return a.ROUTE_FAILED_NO_DATA_DEST;if(o.li(),l.li(),(u=o.wu(t))&&u.ls&&u.ls.pass==oi.NaviModelPassType_NOT_PASS)return{rst:a.ROUTE_FAILED_NO_START_ARRIVAL,dist:i,nodePath:r};if((h=l.wu(e))&&h.ls&&h.ls.pass==oi.NaviModelPassType_NOT_PASS)return{rst:a.ROUTE_FAILED_NO_DEST_ARRIVAL,dist:i,nodePath:r};this.Ht=t,this.bs=u.ls,this.Qt=e,this.ds=h.ls;var s=o.xn,A=l.xn,l=u.ls,u=h.ls,h=a.ROUTE_FAILED_CANNOT_ARRIVE;if(this.jn=[],s===A){var c=t.level;o.bs=l,o.ds=u,(h=o.Jo(t,e,this.zo))===a.ROUTE_SUCCESS&&(l=o.ns(),this.jn.push({Zi:c,jn:l}))}else{if(this.ra(s,A,t,e)!=a.ROUTE_SUCCESS&&(h=a.ROUTE_FAILED_OUTLINE),this.gf.reverse(),(u=this.na(n,t,e))==a.ROUTE_SUCCESS){r=this.aa();for(var f=[],p=0;p<r.length;p++)f.push.apply(f,pr(r[p].zi));return{rst:u,dist:i=this.ka(f),nodePath:f,naviResult:r}}h=u}if(h!=a.ROUTE_SUCCESS)for(;2<this.ia(s,A,t,e).length;){if(this.na(n,t,e)===a.ROUTE_SUCCESS){r=this.aa();for(var d=[],y=0;y<r.length;y++)d.push.apply(d,pr(r[y].zi));return i=this.ka(d),this.ea(),{rst:a.ROUTE_SUCCESS,dist:i,nodePath:d,naviResult:r}}s===A&&0<this.gf.length&&(A=this.gf[this.gf.length-1].ve)}r=this.aa();for(var m=[],g=0;g<r.length;g++)m.push.apply(m,pr(r[g].zi));return i=this.ka(m),this.ea(),{rst:h,dist:i,nodePath:m,naviResult:r}},ka:function(t){var e=0;if(!(null==t||t.length<=1))for(var n=1;n<t.length;n++)e+=ft.dt(t[n].pr,t[n-1].pr);return e},Aa:function(t,e,n,i,r){var o=Math.abs(t.Zi-e.Zi),a=[];function A(e,n){e=t.Ge(e,n,l),a.push.apply(a,pr(e))}var l=[];if(0==this.Wf&&1==this.barrierFree)for(var u=0;u<t.Ue.length;u++)1==t.Ue[u]._a&&l.push(t.Ue[u]);else l=t.Ue;for(var h=0;h<l.length;h++){var c=l[h];c.$i=ft.dt(n,c.pr)}var f,p=(p=t.Ko.sr.size).x+p.y,d=(s.PRIORITY_LIFTONLY!==this.vf&&s.PRIORITY_ESCALATORONLY!==this.vf&&s.PRIORITY_STAIRONLY!==this.vf&&s.PRIORITY_ACCESSIBLEONLY!==this.vf||(f=null,s.PRIORITY_LIFTONLY===this.vf&&(f=oi.NaviLiftType_Lift),s.PRIORITY_ESCALATORONLY===this.vf&&(f=oi.NaviLiftType_Escalator),s.PRIORITY_STAIRONLY===this.vf&&(f=oi.NaviLiftType_Stair),s.PRIORITY_ACCESSIBLEONLY===this.vf&&(f=oi.NaviLiftType_Accessible),a=t.Ge(f,null,l)),s.PRIORITY_LIFTFIRST!==this.vf&&s.PRIORITY_ESCALATORFIRST!==this.vf&&s.PRIORITY_STAIRFIRST!==this.vf&&s.PRIORITY_DEFAULT!==this.vf||(s.PRIORITY_LIFTFIRST!==this.vf&&s.PRIORITY_DEFAULT!==this.vf||(A(oi.NaviLiftType_Lift,-15*o),A(oi.NaviLiftType_Escalator,-8*o),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_ESCALATORFIRST===this.vf&&(A(oi.NaviLiftType_Lift,-8*o),A(oi.NaviLiftType_Escalator,-15*o),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_STAIRFIRST===this.vf&&(A(oi.NaviLiftType_Lift,-8*o),A(oi.NaviLiftType_Escalator,0),A(oi.NaviLiftType_Stair,-15*o))),s.PRIORITY_LIFTFIRST1!==this.vf&&s.PRIORITY_ESCALATORFIRST1!==this.vf&&s.PRIORITY_STAIRFIRST1!==this.vf||(s.PRIORITY_LIFTFIRST1===this.vf&&(A(oi.NaviLiftType_Lift,-p),A(oi.NaviLiftType_Escalator,0),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_ESCALATORFIRST1===this.vf&&(A(oi.NaviLiftType_Lift,0),A(oi.NaviLiftType_Escalator,-p),A(oi.NaviLiftType_Stair,0)),s.PRIORITY_STAIRFIRST1===this.vf&&(A(oi.NaviLiftType_Lift,0),A(oi.NaviLiftType_Escalator,0),A(oi.NaviLiftType_Stair,-p))),this);a.sort(function(t,e){if(t.zone!==e.zone){if(t.zone===d.Gf)return-1;if(e.zone===d.Gf)return 1}return t.$i-e.$i});for(var y=0;y<a.length;y++){var m=a[y];if(!(1===m.ee&&e.Zi<t.Zi||2===m.ee&&e.Zi>t.Zi))for(var g=0;g<e.Ue.length;g++){var v=e.Ue[g];if(m.Hi===v.Hi){i.push(m),r.push(v);break}}}return 0!==i.length},Ra:function(t,e){e.sort(function(e,n){return ft.wt(t,e)-ft.wt(t,n)})},Na:function(t,e){var n=null;if(!(e.length<1)){var i=(n=e[0]).index;if(!(e.length<2)&&3<=e.length){for(var r,o=Number.MAX_VALUE,s=-1,a=0;a<t.length;a++)a!=i&&(r=ft.dt(t[i],t[a]))<o&&(o=r,s=a);s!=e[1].index&&(n=e[1])}}return n},vu:function(t){for(var e=new Map,n=0;n<t.length;n++){var i=t[n],r=e.get(i.Zi);r||e.set(i.Zi,r=[]),r.push(i)}var o,s=this.Lf.af,a=this.Lf.af,A=dr(e.keys());try{for(A.s();!(o=A.n()).done;){var l=o.value,u=this.Zs.get(l);if(!u||this.Ia(e.get(l),u)){var h,c=dr(s.keys());try{for(c.s();!(h=c.n()).done;){var f=h.value,p=s.get(f);p.level===l&&(p.vu(e.get(l)),this.Zs.set(l,e.get(l)))}}catch(t){c.e(t)}finally{c.f()}var d,y=dr(a.keys());try{for(y.s();!(d=y.n()).done;){var m=d.value,g=a.get(m);g.level===l&&(g.vu(e.get(l)),this.Zs.set(l,e.get(l)))}}catch(t){y.e(t)}finally{y.f()}}}}catch(t){A.e(t)}finally{A.f()}},Pa:function(){var t,e=this.Lf.af,n=dr(this.Zs.keys());try{for(n.s();!(t=n.n()).done;){var i,r=t.value,o=dr(e.keys());try{for(o.s();!(i=o.n()).done;){var s=i.value,a=e.get(s);a.level===r&&a.Pa()}}catch(t){o.e(t)}finally{o.f()}}}catch(t){n.e(t)}finally{n.f()}this.Zs.clear()},Ia:function(t,e){if(t.length!=e.length)return!0;for(var n=0;n<t.length;n++){for(var i=!1,r=0;r<e.length;r++)e[r].Da(t[n])&&(i=!0);if(!i)return!0}return!1},uu:function(){for(var t in this.Uf){var e,n=parseInt(t),i=void 0,r=dr((i=(this.Wf&&this.barrierFree?this.Lf:this.Ff).af).keys());try{for(r.s();!(e=r.n()).done;){var o=e.value;i.get(o).Zi===n&&(dij.assignedPts=this.Uf[n],dij.uu(),this.jn.push({Zi:n,jn:dij.ns()}))}}catch(t){r.e(t)}finally{r.f()}}}}),ci),xr={zh:{straight:"",still_go_straight:"",back_to:"",turn_right:"",turn_left:"",right_front:" ",left_front:" ",turn_right_rear:"",turn_left_rear:"",up:"",down:"",up_to:"",down_to:"",drive_up:"",drive_down:"",meter:"",pass:"",arrived:"",front:"",stair:"",stair_pure:"",escalator_pure:"",lift_pure:"",ramp_pure:"",take:"",along:"",take_stair:"",along_ramp:"",front_pure:"",right_front_pure:"",right_pure:"",right_back_pure:"",back_pure:"",left_back_pure:"",left_pure:"",left_front_pure:"",east:"",west:"",south:"",north:"",southeast:"",northeast:"",southwest:"",northwest:"",face_to:"",start:"",dest:"",enter:"",outdoor:"",entrance:"",exit:"",reach:""},en:{straight:"go straight",still_go_straight:"go straight",back_to:"turn back",turn_right:"turn right",turn_left:"turn left",right_front:"go straight right front ",left_front:"go straight left front ",turn_right_rear:"turn right rear",turn_left_rear:"turn left rear",up:"up",down:"up",up_to:"up to",down_to:"down to",drive_up:"drive up",drive_down:"drive down",meter:"meter",pass:"pass",arrived:"arrived",front:"front",stair:"stair",stair_pure:"stair",escalator_pure:"escalator",lift_pure:"lift",ramp_pure:"ramp",take:"take",along:"along",take_stair:"take stair",along_ramp:"along ramp",front_pure:"front",right_front_pure:"right front",right_pure:"right",right_back_pure:"right back",back_pure:"back",left_back_pure:"left back",left_pure:"left",left_front_pure:"left front",east:"east",west:"west",south:"south",north:"north",southeast:"southeast",northeast:"northeast",southwest:"southwest",northwest:"northwest",face_to:"face to",start:"start",dest:"dest",enter:"enter",outdoor:"outdoor",entrance:"entrance",exit:"exit",reach:"reach"}};function wr(t){return(wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Br(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===wr(t=function(t,e){if("object"!==wr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==wr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&Br(t.prototype,e),n&&Br(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.La=e.data||null,this.Fa=e.directionAssert||10,this.Ca=e.combineAsset||5,this.Ba=e.combineDistance||.1,this.Ua=e.language||A.ZH,this.wr=e.type||si.Walk,this.Ga=["north","northeast","east","southeast","south","southwest","west","northwest","north"],this.Wa=["front_pure","right_front_pure","right_pure","right_back_pure","back_pure","left_back_pure","left_pure","left_front_pure","front_pure"],this.Za=["still_go_straight","right_front","turn_right","turn_right_rear","back_to","turn_left_rear","turn_left","left_front","still_go_straight"],this.Va=0,this.Ya=[],this.za=!1,this.Xa=0,Object.assign(this,e)});var Mr=(Object.assign(ci.prototype,{qa:function(t){for(var e=[],n=0;n<t.length;n++)e=e.concat(t[n].zi);return e},Ha:function(t,e){var n=Math.PI/4,i=(t=t/n,parseInt(t));t=t%1*n;return i%2==0?e<t&&(i+=1):n-e<=t&&(i+=1),i},Qa:function(t,e){var n=e.angleTo(t);return new yi(e.x,e.z,e.y).cross(new yi(t.x,t.z,t.y)).z<0?2*Math.PI-n:n},vi:function(){var t={center:{x:0,y:0,z:0}};return this.La&&(t.center.x=this.La.scene.defCenX,t.center.y=this.La.scene.defCenY,t.center.z=this.La.scene.defCenZ),t},Ka:function(t,e){var n=0;return e.level&&(n=this._i(e.level).height),new yi(e.x-t.x,t.y+n,-e.y+t.y)},Ja:function(t){return(t=xr[this.Ua][t])||""},_i:function(t){var e=null;if(!this.La)return null;for(var n=this.La.scene,i=(e={level:t,height:0,gname:"",desc:""},0);i<n.layerGroups.length;i++){var r=n.layerGroups[i];if(r.gid===t){e.height=r.height,e.gname=r.gname,e.desc=r.desc;break}}return e},$a:function(t){if(-1!=t)switch(t){case 2:return" "+this.Ja("stair_pure");case 3:return" "+this.Ja("escalator_pure");case 1:return" "+this.Ja("lift_pure");case 5:return" "+this.Ja("ramp_pure");default:return""}return this.Ja("stair")},th:function(t,e){var n,i,r,o;return e==t.length-1?{index:t[t.length-1].index}:(r=i=new yi(0,0,1),0!=e&&((r=t[e].clone().sub(t[e-1]).normalize()).y=0,r.z*=-1),(o=t[e+1].clone().sub(t[e])).y=0,n=o.length(),(o=o.normalize()).z*=-1,i=this.Ha(this.Qa(i,o),22.5*ft.nt()),r=this.Qa(r,o),{relField:o=this.Ha(r,this.Fa*ft.nt()),relDesc:this.Ja(this.Wa[o]),relAngle:r*ft.it(),absField:i,absDesc:this.Ja(this.Ga[i]),distance:n,index:t[e].index})},rh:function(t,e){for(var n=this,i=this.vi().center,r=t.map(function(t,e){return(t=n.Ka(i,t)).index=e,t}),o=[],s=0;s<r.length;s++){var a=this.th(r,s);a.point=t[s],a.level=e,o.push(a)}for(var A=[o[0]],l=1;l<o.length;l++)1==l&&o[0].distance<=this.Ba?(o[0].distance+=o[l].distance,o[0].relDesc=o[l].relDesc,o[0].relAngle=o[l].relAngle,o[0].absField=o[l].absField,o[0].absDesc=o[l].absDesc):o[l].distance<=this.Ba&&(o[l].relAngle<=this.Ca||360-o[l].relAngle<=this.Ca)||o[l].relAngle<=this.Ca||360-o[l].relAngle<=this.Ca?A[A.length-1].distance+=o[l].distance:A.push(o[l]);return A},nh:function(t,e){var n=[],i=0;if(e.forEach(function(t){(t.Ks||t.pr.Ks)&&n.push(i),i++}),0!=n.length)for(;0!=n.length;){for(var r=0;r<t.length-1;r++)if(t[r].index<=n[0]&&t[r+1].index>=n[0]){t[r+1].Ks=!0;break}n.splice(0,1)}},ih:function(t){var e="";return null==(t=this._i(t))||""+(e=this.Ua==A.ZH?t.desc:t.gname.toUpperCase())!="null"&&""+e!=""&&""+e!="undefined"?e:t.gname.toUpperCase()},eh:function(t,e,n,i,r,o){var s,a,A=t[e],l=t[e+1],u=null,h=this.Ja(this.Za[l.relField]);this.za=e==t.length-3&&l.distance<this.Va,h&&!this.za||(i?(this.za=!1,h||(u=this.oh(t[e+1].point,r),r=this.$a(u),s=null,a=this.ih(i),h=this.wr==si.Drive?(s=n<i?this.Ja("drive_up"):this.Ja("drive_down"),this.Ja("along")+r+" "+s+" "+a):(s=n<i?this.Ja("up_to"):this.Ja("down_to"),this.Ja("take")+r+" "+s+" "+a))):(this.za&&(this.Xa=l.distance),o||(h=this.Ja("arrived")))),n=null,n=0==e?2==t.length?this.Ja("face_to")+" "+A.absDesc+" "+this.Ja("straight")+" "+Math.ceil(A.distance)+" "+this.Ja("meter")+" "+h:this.Ja("face_to")+" "+A.absDesc+" "+this.Ja("straight")+" "+Math.ceil(A.distance)+" "+this.Ja("meter")+" "+this.Ja(this.Za[t[e+1].relField]):this.Ja("straight")+" "+Math.ceil(A.distance+(this.za&&!i?l.distance:0))+" "+this.Ja("meter")+" "+h;return[n=l.Ks?(n+=" ")+this.Ja("pass"):n,u]},sh:function(t,e,n,i,r){var o=t[e],s=t[e+1];return this.Ja(this.Za[t[e+1].relField])&&!this.za||(i?(t=n<i?this.Ja("up"):this.Ja("down"),s.relDesc=t):s.relDesc=r?this.Ja("front_pure"):this.Ja("dest")),{startPoint:o.point,startLevel:o.level,startIndex:o.index,endPoint:s.point,endLevel:s.level,endIndex:s.index,startDirection:o.absDesc,endDirection:s.relDesc,distance:o.distance+(this.za&&!i?s.distance:0)}},oh:function(t,e){for(var n,i=Number.MAX_SAFE_INTEGER,r=-1,o=0;o<e.length;o++)e[o]&&(n=Math.pow(e[o].pr.x-t.x,2)+Math.pow(e[o].pr.y-t.y,2))<i&&(i=n,r=e[o].ie);return r},uh:function(t){for(var e,n=t.fh,i=t.ah,r=t.result,o=[],s=[],a=[],A=null,l=0,u=[],h=!(this.Ya=[]),c=null,f=null,p=(t=t.buildingName||this.Ja("outdoor"),this.qa(r)),d=0;d<r.length;d++){if(e=(g=r[d]).level,A=null,d<r.length-1)for(var y=d;y<r.length;y++)if(r[y].level!=e){A=r[y].level;break}var m,g,v=g.pointList,b=this.rh(v,e);if(this.nh(b,g.zi),1<b.length&&(this.Ya=this.Ya.concat(b)),1==b.length)(A||h)&&(h?s.length&&(d==r.length-1&&(i?(o[o.length-1]+=" "+this.Ja("arrived"),s[s.length-1].endDirection=this.Ja("dest")):s[s.length-1].endDirection=this.Ja("front_pure")),s[s.length-1].endPoint=v[0],s[s.length-1].endLevel=e):c!=e&&null!=c||(g=null,m=this.ih(A),f=this.wr===si.Drive?(g=e<A?this.Ja("drive_up"):this.Ja("drive_down"),this.Ja("along_ramp")+" "+g+" "+m):(g=e<A?this.Ja("up_to"):this.Ja("down_to"),this.Ja("take_stair")+" "+g+" "+m),o.push(f),s.push({startPoint:v[0],startDirection:e<A?this.Ja("up"):this.Ja("down"),startLevel:e})),h=!h);else{c=e;for(var x=0;x<b.length-1&&!this.za;x++){var w,B=(w=this.eh(b,x,e,A,p,i))[0];(w=w[1])&&a.push(w),o.push(B),s.push(this.sh(b,x,e,A,i))}}1<b.length&&(g=b.reduce(function(t,e){return t+(e.distance||0)},0),u.push({level:e,distance:g}),l+=g)}return n&&0<o.length&&(o[0]=this.Ja("enter")+" "+t+" "+o[0]),i&&0<o.length&&(t===this.Ja("outdoor")?o[o.length-1]=o[o.length-1]+this.Ja("reach")+" "+i+" "+this.Ja("entrance"):o[o.length-1]=o[o.length-1]+this.Ja("reach")+" "+t+" "+this.Ja("exit")),[o,s,l,u,this.Xa,a]}}),ci);function Sr(t){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _r(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=Tr(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Er(t){return function(t){if(Array.isArray(t))return Cr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Tr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tr(t,e){var n;if(t)return"string"==typeof t?Cr(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cr(t,e):void 0}function Cr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Fr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Sr(t=function(t,e){if("object"!==Sr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Sr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&Fr(t.prototype,e),n&&Fr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.hh=e.gate,this.lh=e.bidToOutline,this.yh=e.bidToOutlineAccess,this.bh={},this.dh={},this.ph=-1,this.mh=-1,this.wh=[],this.xh=[],this._h=new Map,this.gh=new Map,this.jh=[],this.Sh=new Map,this.Oh=[],this.Eh=new Map,this.Th=new Map,this.Rh=new Map,this.he=null,this.ce=null,this.Mh=null,this.Nh=null,this.wr=e.type,this.kh=e.barrierFree,this.Ah=!1,this.Ih=null,this.Ph=10,this.Dh=2,this.Lh()});var Or=(Object.assign(ci.prototype,{Lh:function(){this.hh&&(this.Fh(),this.Ch(),this.Bh(this.wh,this.Th),this.Bh(this.xh,this.Rh))},Fh:function(){for(var t=0;t<this.hh.length;t++){var e=null,n=null,i=(e=null==this.wr||0===this.wr?(n=this.hh[t].accessible,this.hh[t].navi):this.hh[t].drive,""==this.hh[t].bid?null:this.hh[t].bid),r=this.hh[t].gid;e=this.Uh(e,r,i),n=this.Uh(n,r,i);(r=this.jh).push.apply(r,Er(e)),(r=this.Oh).push.apply(r,Er(n)),null==this.bh[i]&&(this.bh[i]=[]),(r=this.bh[i]).push.apply(r,Er(e)),null==this.dh[i]&&(this.dh[i]=[]),(r=this.dh[i]).push.apply(r,Er(n))}for(var o=0;o<this.jh.length;o++)this.jh[o].xn=o,this.Sh.set(o,this.jh[o]);for(var s=0;s<this.Oh.length;s++)this.Oh[s].xn=s,this.Eh.set(s,this.Oh[s])},Uh:function(t,e,n){if(null==t)return[];for(var i=[],r=0;r<t.length;r++){var o=t[r];o.level=e,o.bid=n,i.push(o)}return i},Ch:function(){this.wh=this.Gh(this.Sh),this.xh=this.Gh(this.Eh,!0);for(var t=0;t<this.wh.length;t++)this.wh[t].xn=t,this._h.set(t,this.wh[t]);for(var e=0;e<this.xh.length;e++)this.xh[e].xn=e,this.gh.set(e,this.xh[e])},Gh:function(t,e){for(var n=[],i=Array.from(t.keys()),r=0;r<i.length;r++)for(var o=r+1;o<i.length;o++){var s,a=i[r],A=i[o],l=t.get(a),u=t.get(A);t.get(a).flag==t.get(A).flag&&(s=this.Wh(l,u),n.push(s)),t.get(a).bid==t.get(A).bid&&this.Zh(l,u,e)&&(s=this.Wh(l,u),n.push(s))}return n},Wh:function(t,e){var n,i,r,o=0,s={};return s.startPoint=t.xn,s.endPoint=e.xn,s.xn=null,t.bid==e.bid?(n={x:t.pts[0],y:t.pts[1]},i={x:e.pts[0],y:e.pts[1]},o=0!=(r=Math.abs(t.level-e.level)*this.Ph)||t.extentID!==e.extentID?(ft.distance(n,i)+r)*this.Dh:ft.distance(n,i)+r,s.dist=Number(o.toFixed(5))):s.dist=o,s},Zh:function(t,e,n){var i=t.bid,r=this.Vh(t),o=this.Vh(e);return(t.extentID=r)==(e.extentID=o)||(n?this.yh:this.lh).get(i).rs(r,o)===a.ROUTE_SUCCESS},Vh:function(t){for(var e,n=null==(e=this.lh.get(t.bid).Go)?void 0:e.We,i=0;i<n.length;i++){var r=n[i].Ko,o=n[i].Zi;if(t.level===o&&(o={x:t.pts[0],y:t.pts[1]},r.Ae(o)))return r.ve}return 0},Yh:function(t){this.he=this.ph;var e,n=t.buildingID||null,i=[],r={type:null,pts:[t.x,t.y],bid:n,level:t.level,xn:this.he};if(null==(e=(this.kh?this.dh:this.bh)[n])||0==e.length)return!1;for(var o,s=0;s<e.length;s++)this.Zh(r,e[s])&&(o=this.Wh(r,e[s]))&&(o.xn=this.mh,i.push(o),(this.kh?(this.xh.push(o),this.gh):(this.wh.push(o),this._h)).set(this.mh,o),--this.mh);return this.kh?(this.Oh.push(r),this.Eh.set(this.he,r),this.Bh(i,this.Rh)):(this.jh.push(r),this.Sh.set(this.he,r),this.Bh(i,this.Th)),--this.ph,!0},Xh:function(t){this.ce=this.ph;var e,n=t.buildingID||null,i=[],r={type:null,pts:[t.x,t.y],bid:n,level:t.level,xn:this.ce};if(null==(e=(this.kh?this.dh:this.bh)[n])||0==e.length)return!1;this.jh.push(r),this.Sh.set(this.ce,r);for(var o,s=0;s<e.length;s++)this.Zh(r,e[s])&&(o=this.Wh(r,e[s]))&&(o.xn=this.mh,i.push(o),(this.kh?(this.xh.push(o),this.gh):(this.wh.push(o),this._h)).set(this.mh,o),--this.mh);return this.kh?(this.Oh.push(r),this.Eh.set(this.ce,r),this.Bh(i,this.Rh)):(this.jh.push(r),this.Sh.set(this.ce,r),this.Bh(i,this.Th)),--this.ph,!0},Bh:function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=i.startPoint,o=i.endPoint;e.has(r)||e.set(r,new Map),e.get(r).set(o,i.dist),e.has(o)||e.set(o,new Map),e.get(o).set(r,i.dist)}return e},qh:function(t,e,n){var i=null,r=null;if(this.kh){if(!this.Rh.has(t))return!1;for(var o=0;o<e.length;o++)if(!this.Rh.has(e[o]))return!1;i=this.Eh,r=this.Rh}else{if(!this.Th.has(t))return!1;for(var s=0;s<e.length;s++)if(!this.Th.has(e[s]))return!1;i=this.Sh,r=this.Th}this.ss(e,t);var a,A=e.length,l=0,u=_r(i.keys());try{for(u.s();!(a=u.n()).done;){var h=a.value;if(i.get(h).$i=h==t?0:Number.MAX_VALUE,i.get(h).te=!1,i.get(h).re=[],n instanceof Array)for(var c=0;c<n.length;c++){if(h!=n[c]&&i.get(h).flag===i.get(n[c]).flag){-1==n.indexOf(h)&&n.push(h);break}if(n.length>=i.size)return!1}}}catch(t){u.e(t)}finally{u.f()}var f=[];for(f.push(t);0<f.length;){var p=f[0],d=(f.splice(0,1),i.get(p));if(!d.te){if(d.te=!0,-1!=e.indexOf(p)&&++l==A)return!0;var y=r.get(p);if(y){var m,g=_r(y.keys());try{for(g.s();!(m=g.n()).done;){var v=m.value,b=d.$i+y.get(v),x=i.get(v);n instanceof Array&&n.includes(v)||x.te||x.$i>b&&(x.$i=b,x.re=[],x.re.push(p),f.push(v))}}catch(t){g.e(t)}finally{g.f()}f.sort(function(t,e){i.get(t).$i,i.get(e).$i})}}}return!(l<A)},ss:function(t,e){for(var n=t.indexOf(e);-1!=n;)t.splice(n,1),n=t.indexOf(e)},Jo:function(){if(this.kh){if(!this.Rh.has(this.he))return a.ROUTE_FAILED_CANNOT_CALCULATE;if(!this.Rh.has(this.ce))return a.ROUTE_FAILED_CANNOT_CALCULATE}else{if(!this.Th.has(this.he))return a.ROUTE_FAILED_CANNOT_CALCULATE;if(!this.Th.has(this.ce))return a.ROUTE_FAILED_CANNOT_CALCULATE}var t=[];return t.push(this.ce),this.qh(this.he,t)?a.ROUTE_SUCCESS:a.ROUTE_FAILED_CANNOT_ARRIVE},ns:function(){var t=[],e=[];e.push(this.ce),this.es(e,t);for(var n=0;n<t.length;n++)t[n].paths.reverse();return t},es:function(t,e){for(var n=0;n<t.length;n++){var i={paths:[],distance:0};i.paths.push(t[n]),this.hs(t[n],i),e.push(i)}},hs:function(t,e){var n=null,i=null;if(this.kh){if(0==this.Eh.get(t).re.length)return;n=this.Eh.get(t).re[0],i=this.Eh.get(t).$i}else{if(0==this.Sh.get(t).re.length)return;n=this.Sh.get(t).re[0],i=this.Sh.get(t).$i}null!=n&&(e.paths.push(n),e.distance+=i),this.hs(n,e)},Hh:function(t){var e,n=new Map,i=_r(t.keys());try{for(i.s();!(e=i.n()).done;){for(var r=e.value,o=ft.Ct(t.get(r)),s=(o.bid=r,0),a=0;a<t.get(r).length;a++)s+=t.get(r)[a].level;s=Math.floor(s/t.get(r).length),o.level=s,n.set(r,o)}}catch(t){i.e(t)}finally{i.f()}return n},Qh:function(t){var e,n=null,i=null,r=[],o=_r(t.keys());try{for(o.s();!(e=o.n()).done;){var s=e.value,a=this.Kh(t.get(s));a.bid==this.Mh?n=a:a.bid==this.Nh?i=a:r.push(a)}}catch(t){o.e(t)}finally{o.f()}return null!=n&&r.unshift(n),null!=i&&r.push(i),r},Kh:function(t){for(var e,n=t.bid||null,i=[],r={type:null,pts:[t.x,t.y],bid:t.bid,level:t.level,xn:this.ph},o=(this.kh?this.dh:this.bh)[n],s=0;s<o.length;s++)this.Zh(r,o[s])&&(e=this.Wh(r,o[s]))&&(e.xn=this.mh,i.push(e),(this.kh?(this.xh.push(e),this.gh):(this.wh.push(e),this._h)).set(this.mh,e),--this.mh);return this.kh?(this.Oh.push(r),this.Eh.set(this.ph,r),this.Bh(i,this.Rh)):(this.jh.push(r),this.Sh.set(this.ph,r),this.Bh(i,this.Th)),--this.ph,r},Jh:function(){if(!this.hh||0===this.hh.length)return null;var t=null;if(this.Ah){for(var e=this.Hh(this.Ih),n=this.Qh(e),i=[],r=1;r<n.length-1;r++)i.push(n[r].xn);var o=[e=n[0].xn],s=[],a=n[n.length-1].xn;if(this.$h(e,i,o,s),this.$h(o[o.length-1],[a],o,s),o.length==n.length)return this.tc(s)}return t},tc:function(t){for(var e=[],n=-1,i=[],r=0;r<t.length;r++)for(var o,s=t[r].paths,a=null,A=0;A<s.length;A++)0<s[A]&&(o=s[A],a=this.Sh.get(o),-1==n&&(n=a.bid),a.bid==n?i.push(a):(e.push({bid:n,entrances:i}),i=[a]),n=a.bid),r==t.length-1&&A==s.length-1&&a&&e.push({bid:a.bid,entrances:i});return e},$h:function(t,e,n,i){if(0!=e.length){for(var r,o=null,s=Number.MAX_VALUE,a=null,A=0,l=0;l<e.length;l++)this.qh(t,[e[l]])&&(this.hs(e[l],r={paths:[],distance:0}),r.distance<s)&&(s=r.distance,o=e[l],a=r,A=l);o&&(n.push(o),a.paths.reverse(),i.push(a),e.splice(A,1),this.$h(o,e,n,i))}},li:function(){this.jh=this.jh.filter(function(t){return 0<=t.xn}),this.Oh=this.Oh.filter(function(t){return 0<=t.xn}),this.wh=this.wh.filter(function(t){return 0<=t.xn}),this.xh=this.xh.filter(function(t){return 0<=t.xn});var t,e=_r(this.Sh.keys());try{for(e.s();!(t=e.n()).done;){var n=t.value;n<0&&this.Sh.delete(n)}}catch(t){e.e(t)}finally{e.f()}var i,r=_r(this.Eh.keys());try{for(r.s();!(i=r.n()).done;){var o=i.value;o<0&&this.Eh.delete(o)}}catch(t){r.e(t)}finally{r.f()}var s,a=_r(this._h.keys());try{for(a.s();!(s=a.n()).done;){var A=s.value;A<0&&this._h.delete(A)}}catch(t){a.e(t)}finally{a.f()}var l,u=_r(this.gh.keys());try{for(u.s();!(l=u.n()).done;){var h=l.value;h<0&&this.gh.delete(h)}}catch(t){u.e(t)}finally{u.f()}var c,f=_r(this.Th.keys());try{for(f.s();!(c=f.n()).done;){var p=c.value;if(p<0)this.Th.delete(p);else{var d,y=_r(this.Th.get(p).keys());try{for(y.s();!(d=y.n()).done;){var m=d.value;m<0&&this.Th.get(p).delete(m)}}catch(t){y.e(t)}finally{y.f()}}}}catch(t){f.e(t)}finally{f.f()}var g,v=_r(this.Rh.keys());try{for(v.s();!(g=v.n()).done;){var b=g.value;if(b<0)this.Rh.delete(b);else{var x,w=_r(this.Rh.get(b).keys());try{for(w.s();!(x=w.n()).done;){var B=x.value;B<0&&this.Rh.get(b).delete(B)}}catch(t){w.e(t)}finally{w.f()}}}}catch(t){v.e(t)}finally{v.f()}this.ph=-1,this.mh=-1}}),ci);function Pr(t){return(Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ur(t){return function(t){if(Array.isArray(t))return Lr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ir(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rr(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=Ir(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ir(t,e){var n;if(t)return"string"==typeof t?Lr(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lr(t,e):void 0}function Lr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Dr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Pr(t=function(t,e){if("object"!==Pr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Pr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(t,e,n){return e&&Dr(t.prototype,e),n&&Dr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Er=null,this.Ht=null,this.Qt=null,this.zo=null,this.vf=null,this.wr=null,this.yf=new Map,this.rc=new Map,this.jn=a.ROUTE_FAILED_CANNOT_ARRIVE,this.nc=[],this.ic=null,this.ec=[],this.Cf=null,this.Uf=[],this.Bf=!1,this.barrierFree=!1,this.Yf=[],this.oc=null});var Qr=(Object.assign(ci.prototype,{Ai:function(t){this.Er=t,this.wr=t.type,this.oc=t.bid||null;var e,n=new Map,i=Rr(this.rc.keys());try{for(i.s();!(e=i.n()).done;){var r=e.value;n.set(r,this.rc.get(r).df)}}catch(t){i.e(t)}finally{i.f()}var o,s=new Map,a=Rr(this.rc.keys());try{for(a.s();!(o=a.n()).done;){var A=o.value;s.set(A,this.rc.get(A).pf)}}catch(t){a.e(t)}finally{a.f()}t={gate:this.Er.gate,bidToOutline:n,bidToOutlineAccess:s,type:this.wr,barrierFree:this.barrierFree},this.sc=new Or(t)},$f:function(t,e,n,i){this.li(),t.buildingID=void 0!==t.buildingID?t.buildingID:this.oc,e.buildingID=void 0!==e.buildingID?e.buildingID:this.oc,this.Ht=t,this.Qt=e,this.zo=n,this.vf=i;var r=[];if(this.Ht.buildingID==this.Qt.buildingID){var o=[[{pts:[t.x,t.y],bid:t.buildingID||null,level:t.level},{pts:[e.x,e.y],bid:e.buildingID||null,level:e.level}]];if(this.jn=this.uc(o),this.jn==a.ROUTE_SUCCESS||this.jn==a.ROUTE_FAILED_NO_START_ARRIVAL||this.jn==a.ROUTE_FAILED_NO_DEST_ARRIVAL)return this.jn;if(null==this.sc)return this.jn}if(0==(o=this.fc(t,e)).length)this.jn=a.ROUTE_FAILED_ENTRANCE;else{for(var s=0;s<o.length;s++)r.push(o[s][0].bid);n=this.uc(o),this.jn=n}return this.jn},li:function(){this.jn=a.ROUTE_FAILED_CANNOT_ARRIVE,this.nc=[],this.ic=null,this.ec=[]},fc:function(t,e){var n=[];if(this.ac(t,e)===a.ROUTE_SUCCESS)for(var i=this.hc()[0],r=[],o=0;o<i.length-1;o++){var s=i[o],A=i[o+1];0===r.length&&r.push(s),s.bid===A.bid?(r.push(A),o==i.length-2&&n.push(r)):(n.push(r),r=[])}return n},uc:function(t){var e,n=new Map,i=new Map;null!=(e=this.sc)&&e.bh&&(i=this.sc.bh);for(var r=0;r<t.length;){if(t[r].length<=1)return a.ROUTE_FAILED_CANNOT_ARRIVE;for(var o=0;o<t[r].length-1;o++){var s,A=((s={}).x=t[r][o].pts[0],s.y=t[r][o].pts[1],s.level=t[r][o].level,t[r][o].xn),l={},u=(l.x=t[r][o+1].pts[0],l.y=t[r][o+1].pts[1],l.level=t[r][o+1].level,t[r][o+1].xn),h=t[r][o].bid;if((s=(this.rc.get(h),this.cc(s,l,h)))===a.ROUTE_SUCCESS){if(l=this.lc(h),this.ec.push({bid:h,result:l}),o===t[r].length-2){r+=1;break}}else{if(l=i[h],1==t.length)return s;if(r==t.length-1){var c=t[r-1][o].xn,f=u,p=(n[h]=n[h]||[],n[h].push(A),n[h]);if(p.length===l.length)return s;if((c=this.vc(c,[f],p)).length<=1)return s;t.splice(r,1),t.splice(r-1,1),t.splice.apply(t,[r-1,0].concat(Ur(c))),r-=1,this.ec.pop();break}if(f=A,p=t[r+1][o+1].xn,n[h]=n[h]||[],n[h].push(u),(c=n[h]).length===l.length)return s;var d=this.vc(f,[p],c);if(!(1<d.length)){if(n[h].pop(),r<1)return s;var y=t[r-1][o].xn;if((A=(n[h]=n[h]||[],n[h].push(A),n[h])).length===l.length)return s;if((h=this.vc(y,[u],A)).length<=1)return s;t.splice(r,1),t.splice(r-1,1),t.splice.apply(t,[r-1,0].concat(Ur(h))),r-=1,this.ec.pop();break}t.splice(r+1,1),t.splice(r,1),t.splice.apply(t,[r,0].concat(Ur(d)))}}}return a.ROUTE_SUCCESS},vc:function(t,e,n){var i=[],r=[],o=[],s=[];if(this.sc.qh(t,e,n)){this.sc.es(e,i);for(var a=0;a<i.length;a++)i[a].paths.reverse();for(var A=0;A<i.length;A++){for(var l=[],u=0;u<i[A].paths.length;u++)this.barrierFree?l.push(this.sc.Eh.get(i[A].paths[u])):l.push(this.sc.Sh.get(i[A].paths[u]));r.push(l)}for(var h=r[0],c=0;c<h.length-1;c++){var f=h[c],p=h[c+1];0===o.length&&o.push(f),f.bid===p.bid?(o.push(p),c==h.length-2&&s.push(o)):(s.push(o),o=[])}}return s},cc:function(t,e,n){return(n=this.rc.get(n=void 0===n?null:n)).barrierFree=this.barrierFree,n.Bf=this.toDoors,n.$f(t,e,this.zo,this.vf)},yc:function(){return this.ec},bc:function(t){for(var e=[],n=0;n<t.length;n++){var i=this.lc(t[n]);e.push({bid:t[n],result:i})}return e},lc:function(t){var e=(t=this.rc.get(t=void 0===t?null:t)).aa();return this.Cf=t.Cf,e},ac:function(t,e){var n=a.ROUTE_FAILED_CANNOT_ARRIVE;return this.sc.li(),this.sc.kh=this.barrierFree,this.sc.Yh(t)&&this.sc.Xh(e)?this.sc.Jo():n},hc:function(){for(var t=this.sc.ns(),e=[],n=0;n<t.length;n++){for(var i=[],r=0;r<t[n].paths.length;r++)this.barrierFree?i.push(this.sc.Eh.get(t[n].paths[r])):i.push(this.sc.Sh.get(t[n].paths[r]));e.push(i)}return e},va:function(t,e){var n=void 0!==t.buildingID?t.buildingID:this.oc;return(n=this.rc.get(n).va(t,e))&&void 0!==t.buildingID&&(n.coords.buildingID=t.buildingID),n},vu:function(t){for(var e=new Map,n=0;n<t.length;n++){var i=t[n],r=e.get(i.oc);r||e.set(i.oc,r=[]),r.push(i)}var o,s=Rr(e.keys());try{for(s.s();!(o=s.n()).done;){var a=o.value;this.rc.get(a).vu(t)}}catch(t){s.e(t)}finally{s.f()}},uu:function(){for(var t in this.Uf){var e=parseInt(t);t=((e=this.rc.get(e)).Uf=this.Uf[t],e.uu(),e.aa());(e=this.ec).push.apply(e,Ur(t))}},qf:function(t,e,n,i){this.Ht=t,this.Qt=e,this.zo=n,this.vf=i;for(var r=!1,o=0;o<this.Yf.length;o++)this.Yf[o].Ks=!0,this.Yf[o].order?r=!0:r&&(this.Yf[o].order=Number.MAX_VALUE);r&&this.Yf.sort(function(t,e){return t.order-e.order}),this.Yf.unshift(t),this.Yf.push(e);for(var s=0;s<this.Yf.length;s++)this.Yf[s].buildingID=void 0!==this.Yf[s].buildingID?this.Yf[s].buildingID:this.oc;return r?this.dc(this.Yf):(n=this.mc(this.Yf),i=null,this.sc&&(this.sc.Ih=n,this.sc.Ah=!0,this.sc.Mh=t.buildingID,this.sc.Nh=e.buildingID,i=this.sc.Jh()),this.wc(t,e,i,this.Yf))},mc:function(t){for(var e=new Map,n=0;n<t.length;n++){var i=t[n].buildingID||null;e.has(i)||e.set(i,[]),e.get(i).push(t[n])}return e},wc:function(t,e,n,i){var r=[],o=null;if(i.shift(),i.pop(),n)for(var s=this.mc(i),A=0;A<n.length;A++){var l,u,h,c,f,p=n[A].bid;if(0==A?(u={x:n[A].entrances[0].pts[0],y:n[A].entrances[0].pts[1],level:n[A].entrances[0].level},s.has(p)?(l=s.get(p),o=this.xc(t,u,p,l),s.delete(p)):o=this.cc(t,u,p)):A==n.length-1?(l={x:n[A].entrances[0].pts[0],y:n[A].entrances[0].pts[1],level:n[A].entrances[0].level},s.has(p)?(u=s.get(p),o=this.xc(l,e,p,u),s.delete(p)):o=this.cc(l,e,p)):(h={x:n[A].entrances[0].pts[0],y:n[A].entrances[0].pts[1],level:n[A].entrances[0].level},c={x:n[A].entrances[1].pts[0],y:n[A].entrances[1].pts[1],level:n[A].entrances[1].level},s.has(p)?(f=s.get(p),o=this.xc(h,c,p,f),s.delete(p)):o=this.cc(h,c,p)),o!==a.ROUTE_SUCCESS)break;y=this.lc(p),r.push({bid:p,result:y})}else{var d=t.buildingID||null,y=(o=this.xc(t,e,d,i),this.lc(d));r.push({bid:d,result:y})}return this.ec=r,this.jn=o},dc:function(t){for(var e,n=[],i=null,r=null,o=0;o<t.length-1;o++)if(t[o].buildingID==t[o+1].buildingID){var s=t[o].buildingID;if((i=this.toDoors&&0<o?(f=(r=e).result[r.result.length-1].Yi,(p=t[o]).x=f[f.length-1].x,p.y=f[f.length-1].y,this.cc(p,t[o+1],s)):this.cc(t[o],t[o+1],s))!=a.ROUTE_SUCCESS)return i;if(e={bid:s,result:this.lc(s)},0<n.length){if(e.bid===n[n.length-1].bid)for(var A,l=n[n.length-1].result.length,u=n[n.length-1].result[l-1],h=!0,c=0;c<e.result.length;c++)u.Zi==e.result[c].Zi&&1<e.result[c].zi.length&&h?(n[n.length-1].result[l-1].Vi+=e.result[c].Vi,e.result[c].zi.shift(),e.result[c].Yi.shift(),(A=n[n.length-1].result[l-1].zi).push.apply(A,Ur(e.result[c].zi)),(A=n[n.length-1].result[l-1].Yi).push.apply(A,Ur(e.result[c].Yi))):(h=h&&!1,n[n.length-1].result.push(e.result[c]))}else n.push(e)}else{var f,p,d=this.toDoors&&0<o?(f=(r=e[e.length-1]).result[r.result.length-1].Yi,(p=t[o]).x=f[f.length-1].x,p.y=f[f.length-1].y,this.fc(p,this.Yf[o+1])):this.fc(this.Yf[o],this.Yf[o+1]);if((i=this.uc(d))!=a.ROUTE_SUCCESS)return i;for(var y=[],m=0;m<d.length;m++)y.push(d[m][0].bid);e=this.bc(y),n.push.apply(n,Ur(e))}return this.ec=n,this.jn=i},xc:function(t,e,n,i){return(n=this.rc.get(n)).Yf=i,n.barrierFree=this.barrierFree,n.Bf=this.toDoors,n.zo=this.zo,n.vf=this.vf,i=n.qf(t,e),n.Yf=null,i},Mr:function(){this.Er=null,this.ec=null,this.nc=null,this.ic=null;var t,e=Rr(this.rc.keys());try{for(e.s();!(t=e.n()).done;){var n=t.value;this.rc.get(n).Mr()}}catch(t){e.e(t)}finally{e.f()}}}),ci);function kr(t){return(kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nr(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=Hr(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jr(t){return function(t){if(Array.isArray(t))return zr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Hr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hr(t,e){var n;if(t)return"string"==typeof t?zr(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zr(t,e):void 0}function zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Vr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===kr(t=function(t,e){if("object"!==kr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==kr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(){function t(e,n,i){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Er=Object.assign({tile:!0,isPreview:!1},e),this._c=new Map,this.gc=null,this.jc=[],this.Sc=[],this.Oc=[],this.isExistAccess=!0,this.isExistNavi=!0,this.isExistDrive=!0,this.load_cnt=0,this.sc=null,this.Ec=void 0!==e.mapID?e.mapID:null,this.Tc=null,this.Oi=!!e.map,this.Ei=e.map?e.map.getDataManager():new Vn,this.Rc=1,this.Mc={radius:.5,dash:{size:4,gap:2}},this.Mi=n,this.Ni=i,this.wr=e.type,this.Nc=new Map,this.kc=new Map,this.ki=ti.generateUUID(),this.Ac=null,this.Ai()}var e,n;return e=t,(n=[{key:"setObstructions",value:function(t){this.gc&&this.gc.vu(t)}},{key:"route",value:function(t,e,n){this.gc.toDoors=void 0!==t.toDoors&&t.toDoors,this.gc.obstruct=void 0===t.obstruct||t.obstruct,this.gc.barrierFree=void 0!==t.barrierFree&&t.barrierFree;var i;if((i=t.viapoints&&0<t.viapoints.length?(this.gc.Yf=t.viapoints,this.gc.qf(t.start,t.dest,t.mode||o.MODULE_SHORTEST,t.priority||s.PRIORITY_DEFAULT)):this.gc.$f(t.start,t.dest,t.mode||o.MODULE_SHORTEST,t.priority||s.PRIORITY_DEFAULT))===a.ROUTE_SUCCESS){this.jc=this.gc.yc();var r=null,l=null;this.Sc=[];for(var u=0;u<this.jc.length;u++)0<u&&(r=this.Er.bidToName.get(this.jc[u-1].bid)?this.Er.bidToName.get(this.jc[u-1].bid):"outdoor"),u<this.jc.length-1&&(l=this.Er.bidToName.get(this.jc[u+1].bid)?this.Er.bidToName.get(this.jc[u+1].bid):"outdoor"),this.jc[u].fh=r,this.jc[u].ah=l,l=r=null,this.jc[u].buildingName=this.Er.bidToName.get(this.jc[u].bid),this.Sc.push([this.Ic(this.jc[u],{language:A.ZH}),this.Ic(this.jc[u],{language:A.EN})]);this.Tc=this.gc.Cf,e&&e(this.Gi())}else n&&n(i)}},{key:"dispose",value:function(){this.Pc=null,this.jc=[],this.Sc=[],this.gc&&(this.gc.Mr(),this.gc=null)}},{key:"pathConstraint",value:function(t,e){return this.gc?this.gc.va(t,e):null}},{key:"getNaviGraph",value:function(t){var e=t.buildingID;t=t.level;return null!=e?null!=t?this.gc.yf.get(e).get(t):this.gc.yf.get(e):null!=t?this.gc.yf.get(null).get(t):jr(this.gc.yf.values())}},{key:"query",value:function(t,e,n,i){var r=[],o=n?this.gc.rc.get(n):this.gc.rc.get(null),s=i?o.bf:o.yf;if(s){if(null==t){var a,A=Nr(s.keys());try{for(A.s();!(a=A.n()).done;){var l=a.value;r.push({level:l,roadRanks:e,roadVector:s.get(l).Ze.slice(0)})}}catch(t){A.e(t)}finally{A.f()}}else if(null==e)r.push({level:t,roadRanks:e,roadVector:s.get(t).Ze.slice(0)});else{for(var u=[],h=s.get(t).Ze,c=0;c<e.length;c++)for(var f=0;f<h.length;f++)h[f].de===e[c]&&u.push(h[f]);r.push({level:t,roadRanks:e,roadVector:u})}for(var p=0;p<r.length;p++)for(var d=0;d<r[p].roadVector.length;d++)r[p].roadVector[d]=Object.assign({},this.Dc(r[p].roadVector[d])),n&&(r[p].roadVector[d].buildingID=n)}return r}},{key:"intersectionRoadsByCircle",value:function(t,e,n){var i;if(!n||!n.roadVector||n.roadVector.length<=0)return null;var r,o=null==n.roadVector[0].buildingID?null:n.roadVector[0].buildingID,s={center:t,radius:e,points:[]},a=t.x-e,A=t.x+e,l=t.y-e,u=t.y+e,h=[],c=new Map,f=Nr(n.roadVector);try{for(f.s();!(r=f.n()).done;){var p,d=r.value,y=ft.Bt(t,e,d.startPoint,d.endPoint);if(!(y.length<1)){var m=d.roadEntry,g=d.endId;if(ft.distance(d.endPoint,t)>e&&((m=m===oi.Entry_FORWARD?li:m)===oi.Entry_BACK&&(m=Ai),g=d.startId),m===Ai||m===ai){var v,b=Nr(y);try{for(b.s();!(v=b.n()).done;){var x=v.value;x.direction=m,x.Lc=g}}catch(t){b.e(t)}finally{b.f()}(p=s.points).push.apply(p,jr(y)),d.startPoint.x>=a&&d.startPoint.x<=A&&d.startPoint.y>=l&&d.startPoint.y<=u&&h.push(d.startId),d.endPoint.x>=a&&d.endPoint.x<=A&&d.endPoint.y>=l&&d.endPoint.y<=u&&h.push(d.endId)}}}}catch(t){f.e(t)}finally{f.f()}n=n.level;for(var w=(null==(i=this.gc.rc)?void 0:i.get(o)).yf.get(n).He,B=0,M=h;B<M.length;B++){var S=M[B];c.set(S,w.get(S))}var _,E=Nr(s.points);try{for(E.s();!(_=E.n()).done;){var T=_.value;T.branch=this.Fc(c,T.Lc,t.nodeID)}}catch(t){E.e(t)}finally{E.f()}return s}},{key:"queryNode",value:function(t){var e=t.buildingID?this.gc.rc.get(buildingID):this.gc.rc.get(null);if(null!=e){var n=(e=(t.barrierFree?e.bf:e.yf).get(t.level)).io(t.point);if(!(n<=0))for(var i=e.Ze,r=new Set,o=0;o<i.length;o++)if(n===i[o].ve){if(!r.has(i[o].he)&&ft._compare(t.point,i[o].Ht))return t.nodeID=i[o].he,t;if(!r.has(i[o].ce)&&ft._compare(t.point,i[o].Qt))return t.nodeID=i[o].ce,t;r.add(i[o].he),r.add(i[o].ce)}}return null}},{key:"constraintTrack",value:function(t){var e=[];if(!(null==t||t.length<=0)){for(var n=new Map,i=0;i<t.length;i++){var r=void 0===t[i].coords.buildingID?null:t[i].coords.buildingID;n.has(r)?n.get(r).push(t[i]):n.set(r,[t[i]])}if(!(n.size<=0)){var o,s=Nr(n.keys());try{for(s.s();!(o=s.n()).done;){for(var a=o.value,A=n.get(a),l=new Set,u=new Set,h=0;h<A.length;h++)l.add(A[h].coords.level),u.add(A[h].road.roadRank);if(l.size<=0)return e;var c=Array.from(l),f=Array.from(u);this.Cc(c,f,a)}}catch(t){s.e(t)}finally{s.f()}for(var p=t.length-1,d=0;d<p;d++){var y=this.Bc(t[d],t[d+1]);e.push(t[d].coords),e.push.apply(e,jr(y)),d+1==p&&e.push(t[d+1].coords)}}}return e}}])&&Vr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var Gr=(Object.assign(ci.prototype,{Ai:function(){this.Oi&&(t=this.Er.map.getMapOptions(),this.Er.mapID=t.mapID,this.Er.appName=t.appName,this.Er.key=t.key,this.Er.license=t.license,this.Er.mapURL=t.mapURL,this.Er.mapURLAbsolute=t.mapURLAbsolute,this.Er.navigationData=t.navigationData,this.Er.buildingOptions=t.buildingOptions,this.Er.type=this.wr);var t={buildingID:this.Er.mapID,appName:this.Er.appName,key:this.Er.key,license:this.Er.license,mapURL:this.Er.mapURL,mapURLAbsolute:this.Er.mapURLAbsolute,buildingOptions:this.Er.buildingOptions,navigationData:this.Er.navigationData,merge:this.Er.merge,loadNavi:!0,justDecode:!0,preLoad:!0,isPreview:"undefined"!=typeof KjWzhWlSj&&!!KjWzhWlSj.ProtoDef,tile:this.Er.tile,type:this.Er.type,bid:this.Er.buildingID||null,gate:null,isOutdoor:!0,uuid:this.ki};this.Ec||(this.Ec=this.Er.mapID),this._c.set(t.bid,t),this.Er.bidToMid=new Map,this.Er.bidToName=new Map,this.Er.bidToMid.set(t.bid,this.Ec),this.gc=new Qr,this.Li(t)},Li:function(t){var e=this;setTimeout(function(){t.tile?e.Ei.load(t,function(n,i){e.Fi(n,i,t)}):e.Ei.loadWhole(t,function(n,i){e.Fi(n,i,t)})},0)},Fi:function(t,e,n){if("error"===t)this.isExistAccess=!1,this.isExistNavi=!1,this.isExistDrive=!1;else if("scene"===t&&e.naviType&&"undefined"!=e.naviType&&0!=e.naviType){this.isExistAccess=!0,this.isExistNavi=!0,this.isExistDrive=!0;var i=e.naviType;1===i?(this.isExistAccess=!1,this.isExistNavi=!1,this.isExistDrive=!1):(8<=i&&(i-=8),this.isExistAccess=!1,4<=i?i-=4:this.wr===si.Drive&&(this.isExistDrive=!1),i<=0&&!this.isExistAccess&&this.wr===si.Walk&&(this.isExistNavi=!1)),this.load_cnt++,this.isExistAccess||this.isExistNavi||this.wr!==si.Walk?this.isExistDrive||this.wr!==si.Drive||this.Oc.push({buildingID:n.buildingID,error:"NONE_DRIVE_RODE_NETWORK",data:u.NONE_DRIVE_RODE_NETWORK}):this.Oc.push({buildingID:n.buildingID,error:"NONE_WALK_RODE_NETWORK",data:u.NONE_WALK_RODE_NETWORK})}else if("decode"===t){(i=new br(n)).Ai(e),this.gc.rc.set(n.bid,i),this.gc.yf.set(n.bid,i.yf),e.gate&&(this.Ac=e.gate.floors);for(var r=0;r<(null==(o=e.scene.buildings)?void 0:o.length);r++){var o=e.scene.buildings[r],s=((s={mapID:this.Er.mapID,buildingID:null,appName:this.Er.appName,key:this.Er.key,license:this.Er.license,mapURL:this.Er.mapURL,mapURLAbsolute:this.Er.mapURLAbsolute,merge:this.Er.merge,loadNavi:!0,justDecode:!0,preLoad:!0,isPreview:"undefined"!=typeof KjWzhWlSj,tile:this.Er.tile,type:this.Er.type,bid:null,isOutdoor:!1,uuid:this.ki}).buildingID=o.mid,s.bid=o.bid,Object.assign({},s));this._c.set(o.bid,s),this.Er.bidToMid.set(o.bid,o.mid),this.Er.bidToName.set(o.bid,o.name),this.Li(s)}this.gc.rc.size===this.Er.bidToMid.size&&(null!=this.Ac&&this.gc.Ai(Object.assign(this.Er,{gate:this.Ac})),0!==this.load_cnt&&this.Oc.length>=this.load_cnt?this.Ni&&this.Ni({result:this.Oc}):(this.Oc={state:t,error:"0",data:null},this.Mi&&this.Mi()))}},Gi:function(){for(var t={buildings:[],distance:0,subs:[],viapoints:[]},e=0;e<this.jc.length;e++){var n,i={buildingID:null,buildingName:null,levels:[],distance:0},r=this.jc[e].bid,o=this.jc[e].buildingName,s=this.Uc(this.jc[e],this.Sc[e],r),a=(i.levels=s.levels,i.distance=s.distance,t.distance+=i.distance,e!==this.jc.length-1&&s.subs[s.subs.length-1]&&(s.subs[s.subs.length-1].transfer=l.TRANSFER_ENTRANCE),i.buildingID=r==this.Ec?null:r,i.buildingName=o||null,Nr(s.subs));try{for(a.s();!(n=a.n()).done;){var A=n.value;A.buildingID=i.buildingID,A.buildingName=i.buildingName}}catch(t){a.e(t)}finally{a.f()}t.buildings.push(i),(r=t.subs).push.apply(r,jr(s.subs)),(o=t.viapoints).push.apply(o,jr(s.viapoints))}return t},Uc:function(t,e,n){if(0==t.length||0==e.length)return null;for(var i={viapoints:[],subs:[],levels:[],distance:0},r=e[0].descriptions,o=e[0].descriptionsData,s=e[1].descriptions,a=e[1].descriptionsData,A=e[0].ladderList,l=0,u=[],h=!1,c=[],f=0;f<o.length;f++){var p={instruction:{zh:null,en:null},waypoint:{points:null,direction:{zh:null,en:null}},viapoint:null,levels:null,distance:Number.NaN,buildingID:null},d=r[f],y=o[f],m=s[f],g=a[f];d=(p.instruction.zh=d,p.instruction.en=m,p.levels=[y.startLevel,y.endLevel],p.distance=void 0!==y.distance?y.distance:0,p.waypoint.direction.zh=[y.startDirection,y.endDirection||y.startDirection],p.waypoint.direction.en=[g.startDirection,g.endDirection||g.startDirection],p.levels[0]!=p.levels[1]?(h=!0,u.push.apply(u,jr(p.levels)),p.transfer=A[l],l+=1):0!=u.length&&u.slice(-1)[0]==p.levels[0]&&!h||(u.push(p.levels[0]),h=!1),this.Gc([y.startIndex,y.endIndex],u,t.result));p.waypoint.points=d.points,d.via&&-1==c.indexOf(d.via)&&(p.viapoint=Object.assign({},d.via.pr),i.viapoints.push(Object.assign({},d.via.pr)),c.push(d.via)),i.distance+=p.distance,p.buildingID=n,i.subs.push(p)}for(var v=0;v<u.length;v++)0!=i.levels.length&&i.levels.slice(-1)[0]==u[v]||i.levels.push(u[v]);return i.door=this.Tc,i},Gc:function(t,e,n){for(var i=[],r=[],o=null,s=[],a=0;a<n.length;a++){var A=n[a];if(s.push(A.Zi),e.toString()==s.toString()){var l=e[e.length-1],u=A.Yi,h=A.zi;if(void 0===t[0]||void 0===t[1])i.push(Object.assign({level:A.Zi},A.Yi[0])),r.push(A.zi[0]),A=n[a-1],i.unshift(Object.assign({level:A.Zi},A.Yi[0])),r.unshift(A.zi[0]);else for(var c=t[0];c<=t[1];c++)i.push({x:u[c].x,y:u[c].y,level:l}),r.push(h[c]);break}}return r.forEach(function(t){t.Ks&&(o=t)}),{points:i,via:o}},Ic:function(t,e){var n=t.bid,i=t.result;return this.Wc(i)?(i=new Mr(Object.assign({data:this.Ei.getDecode(this._c.get(n)),directionAssert:10,combineAsset:10,language:A.ZH},e)).uh(t),n=this.Zc(i[5]),{descriptions:i[0],descriptionsData:i[1],distance:i[2],distances:i[3],ladderList:n}):{}},Zc:function(t){for(var e=0;e<t.length;e++)switch(t[e]){case 1:t[e]=l.TRANSFER_LIFT;break;case 2:t[e]=l.TRANSFER_STAIR;break;case 3:t[e]=l.TRANSFER_ESCALATOR;break;case 4:t[e]=l.TRANSFER_ACCESSIBLE;break;case 5:t[e]=l.TRANSFER_RAMP;break;default:return}return t},Vc:function(t){this.gc.Uf=t,this.gc.uu(),this.jc=this._navi.aa()},Yc:function(){return this.jc},zc:function(t){var e=t||this.jc;if(!this.Wc(e))return[];var n,i=[];for(n in e)e[n].getPointList&&i.push.apply(i,jr(e[n].pointList));return i},Xc:function(t){var e=t||this.jc;if(!this.Wc(e))return[];for(var n=[],i=0;i<e.length;i++){for(var r=e[i],o=r.level,s=r.pointList,a={level:o,points:[]},A=0;A<s.length;A++)a.points.push(Object.assign({},s[A]));n.push(a)}return n},qc:function(t){if(t=t||this.jc,!this.Wc(t))return 0;var e=this.zc(t);if(0==e.length)return 0;for(var n=0,i=0;i<e.length-1;i++)n+=ft.dt(e[i],e[i+1]);return n},Hc:function(t){var e=t||this.jc;if(!this.Wc(e))return[];var n,i=[];for(n in e)!e[n].level||0!=n&&i[i.length-1]==e[n].level||i.push(e[n].level);return i},Qc:function(t,e){var n=e||this.jc;if(!this.Wc(n))return[];var i,r=[];for(i in n)n[i].level&&n[i].level==t&&(r=r.concat(n[i].pointList));return r},Wc:function(t){if(!Array.isArray(t))return!1;if(0==t.length)return!1;for(var e=0;e<t.length;e++)if(!(t[e]instanceof fi))return!1;return!0},Kc:function(t,e){if(0===t.length)return null;null==e&&(e={});for(var n=Object.assign({},this.Mc),i=(e&&e.style&&Object.assign(n,e.style),1===this.wr&&(n.color="#002FA7"),e&&e.height?e.height:this.Rc),r=[],o=0;o<t.length;o++)!function(){var e=(n=t[o]).pointList;if(0!==e.length){var n=n.level,s=[],a=(e.forEach(function(t){var e=parseFloat(""+t.x);t=parseFloat(""+t.y);s.push({x:e,y:t,z:i})}),e.length<2&&(a=parseFloat(""+e[0].x),e=parseFloat(""+e[0].y),s.push({x:a,y:e,z:i})),new fengmap.FMSegment);a.level=n,a.points=s,r.push(a)}}();return(n=new fengmap.FMLineMarker(Object.assign({segments:r},n))).passed=e&&e.passed?e.passed:this._linePassed,n},Dc:function(t){return{id:t.xn,startPoint:{x:t.Ht.x,y:t.Ht.y},endPoint:{x:t.Qt.x,y:t.Qt.y},startId:t.he,endId:t.ce,roadRank:t.de,roadEntry:t.pe}},Fc:function(t,e,n){if(0!=t.length&&null!=t.get(e)&&null!=t.get(n)){var i,r=new Map,o=Nr(t.keys());try{for(o.s();!(i=o.n()).done;){var s=i.value;r.set(s,!1)}}catch(t){o.e(t)}finally{o.f()}for(var a=[e];0<a.length;){var A=a[0];if(r.get(A))a.splice(0,1);else{if(r.set(A,!0),a.splice(0,1),A==n)return!1;var l=t.get(A);if(!l||2<l.length)return!0;for(var u=0;u<l.length;u++)a.push(l[u]._o)}}return!0}},Bc:function(t,e){var n=[];if(t.coords.buildingID==e.coords.buildingID&&t.coords.level==e.coords.level){var i=null==t.buildingID?null:t.buildingID,r=t.coords.level,o=this.Nc.get(i).get(r),s=t.road.id,a=e.road.id,A=o.get(s),l=(o=o.get(a),t.coords.buildingID),u=null==this.kc.get(l)?[]:this.kc.get(l);i=l?this.gc.rc.get(i):this.gc.rc.get(null);if(A!=o){for(var h=null,c=0;c<u.length;c++)if(u[c].level==r&&null!=u[c].ptsBwteenRoad){h=u[c].ptsBwteenRoad;break}null!=h&&null!=h.get(s)&&null!=h.get(s).get(a)?n=h.get(s).get(a):(A=i._multiFloorDijkstraMap.get(r),n=this.Jc(t,e,A),null==h?((h=new Map).set(s,new Map),h.get(s).set(a,n),u.push({level:r,ptsBwteenRoad:h}),this.kc.set(l,u)):(null==h.get(s)&&h.set(s,new Map),h.get(s).set(a,n)))}}return n},Cc:function(t,e,n,i){var r,o=new Map;if(null==(r=(n=null==n?null:n)?this.gc.rc.get(n):this.gc.rc.get(null)))return null;for(var s=i?r.bf:r.yf,a=0;a<t.length;a++){var A=t[a],l=s.get(A).Ze,u=[],h=void 0;if(null!=e&&0<e.length){for(var c=0;c<e.length;c++)for(var f=0;f<l.length;f++)l[f].de===e[c]&&u.push(l[f]);h=this.$c(u)}else h=this.$c(l);o.set(A,h)}this.Nc.set(n,o)},$c:function(t){for(var e=new Map,n=new Map,i=0,r=0;r<t.length;r++)n.set(t[r].xn,[0,0]),e.set(t[r].xn,-1);for(var o=0;o<t.length;o++){var s=t[o];if(1!=n.get(s.xn)[0]||1!=n.get(s.xn)[1]){for(var a=s.he,A=s.ce,l=new yi(s.Qt.x-s.Ht.x,s.Qt.y-s.Ht.y),u=o+1;u<t.length;u++){var h=t[u];if(s.de==h.de){var c=h.he,f=h.ce,p=e.get(s.xn),d=e.get(h.xn),y=void 0,m=(y=-1==p&&-1==d?-1:-1!=p&&(-1==d||p<=d)?p:d,new yi(h.Qt.x-h.Ht.x,h.Qt.y-h.Ht.y));if(0==n.get(s.xn)[0]){if(a==c){if(l.multiplyScalar(-1).angleTo(m)*ft.it()<=5){if(y=-1==y?++i:y,e.set(s.xn,y),e.set(h.xn,y),n.get(s.xn)[0]=1,-(n.get(h.xn)[0]=1)!=d&&d!=y){var g,v=Nr(e.keys());try{for(v.s();!(g=v.n()).done;){var b=g.value;e.get(b)==d&&e.set(b,y)}}catch(t){v.e(t)}finally{v.f()}}if(-1!=p&&p!=y){var x,w=Nr(e.keys());try{for(w.s();!(x=w.n()).done;){var B=x.value;e.get(B)==p&&e.set(B,y)}}catch(t){w.e(t)}finally{w.f()}}}continue}if(a==f){if(l.multiplyScalar(-1).angleTo(m.multiplyScalar(-1))*ft.it()<=5){if(y=-1==y?++i:y,e.set(s.xn,y),e.set(h.xn,y),n.get(s.xn)[0]=1,-(n.get(h.xn)[1]=1)!=d&&d!=y){var M,S=Nr(e.keys());try{for(S.s();!(M=S.n()).done;){var _=M.value;e.get(_)==d&&e.set(_,y)}}catch(t){S.e(t)}finally{S.f()}}if(-1!=p&&p!=y){var E,T=Nr(e.keys());try{for(T.s();!(E=T.n()).done;){var C=E.value;e.get(C)==p&&e.set(C,y)}}catch(t){T.e(t)}finally{T.f()}}}continue}}if(0==n.get(s.xn)[1])if(A==c){if(l.angleTo(m)*ft.it()<=5){if(y=-1==y?++i:y,e.set(s.xn,y),e.set(h.xn,y),n.get(s.xn)[1]=1,-(n.get(h.xn)[0]=1)!=d&&d!=y){var F,O=Nr(e.keys());try{for(O.s();!(F=O.n()).done;){var P=F.value;e.get(P)==d&&e.set(P,y)}}catch(t){O.e(t)}finally{O.f()}}if(-1!=p&&p!=y){var U,R=Nr(e.keys());try{for(R.s();!(U=R.n()).done;){var I=U.value;e.get(I)==p&&e.set(I,y)}}catch(t){R.e(t)}finally{R.f()}}}}else if(A==f&&l.angleTo(m.multiplyScalar(-1))*ft.it()<=5){if(y=-1==y?++i:y,e.set(s.xn,y),e.set(h.xn,y),n.get(s.xn)[1]=1,-(n.get(h.xn)[1]=1)!=d&&d!=y){var L,D=Nr(e.keys());try{for(D.s();!(L=D.n()).done;){var Q=L.value;e.get(Q)==d&&e.set(Q,y)}}catch(t){D.e(t)}finally{D.f()}}if(-1!=p&&p!=y){var k,N=Nr(e.keys());try{for(N.s();!(k=N.n()).done;){var j=k.value;e.get(j)==p&&e.set(j,y)}}catch(t){N.e(t)}finally{N.f()}}}}}-1==e.get(s.xn)&&e.set(s.xn,++i)}}return e},Jc:function(t,e,n){var i=[],r=t.coords,o=(t=t.road,e.coords),s=(e=e.road,n.ru(r)),a=n.ru(o);if(null!=t&&null!=e&&r.level==o.level&&t.extentID==e.extentID&&s==a){a=null;var A=r.level,l=ft.wt(o,t.startPoint)<=ft.wt(o,t.endPoint)?(a=t.startPoint,t.startID):(a=t.endPoint,t.endID);r=null,r=ft.wt(a,e.startPoint)<=ft.wt(a,e.endPoint)?(e.startPoint,e.startID):(e.endPoint,e.endID),t=(o=n.Go).jo(l),a=[o.jo(r)];if((e=n.Fu(s)).ts(o,t,a)){e.Yo=r;for(var u=e.ns(),h=u.length-1;0<=h;h--)i.push(Object.assign({level:A},u[h].pr))}}return i}}),ci);function Yr(t){return(Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kr(t,e){return(Kr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function Xr(t){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Wr(t){return(Wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zr(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function qr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Wr(t=function(t,e){if("object"!==Wr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Wr(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}ci=function(){var t=i,e=Gr;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kr(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=Xr(t);if(n=e?(n=Xr(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===Yr(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return n.call(this,t,e,r);throw new TypeError("Cannot call a class as a function")}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}();var Jr=function(t,e,n){return e&&qr(t.prototype,e),n&&qr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.oc=void 0!==e.buildingID?e.buildingID:null,this.Zi=void 0!==e.level?e.level:null,this.Se=void 0!==e.points?e.points:null,this.Mu=-1,this.sr=null,this.Ai()});function $r(t){return($r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function to(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===$r(t=function(t,e){if("object"!==$r(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==$r(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function eo(t,e){return(eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function no(t){return(no=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.assign(Jr.prototype,{Ai:function(){this.Se&&(this.sr=new yt,this.sr.ir(this.Se),this.Mu=this.Se.length,this.Se[0].x==this.Se[this.Mu-1].x&&this.Se[0].y==this.Se[this.Mu-1].y?this.Mu--:this.Se.push(this.Se[0]))},uf:function(t,e){return ft.ft(t,e,this.sr.tr,this.sr.rr)},To:function(t){return!!ft.ct(t,this.sr.min,this.sr.max)&&ft.yt(t,this.Se,this.Mu)},tl:function(t){var e=0;return this.To(t[0])&&(e|=1),this.To(t[1])&&(e|=2),e},Eo:function(t,e){if(!ft.ft(t[0],t[1],this.sr.min,this.sr.max))return!1;for(var n,i,r=!1,o=0;o<this.Mu;o++){var s={};1==ft.Ot(t[0],t[1],this.Se[o],this.Se[o+1],s)&&(r=!0,e.push(s))}return t[0].x!=t[1].x?(n=t[0].x<t[1].x,e.sort(function(t,e){return n?t.x-e.x:e.x-t.x})):(i=t[0].y<t[1].y,e.sort(function(t,e){return i?t.y-e.y:e.y-t.y})),r},rl:function(t,e){for(var n=[],i=(n.push(t[0]),n.push.apply(n,function(t){return function(t){if(Array.isArray(t))return Zr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?Zr(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Zr(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e)),n.push(t[1]),[]),r=0;r<n.length-1;r++)i.push([n[r],n[r+1]]);return i},Da:function(t){if(this.oc!=t.bid||this.Zi!=t.Zi)return!1;if(this.Se.length!=t.Se.length)return!1;for(var e=0;e<this.Se.length;e++){if(this.Se[e].x!=t.Se[e].x)return!1;if(this.Se[e].y!=t.Se[e].y)return!1}return!0}});var io=function(){var t=i,e=Gr;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eo(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=no(t);if(n=e?(n=no(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===$r(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return t.type=si.Drive,n.call(this,t,e,r);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"route",value:function(t,e,n){this.gc.obstruct=void 0===t.obstruct||t.obstruct;var i;if((i=t.viapoints&&0<t.viapoints.length?(this.gc.Yf=t.viapoints,this.gc.qf(t.start,t.dest)):this.gc.$f(t.start,t.dest,t.mode||o.MODULE_SHORTEST,t.priority||s.PRIORITY_DEFAULT))===a.ROUTE_SUCCESS){this.jc=this.gc.yc();var r=null,l=null;this.Sc=[];for(var u=0;u<this.jc.length;u++)0<u&&(r=this.Er.bidToName.get(this.jc[u-1].bid)?this.Er.bidToName.get(this.jc[u-1].bid):"outdoor"),u<this.jc.length-1&&(l=this.Er.bidToName.get(this.jc[u+1].bid)?this.Er.bidToName.get(this.jc[u+1].bid):"outdoor"),this.jc[u].fh=r,this.jc[u].ah=l,l=r=null,this.jc[u].buildingName=this.Er.bidToName.get(this.jc[u].bid),this.Sc.push([this.Ic(this.jc[u],{language:A.ZH,type:si.Drive}),this.Ic(this.jc[u],{language:A.EN,type:si.Drive})]);this.Tc=this.gc.Cf,e&&e(this.Gi())}else n&&n(i)}}])&&to(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}();function ro(t){return(ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oo(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ro(t=function(t,e){if("object"!==ro(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ro(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function so(t,e){return(so=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ao(t){return(ao=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Ao,lo=function(){var t=i,e=Gr;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&so(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ao(t);if(n=e?(n=ao(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===ro(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return t.type=si.Walk,n.call(this,t,e,r);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"route",value:function(t,e,n){this.gc.toDoors=void 0!==t.toDoors&&t.toDoors,this.gc.obstruct=void 0===t.obstruct||t.obstruct,this.gc.barrierFree=void 0!==t.barrierFree&&t.barrierFree;var i;if((i=t.viapoints&&0<t.viapoints.length?(this.gc.Yf=t.viapoints,this.gc.qf(t.start,t.dest,t.mode||o.MODULE_SHORTEST,t.priority||s.PRIORITY_DEFAULT)):this.gc.$f(t.start,t.dest,t.mode||o.MODULE_SHORTEST,t.priority||s.PRIORITY_DEFAULT))===a.ROUTE_SUCCESS){this.jc=this.gc.yc();var r=null,l=null;this.Sc=[];for(var u=0;u<this.jc.length;u++)0<u&&(r=this.Er.bidToName.get(this.jc[u-1].bid)?this.Er.bidToName.get(this.jc[u-1].bid):"outdoor"),u<this.jc.length-1&&(l=this.Er.bidToName.get(this.jc[u+1].bid)?this.Er.bidToName.get(this.jc[u+1].bid):"outdoor"),this.jc[u].fh=r,this.jc[u].ah=l,l=r=null,this.jc[u].buildingName=this.Er.bidToName.get(this.jc[u].bid),this.Sc.push([this.Ic(this.jc[u],{language:A.ZH}),this.Ic(this.jc[u],{language:A.EN})]);this.Tc=this.gc.Cf,e&&e(this.Gi())}else n&&n(i)}}])&&oo(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),uo=(n=n(28),{VERSION:i,BUILD:70,XMLHttpRequest:n.a,FMType:r,FMNaviMode:o,FMNaviPriority:s,FMRouteResult:a,FMLanguageType:A,FMNaviTransfer:l,FMRoadNetworkResult:u,FMSearchRequest:f,FMSearchAnalyser:te,FMNaviAnalyser:ci,FMNaviObstruction:Jr,FMNaviDriveAnalyser:io,FMNaviWalkAnalyser:lo}),ho=void 0!==(n=zt.a.global())?n.fengmap:{};for(Ao in void 0===ho&&(ho={}),uo)ho[Ao]=uo[Ao];void 0!==n&&(n.fengmap=ho),e.default=ho}]).default},module.exports=r(__webpack_require__("Ya8g"))},fqQU:function(t,e){},kKzE:function(t,e,n){var i;i=function(){return e=[function(t,e,n){"use strict";function i(){var t=0,e=document.createElement("div");function n(t){return e.appendChild(t.dom),t}function r(n){for(var i=0;i<e.children.length;i++)e.children[i].style.display=i===n?"block":"none";t=n}e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(n){n.preventDefault(),r(++t%e.children.length)},!1);var o,s=(performance||Date).now(),a=s,A=0,l=n(new i.Panel("FPS","#0ff","#002")),u=n(new i.Panel("MS","#0f0","#020"));return self.performance&&self.performance.memory&&(o=n(new i.Panel("MB","#f08","#201"))),r(0),{REVISION:16,dom:e,addPanel:n,showPanel:r,begin:function(){s=(performance||Date).now()},end:function(){A++;var t,e=(performance||Date).now();return u.update(e-s,200),a+1e3<=e&&(l.update(1e3*A/(e-a),100),a=e,A=0,o)&&(t=performance.memory,o.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)),e},update:function(){s=this.end()},domElement:e,setMode:r}}n.r(e),i.Panel=function(t,e,n){var i=1/0,r=0,o=Math.round,s=o(window.devicePixelRatio||1),a=80*s,A=48*s,l=3*s,u=2*s,h=3*s,c=15*s,f=74*s,p=30*s,d=document.createElement("canvas"),y=(d.width=a,d.height=A,d.style.cssText="width:80px;height:48px",d.getContext("2d"));return y.font="bold "+9*s+"px Helvetica,Arial,sans-serif",y.textBaseline="top",y.fillStyle=n,y.fillRect(0,0,a,A),y.fillStyle=e,y.fillText(t,l,u),y.fillRect(h,c,f,p),y.fillStyle=n,y.globalAlpha=.9,y.fillRect(h,c,f,p),{dom:d,update:function(A,m){i=Math.min(i,A),r=Math.max(r,A),y.fillStyle=n,y.globalAlpha=1,y.fillRect(0,0,a,c),y.fillStyle=e,y.fillText(o(A)+" "+t+" ("+o(i)+"-"+o(r)+")",l,u),y.drawImage(d,h+s,c,f-s,p,h,c,f-s,p),y.fillRect(h+f-s,c,s,p),y.fillStyle=n,y.globalAlpha=.9,y.fillRect(h+f-s,c,s,o((1-A/m)*p))}}};var r=i;function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e,n){return(e=A(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,A(i.key),i)}}function A(t){return"symbol"===o(t=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==o(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}var l=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.map=e,this.info={extent:{faceCount:0,vertexCount:0},model:{faceCount:0,vertexCount:0},externalModel:{faceCount:0,vertexCount:0},tiles3d:{faceCount:0,vertexCount:0}},this.initDom()}var e,n;return e=t,(n=[{key:"initDom",value:function(){this.domElement=document.createElement("div"),this.domElement.classList.add("fengmap-performance-container"),this.domElement.innerHTML='\n    <div class="fengmap-performance-layer extent">\n      <div class="fengmap-performance-title">extent</div>\n      <div class="fengmap-performance-item">&nbsp;&nbsp;&nbsp;&nbsp;: <span class="face">0</span> </div>\n      <div class="fengmap-performance-item">: <span class="vertex">0</span> </div>\n    </div>\n\n    <div class="fengmap-performance-layer model">\n      <div class="fengmap-performance-title">model</div>\n      <div class="fengmap-performance-item">&nbsp;&nbsp;&nbsp;&nbsp;: <span class="face">0</span> </div>\n      <div class="fengmap-performance-item">:<span class="vertex">0</span> </div>\n    </div>\n\n    <div class="fengmap-performance-layer externalModel">\n      <div class="fengmap-performance-title">externalModel</div>\n      <div class="fengmap-performance-item">&nbsp;&nbsp;&nbsp;&nbsp;: <span class="face">0</span> </div>\n      <div class="fengmap-performance-item">:<span class="vertex">0</span> </div>\n    </div>\n\n\n    <div class="fengmap-performance-layer tiles3d">\n      <div class="fengmap-performance-title">tiles3d</div>\n      <div class="fengmap-performance-item">&nbsp;&nbsp;&nbsp;&nbsp;: <span class="face">0</span> </div>\n      <div class="fengmap-performance-item">:<span class="vertex">0</span> </div>\n    </div>\n    ';var t=document.createElement("style");t.textContent="\n      .fengmap-performance-container {\n        position: absolute;\n        top: 2px;\n        right: 2px;\n        cursor: pointer;\n        z-index: 10000;\n        width: 180px;\n        background-color: rgba(0,0,2,0.6);\n        padding: 8px;\n        border-radius: 4px;\n        font-family: sans-serif;\n        color: rgba(25,255,255,1);\n      }\n\n      .fengmap-performance-container span {\n        margin-left: 15px;\n        color:#fff;\n      }\n\n      .fengmap-performance-layer {\n        margin-bottom: 10px;\n      }\n\n      .fengmap-performance-title{\n        font-size: 18px;\n        margin-bottom: 2px;\n        color:#fff;\n      }\n\n      .fengmap-performance-item {\n        margin-left: 20px;\n        font-size: 14px;\n      }\n    ",document.getElementsByTagName("HEAD").item(0).appendChild(t)}},{key:"handleLayer",value:function(t,e){var n,i=this;e!==fengmap.FMType.MODEL_LAYER&&e!==fengmap.FMType.EXTENT_LAYER&&e!==fengmap.FMType.EXTERNAL_MODEL_LAYER||(n=s(s(s({},fengmap.FMType.EXTENT_LAYER,"extent"),fengmap.FMType.MODEL_LAYER,"model"),fengmap.FMType.EXTERNAL_MODEL_LAYER,"externalModel")[e],t.traverse(function(t){var r;"Mesh"===t.type&&(e===fengmap.FMType.EXTERNAL_MODEL_LAYER?t.geometry.attributes?(i.info[n].vertexCount+=t.geometry.attributes.position.count,i.info[n].faceCount+=t.geometry.index.count/3):t.geometry.faces&&(i.info[n].faceCount+=null!=(r=null==(r=t.geometry)||null==(r=r.faces)?void 0:r.length)?r:0,i.info[n].vertexCount+=null!=(r=null==(r=t.geometry)||null==(r=r.vertices)?void 0:r.length)?r:0):(i.info[n].faceCount+=null!=(r=null==(r=t.geometry)||null==(r=r.faces)?void 0:r.length)?r:0,i.info[n].vertexCount+=null!=(t=null==(r=t.geometry)||null==(r=r.vertices)?void 0:r.length)?t:0))}),document.querySelector(".".concat(n," .face")).innerText=Number(this.info[n].faceCount).toLocaleString(),document.querySelector(".".concat(n," .vertex")).innerText=Number(this.info[n].vertexCount).toLocaleString())}},{key:"clear",value:function(){this.info.extent.faceCount=0,this.info.extent.vertexCount=0,this.info.model.faceCount=0,this.info.model.vertexCount=0,this.info.externalModel.faceCount=0,this.info.externalModel.vertexCount=0,this.info.tiles3d.faceCount=0,this.info.tiles3d.vertexCount=0}},{key:"handleTile3d",value:function(){for(var t=this,e=this.map.getRenderManager().get3DTilesLayerSceneArr(),n="tiles3d",i=0;i<e.length;i++){var r=e[i];r&&r.traverse(function(e){"Mesh"===e.type&&(t.info[n].vertexCount+=e.geometry.attributes.position.count,t.info[n].faceCount+=e.geometry.index.count/3)})}document.querySelector(".".concat(n," .face")).innerText=Number(this.info[n].faceCount).toLocaleString(),document.querySelector(".".concat(n," .vertex")).innerText=Number(this.info[n].vertexCount).toLocaleString()}},{key:"update",value:function(){var t=this;this.map&&(this.clear(),this.map.getRenderManager().getRenderList().forEach(function(e,n){n=n.split("%A%B%C%D")[2],t.handleLayer(e,+n)}),this.handleTile3d())}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===u(t=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==u(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}n=function(){function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.u=e,this.v=!0,this.h=void 0===n.needUpdateVertex||n.needUpdateVertex,this.g=void 0===n.needUpdateFPS||n.needUpdateFPS,this.initFPS(),this.initVertex(e),this.update=this.update.bind(this),this.visible=!0}var e,n;return e=t,(n=[{key:"visible",get:function(){return this.v},set:function(t){(this.v=t)?(this.u.on("update",this.update),this.S.domElement.style.top="2px",this.j.domElement.style.top="2px"):(this.u.off("update",this.update),this.S.domElement.style.top="-9999px",this.j.domElement.style.top="-9999px")}},{key:"update",value:function(){this.g&&this.S.update(),this.h&&this.j.update()}},{key:"initFPS",value:function(){this.S=new r,this.S.setMode(0),this.S.domElement.style.position="absolute",this.S.domElement.style.left="2px",document.body.appendChild(this.S.domElement)}},{key:"initVertex",value:function(t){this.j=new l(t),this.j.domElement.style.position="absolute",this.j.domElement.style.right="2px",document.body.appendChild(this.j.domElement)}}])&&h(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var c=window.fengmap||{};c.FMPerformance=n,e.default=c}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"M",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.M)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.M?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=0).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()},o2Cy:function(t,e,n){var i;i=function(){return e=[function(t,e,n){"use strict";n.r(e);n={MODULE_SHORTEST:1,MODULE_BEST:2};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){return"symbol"===i(t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==i(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(r.key),r)}}var o=function(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}),s=(Object.assign(o.prototype,{h:function(t,e){void 0===this.u&&(this.u={});var n=this.u;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},v:function(t,e){var n;return void 0!==this.u&&void 0!==(n=this.u)[t]&&-1!==n[t].indexOf(e)},M:function(t,e){var n;void 0!==this.u&&void 0!==(t=this.u[t])&&-1!==(n=t.indexOf(e))&&t.splice(n,1)},k:function(t){if(void 0!==this.u){var e=this.u[t.type];if(void 0!==e)for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t)}}}),o);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===a(t=function(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==a(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var l=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var e,n;return e=t,(n=[{key:"start",value:function(){this.startTime=u(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t,e=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(e=((t=u())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e),e)}}])&&A(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(){return("undefined"==typeof performance?Date:performance).now()}for(var h=[],c=0;c<256;c++)h[c]=(c<16?"0":"")+c.toString(16);var f=1234567,p={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(h[255&t]+h[t>>8&255]+h[t>>16&255]+h[t>>24&255]+"-"+h[255&e]+h[e>>8&255]+"-"+h[e>>16&15|64]+h[e>>24&255]+"-"+h[63&n|128]+h[n>>8&255]+"-"+h[n>>16&255]+h[n>>24&255]+h[255&i]+h[i>>8&255]+h[i>>16&255]+h[i>>24&255]).toUpperCase()},clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:n<=t?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return((f=16807*(f=void 0!==t?t%2147483647:f)%2147483647)-1)/2147483646},degToRad:function(t){return t*p.DEG2RAD},radToDeg:function(t){return t*p.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,n,i,r){var o=Math.cos,s=Math.sin,a=o(n/2),A=s(n/2),l=o((e+i)/2),u=s((e+i)/2),h=o((e-i)/2),c=s((e-i)/2),f=o((i-e)/2),p=s((i-e)/2);switch(r){case"XYX":t.set(a*u,A*h,A*c,a*l);break;case"YZY":t.set(A*c,a*u,A*h,a*l);break;case"ZXZ":t.set(A*h,A*c,a*u,a*l);break;case"XZX":t.set(a*u,A*p,A*f,a*l);break;case"YXY":t.set(A*f,a*u,A*p,a*l);break;case"ZYZ":t.set(A*p,A*f,a*u,a*l)}}};function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===d(t=function(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==d(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===m(t=function(t,e){if("object"!==m(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==m(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}o=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isQuaternion",{value:!0}),this.g=e,this.S=n,this._=i,this.j=r}var e,n,i;return e=t,i=[{key:"slerp",value:function(t,e,n,i){return n.copy(t).slerp(e,i)}},{key:"slerpFlat",value:function(t,e,n,i,r,o,s){var a,A,l,u=n[i+0],h=n[i+1],c=n[i+2],f=(n=n[i+3],i=r[o+0],r[o+1]),p=r[o+2];n===(r=r[o+3])&&u===i&&h===f&&c===p||(o=1-s,a=0<=(A=u*i+h*f+c*p+n*r)?1:-1,(l=1-A*A)>Number.EPSILON&&(l=Math.sqrt(l),A=Math.atan2(l,A*a),o=Math.sin(o*A)/l,s=Math.sin(s*A)/l),u=u*o+i*(A=s*a),h=h*o+f*A,c=c*o+p*A,n=n*o+r*A,o===1-s&&(u*=l=1/Math.sqrt(u*u+h*h+c*c+n*n),h*=l,c*=l,n*=l)),t[e]=u,t[e+1]=h,t[e+2]=c,t[e+3]=n}},{key:"multiplyQuaternionsFlat",value:function(t,e,n,i,r,o){var s=n[i],a=n[i+1],A=n[i+2],l=(n=n[i+3],i=r[o],r[o+1]),u=r[o+2];r=r[o+3];return t[e]=s*r+n*i+a*u-A*l,t[e+1]=a*r+n*l+A*i-s*u,t[e+2]=A*r+n*u+s*l-a*i,t[e+3]=n*r-s*i-a*l-A*u,t}}],(n=[{key:"x",get:function(){return this.g},set:function(t){this.g=t,this.O()}},{key:"y",get:function(){return this.S},set:function(t){this.S=t,this.O()}},{key:"z",get:function(){return this._},set:function(t){this._=t,this.O()}},{key:"w",get:function(){return this.j},set:function(t){this.j=t,this.O()}},{key:"set",value:function(t,e,n,i){return this.g=t,this.S=e,this._=n,this.j=i,this.O(),this}},{key:"clone",value:function(){return new this.constructor(this.g,this.S,this._,this.j)}},{key:"copy",value:function(t){return this.g=t.x,this.S=t.y,this._=t.z,this.j=t.w,this.O(),this}},{key:"setFromEuler",value:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t.g,i=t.S,r=t._,o=t._order,s=(t=Math.cos,Math.sin),a=t(n/2),A=t(i/2),l=t(r/2),u=s(n/2),h=s(i/2),c=s(r/2);switch(o){case"XYZ":this.g=u*A*l+a*h*c,this.S=a*h*l-u*A*c,this._=a*A*c+u*h*l,this.j=a*A*l-u*h*c;break;case"YXZ":this.g=u*A*l+a*h*c,this.S=a*h*l-u*A*c,this._=a*A*c-u*h*l,this.j=a*A*l+u*h*c;break;case"ZXY":this.g=u*A*l-a*h*c,this.S=a*h*l+u*A*c,this._=a*A*c+u*h*l,this.j=a*A*l-u*h*c;break;case"ZYX":this.g=u*A*l-a*h*c,this.S=a*h*l+u*A*c,this._=a*A*c-u*h*l,this.j=a*A*l+u*h*c;break;case"YZX":this.g=u*A*l+a*h*c,this.S=a*h*l+u*A*c,this._=a*A*c-u*h*l,this.j=a*A*l-u*h*c;break;case"XZY":this.g=u*A*l-a*h*c,this.S=a*h*l-u*A*c,this._=a*A*c+u*h*l,this.j=a*A*l+u*h*c}return!1!==e&&this.O(),this}},{key:"setFromAxisAngle",value:function(t,e){e/=2;var n=Math.sin(e);return this.g=t.x*n,this.S=t.y*n,this._=t.z*n,this.j=Math.cos(e),this.O(),this}},{key:"setFromRotationMatrix",value:function(t){var e=(t=t.elements)[0],n=t[4],i=t[8],r=t[1],o=t[5],s=t[9],a=t[2],A=t[6],l=e+o+(t=t[10]);return 0<l?(l=.5/Math.sqrt(l+1),this.j=.25/l,this.g=(A-s)*l,this.S=(i-a)*l,this._=(r-n)*l):o<e&&t<e?(l=2*Math.sqrt(1+e-o-t),this.j=(A-s)/l,this.g=.25*l,this.S=(n+r)/l,this._=(i+a)/l):t<o?(l=2*Math.sqrt(1+o-e-t),this.j=(i-a)/l,this.g=(n+r)/l,this.S=.25*l,this._=(s+A)/l):(l=2*Math.sqrt(1+t-e-o),this.j=(r-n)/l,this.g=(i+a)/l,this.S=(s+A)/l,this._=.25*l),this.O(),this}},{key:"setFromUnitVectors",value:function(t,e){var n=t.dot(e)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.g=-t.y,this.S=t.x,this._=0):(this.g=0,this.S=-t.z,this._=t.y)):(this.g=t.y*e.z-t.z*e.y,this.S=t.z*e.x-t.x*e.z,this._=t.x*e.y-t.y*e.x),this.j=n,this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(p.clamp(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,e){var n=this.angleTo(t);return 0!==n&&(e=Math.min(1,e/n),this.slerp(t,e)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.g*=-1,this.S*=-1,this._*=-1,this.O(),this}},{key:"dot",value:function(t){return this.g*t.g+this.S*t.S+this._*t._+this.j*t.j}},{key:"lengthSq",value:function(){return this.g*this.g+this.S*this.S+this._*this._+this.j*this.j}},{key:"length",value:function(){return Math.sqrt(this.g*this.g+this.S*this.S+this._*this._+this.j*this.j)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this.g=0,this.S=0,this._=0,this.j=1):(this.g=this.g*(t=1/t),this.S=this.S*t,this._=this._*t,this.j=this.j*t),this.O(),this}},{key:"multiply",value:function(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,e){var n=t.g,i=t.S,r=t._,o=(t=t.j,e.g),s=e.S,a=e._;e=e.j;return this.g=n*e+t*o+i*a-r*s,this.S=i*e+t*s+r*o-n*a,this._=r*e+t*a+n*s-i*o,this.j=t*e-n*o-i*s-r*a,this.O(),this}},{key:"slerp",value:function(t,e){if(0!==e){if(1===e)return this.copy(t);var n,i=this.g,r=this.S,o=this._,s=this.j,a=s*t.j+i*t.g+r*t.S+o*t._;a<0?(this.j=-t.j,this.g=-t.g,this.S=-t.S,this._=-t._,a=-a):this.copy(t),1<=a?(this.j=s,this.g=i,this.S=r,this._=o):((t=1-a*a)<=Number.EPSILON?(this.j=(n=1-e)*s+e*this.j,this.g=n*i+e*this.g,this.S=n*r+e*this.S,this._=n*o+e*this._,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,a),a=Math.sin((1-e)*t)/n,e=Math.sin(e*t)/n,this.j=s*a+this.j*e,this.g=i*a+this.g*e,this.S=r*a+this.S*e,this._=o*a+this._*e),this.O())}return this}},{key:"equals",value:function(t){return t.g===this.g&&t.S===this.S&&t._===this._&&t.j===this.j}},{key:"fromArray",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.g=t[e],this.S=t[e+1],this._=t[e+2],this.j=t[e+3],this.O(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.g,t[e+1]=this.S,t[e+2]=this._,t[e+3]=this.j,t}},{key:"fromBufferAttribute",value:function(t,e){return this.g=t.getX(e),this.S=t.getY(e),this._=t.getZ(e),this.j=t.getW(e),this}},{key:"_onChange",value:function(t){return this.O=t,this}},{key:"_onChangeCallback",value:function(){}}])&&y(e.prototype,n),i&&y(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();var v=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isVector3",{value:!0}),this.x=e,this.y=n,this.z=i}var e,n;return e=t,(n=[{key:"set",value:function(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t,e){return void 0!==e?this.addVectors(t,e):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}},{key:"sub",value:function(t,e){return void 0!==e?this.subVectors(t,e):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}},{key:"multiply",value:function(t,e){return void 0!==e?this.multiplyVectors(t,e):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}},{key:"applyEuler",value:function(t){return t&&t.isEuler,this.applyQuaternion(x.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,e){return this.applyQuaternion(x.setFromAxisAngle(t,e))}},{key:"applyMatrix3",value:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[3]*n+t[6]*i,this.y=t[1]*e+t[4]*n+t[7]*i,this.z=t[2]*e+t[5]*n+t[8]*i,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var e=this.x,n=this.y,i=this.z,r=1/((t=t.elements)[3]*e+t[7]*n+t[11]*i+t[15]);return this.x=(t[0]*e+t[4]*n+t[8]*i+t[12])*r,this.y=(t[1]*e+t[5]*n+t[9]*i+t[13])*r,this.z=(t[2]*e+t[6]*n+t[10]*i+t[14])*r,this}},{key:"applyQuaternion",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,o=t.y,s=t.z,a=(t=t.w)*e+o*i-s*n,A=t*n+s*e-r*i,l=t*i+r*n-o*e;e=-r*e-o*n-s*i;return this.x=a*t+e*-r+A*-s-l*-o,this.y=A*t+e*-o+l*-r-a*-s,this.z=l*t+e*-s+a*-o-A*-r,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var e=this.x,n=this.y,i=this.z;t=t.elements;return this.x=t[0]*e+t[4]*n+t[8]*i,this.y=t[1]*e+t[5]*n+t[9]*i,this.z=t[2]*e+t[6]*n+t[10]*i,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}},{key:"clampScalar",value:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}},{key:"clampLength",value:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}},{key:"lerpVectors",value:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}},{key:"cross",value:function(t,e){return void 0!==e?this.crossVectors(t,e):this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,e){var n=t.x,i=t.y,r=(t=t.z,e.x),o=e.y;e=e.z;return this.x=i*e-t*o,this.y=t*r-n*e,this.z=n*o-i*r,this}},{key:"projectOnVector",value:function(t){var e=t.lengthSq();return 0===e?this.set(0,0,0):(e=t.dot(this)/e,this.copy(t).multiplyScalar(e))}},{key:"projectOnPlane",value:function(t){return b.copy(this).projectOnVector(t),this.sub(b)}},{key:"reflect",value:function(t){return this.sub(b.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===e?Math.PI/2:(t=this.dot(t)/e,Math.acos(p.clamp(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n+(t=this.z-t.z)*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}},{key:"setFromMatrixPosition",value:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length();t=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=t,this}},{key:"setFromMatrixColumn",value:function(t,e){return this.fromArray(t.elements,4*e)}},{key:"setFromMatrix3Column",value:function(t,e){return this.fromArray(t.elements,3*e)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,e,n){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}])&&g(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),b=new v,x=new o;function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function B(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===w(t=function(t,e){if("object"!==w(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==w(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}o=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.T={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}var e,n;return e=t,(n=[{key:"min",get:function(){return this.T}},{key:"max",get:function(){return this.R}},{key:"center",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}},{key:"size",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}},{key:"copy",value:function(t){return this.R.x=t.max.x,this.R.y=t.max.y,this.T.x=t.min.x,this.T.y=t.min.y,this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"reset",value:function(){this.T={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}},{key:"toObject",value:function(){return{min:this.min,max:this.max,center:this.center,size:this.size}}},{key:"expand",value:function(t){this.P(t)}},{key:"expandByCoords",value:function(t){this.I(t)}},{key:"valid",value:function(){return this.C()}},{key:"isCross",value:function(t){var e=!0;return t.max.x<this.min.x&&(e=!1),t.min.x>this.max.x&&(e=!1),t.max.y<this.min.y&&(e=!1),!(t.min.y>this.max.y)&&e}}])&&B(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var M=(Object.assign(o.prototype,{C:function(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},P:function(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},I:function(t){var e=this;t&&0!=t.length&&t.forEach(function(t){t.x<e.min.x&&(e.min.x=t.x),t.y<e.min.y&&(e.min.y=t.y),t.x>e.max.x&&(e.max.x=t.x),t.y>e.max.y&&(e.max.y=t.y)})}}),o),S=function(t,e,n){n=n||2;var i,r,o,s,a,A=e&&e.length,l=A?e[0]*n:t.length,u=_(t,0,l,n,!0),h=[];if(u&&u.next!==u.prev){if(A&&(u=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=_(t,s=e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(function(t){for(var e=t,n=t;(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),(e=e.next)!==t;);return n}(s));for(a.sort(T),r=0;r<a.length;r++)!function(t,e){(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}}while((i=i.next)!==e);if(!n)return null;if(r!==s){var A,l=n,u=n.x,h=n.y,c=1/0;for(i=n;r>=i.x&&i.x>=u&&r!==i.x&&F(o<h?r:s,o,u,h,o<h?s:r,o,i.x,i.y)&&(A=Math.abs(o-i.y)/(r-i.x),L(i,t))&&(A<c||A===c&&(i.x>n.x||i.x===n.x&&function(t,e){return O(t.prev,t,e.prev)<0&&O(e.next,t,t.next)<0}(n,i)))&&(n=i,c=A),(i=i.next)!==l;);}return n}(t,e))&&(t=D(e,t),E(e,e.next),E(t,t.next))}(a[r],n),n=E(n,n.next);return n}(t,e,u,n)),t.length>80*n){for(var c=i=t[0],f=r=t[1],p=n;p<l;p+=n)(o=t[p])<c&&(c=o),(s=t[p+1])<f&&(f=s),i<o&&(i=o),r<s&&(r=s);a=0!==(a=Math.max(i-c,r-f))?1/a:0}!function t(e,n,i,r,o,s,a){if(e){if(!a&&s){for(var A=e,l=r,u=o,h=s,c=A;null===c.z&&(c.z=C(c.x,c.y,l,u,h)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==A;);c.prevZ.nextZ=null,c.prevZ=null;var f,p,d,y,m,g,v,b,x=c,w=1;do{for(p=x,m=x=null,g=0;p;){for(g++,d=p,f=v=0;f<w&&(v++,d=d.nextZ);f++);for(b=w;0<v||0<b&&d;)0!==v&&(0===b||!d||p.z<=d.z)?(p=(y=p).nextZ,v--):(d=(y=d).nextZ,b--),m?m.nextZ=y:x=y,y.prevZ=m,m=y;p=d}}while(m.nextZ=null,w*=2,1<g)}for(var B,M,S=e;e.prev!==e.next;)if(B=e.prev,M=e.next,s?function(t,e,n,i){var r=t.prev,o=t,s=t.next;if(!(0<=O(r,o,s))){for(var a=(r.x<o.x?r.x<s.x?r:s:o.x<s.x?o:s).x,A=(r.y<o.y?r.y<s.y?r:s:o.y<s.y?o:s).y,l=(r.x>o.x?r.x>s.x?r:s:o.x>s.x?o:s).x,u=(r.y>o.y?r.y>s.y?r:s:o.y>s.y?o:s).y,h=C(a,A,e,n,i),c=C(l,u,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=h&&p&&p.z<=c;){if(f!==t.prev&&f!==t.next&&F(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=O(f.prev,f,f.next))return;if(f=f.prevZ,p!==t.prev&&p!==t.next&&F(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=O(p.prev,p,p.next))return;p=p.nextZ}for(;f&&f.z>=h;){if(f!==t.prev&&f!==t.next&&F(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=O(f.prev,f,f.next))return;f=f.prevZ}for(;p&&p.z<=c;){if(p!==t.prev&&p!==t.next&&F(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&0<=O(p.prev,p,p.next))return;p=p.nextZ}return 1}}(e,r,o,s):function(t){var e=t.prev,n=t,i=t.next;if(!(0<=O(e,n,i))){for(var r=t.next.next;r!==t.prev;){if(F(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=O(r.prev,r,r.next))return;r=r.next}return 1}}(e))n.push(B.i/i),n.push(e.i/i),n.push(M.i/i),k(e),e=M.next,S=M.next;else if((e=M)===S){a?1===a?t(e=function(t,e,n){var i=t;do{var r=i.prev,o=i.next.next}while(!P(r,o)&&U(r,i,i.next,o)&&L(r,o)&&L(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),k(i),k(i.next),i=t=o),(i=i.next)!==t);return E(i)}(E(e),n,i),n,i,r,o,s,2):2===a&&function(e,n,i,r,o,s){var a=e;do{for(var A,l=a.next.next;l!==a.prev;){if(a.i!==l.i&&function(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&U(n,n.next,t,e))return 1}while((n=n.next)!==t)}(t,e)&&(L(t,e)&&L(e,t)&&function(t,e){for(var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!==t;);return i}(t,e)&&(O(t.prev,t,e.prev)||O(t,e.prev,e))||P(t,e)&&0<O(t.prev,t,t.next)&&0<O(e.prev,e,e.next))}(a,l))return A=D(a,l),a=E(a,a.next),A=E(A,A.next),t(a,n,i,r,o,s),t(A,n,i,r,o,s);l=l.next}}while((a=a.next)!==e)}(e,n,i,r,o,s):t(E(e),n,i,r,o,s,1);break}}}(u,h,n,c,f,a)}return h};function _(t,e,n,i,r){var o,s;if(r===0<function(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}(t,e,n,i))for(o=e;o<n;o+=i)s=Q(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=Q(o,t[o],t[o+1],s);return s&&P(s,s.next)&&(k(s),s=s.next),s}function E(t,e){if(!t)return t;e=e||t;var n,i=t;do{if(n=!1,i.steiner||!P(i,i.next)&&0!==O(i.prev,i,i.next))i=i.next;else{if(k(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function T(t,e){return t.x-e.x}function C(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function F(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function O(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function P(t,e){return t.x===e.x&&t.y===e.y}function U(t,e,n,i){var r=I(O(t,e,n)),o=I(O(t,e,i)),s=I(O(n,i,t)),a=I(O(n,i,e));return r!==o&&s!==a||0===r&&R(t,n,e)||0===o&&R(t,i,e)||0===s&&R(n,t,i)||!(0!==a||!R(n,e,i))}function R(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function I(t){return 0<t?1:t<0?-1:0}function L(t,e){return O(t.prev,t,t.next)<0?0<=O(t,e,t.next)&&0<=O(t,t.prev,e):O(t,e,t.prev)<0||O(t,t.next,e)<0}function D(t,e){var n=new N(t.i,t.x,t.y),i=new N(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function Q(t,e,n,i){return t=new N(t,e,n),i?(t.next=i.next,(t.prev=i).next.prev=t,i.next=t):(t.prev=t).next=t,t}function k(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function N(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function j(t){return function(t){if(Array.isArray(t))return H(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){var n;if(t)return"string"==typeof t?H(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(t,e):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var z={area:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n},isClockWise:function(t){return z.area(t)<0},triangulateShape:function(t,e){var n=[],i=[],r=[],o=(V(t),G(n,t),t.length);e.forEach(V);for(var s=0;s<e.length;s++)i.push(o),o+=e[s].length,G(n,e[s]);for(var a=S(n,i),A=0;A<a.length;A+=3)r.push(a.slice(A,A+3));return r},triangulate:function(t){(r=[]).push.apply(r,j(t[0]));for(var e=[],n=1;n<t.length;n++){var i=[];i.push.apply(i,j(t[n])),e.push(i)}if(!z.isClockWise(r))for(var r=r.reverse(),o=0,s=e.length;o<s;o++){var a=e[o];z.isClockWise(a)&&(e[o]=a.reverse())}return z.triangulateShape(r,e)}};function V(t){var e,n=t.length;2<n&&(n=t[n-1],e=t[0],n.x===e.x)&&n.y===e.y&&t.pop()}function G(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function Y(t){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===Y(t=function(t,e){if("object"!==Y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==Y(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}var X=1e-5,W=.001,Z=Math.PI/180,q=180/Math.PI;o=function(t,e,n){return e&&K(t.prototype,e),n&&K(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(o.prototype,{N:function(){return X},D:function(){return Z},L:function(){return q},A:function(t){return t<X&&-X<t},F:function(t){return X<t},Y:function(t){return t<-X},V:function(t,e,n){return e=(t.x-n.x)*(e.y-n.y)-(e.x-n.x)*(t.y-n.y),Math.abs(e)<X?0:e},distanceOfTwoPoints:function(t,e){return t&&e?Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)):Number.NaN},distance:function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},isPolygonContainPoint:function(t,e){for(var n=0,i=0;i<t.length;i++){var r=t[i].x,o=t[i].y,s=0,a=(i<t.length-1?(s=t[i+1].x,t[i+1]):(s=t[0].x,t[0])).y;if(r===e.x&&o===e.y||s===e.x&&a===e.y)return!0;if(a!==o){var A=r+(e.y-o)*(s-r)/(a-o);if(A===e.x)return!0;r!==s?A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&A!==r&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++):A<=Math.max(r,s)&&A>=Math.min(r,s)&&A>e.x&&(A===s&&0<(o-e.y)*(a-e.y)?n+=2:n++)}}return 0<n%2},Z:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y))},B:function(t,e,n,i){return!(Math.max(t.x,e.x)<Math.min(n.x,i.x)||Math.max(t.y,e.y)<Math.min(n.y,i.y)||Math.max(n.x,i.x)<Math.min(t.x,e.x)||Math.max(n.y,i.y)<Math.min(t.y,e.y)||0===this.V(n,e,t)&&0===this.V(e,i,t)||this.V(n,e,t)*this.V(e,i,t)<0||this.V(t,i,n)*this.V(i,e,n)<0)},U:function(t,e,n){return!(t.x<e.x||t.y<e.y||t.x>n.x||t.y>n.y)},X:function(t,e,n){var i=Math.min(e.x,n.x),r=Math.max(e.x,n.x),o=Math.min(e.y,n.y);e=Math.max(e.y,n.y);return!(t.x<i||t.x>r||t.y<o||t.y>e)},H:function(t,e,n){var i=Math.min(n.x,e.x),r=Math.max(n.x,e.x),o=Math.min(n.y,e.y);n=Math.max(n.y,e.y);return!(t.x<i||t.x>r||t.y<o||t.y>n)},q:function(t,e,n){for(var i,r,o=!1,s=0;s<n;s++)i=e[s],r=e[(s+1)%n],(i.y<t.y&&r.y>=t.y||r.y<t.y&&i.y>=t.y)&&(i.x<=t.x||r.x<=t.x)&&i.x+(t.y-i.y)/(r.y-i.y)*(r.x-i.x)<t.x&&(o=!o);return o},G:function(t,e,n){return(t.x-e.x)*(n.y-e.y)==(n.x-e.x)*(t.y-e.y)&&Math.min(e.x,n.x)<=t.x&&t.x<=Math.max(e.x,n.x)&&Math.min(e.y,n.y)<=t.y&&t.y<=Math.max(e.y,n.y)},W:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},$:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)},J:function(t,e,n){var i=e.x,r=(e=e.y,n.x),o=(n=n.y,t.x),s=r-i,a=n-e,A=s*s+a*a,l=o-i,u=(t=t.y)-e,h=l*l+u*u;return this.A(A)?this.A(h)?0:h:(A=Math.sqrt(A),u=this.F(a=(s/=A)*l+(l=a/A)*u)?this.Y(a-A)?(u=o-(i+a*s))*u+(A=t-(e+a*l))*A:(i=o-r)*i+(s=t-n)*s:h,this.A(u)?0:u)},K:function(t,e,n,i){var r,o=e.x,s=e.y,a=n.x,A=n.y,l=t.x,u=(t=t.y,a-o),h=A-s,c=Math.sqrt(u*u+h*h),f=l-o,p=t-s,d=Math.sqrt(f*f+p*p);return this.A(c)?(i.x=e.x,i.y=e.y,this.A(r=d)?0:r):(r=this.F(h=(u/=c)*f+(f=h/c)*p)?this.Y(h-c)?(c=l-(p=o+h*u),u=t-(o=s+h*f),s=Math.sqrt(c*c+u*u),i.x=p,i.y=o,s):(h=l-a,f=t-A,c=Math.sqrt(h*h+f*f),i.x=n.x,i.y=n.y,c):(i.x=e.x,i.y=e.y,d),this.A(r)?0:r)},tt:function(t,e){for(var n=0,i=0,r=0,o=0;o<e;o++){var s=t[o],a=t[(o+1)%e],A=(s.x*a.y-s.y*a.x)/2;n+=A,i+=A*(s.x+a.x)/3,r+=A*(s.y+a.y)/3}return{x:i/=n,y:r/=n}},it:function(t){for(var e=z.triangulate([t]),n=0,i=0,r=0,o=0;o<e.length;o++){var s=t[e[o][0]],a=t[e[o][1]],A=t[e[o][2]],l=a.x-s.x,u=a.y-s.y,h=A.x-s.x;n+=l=(l*(A.y-s.y)-h*u)/2,i+=(s.x+a.x+A.x)/3*l,r+=(s.y+a.y+A.y)/3*l}return{x:i/n,y:r/n}},nt:function(t,e){if(e<3)return 0;for(var n=0,i=0;i<e;++i){var r=t[i],o=t[(i+1)%e];n+=r.x*o.y-r.y*o.x}return Math.abs(n/2)},et:function(t,e,n,i,r){var o,s;return this.B(t,e,n,i)?(o=(i.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-i.y),s=(t.y-n.y)*(e.x-t.x)*(i.x-n.x)+n.x*(i.y-n.y)*(e.x-t.x)-t.x*(e.y-t.y)*(i.x-n.x),r.x=s/o,o=(t.x-e.x)*(i.y-n.y)-(e.y-t.y)*(n.x-i.x),s=e.y*(t.x-e.x)*(i.y-n.y)+(i.x-e.x)*(i.y-n.y)*(t.y-e.y)-i.y*(n.x-i.x)*(e.y-t.y),r.y=s/o,1):0},rt:function(t,e,n,i,r){var o=Math.min(n.x,i.x),s=Math.max(n.x,i.x),a=Math.min(n.y,i.y),A=Math.max(n.y,i.y),l=t.x,u=t.y,h=n.x,c=n.y,f=i.x,p=i.y;if(90==e)return!(t.x<o||t.x>s||(Math.abs(s-o<W)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.x<c?(r.x=h,r.y=c,0):!(p<c&&t.x<p)||(r.x=f,r.y=p,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,d<u||!this.H(r,n,i))));if(270==e)return!(t.x<o||t.x>s||(Math.abs(s-o<W)?t.y>=c&&t.y<=p||t.y>=p&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<p&&t.y>p?(r.x=f,r.y=p,0):!(p<c&&t.y>c)||(r.x=h,r.y=c,0):(r.y=d=(p-c)/(f-h)*(l-h)+c,r.x=l,u<d||!this.H(r,n,i))));if(270!=e&&90!=e&&Math.abs(s-o<W)){t=o;var d=Math.tan(e/180*Math.PI)*(t-l)+u;if(r.y=d,r.x=t,this.H(r,n,i))return s=d-u,0<(o=t-l)/Math.sqrt(o*o+s*s)*Math.cos(e/180*Math.PI)}return Math.abs(A-a<=W)?(d=a,t=1/Math.tan(e/180*Math.PI)*(d-u)+l,r.x=t,r.y=d,!!this.H(r,n,i)&&(o=d-u,0<(s=t-l)/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI))):(t=u+(A=Math.tan(e/180*Math.PI))*((d=(c-u-((a=(p-c)/(f-h))*h-A*l))/(A-a))-l),r.x=d,r.y=t,!!this.H(r,n,i)&&(s=d-l,o=t-u,Math.abs(s)<=W&&Math.abs(o)<=W||0<s/Math.sqrt(s*s+o*o)*Math.cos(e/180*Math.PI)))},st:function(t,e){return Math.abs(t.x-e.x)<X&&Math.abs(t.y-e.y)<X},ot:function(t,e,n,i){var r,o,s,a,A=t.x,l=t.y,u=e.x,h=e.y,c=n.x,f=n.y;return this.st(t,e)||this.st(t,n)?(i.x=A,i.y=l,!0):(s=Math.min(e.x,n.x),a=Math.max(e.x,n.x),r=Math.min(e.y,n.y),o=Math.max(e.y,n.y),Math.abs(u-c)<1e-5?(i.x=u,r<=(i.y=l)&&l<=o):Math.abs(h-f)<1e-5?(i.x=A,i.y=h,s<=A&&A<=a):(a=l+(r=-1/((f-h)/(c-u)))*((s=(h-l-((o=(f-h)/(c-u))*u-r*A))/(r-o))-A),i.x=s,i.y=a,!!this.H(i,e,n)||!(!this.st(t,e)&&!this.st(t,n))))},ht:function(t,e){return{x:t.y*e.z-t.z*e.y,y:t.z*e.x-t.x*e.z,z:t.x*e.y-t.y*e.x}},ut:function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},ft:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},ct:function(t,e){return t.x*e.x+t.y*e.y},lt:function(t,e){return t.x*e.y-t.y*e.x},vt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},yt:function(t,e){var n,i;return 0==t.x&&0==t.y||0==e.x&&0==e.y?0:(n={x:t.x,y:t.y,z:0},i={x:e.x,y:e.y,z:0},n=this.ht(n,i),i=this.ct(t,e),i=Math.acos(i/(this.vt(t)*this.vt(e))),0<n.z?i/Math.PI*180:360-i/Math.PI*180)},bt:function(t,e,n,i){for(var r=0;r<n.length;r++){var o=n[r],s=n[(r+1)%n.length];if(1==this.et(t,e,o,s,i))return!0}return!1},dt:function(t,e,n,i,r){var o=Math.min(t.x,n.x,i.x),s=Math.max(t.x,n.x,i.x),a=Math.min(t.y,n.y,i.y),A=Math.max(t.y,n.y,i.y);s=Math.sqrt((s-o)*(s-o)+(A-a)*(A-a)),o=e/180*Math.PI,A=s*Math.cos(o)+t.x,a=s*Math.sin(o)+t.y;return 1==this.et(t,{x:A,y:a},n,i,r)},Mt:function(t){for(var e={x:null,y:null},n=0,i=0,r=0;r<t.length;r++)n+=t[r].x,i+=t[r].y;return e.x=n/t.length,e.y=i/t.length,e},kt:function(t,e,n,i){var r=[],o=t.x-e,s=t.x+e,a=t.y-e,A=t.y+e,l=Math.min(n.x,i.x),u=Math.max(n.x,i.x),h=Math.min(n.y,i.y),c=Math.max(n.y,i.y);return u<o||s<l||c<a||A<h||(o=i.x-n.x,s=i.y-n.y,(a=(t=(o*(a=t.x-n.x)+s*(A=t.y-n.y))/(i=o*o+s*s))*t-(a*a+A*A-e*e)/i)<0)||(A=Math.sqrt(a),i={x:n.x-o*(e=-t+A),y:n.y-s*e},o={x:n.x-o*(a=-t-A),y:n.y-s*a},e!==a&&(l<=i.x&&i.x<=u&&h<=i.y&&i.y<=c&&r.push(i),l<=o.x)&&o.x<=u&&h<=o.y&&o.y<=c&&r.push(o)),r},gt:function(t,e,n){var i,r={};if(t.x!=e.x)return i=e=(e.y-t.y)/(e.x-t.x),e=t.y-e*t.x,r.x=(+n.x- -1*i*n.y-i*e)/(i*i+1),r.y=(i*i*n.y- -1*i*n.x- -1*e)/(i*i+1),r;r.x=t.x,r.y=n.y},wt:function(t,e,n,i){var r,o,s,a,A={point:null,isintersect:!1};return t==n||t==i?(A.isintersect=!0,A.point=t):e==n||e==i?(A.isintersect=!0,A.point=e):(r={x:e.x-t.x,y:e.y-t.y},o={x:i.x-n.x,y:i.y-n.y},s={x:n.x-t.x,y:n.y-t.y},i={x:i.x-t.x,y:i.y-t.y},e={x:e.x-n.x,y:e.y-n.y},n={x:-s.x,y:-s.y},a=this.lt(o,r),Math.abs(a)<=1e-5||this.lt(s,r)*this.lt(i,r)<=5e-4&&this.lt(n,o)*this.lt(e,o)<5e-4&&(i=this.lt(o,s)/a,A.point={x:t.x+r.x*i,y:t.y+r.y*i},A.isintersect=!0)),A},St:function(t,e,n){t.x===e.x&&(e.x=e.x+1),t.y===e.y&&(e.y=e.y+1),e.x===n.x&&(n.x=n.x+1),e.y===n.y&&(n.y=n.y+1);var i=e.x-t.x,r=(t=e.y-t.y,n.x-e.x);return!(0<i*(n.y-e.y)-t*r)},getAngle:function(t){var e=t.p1,n=(t=t.p2).x-e.x;t=t.y-e.y,e=Math.sqrt(n*n+t*t),e=Math.asin(Math.abs(t)/e);return 0<n&&0<t?e:n<0&&0<t?Math.PI-e:n<0&&t<0?Math.PI+e:0<n&&t<0?2*Math.PI-e:0==n&&0<t?e:0==n&&t<0?3*Math.PI/2:0<n&&0==t?e:n<0&&0==t?Math.PI:null},_t:function(t){var e=this.distanceOfTwoPoints(t[0],t[1]),n=this.distanceOfTwoPoints(t[1],t[2]),i=(e+n+(t=this.distanceOfTwoPoints(t[0],t[2])))/2;return Math.sqrt(i*(i-e)*(i-n)*(i-t))},jt:function(t,e){var n,i,r,o,s;return this.K(t,e[0],e[1],{})<1e-4||this.K(t,e[0],e[2],{})<1e-4||this.K(t,e[1],e[2],{})<1e-4||(o={x:e[1].x-e[0].x,y:e[1].y-e[0].y},n={x:e[0].x-e[2].x,y:e[0].y-e[2].y},i={x:e[2].x-e[1].x,y:e[2].y-e[1].y},s={x:t.x-e[0].x,y:t.y-e[0].y},r={x:t.x-e[1].x,y:t.y-e[1].y},t={x:t.x-e[2].x,y:t.y-e[2].y},e=this.lt(o,s),o=this.lt(i,r),s=this.lt(n,t),X<e*o&&X<o*s)},Ot:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null,type:0,outer:null},o=[];if(this.jt(t,n)&&(r.start=t),this.jt(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0,r.type=1;else{for(var s=(n[1].x+n[2].x)/2,a=(n[1].y+n[2].y)/2,A=1;A<i;A++){var l,u=this.wt(t,e,n[A-1],n[A]);if(u.isintersect){if(null!=r.start)return r.end=u.point,r.isintersect=!0,r.outer="end",l=this.yt({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;if(null!=r.end)return r.start=u.point,r.isintersect=!0,r.outer="start",l=this.yt({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;o.push(u)}}var h,c=this.wt(t,e,n[0],n[i-1]);if(c.isintersect){if(null!=r.start)return r.end=c.point,r.isintersect=!0,r.outer="end",h=this.yt({x:s-n[0].x,y:a-n[0].y},{x:e.x-n[0].x,y:e.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;if(null!=r.end)return r.start=c.point,r.isintersect=!0,r.outer="start",h=this.yt({x:s-n[0].x,y:a-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(h=h<180?h:h-360)?2:3,r;o.push(c)}2!=o.length||this.distanceOfTwoPoints(o[0].point,o[1].point)<.01||(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?(r.start=o[0].point,r.end=o[1].point):(r.start=o[1].point,r.end=o[0].point),r.isintersect=!0,r.type=4)}return r},xt:function(t,e,n){var i=n.length,r={isintersect:!1,start:null,end:null},o=[];if(this.jt(t,n)&&(r.start=t),this.jt(e,n)&&(r.end=e),null!=r.start&&null!=r.end)r.isintersect=!0;else{for(var s=1;s<i;s++){var a=this.wt(t,e,n[s-1],n[s]);if(a.isintersect){if(null!=r.start)return r.end=a.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(a)}}var A=this.wt(t,e,n[0],n[i-1]);if(A.isintersect){if(null!=r.start)return r.end=A.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;o.push(A)}2==o.length&&(r.start=(this.distanceOfTwoPoints(o[0].point,t)<=this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.end=(this.distanceOfTwoPoints(o[0].point,t)>this.distanceOfTwoPoints(o[0].point,e)?o[0]:o[1]).point,r.isintersect=!0)}return r},Tt:function(t,e){if(0==e.length)return[t];var n,i,r=this.Rt(e),o=[],s=(r.sort(function(e,n){var i=(e.Et.x-t.Et.x)*(e.Et.x-t.Et.x)+(e.Et.y-t.Et.y)*(e.Et.y-t.Et.y),r=(n.Et.x-t.Et.x)*(n.Et.x-t.Et.x)+(n.Et.y-t.Et.y)*(n.Et.y-t.Et.y);e=(e.Pt.x-t.Et.x)*(e.Pt.x-t.Et.x)+(e.Pt.y-t.Et.y)*(e.Pt.y-t.Et.y),n=(n.Pt.x-t.Et.x)*(n.Pt.x-t.Et.x)+(n.Pt.y-t.Et.y)*(n.Pt.y-t.Et.y);return(i<e?i:e)<(r<n?r:n)}),0);for(s=0;s<r.length;s++)this.distanceOfTwoPoints(r[s].Et,r[s].Pt)<.01||(n=this.distanceOfTwoPoints(r[s].Et,t.Et),i=this.distanceOfTwoPoints(r[s].Pt,t.Et),n<.01?t.Et=r[s].Pt:i<.01?t.Et=r[s].Et:n<i?.1<this.distanceOfTwoPoints(t.Et,r[s].Et)&&(o.push({It:t.It,Et:t.Et,Pt:r[s].Et,W:t.W,Ct:t.Ct}),t.Et=r[s].Pt):.1<this.distanceOfTwoPoints(t.Et,r[s].Pt)&&(o.push({It:t.It,Et:t.Et,Pt:r[s].Pt,W:t.W,Ct:t.Ct}),t.Et=r[s].Et),r.splice(s,1));return.1<this.distanceOfTwoPoints(t.Et,t.Pt)&&o.push(t),o},Rt:function(t){var e=[];if(1==t.length)return t;for(var n=t[0],i=1;0<t.length;){if(i>=t.length){if(e.push(n),t.splice(0,1),t.length<1)break;n=t[0],i=1}if(1===t.length){e.push(n);break}this.Nt(n.Et,n.Pt,t[i].Et)?(this.Nt(n.Et,n.Pt,t[i].Pt)||(n.Pt=t[i].Pt),t.splice(i,1)):this.Nt(n.Et,n.Pt,t[i].Pt)?(n.Et=t[i].Et,t.splice(i,1)):this.Nt(t[i].Et,t[i].Pt,n.Et)?(this.Nt(t[i].Et,t[i].Pt,n.Pt)||(t[i].Pt=n.Pt),n=t[i],t.splice(i,1)):this.Nt(t[i].Et,t[i].Pt,n.Pt)?(t[i].Et=n.Et,n=t[i],t.splice(i,1)):i++}return e},Nt:function(t,e,n){var i=t.x-n.x,r=t.y-n.y,o=e.x-n.x,s=e.y-n.y,a=this.distanceOfTwoPoints(t,n);n=this.distanceOfTwoPoints(e,n),t=this.distanceOfTwoPoints(t,e);return i*s-r*o<1e-5&&a+n-t<.001}});var J=new o,$={Drive:1,Walk:0},tt={Auto:1,SpecifiedDistance:2};function et(t,e){var n,i,r,o,s="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(s)return i=!(n=!0),{s:function(){s=s.call(t)},n:function(){var t=s.next();return n=t.done,t},e:function(t){i=!0,r=t},f:function(){try{n||null==s.return||s.return()}finally{if(i)throw r}}};if(Array.isArray(t)||(s=rt(t))||e&&t&&"number"==typeof t.length)return s&&(t=s),o=0,{s:e=function(){},n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:e};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t){return function(t){if(Array.isArray(t))return ot(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||rt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rt(t,e){var n;if(t)return"string"==typeof t?ot(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ot(t,e):void 0}function ot(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function st(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===nt(t=function(t,e){if("object"!==nt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==nt(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}o=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.Dt=e.type,this.stepLength=.7,this.Lt=180/Math.PI,this.At=[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18056,9028,4514,2257,1128,564,282,141,70,35,17,8,4,2,1],this.Ft=null,this.Yt=null,this.Vt=5,this.Zt=!0,this.zt=.2,this.Bt=!1,this.Ut=!0,this.Xt=!1,this.Ht=1.2,this.Qt=80,this.qt=30,this.Gt=21,this.Wt=!0,this.$t=22,this.Jt=1.3,this.Kt="",this.ti=100,this.ii=3,this.ni=1,this.ei=6,this.ri=10,this.si=5,this.oi=0,this.hi=!1,this.ui=!1,this.ai=!1,this.fi=!1,this.ci=0,this.li=0,this.vi=0,this.yi=0,this.bi=null,this.di=null,this.mi=!1,this.pi=null,this.Mi=null,this.ki=!1,this.gi=!1,this.wi=null,this.Si=0,this._i=fengmap.FMLanguageType.ZH,this.ji=fengmap.FMNaviMode.MODULE_SHORTEST,this.Oi=fengmap.FMNaviPriority.PRIORITY_DEFAULT,this.xi=!1,this.Ti=!0,this.Ri=[],this.Ei=!1,this.Pi=new Map,this.Ii=!0,this.crossCircles,this.Ci=tt.Auto,this.Ni={radius:.5,dash:{size:4,gap:2}},this.Di="#002FA7",this.Li=!0,this.Ai=0,this.Fi=new l,this.Yi=new s,this.on=this.on.bind(this),this.Vi(e),this.Zi()}var e,n;return e=t,(n=[{key:"locationMarker",get:function(){return this.zi},set:function(t){this.zi=t}},{key:"lineFillMode",get:function(){return this.Ci},set:function(t){this.Ci=t}},{key:"naviResult",get:function(){return this.Bi}},{key:"followPosition",get:function(){return this.Zt},set:function(t){this.Zt=t}},{key:"on",value:function(t,e){this.Yi.h(t,e)}},{key:"off",value:function(t,e){this.Yi.M(t,e)}},{key:"dispose",value:function(){this.stop(),this.Ft=null,this.Yt&&(this.Yt.dispose(),this.Yt=null)}},{key:"setLanguage",value:function(t){this._i!=t&&(this._i=t,this.Ui())}},{key:"setObstructions",value:function(t){this.Yt.setObstructions(t)}},{key:"setStartPoint",value:function(t,e){this.Xi=Object.assign({},this.Xi,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.ei});var n=null;return t.url&&!e?this.Hi(this.Xi,!0):n}},{key:"setDestPoint",value:function(t,e){this.Qi=Object.assign({},this.Qi,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.ei});var n=null;return t.url&&!e?this.Hi(this.Qi,!1):n}},{key:"route",value:function(t,e,n){this.Vi(t),this.qi(),this.Gi({mode:this.ji,priority:this.Oi,toDoors:this.xi,obstruct:this.Ti,viapoints:this.Ri,barrierFree:this.Ei},e,n)}},{key:"naviConstraint",value:function(t){if(this.Xi&&this.Qi){null==this.Wi&&this.$i(),t.buildingID=void 0!==t.buildingID?t.buildingID:null;var e={},n=[],i=Number.MAX_VALUE,r=0,o={index:-1,coords:{level:t.level,buildingID:t.buildingID},angle:null,distance:Number.MAX_VALUE,distanceToNext:Number.MAX_VALUE,remain:this.Ji,relDirection:1,time:null,dots:[],insertIndex:-1,toNext:null,buildingIndex:-1};this.Ki&&this.Ki.coords.buildingID!==t.buildingID&&(this.Ki.insertIndex=-1);for(var s=0;s<this.Wi.length;s++){if(this.Wi[s].bid!==t.buildingID);else for(var a=this.Wi[s].naviPoints,A=1;A<a.length;A++){var l,u,h=a[A-1],c=a[A],f=h.index-r;this.Ki&&this.Ki.index>h.index||(f=this.tn[s].result.naviDescriptionsData[f].endPoint,h.level===t.level&&c.level===t.level&&(l=J.K(t,h,c,e))<i&&(1===A||null===this.Ki||this.Ki&&this.Ki.coords.buildingID===t.buildingID&&this.Ki&&this.Ki.insertIndex<=A)&&(null!=this.nn&&(u=(t.x-this.nn.x)*(c.x-h.x)+(t.y-this.nn.y)*(c.y-h.y),0===Math.abs(u)&&null!=this.Ki?o.relDirection=this.Ki.relDirection:u<0&&(o.relDirection=-1)),o.distance=l,Object.assign(o.coords,e),o.angle=this.en(h,c),o.index=h.index,o.distanceToNext=J.W(e,f),o.insertIndex=A,o.toNext=J.W(e,c),o.buildingIndex=s,this.rn(o),n.push(Object.assign({},o)),i=l))}r+=this.tn[s].result.naviDescriptionsData.length}var p=o;if(this.Ki)for(var d=n.length-2;0<=d;d--)n[d].remain>=p.remain&&n[d].remain<this.Ki.remain&&(n[d].distance<=p.distance||Math.abs(4<=p.insertIndex-this.Ki.insertIndex)&&p.buildingIndex==this.Ki.buildingIndex)&&(p=n[d]);return p.time=t.time,this.nn=t,p.remain<.5?this.Ki=null:this.Ki=p,p}}},{key:"pathConstraint",value:function(t,e){return this.Yt?this.Yt.pathConstraint(t,e):null}},{key:"locate",value:function(t,e){this.ui&&this.stop(),this.sn(t,e),this.nn=t}},{key:"locateNoConstraint",value:function(t,e){this.ui&&this.stop(),this.hn(t,e),this.nn=t}},{key:"clearLocationMarker",value:function(){this.zi&&(this.zi.remove(),this.zi=null)}},{key:"clearMarkers",value:function(){this.un&&(this.un.remove(),this.un=null,this.Xi=null),this.an&&(this.an.remove(),this.an=null,this.Qi=null)}},{key:"drawNaviLine",value:function(t){if(this.Xi&&this.Qi)return this.fn=this.cn(this.ln,t),this.fn}},{key:"clearNaviLine",value:function(){this.fn&&(this.fn.remove(),this.fn=null)}},{key:"clearAll",value:function(){this.clearMarkers(),this.clearNaviLine(),this.clearLocationMarker()}},{key:"overview",value:function(t,e){var n=this;if(0!==this.ln.length){for(var i=new M,r=[],o=0;o<this.ln.length;o++)!function(){var t=[Number.MAX_VALUE,-Number.MAX_VALUE];n.ln[o].resultbuild.forEach(function(e){t[0]=Math.min(t[0],e.level),t[1]=Math.max(t[1],e.level),i.I(e.pointList)}),r.push({bid:n.ln[o].bid,levelRange:t})}();this.vn(t,i,r,e)}}},{key:"focusNaviLineSegment",value:function(t,e,n){if(0!=this.tn.length){for(var i,r,o,s=null,a=null,A=0;A<this.tn.length;A++){var l=this.tn[A].result.naviDescriptionsData;if(t-l.length<0){s=l[t],a=this.tn[A].bid;break}t-=l.length}a&&s&&((i=new M).I([s.startPoint,s.endPoint]),r=[Math.min(s.startLevel,s.endLevel),Math.max(s.startLevel,s.endLevel)],o=this.Ft.getBuilding(a),this.vn(e,i,r,o,n))}}},{key:"simulate",value:function(t){var e,n,i=this;this.Xi&&this.Qi&&0!==this.ln.length&&(this.ui&&this.stop(),this.ui=!0,this.Vi(t),e={},this.mi=!1,this.pi=this.Ft.getRotation(),n=e.Ht||this.Ht,e.Gt=e.Gt||this.Gt||0,this.yn(),this.zi.rotateTo({heading:-this.pi}),this.Zt?this.bn(this.Xi.level,this.Xi.buildingID,n,function(){i.ui&&i.dn(i.Xi,n,function(){var t;i.ui&&(t=e.Gt>i.$t?i.$t:e.Gt,i.Wt?i.mn(i.Qt,n,function(){i.ui&&i.pn(t,n,function(){i.ui&&i.Mn()})}):i.pn(t,n,function(){i.ui&&i.Mn()}))})}):this.ui&&this.Mn())}},{key:"pause",value:function(){this.fi=!0}},{key:"resume",value:function(){this.fi=!1}},{key:"stop",value:function(){this.hi=!0,this.Fi.stop(),this.kn&&this.Ft.off("update",this.kn),this.fi=!1,this.di=null,this.Mi=null,this.vi=0,this.mi=!1,this.wi=null,this.Si=0,this.ki=!1,this.gi=!1,this.kn=null,this.ui=!1,this.ai=!1,this.ci=0,this.li=0,this.bi=null}},{key:"getSpeed",value:function(){return this.Vt}},{key:"setSpeed",value:function(t){this.Vt=t}},{key:"addZoomCircle",value:function(t){if(0!=t.length){var e,n=null==t[0].buildingID?null:t[0].buildingID;this.Pi.has(n)?e=this.Pi.get(n):(e=new Map,this.Pi.set(n,e));for(var i,r=0;r<t.length;r++)e.has(t[r].level)||e.set(t[r].level,[]),(i=e.get(t[r].level)).push.apply(i,it(t[r].circle))}}},{key:"stopZoomCircle",value:function(){this.Ii=!1}},{key:"constraintTrack",value:function(t){return this.Yt.constraintTrack(t)}},{key:"setLineFillMode",value:function(t){this.Ci=t}},{key:"setPassedLineDistance",value:function(t){this.fn&&this.Ci==tt.SpecifiedDistance&&this.fn.moveProportion(t/this.Ji)}}])&&st(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();var at=(Object.assign(o.prototype,{Vi:function(t){t&&(void 0!==t.map&&(this.Ft=t.map),void 0!==t.analyser&&(this.Yt=t.analyser),void 0!==t.speed&&(this.Vt=t.speed),void 0!==t.followSpeed&&(this.zt=t.followSpeed),void 0!==t.followPosition&&(this.Zt=t.followPosition),void 0!==t.followAngle&&(this.Bt=t.followAngle),void 0!==t.locationMarkerFollowAngle&&(this.Ut=t.locationMarkerFollowAngle),void 0!==t.isMultiLevels&&(this.Xt=t.isMultiLevels),void 0!==t.inTime&&(this.Ht=t.inTime),void 0!==t.tiltAngle&&(this.Qt=t.tiltAngle),void 0!==t.changeFloorTiltAngle&&(this.qt=t.changeFloorTiltAngle),void 0!==t.changeTiltAngle&&(this.Wt=t.changeTiltAngle),void 0!==t.zoom&&(this.Gt=t.zoom),void 0!==t.maxZoom&&(this.$t=t.maxZoom),void 0!==t.extendScale&&(this.Jt=t.extendScale),void 0!==t.locationMarkerUrl&&(this.Kt=t.locationMarkerUrl),void 0!==t.locationMarkerSize&&(this.ti=t.locationMarkerSize),void 0!==t.locationMarkerHeight&&(this.ii=t.locationMarkerHeight),void 0!==t.lineMarkerHeight&&(this.ni=t.lineMarkerHeight),void 0!==t.imageMarkerHeight&&(this.ei=t.imageMarkerHeight),void 0!==t.directionAssert&&(this.ri=t.directionAssert),void 0!==t.combineAsset&&(this.si=t.combineAsset),void 0!==t.completeDistance&&(this.oi=t.completeDistance),void 0!==t._i&&(this.ri=t.directionAssert),void 0!==t.mode&&(this.ji=t.mode),void 0!==t.priority&&(this.Oi=t.priority),void 0!==t.toDoors&&(this.xi=t.toDoors),void 0!==t.obstruct&&(this.Ti=t.obstruct),void 0!==t.viapoints&&(this.Ri=t.viapoints),void 0!==t.barrierFree&&(this.Ei=t.barrierFree),void 0!==t.lineStyle&&Object.assign(this.Ni,t.lineStyle),void 0!==t.linePassed&&(this.Li=t.linePassed),void 0!==t.lineFillMode)&&(this.Ci=t.lineFillMode)},Zi:function(){1===this.Dt?this.gn=void 0!==fengmap.FMNaviDriveAnalyser&&this.Yt instanceof fengmap.FMNaviDriveAnalyser:this.gn=void 0!==fengmap.FMNaviAnalyser&&(this.Yt instanceof fengmap.FMNaviAnalyser||this.Yt instanceof fengmap.FMNaviWalkAnalyser),this.Xi=null,this.Qi=null,this.un=null,this.an=null,this.zi=null,this.kn=null,this.qi()},yn:function(){this.zi instanceof fengmap.FMLocationMarker?this.zi.moveTo({buildingID:this.Xi.buildingID,level:this.Xi.level,x:this.Xi.x,y:this.Xi.y}):this.zi=new fengmap.FMLocationMarker({id:"location",buildingID:this.Xi.buildingID,level:this.Xi.level,x:this.Xi.x,y:this.Xi.y,url:this.Kt||"",size:this.ti,height:this.ii}),this.zi.addTo(this.Ft)},wn:function(t){for(var e,n=arguments.length<=1?0:arguments.length-1,i=0;i<n;i++){var r=i+1<1||arguments.length<=i+1?void 0:arguments[i+1];if(t[r])return t[r]}return(e=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=e?void 0:arguments[e]},Sn:function(t){if(this.Xi&&this.Qi)return t==this.Xi.level||t==this._detData.level},qi:function(){this.Bi=null,this._n=[],this.jn=[],this.ln=[],this.On=[],this.tn=[],this.Wi=[],this.xn=[],this.Tn=[],this.Ji=0,this.Rn=[],this.Ki=null,this.nn=null},Hi:function(t,e){if(t.level){var n=t.url||(e?"image/small/marker/nav_location_start.png":"image/small/marker/nav_location_dest.png"),i=e?this.un:this.an,r=(i&&i.remove(),(null!=t.buildingID?this.Ft.getBuilding(t.buildingID):this.Ft).getFloor(t.level));if(r)return(i=new fengmap.FMImageMarker(Object.assign({map:this.Ft,url:n,callback:function(){t.callback&&t.callback(i)},anchor:fengmap.FMMarkerAnchor.BOTTOM,depth:!1,collision:!1},t))).addTo(r),e?this.un=i:this.an=i,i}},Gi:function(t,e,n){var i=this;this.Xi&&this.Qi&&(t=Object.assign({start:Object.assign({},this.Xi),dest:Object.assign({},this.Qi)},t),this.En(t,function(t){i.Bi=t,i.Pn(),i.crossCircles=i.In(i.ln,i.Pi),i.Cn(),i.Nn(),i.Dn(),i.$i(),e&&e(t)},function(t){n&&n(t)}))},Pn:function(){if(this.Bi&&this.Bi.subs&&0!=this.Bi.subs.length){for(var t=this.Bi.subs[0].buildingID,e=[],n=[],i=[],r=0;r<this.Bi.subs.length;r++){var o=this.Bi.subs[r];o.buildingID!==t&&(i.push({bid:t,result:e}),e=[],t=o.buildingID),e.push(o),r==this.Bi.subs.length-1&&i.push({bid:t,result:e})}for(var s=0;s<i.length;s++){var a=this.Ln(i[s].result);n.push({bid:i[s].bid,resultbuild:a})}this._n=i,this.ln=n}},Ln:function(t){for(var e=[],n=Number.NaN,i=null,r=0;r<t.length;r++){var o,s=t[r];n!=s.levels[0]&&((i={length:0,level:s.levels[0],pointList:[]}).pointList.push(s.waypoint.points[0]),e.push(i),n=s.levels[0]),s.levels[0]==s.levels[1]?((o=i.pointList).push.apply(o,it(s.waypoint.points.slice(1))),i.length+=s.distance):(i={length:0,level:s.levels[0],pointList:[s.waypoint.points[0]]},e.push(i),i={length:0,level:s.levels[1],pointList:[s.waypoint.points[1]]},e.push(i))}return e},Cn:function(){for(var t=0;t<this.ln.length;t++){var e=this.ln[t].resultbuild;this.An(e)}},An:function(t){for(var e=0;e<t.length-1;e++){var n,i,r=t[e];r.length&&(n=r.pointList[r.pointList.length-1],i=t[e+1].pointList[0],.2<J.W(n,i))&&r.pointList.push(Object.assign({},i))}},Nn:function(){for(var t=0;t<this.ln.length;t++){var e=this.ln[t].resultbuild;e=this.Fn(e);this.On.push({bid:this.ln[t].bid,groupsPoints:e})}},Fn:function(t){for(var e=[],n=null,i=null,r=0;r<t.length;r++){var o=t[r],s=n==o.level;0==o.length&&0!=r&&r!=t.length-1||(s||(n=o.level,i&&e.push(i),i={level:o.level,pointList:[]}),i.pointList=i.pointList.concat(o.pointList))}return i&&e.push(i),e},Dn:function(){if(this.Bi)for(var t=0;t<this._n.length;t++){var e=this._n[t].bid,n=this._n[t].result;n=this.Ui(n);this.tn.push({bid:e,result:n}),this.Ji+=n.naviDistance}},Ui:function(t){if(t){for(var e=[],n=[],i=[],r=0,o=this._i,s=t,a=0,A=null,l=0;l<s.length;l++){var u=s[l],h=u.waypoint.points,c=u.waypoint.direction[o];c=(e.push(u.instruction[o]),{startDirection:c[0],startIndex:void 0,startLevel:u.levels[0],startPoint:h[0],endDirection:c[1],endIndex:void 0,endLevel:u.levels[1],endPoint:h.slice(-1)[0],distance:u.distance});u.levels[0]==u.levels[1]?(c.startIndex=a,a+=h.length-1,c.endIndex=a):a=0,n.push(c),null!=A&&u.levels[0]==u.levels[1]||(A={level:u.levels[1],distance:0},i.push(A)),A.distance+=u.distance,r+=u.distance}return{naviDescriptions:e,naviDescriptionsData:n,naviFloorsDistance:i,naviDistance:r}}},$i:function(){if(this._n){for(var t=0,e=[],n=0;n<this._n.length;n++){for(var i=this._n[n].result,r=this._n[n].bid,o=this.Yn(i),s=this.Vn(i),a=0;a<o.length;a++)o[a].index+=t;for(var A=0;A<s.length;A++)s[A].index+=t;var l=this.tn[n].result.naviDistance;t+=i.length,e.push({bid:r,distance:l,naviPoints:o,naviSubPoints:s})}this.Wi=e}},Yn:function(t){if(!t)return[];for(var e=[],n=t,i=0;i<n.length;i++){var r=n[i];if(r.levels[0]==r.levels[1])for(var o=i+1==n.length?null:n[i+1],s=r.waypoint.points,a=null==o||o.levels[0]!=o.levels[1]?s.length:s.length-1,A=0;A<a;A++){var l={x:s[A].x,y:s[A].y,z:0,level:r.levels[0],index:i};e.push(l)}}return e},Vn:function(t){if(!t)return[];for(var e=[],n=t,i=0;i<n.length;i++){var r=n[i].waypoint.points,o={x:r[0].x,y:r[0].y,level:r[0].level,index:i};e.push(o),i==n.length-1&&(o={x:r.slice(-1)[0].x,y:r.slice(-1)[0].y,level:r.slice(-1)[0].level,index:n.length},e.push(o))}return e},Zn:function(t,e){var n=null;if(0!=t.length){for(var i=[],r=0;r<t.length;)t[r].distance==e&&i.push(t[r]),r+=1;if(1<i.length){for(var o=0;o<i.length;o++)if(0<=i[o].relDirection){n=i[o];break}n=n||i[0]}else 1==i.length&&(n=i[0])}return n},rn:function(t){if(-1!=t.buildingIndex&&-1!==t.insertIndex){for(var e,n,i=t.buildingIndex,r=this.Wi[i].naviPoints,o=0,s=r.length-1;s>t.insertIndex;s--)s-1>=t.insertIndex&&(e=r[s],n=r[s-1],e.level===n.level)&&(o+=J.W(e,n));r[t.insertIndex]&&r[t.insertIndex].level===t.coords.level&&(o+=J.W(r[t.insertIndex],t.coords));for(var a=i+1;a<this.Wi.length;a++)o+=this.Wi[a].distance;t.remain=o}},cn:function(t,e){if(0===t.length)return null;1!==this.Dt||this.Ni.hasOwnProperty("color")||(this.Ni.color=this.Di);for(var n=Object.assign({},this.Ni),i=(e&&e.style&&Object.assign(n,e.style),e&&e.height?e.height:this.ni),r=[],o=0;o<t.length;o++)for(var s=t[o].bid,a=t[o].resultbuild,A=0;A<a.length;A++)!function(){var t=(e=a[A]).pointList;if(0!==t.length){var e=e.level,n=[],o=(t.forEach(function(t){var e=parseFloat(""+t.x);t=parseFloat(""+t.y);n.push({x:e,y:t,z:i})}),t.length<2&&(o=parseFloat(""+t[0].x),t=parseFloat(""+t[0].y),n.push({x:o,y:t,z:i})),new fengmap.FMSegment);o.level=e,o.points=n,o.buildingID=s,r.push(o)}}();return(n=new fengmap.FMLineMarker(Object.assign({segments:r},n))).passed=e&&null!=e.passed?e.passed:this.Li,n.addTo(this.Ft),n},En:function(t,e,n){var i=this;this.Yt.route(t,function(t){i.xi&&t.door&&(i.Qi.x=t.door.x,i.Qi.y=t.door.y),e&&e(t)},function(t){n&&n(t)})},dn:function(t,e,n){this.Ft.setCenter({x:t.x,y:t.y,animate:"number"==typeof e,duration:"number"==typeof e?e:0,finish:n})},mn:function(t,e,n){this.Ft.setTilt({tilt:t,animate:"number"==typeof e,duration:"number"==typeof e?e:0,finish:n})},zn:function(t,e,n){this.Ft.setRotation({rotation:t,animate:"number"==typeof e,duration:"number"==typeof e?e:0,finish:n})},pn:function(t,e,n){this.Ft.setZoom({zoom:t,animate:"number"==typeof e,duration:"number"==typeof e?e:0,finish:n},!0)},bn:function(t,e,n,i){var r;return(e=null==e?((r=this.Ft).setVisibleLevels([t]),r.getLevel()):((r=this.Ft.getBuilding(e)).setVisibleLevels([t]),r.level))==t?(i&&i(),null):r.setLevel({level:t,animate:"number"==typeof n,duration:"number"==typeof n?n:0,finish:i})},Bn:function(t){var e=this.jn;if(0===e.length)return[];for(var n=[],i=0,r=0;r<e.length;r++){var o=e[r];if(!(o.pointList.length<=1))for(var s=o.level,a=0;a<o.pointList.length;a++){for(var A=o.pointList[a],l=((A=new v(A.x,0,A.y)).level=s,-1),u=1;u<t.length;u++)if(i<t[u].Un){l=t[u-1].Xn;break}A.Xn=-1!==l?l:t[t.length-1].Xn,n.push(A),i++}}return n},Hn:function(t,e){if(0===e)return t[0];for(var n,i,r=0,o=0,s=t[0],a=1;a<t.length;a++)if((n=t[a]).bid!==s.bid)s=n;else if(n.level!==s.level)s=n;else{if(e<=(r+=(i=n.clone().sub(s)).length()))return i.normalize(),(i=s.clone().add(i.clone().multiplyScalar(e-o))).level=n.level,i.index=n.Xn!=s.index?s.index:n.Xn,i.bid=(n.bid!=s.bid?s:n).bid,i;(s=n.clone()).level=n.level,s.index=n.Xn,s.bid=n.bid,o=r}var A=t[t.length-1];return A.index=A.Xn,A.bid=A.bid,A},Qn:function(t){var e,n,i,r,o;return t&&0!==t.length?(n=0,i=e=-1,t=t.map(function(t,r){var o=new v(t.startPoint.x,0,t.startPoint.y);return o.level=t.startLevel,o.Xn=r,e=r,t.startLevel!==t.endLevel?(n+=i,o.Un=n,n++):o.Un=t.startIndex+n,i=t.endIndex,o}),r=this._naviDescriptionsData[this._naviDescriptionsData.length-1],(o=new v(r.endPoint.x,0,r.endPoint.y)).level=r.endLevel,o.Xn=e+1,o.Un=r.endIndex+n,t.push(o),t):[]},qn:function(t){var e,n,i,r=this;this.zi&&(this.gi?(e={x:t.x,y:t.y,height:this.zi.height,level:t.level,buildingID:t.bid},this.zi.moveTo(e),this.gi=!1):(n=(e={}).Ht||this.Ht,e.Gt=e.Gt||this.Gt||0,i=e.Gt>this.$t?this.$t:e.Gt,this.Xt||(this.Gn(t),this.zi.visible=!0),this.Wt&&this.mn(this.Qt,n,null),this.dn(t,n,function(){r.pn(i,n,function(){r.ki=!1})})))},Wn:function(t){this.zi&&(this.Gn(t),this.gi=!1)},en:function(t,e){var n=new v(0,0,1);t=new v(t.x,0,t.y),t=(e=new v(e.x,0,e.y).clone().sub(t).normalize()).angleTo(n)*J.L();return 0<e.clone().cross(n).y?360-t:t},$n:function(t,e,n){return t===e?t:(180<Math.abs(e-t)&&(t<e?t+=360:e+=360),(t*(1-n)+e*n)%360)},Jn:function(t,e){var n=this.At,i=Math.floor(t),r=n[i-1]*(1-t%1)+n[i]*(t%1);for(r*=e,i=0;r<n[i];)i++;return i+1-(r-n[i])/(n[i-1]-n[i])},Kn:function(t){var e,n,i;this.hi||requestAnimationFrame(this.Kn.bind(this,t)),this.ai||(t.cnt++,t.cnt!==t.step)||(t.cnt=0,e=this.Fi.getDelta(),this.gi)||this.ki||this.fi||(this.vi+=this.Vt*e,this.vi<=0)||this.Vt*e==0||(e=Object.assign({},this.Hn(t.ps,this.vi)),n=this.Ji-this.vi,i=e.y,e.y=e.z,e.z=i,this.bi={distance:0,remain:n<this.yi?this.yi:n,walk:this.vi,point:e,level:e.level,buildingID:e.bid,index:e.index-1},null!=this.di&&(this.Mi=this.en(this.di,e)),this.di=Object.assign({},e),!e||n<this.yi&&this.mi?this.ai=!0:(n<this.yi&&!this.mi&&(this.mi=!0),this.Si||(this.Si=t.ps[0].level),null==this.wi&&(this.wi=t.ps[0].bid||"outdoor"),this.ui&&(i=e.bid||"outdoor",this.wi!==i?(this.gi=!0,this.wi=i,this.ci++,this.li=0,this.Si=e.level,this.te(1,e),this.Yi.k({type:"transit",level:e.level,buildingID:e.bid})):this.Si!==e.level&&(this.Si=e.level,this.li++,this.te(0,e),this.Yi.k({type:"transit",level:e.level,buildingID:e.bid})))))},te:function(t,e){var n=this;if(this.Zt){var i={},r=i.Ht||this.Ht,o=(i.Gt=i.Gt||this.Gt||0,i.Gt>this.$t?this.$t:i.Gt);if(1===t)return this.ie(e.level,e.bid,function(){n.bn(e.level,e.bid,r,function(){n.qn(e)})});this.ki=!0,this.Wt&&this.mn(this.qt,r,null),this.Xt||(this.zi.visible=!1),this.ie(e.level,e.bid,function(){n.bn(e.level,e.bid,r,function(){n.pn(o,r,function(){n.dn(e,r,function(){n.Wt?n.mn(n.Qt,r,function(){n.qn(e)}):n.qn(e)})})})})}else if(1===t)return this.ie(e.level,e.bid,function(){n.qn(e)})},ne:function(){this.hi=!1;for(var t=[],e=0;e<this.Wi.length;e++){for(var n=this.Wi[e].naviPoints,i=[],r=0;r<n.length;r++){var o=new v(n[r].x,0,n[r].y);o.Xn=n[r].index,o.level=n[r].level,o.bid=this.Wi[e].bid,i.push(o)}t.push.apply(t,i)}this.Fi.start(),this.ai=!1,this.ci=0,this.li=0,this.Kn({step:2,cnt:0,ps:t})},ee:function(){if(!(this.ki||this.gi||this.fi)){if(this.di){var t,e,n=new v(this.zi.x,this.zi.y,0).lerp(this.di,this.mi?1:this.zt),i=(n.level=this.di.level,n.buildingID=this.di.bid,this.naviConstraint(n));if(i.index<0)return;if(this.zi.moveTo({x:n.x,y:n.y,height:this.ii,level:n.level,buildingID:n.buildingID}),this.fn&&(this.fn.passed?this.fn.moveProportion(1-i.remain/this.Ji):this.fn.moveProportion(0)),this.Ii)for(var r=0;r<this.crossCircles.length;r++)i.coords.buildingID==this.crossCircles[r].bid&&i.coords.level==this.crossCircles[r].level&&i.remain<=this.crossCircles[r].point.remain&&i.remain>=this.crossCircles[r].remain&&(t=!0,e=this.crossCircles[r].point);if(this.Yi.k(Object.assign({},this.bi,this.re(i,t,e))),t=!1,e=null,this.Zt?this.dn(n):this.Ft.updateCountDown_=0,this.ai)return this.stop(),void this.Yi.k({type:"complete"})}null!=this.Mi&&(n=this.$n(this.pi,this.Mi,this.zt),this.pi=n,this.zi.rotateTo({heading:-n}),this.Bt)&&this.zn(n)}},Mn:function(){this.ne(),this.kn=this.ee.bind(this),this.Ft.on("update",this.kn)},sn:function(t,e){var n,i,r=this.naviConstraint(t);if(this.Ci==tt.Auto&&this.fn&&(this.fn.passed?this.fn.moveProportion(1-r.remain/this.Ji):this.fn.moveProportion(0)),this.Ii)for(var o=0;o<this.crossCircles.length;o++)r.coords.buildingID==this.crossCircles[o].bid&&r.coords.leve==this.crossCircles[o].level&&r.remain<=this.crossCircles[o].point.remain&&r.remain>=this.crossCircles[o].remain&&(n=!0,i=this.crossCircles[o].point);this.Yi.k(this.re(r,n,i)),n=!1,i=null,this.zi&&(r.coords.height=this.ii,this.zi.moveTo(r.coords),void 0!==e?this.zi.rotateTo({heading:e}):this.zi.rotateTo({heading:-r.angle}))},hn:function(t,e){var n,i,r=this.naviConstraint(t);if(this.Ii)for(var o=0;o<this.crossCircles.length;o++)r.coords.buildingID==this.crossCircles[o].bid&&r.coords.leve==this.crossCircles[o].level&&r.remain<=this.crossCircles[o].point.remain&&r.remain>=this.crossCircles[o].remain&&(n=!0,i=this.crossCircles[o].point);this.Yi.k(this.re(r,n,i)),n=!1,i=null,this.zi&&(t.height=this.ii,this.zi.moveTo(t),void 0!==e?this.zi.rotateTo({heading:e}):this.zi.rotateTo({heading:-r.angle}))},se:function(t,e){for(var n=[{x:t.min.x,y:t.min.y},{x:t.min.x,y:t.max.y},{x:t.max.x,y:t.max.y},{x:t.max.x,y:t.min.y}],i=new M,r=0;r<e.length;r++)for(var o=e[r].levelRange,s=0;s<o.length;s++)for(var a=s===o.length-1?this.ni+2*this.Ni.radius:this.ni,A=0;A<n.length;A++){var l=fengmap.FMUtil.coordsMapToScreen(this.Ft,{x:n[A].x,y:n[A].y,buildingID:e[r].bid,level:o[s],height:a});l&&i.I([l])}return i},oe:function(t,e){t=this.se(t,e).size,e=this.Ft.getContainer().clientHeight;var n=this.Ft.getContainer().clientWidth;return n/e>t.x/t.y?t.y/e:t.x/n},he:function(t,e,n,i,r,o){var s=this,a=this.oe(t,e),A=this.Ft.getZoom();a?(A=this.Jn(this.Ft.getZoom(),a*(n||1)),r=i-1):A-=1,this.Ft.setZoom({zoom:A,animate:!1,finish:function(){++r===i?o&&o({zoom:A}):s.he(t,e,n,i,r,o)}})},ue:function(t,e){for(var n=this.se(t,e),i=[],r=0;r<e.length;r++)for(var o=e[r].levelRange,s=e[r].bid||this.Ft.getMapOptions().buildingID,a=0;a<o.length;a++){var A=this.Ft.getBuilding(s).getFloor(o[a]).height;i.push(fengmap.FMUtil.coordsScreenToMap(this.Ft,{x:(n.max.x+n.min.x)/2,y:(n.max.y+n.min.y)/2,z:A+2*this.Ni.radius}))}for(var l=new v,u=0;u<i.length;u++)l.add(i[u]);return l.divideScalar(i.length),l},ae:function(t,e,n,i,r,o){var s=this;this.he(t,e,n,10,0,function(a){var A=s.ue(t,e);s.Ft.setCenter({animate:!1,x:A.x,y:A.y,finish:function(){++r===i?o&&o({zoom:a.zoom,center:A}):s.ae(t,e,n,i,r,o)}})})},vn:function(t,e,n,i){for(var r=this,o=t&&void 0!==t.ratio?t.ratio:1,s=t&&void 0!==t.rotation?t.rotation:0,a=t&&void 0!==t.tilt?t.tilt:30,A=!t||void 0===t.animate||t.animate,l=1,u=[1],h=0;h<n.length;h++){for(var c=n[h].levelRange,f=[],p=c[0];p<=c[1];)f.push(p),p++;null==n[h].bid?l=(u=f)[Math.floor((f.length-1)/2)]:this.Ft.getBuilding(n[h].bid).setVisibleLevels(f)}this.Ft.setVisibleLevels(u,function(){r.Ft.setLevel({level:l,animate:A,finish:function(){var t=u.length%2==0?r.Ft.getFloorSpace()/2:0;r.Ft.getInteracations().controls.panAdd({x:0,y:t,z:0}),r.Ft.setCenter({animate:A,x:e.center.x,y:e.center.y,finish:function(){r.Ft.setTilt({tilt:a,animate:A,finish:function(){r.Ft.setRotation({rotation:s,animate:A,finish:function(){var t=r.Ft.getInteracations(),s=r.Ft.copyCamera(),a=t.copyControls(s),l=t.controls,u=r.Ft.camera;t.controls=a,r.Ft.camera=s,r.Ft.getInteracations().controls.update(),r.ae(e,n,o,10,0,function(e){t.controls=l,r.Ft.camera=u,a.dispose(),a=null,r.Ft.enableUpdateRender(),r.Ft.setZoom({animate:A,zoom:e.zoom,duration:.5}),r.Ft.setCenter({animate:A,x:e.center.x,y:e.center.y,duration:.5,finish:function(){i&&i()}})})}})}})}})}})})},ie:function(t,e,n){if(null==t||null==e)return n&&n(),null;for(var i=this.Ft.getBuilding(e).levelChart,r=this.Ft.getVisibleLevels(),o=null,s=0;s<i.length;s++)if(s%2==1&&i[s]===t&&(o=i[s-1],r.indexOf(o)<0)){this.Ft.setVisibleLevels([o]);break}return null==o||this.Ft.getLevel()===o?(n&&n(),null):this.Ft.setLevel({level:o,animate:"number"==typeof duration,duration:"number"==typeof duration?duration:0,finish:n})},In:function(t,e){if(!e)return[];for(var n=0,i=0,r=[],o=0;o<t.length;o++)for(var s=t[o].resultbuild,a=0;a<s.length;a++)i+=s[a].length;for(var A=0;A<t.length;A++)for(var l=t[A].bid,u=t[A].resultbuild,h=0;h<u.length;h++){var c=u[h].level,f=u[h].pointList;if(0<h&&(n+=u[h-1].length),!(f.length<=1)&&e.has(l)&&e.get(l).has(c))for(var p=0,d=e.get(l).get(c),y=0;y<f.length;y++){0<y&&(p+=J.distance(f[y-1],f[y]));var m,g=et(d);try{for(g.s();!(m=g.n()).done;){var v,b=m.value,x=this.fe(f,b,y);x&&(x.remain=0==y?i-(n+p):i-(n+p-x.disIntersectToPoint),v=i-(n+p-x.disCenterToPoint),r.push({center:b.center,radius:b.radius,remain:v,point:x,level:c,bid:l}))}}catch(t){g.e(t)}finally{g.f()}}}return r},fe:function(t,e,n){var i=0;if(0==n)return J.$(t[n],e.center)<=.001?Object.assign({disIntersectToCenter:disIntersectToCenter,disIntersectToPoint:i},t[n]):null;if(!(J.$(e.center,t[n-1])<=.001)&&J.J(e.center,t[n-1],t[n])<=.001){var r,o=et(e.points);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(!J.H(s,e.center,t[n]))for(var a=n;0<a;a--)if(J.H(s,t[a-1],t[a])&&J.J(s,t[a-1],t[a])<=.001){for(var A=[s],l=a;l<=n;l++)A.push(t[l]);for(var u=0;u<A.length-1;u++)i+=J.distance(A[u],A[u+1]);return s.disIntersectToPoint=i,s.disCenterToPoint=J.distance(e.center,t[n]),s}}}catch(t){o.e(t)}finally{o.f()}}return null},Gn:function(t){t={x:this.zi.x,y:this.zi.y,height:this.zi.height,level:t.level,buildingID:t.bid};var e=this.On[this.ci].groupsPoints[this.li];e&&e.pointList&&0<e.pointList.length&&(t=Object.assign(t,e.pointList[0])),this.zi.moveTo(t)},re:function(t,e,n){return e={distance:t.distance,remain:t.remain,distanceToNext:t.distanceToNext,angle:t.angle,point:t.coords,level:t.coords.level,buildingID:t.coords.buildingID,index:t.index,enterCircle:e,intersect:n},this.Dt===$.Drive?(e.type="driving",e.drive=this.Ji-t.remain):(e.type="walking",e.walk=this.Ji-t.remain),e}}),o);function At(t){return(At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function lt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===At(t=function(t,e){if("object"!==At(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==At(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function ut(){return(ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ct(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function ht(t,e){return(ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ct(t){return(ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ft(t){return(ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===ft(t=function(t,e){if("object"!==ft(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==ft(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function dt(){return(dt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=mt(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function yt(t,e){return(yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function mt(t){return(mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){return"symbol"===gt(t=function(t,e){if("object"!==gt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==gt(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(i.key),i)}}function bt(){return(bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=wt(t)););return t}(t,e);if(i)return(i=Object.getOwnPropertyDescriptor(i,e)).get?i.get.call(arguments.length<3?t:n):i.value}).apply(this,arguments)}function xt(t,e){return(xt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function wt(t){return(wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Bt,Mt={FMNaviMode:n,FMNaviPriority:{PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},FMLanguageType:{ZH:"zh",EN:"en"},FMNavigation:function(){var t=i,e=at;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ht(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=ct(t);if(n=e?(n=ct(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===At(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return n.call(this,t,e,r);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"on",value:function(t,e){ut(ct(i.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){ut(ct(i.prototype),"off",this).call(this,t,e)}}])&&lt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),FMNavigationDrive:function(){var t=i,e=at;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yt(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=mt(t);if(n=e?(n=mt(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===ft(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return t.type=$.Drive,(t=n.call(this,t,e,r)).Vt=7,t.zt=.2,t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"on",value:function(t,e){dt(mt(i.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){dt(mt(i.prototype),"off",this).call(this,t,e)}},{key:"locate",value:function(t,e){dt(mt(i.prototype),"locate",this).call(this,t,e)}},{key:"route",value:function(t,e,n){dt(mt(i.prototype),"route",this).call(this,t,e,n)}},{key:"locateNoConstraint",value:function(t,e){dt(mt(i.prototype),"locateNoConstraint",this).call(this,t,e)}},{key:"simulate",value:function(t){dt(mt(i.prototype),"simulate",this).call(this,t)}},{key:"naviResult",get:function(){return this.Bi}}])&&pt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}(),FMNavigationWalk:function(){var t=i,e=at;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xt(t,e);var n=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=wt(t);if(n=e?(n=wt(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments),i=this,n&&("object"===gt(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==i)return i;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}(i);function i(t,e,r){if(this instanceof i)return t.type=$.Walk,n.call(this,t,e,r);throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"on",value:function(t,e){bt(wt(i.prototype),"on",this).call(this,t,e)}},{key:"off",value:function(t,e){bt(wt(i.prototype),"off",this).call(this,t,e)}},{key:"route",value:function(t,e,n){bt(wt(i.prototype),"route",this).call(this,t,e,n)}}])&&vt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),i}()},St=window.fengmap||{};for(Bt in Mt)St[Bt]=Mt[Bt];window.fengmap=St,e.default=St}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"ce",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.ce)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.ce?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=0).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()},pP7p:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("woOf"),r=n.n(i),o=n("5qI+"),s=n.n(o),a=(n("j5PW"),n("bYmx"),n("o2Cy"),n("8qUe"),n("C7iZ"),n("/Wqo"),n("Tvr9"),n("yYa5"),n("EApQ"),n("kKzE"),n("qONO"),n("PO8r")),A=n("CTnB"),l=n("3zDK"),u=(n("ktr9"),n("trid")),h=n("czjk"),c=n("7rnj"),f=n("flqW"),p=n("Lfyu"),d=n("/LWt"),y=n("nq2H"),m=n("T18w"),g=n("WMwB"),v=n("Umvz"),b=n("Mjwz"),x=n("zOBh"),w=n("c2Ch"),B={components:{Menu:a.a,Project:A.a},name:"MapManagement",data:function(){return{i8n:this.$store.state.i18n,map:null,mapName:"map",draw:"",snap:"",choseMap:!1,contrForPrionum:this.$store.state.userInfo.prionum,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,intoProjectName:this.$store.state.intoProjectName,tableData:[],searchList:{mapid:"",status:"",page:1,count:20,projectid:this.$store.state.projectid},currentPage1:1,total:0,add2D:!1,add3D:!1,addData:{mapname:"",filename:"",tenantid:this.$store.state.userInfo.tenantid,width:"",length:"",memo:"",projectid:"",distance:"",reallength:"",realwidth:"",maptype:"",active:"",mapkey:"",appname:"",scale:1},addRules:{scale:[{pattern:/^\+?\d*$/,message:this.$t("mapmanagement.tit"),trigger:"blur"}],mapkey:[{required:!0,message:this.$t("mapmanagements.Please3dmapkey"),trigger:"blur"}],appname:[{required:!0,message:this.$t("mapmanagements.Please3dmapkeyName"),trigger:"blur"}],mapname:[{required:!0,message:this.$t("mapmanagements.Pleasemapname"),trigger:"blur"}],filename:[{required:!0,message:this.$t("mapmanagements.Please3dmapname"),trigger:"blur"}],realwidth:[{pattern:/^\+?\d*$/,message:this.$t("mapmanagement.tit"),trigger:"blur"}],reallength:[{pattern:/^\+?\d*$/,message:this.$t("mapmanagement.tit"),trigger:"blur"}],distance:[{pattern:/^\+?\d*$/,message:this.$t("mapmanagement.tit"),trigger:"blur"}],active:[{pattern:/^((0+)(\.\d{1})|1|0?)$/,message:this.$t("mapmanagement.tit1"),trigger:"blur"}],width:[{required:!0,message:this.$t("mapmanagement.mapwidthrule"),trigger:"blur"},{required:!0,pattern:/^[1-9][0-9]{0,2}$|^1000$/,message:this.$t("mapmanagement.mapintrule"),trigger:"blur"}],length:[{required:!0,message:this.$t("mapmanagement.mapheightrule"),trigger:"blur"},{required:!0,pattern:/^[1-9][0-9]{0,2}$|^1000$/,message:this.$t("mapmanagement.mapintrule"),trigger:"blur"}],status:[{required:!0,message:this.$t("mapmanagement.selectmap"),trigger:"change"}]},projectList:[],dialogImageUrl:"",dialogVisible:!1,fileListAdd:[],fileListEdit:[],userIdForPic:{},userIdForPicEdit:{},ImagePath:l.a.host+"map/addMapInfoAndMapFile",ImagePathEdit:l.a.host+"map/updateMapFile",myHeader:{tenantkey:this.$store.state.userInfo.tenantkey,ts:(new Date).getTime(),tenantid:this.$store.state.userInfo.tenantid,userName:this.$store.state.userInfo.username},myHeaderEdit:{tenantkey:this.$store.state.userInfo.tenantkey,ts:(new Date).getTime(),tenantid:this.$store.state.userInfo.tenantid,userName:this.$store.state.userInfo.username},pageCount:20,edit2D:!1,edit3D:!1,editCompany2D:!1,changeImg:!1,editData:{status:"",mapname:"",mapid:"",width:"",length:"",instruction:"",memo:"",sysmemo:"",projectid:"",realwidth:"",reallength:"",distance:"",active:"",scale:""},editDatas:{status:"",mapname:"",mapid:"",width:"",length:"",instruction:"",memo:"",sysmemo:"",projectid:"",realwidth:"",reallength:"",distance:"",active:"",scale:""},passEdit:!1,needChangeAPI:!1,choseApiEdit:!1,del:!1,delData:{},check:!1,check3D:!1,clickTrue:!0,map3d:null,themeId:"",fmapId:"",fmapKey:"",fmapName:"",loading:!0,scrollFloorControl:"",checkData:{},auditBtn:"",imgUrl:"",imageInfo:{},srcList:[],searchStatus:[{index:1,value:"Draft"},{index:2,value:"Audit"},{index:3,value:"Pass"},{index:4,value:"Fail"},{index:5,value:"Lock"}],statusList:[{index:1,value:"Draft"},{index:2,value:"Audit"},{index:3,value:"Pass"},{index:4,value:"Fail"},{index:5,value:"Lock"}],mapIdList:[],featureNum:0,actualrange:"",imageX:"",imageY:"",mapLoading:!1,mapOptions:[]}},methods:{mapInit:function(t,e){var n=this,i=this;i.actualrange="";var r=[0,0,t,e],o=new c.a({code:"xkcd-image",units:"pixels",extent:r});setTimeout(function(){n.$refs.map.style.width="100%",n.$refs.map.style.height="90%",n.map=new u.a({layers:[new h.a({source:new f.a({url:i.dialogImageUrl,projection:o,imageExtent:r})})],target:n.mapName,view:new p.a({projection:o,center:Object(d.y)(r),zoom:1,maxZoom:6})}),n.mapClick()},0)},removeMap:function(){this.map.setTarget(void 0),this.featureNum=0},mapClick:function(){var t,e=this,n=this;this.mapClickEvent=this.map.on("click",function(i){var r=e.map.forEachFeatureAtPixel(i.pixel,function(e){return t=i.coordinate,e});if(void 0==r){if(2==n.featureNum)return;n.featureNum+=1,t=i.coordinate;var o=new b.c({image:new x.a({anchor:[.5,.5],src:"../../../static/near.png",scale:.3})}),s=new y.a({x:t[0],y:t[1],point:!0,geometry:new m.a([t[0],t[1]])}),a=new g.a({features:[s]}),A=new v.a({source:a,style:o,zIndex:1e4});e.map.addLayer(A),2==n.featureNum?e.$nextTick(function(){n.$refs.actualrange.focus()}):n.actualrange=""}else n.removeFeature(r),n.actualrange=""})},removeFeature:function(t){for(var e=this.map.getLayers().getArray(),n=1;n<e.length;n++)e[n].getSource().getFeatures()[0].values_.x==t.values_.x&&e[n].getSource().getFeatures()[0].values_.y==t.values_.y&&this.delFeatureAndLayer(e[n])},delFeatureAndLayer:function(t){t.getSource().getFeatures().forEach(function(e){t.getSource().removeFeature(e)}),this.map.removeLayer(t),this.featureNum-=1},distanceTrue:function(){var t=this;if(""==this.actualrange||0==this.actualrange||this.actualrange<0)return t.$message({message:this.$t("mapmanagement.actualdistance"),type:"warning"}),void t.$nextTick(function(){t.$refs.actualrange.focus()});var e=this.map.getLayers().getArray(),n=Math.abs(e[1].getSource().getFeatures()[0].values_.x-e[2].getSource().getFeatures()[0].values_.x),i=Math.abs(e[1].getSource().getFeatures()[0].values_.y-e[2].getSource().getFeatures()[0].values_.y),r=Math.round(Math.sqrt(Math.pow(n,2)+Math.pow(i,2)));this.add2D&&(t.addData.reallength=Math.round(t.imageX*t.actualrange/r),t.addData.realwidth=Math.round(t.imageY*t.actualrange/r)),this.edit2D&&(t.editData.reallength=Math.round(t.imageX*t.actualrange/r),t.editData.realwidth=Math.round(t.imageY*t.actualrange/r)),this.editCompany2D&&(t.editDatas.reallength=Math.round(t.imageX*t.actualrange/r),t.editDatas.realwidth=Math.round(t.imageY*t.actualrange/r)),this.dialogVisible=!1},handleCurrentChange:function(t){this.searchList.page=t,this.searchList.count=this.pageCount,this.getMapInfoLists()},handleSizeChange:function(t){this.pageCount=t,this.searchList.count=t,this.searchList.page=1,this.currentPage1=1,this.getMapInfoLists()},datetimecut:function(t){if(!t)return"-";function e(t){return t>9?t:"0"+t}var n=new Date(t);return n.getFullYear()+"-"+e(n.getMonth()+1)+"-"+e(n.getDate())+" "+(n.getHours()<10?"0"+n.getHours():n.getHours())+":"+e(n.getMinutes())+":"+e(n.getSeconds())},formatDateCreattime:function(t,e){if(null==t.creattime||0==t.creattime)return"";var n=new Date(1e3*parseInt(t.creattime)).toUTCString();return this.datetimecut(n)},formatDateEdittime:function(t,e){if(null==t.edittime||0==t.edittime)return"";var n=new Date(1e3*parseInt(t.edittime)).toUTCString();return this.datetimecut(n)},formatDateAudittime:function(t,e){if(null==t.audittime||0==t.audittime)return"";var n=new Date(1e3*parseInt(t.audittime)).toUTCString();return this.datetimecut(n)},myHeaderd:function(){(new Date).getTime();this.myHeader.tenantkey=this.tenantkey_A,this.myHeader.ts=this.time_A,this.myHeader.tenantid=this.tenantid_A,this.myHeader.userName=this.userName},handlePictureCardPreview:function(t){var e=this;this.dialogImageUrl=t.url;var n=new Image;n.src=t.url,n.onload=function(){e.imageX=n.width,e.imageY=n.height,e.mapInit(n.width,n.height)},this.dialogVisible=!0},handlePictureCardPreviewEdit:function(t){var e=this;this.dialogImageUrl=t.url;var n=new Image;n.src=t.url,n.onload=function(){e.imageX=n.width,e.imageY=n.height,e.mapInit(n.width,n.height)},this.dialogVisible=!0},picSuccess:function(t,e,n){this.$refs.upload.clearFiles(),1001==t.code?(this.add2D=!1,this.$message({message:this.$t("buildingmanagement.addsuccess"),type:"success"}),this.getMapInfoLists(),this.getSearchMapInfoList()):this.$message({message:this.$t("buildingmanagement.addfaile"),type:"warning"})},picSuccessEdit:function(t,e,n){this.$refs.upload.clearFiles(),1001==t.code?(this.editCompany2D=!1,this.$message({message:this.$t("mapmanagement.editsuccess"),type:"success"}),this.getMapInfoLists(),this.getSearchMapInfoList(),this.choseApiEdit=!1,this.needChangeAPI=!1):this.$message({message:this.$t("mapmanagement.editfaile"),type:"warning"})},picError:function(t){this.$refs.upload.clearFiles()},picErrorEdit:function(t){this.$refs.upload.clearFiles()},handleExceed:function(t,e){this.$message.warning(this.$t("mapmanagement.maprule"))},handleExceedEdit:function(t,e){this.$message.warning(this.$t("mapmanagement.maprule"))},handleChange:function(t){var e=this,n=new Image;n.src=t.url,n.onload=function(){e.userIdForPic.width=n.height,e.userIdForPic.length=n.width},this.dialogImageUrl=t.url},beforeAvatarUpload:function(t){var e=t.name.lastIndexOf("."),n=t.name.substr(e+1);if("jpg"!=n&&"jpeg"!=n&&"png"!=n)return this.$message.warning(this.$t("mapmanagement.maprule1")),!1;var i=t.size/1024/1024<2;return i||this.$message.warning(this.$t("mapmanagement.maprule2")),i},beforeAvatarUploadEdit:function(t){var e=t.name.lastIndexOf("."),n=t.name.substr(e+1);if("jpg"!=n&&"jpeg"!=n&&"png"!=n)return this.$message.warning(this.$t("mapmanagement.maprule1")),!1;var i=t.size/1024/1024<2;return i||this.$message.warning(this.$t("tet.tet13")),i},getProjectListByTenantids:function(){var t=this,e={superid:this.$store.state.userInfo.tenantid};Object(w._82)(e,this.tenantkey_A,this.tenantid_A,this.username).then(function(e){1001==e.code&&(t.projectList=e.data.list)})},addMap:function(){this.fileListAdd=[],this.themeId="",3==this.contrForPrionum||4==this.contrForPrionum?this.addData={mapname:"",tenantid:this.$store.state.userInfo.tenantid,width:"",length:"",memo:"",projectid:this.$store.state.intoProjectid,realwidth:"",reallength:"",distance:"5",maptype:"",active:"0.5",mapkey:"",appname:"",filename:"",scale:1}:5==this.contrForPrionum&&(this.addData={mapname:"",tenantid:this.$store.state.userInfo.superid,width:"",length:"",memo:"",projectid:this.$store.state.intoProjectid,realwidth:"",reallength:"",distance:"5",maptype:"",active:"0.5",mapkey:"",appname:"",filename:"",scale:1}),this.choseMap=!1},addMap2D:function(){this.addMap(),this.add2D=!0},addMap3D:function(){this.addMap(),this.add3D=!0},addCancel2D:function(t){this.add2D=!1,this.$refs[t].resetFields()},addCancel3D:function(t){this.add3D=!1,this.$refs[t].resetFields()},addTrue2D:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.addData.maptype=1,e.userIdForPic.tenantid=e.addData.tenantid,e.userIdForPic.maptype=e.addData.maptype,e.userIdForPic.memo=e.addData.memo,e.userIdForPic.mapname=e.addData.mapname,e.userIdForPic.projectid=e.addData.projectid,e.userIdForPic.realwidth=e.addData.realwidth,e.userIdForPic.reallength=e.addData.reallength,e.userIdForPic.distance=e.addData.distance,e.userIdForPic.active=e.addData.active,e.userIdForPic.status=1,e.$refs.upload.submit()})},addTrue3D:function(t){var e=this,n=this;this.$refs[t].validate(function(t){t&&(e.addData.filetype=e.themeId,e.addData.maptype=2,e.addData.status=1,Object(w.n)(e.addData,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.$message({message:n.$t("mapmanagement.addsuccess"),type:"warning"}),n.getMapInfoLists(),n.add3D=!1):n.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})}))})},auditTrue2D:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.addData.maptype=1,e.userIdForPic.tenantid=e.addData.tenantid,e.userIdForPic.maptype=e.addData.maptype,e.userIdForPic.memo=e.addData.memo,e.userIdForPic.mapname=e.addData.mapname,e.userIdForPic.projectid=e.addData.projectid,e.userIdForPic.realwidth=e.addData.realwidth,e.userIdForPic.reallength=e.addData.reallength,e.userIdForPic.distance=e.addData.distance,e.userIdForPic.active=e.addData.active,e.userIdForPic.status=2,e.$refs.upload.submit()})},auditTrue3D:function(t){var e=this,n=this;this.$refs[t].validate(function(t){t&&(e.addData.filetype=e.themeId,e.addData.maptype=2,e.addData.status=2,Object(w.n)(e.addData,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.$message({message:n.$t("mapmanagement.Submittedsuccessfully"),type:"warning"}),n.getMapInfoLists(),n.add3D=!1):n.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})}))})},getMapInfoLists:function(){var t=this;Object(w._61)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&(t.tableData=e.data.list,t.total=e.data.size)})},getSearchMapInfoList:function(){var t=this,e={};1==this.$store.state.userInfo.prionum||2==this.$store.state.userInfo.prionum?e={tenantid:""}:3==this.$store.state.userInfo.prionum||4==this.$store.state.userInfo.prionum?e={projectid:this.$store.state.intoProjectid}:5==this.$store.state.userInfo.prionum&&(e={projectid:this.$store.state.intoProjectid}),Object(w._61)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){t.mapIdList=e.data.list.map(function(t){return{value:""+t.mapid,maplabel:""+t.mapid,mapname:""+t.mapname}})})},remoteMapMethod:function(t){var e=this;""!==t?(this.mapLoading=!0,setTimeout(function(){e.mapLoading=!1,e.mapOptions=e.mapIdList.filter(function(e){return e.value.toLowerCase().indexOf(t.toLowerCase())>-1?e.value.toLowerCase().indexOf(t.toLowerCase())>-1:e.mapname.toLowerCase().indexOf(t.toLowerCase())>-1?e.mapname.toLowerCase().indexOf(t.toLowerCase())>-1:void 0})},200)):this.mapOptions=[]},searchInfo:function(){this.searchList.page=1,this.currentPage1=1;var t=this;Object(w._61)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&(t.tableData=e.data.list,t.total=e.data.size,t.currentPage1=1,0==e.data.size?t.$message({message:t.$t("mapmanagement.nodata"),type:"success"}):t.$message({message:t.$t("mapmanagement.searchsuccess"),type:"success"})),t.searchList.count=20})},clearBtn:function(){1==this.$store.state.userInfo.prionum||2==this.$store.state.userInfo.prionum?this.searchList={mapid:"",status:"",page:1,count:this.pageCount,projectid:""}:3!=this.$store.state.userInfo.prionum&&4!=this.$store.state.userInfo.prionum&&5!=this.$store.state.userInfo.prionum||(this.searchList={mapid:"",status:"",page:1,count:this.pageCount,projectid:this.$store.state.intoProjectid}),this.currentPage1=1,this.getMapInfoLists()},editMap:function(t){if(1==this.contrForPrionum||2==this.contrForPrionum)if(this.tableData[t].inuseNum>0?this.statusList=[{index:3,value:"Pass"},{index:5,value:"Lock"}]:this.statusList=[{index:1,value:"Draft"},{index:2,value:"Audit"},{index:3,value:"Pass"},{index:4,value:"Fail"},{index:5,value:"Lock"}],this.passEdit=!0,this.editData.mapid=this.tableData[t].mapid,this.editData.status=this.tableData[t].status,this.editData.mapname=this.tableData[t].mapname,this.editData.width=this.tableData[t].width,this.editData.length=this.tableData[t].length,this.editData.instruction=this.tableData[t].instruction,this.editData.memo=this.tableData[t].memo,this.editData.sysmemo=this.tableData[t].sysmemo,this.editData.projectid=this.tableData[t].projectid,this.editData.distance=this.tableData[t].distance,this.editData.reallength=this.tableData[t].reallength,this.editData.realwidth=this.tableData[t].realwidth,this.editData.active=this.tableData[t].active,1==this.tableData[t].maptype){this.imgUrl="",this.srcList=[];var e=l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/";this.imgUrl=e+"indoormap/"+this.tableData[t].filetype,this.srcList.push((l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/")+"indoormap/"+this.tableData[t].filetype),this.edit2D=!0}else this.editData.filename=this.tableData[t].filename,this.fmapId=this.tableData[t].filename,this.fmapKey=this.tableData[t].mapkey,this.themeId=this.tableData[t].filetype,this.fmapName=this.tableData[t].appname,this.edit3D=!0,this.loading=!0;else this.tableData[t].inuseNum>0?this.changeImg=!0:this.changeImg=!1,1==this.tableData[t].status||4==this.tableData[t].status?this.auditBtn=!0:this.auditBtn=!1,this.editDatas.mapid=this.tableData[t].mapid,this.editDatas.status=this.tableData[t].status,this.editDatas.mapname=this.tableData[t].mapname,this.editDatas.width=this.tableData[t].width,this.editDatas.length=this.tableData[t].length,this.editDatas.instruction=this.tableData[t].instruction,this.editDatas.memo=this.tableData[t].memo,this.editDatas.sysmemo=this.tableData[t].sysmemo,this.editDatas.projectid=this.tableData[t].projectid,this.editDatas.realwidth=this.tableData[t].realwidth,this.editDatas.reallength=this.tableData[t].reallength,this.editDatas.distance=this.tableData[t].distance,this.editDatas.active=this.tableData[t].active,1==this.tableData[t].maptype?(this.needChangeAPI=!0,this.fileListEdit=[{name:this.tableData[t].mapname,url:(l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/")+"indoormap/"+this.tableData[t].filetype}],this.editCompany2D=!0):(this.editData.mapid=this.tableData[t].mapid,this.editData.status=this.tableData[t].status,this.editData.mapname=this.tableData[t].mapname,this.editData.instruction=this.tableData[t].instruction,this.editData.memo=this.tableData[t].memo,this.editData.sysmemo=this.tableData[t].sysmemo,this.editData.projectid=this.tableData[t].projectid,this.editData.distance=this.tableData[t].distance,this.editData.width=this.tableData[t].width,this.editData.length=this.tableData[t].length,this.editData.realwidth=this.tableData[t].realwidth,this.editData.reallength=this.tableData[t].reallength,this.editData.active=this.tableData[t].active,this.editData.filename=this.tableData[t].filename,this.editData.scale=this.tableData[t].scale,this.fmapId=this.tableData[t].filename,this.fmapKey=this.tableData[t].mapkey,this.themeId=this.tableData[t].filetype,this.fmapName=this.tableData[t].appname,this.edit3D=!0,this.loading=!0)},editTrue:function(t){var e=this,n=this;this.$refs[t].validate(function(t){if(!t)return!1;Object(w._172)(e.editData,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.edit2D=!1,n.getMapInfoLists(),n.getSearchMapInfoList(),n.$message({message:n.$t("mapmanagement.editsuccess"),type:"success"})):e.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})})})},editTrue3D:function(t){var e=this,n=this;this.editData.filetype=this.themeId,this.$refs[t].validate(function(t){if(!t)return!1;Object(w._172)(e.editData,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.edit3D=!1,n.getMapInfoLists(),n.getSearchMapInfoList(),n.$message({message:n.$t("mapmanagement.editsuccess"),type:"success"})):n.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})})})},auditTrues3D:function(t){var e=this,n=this;this.$refs[t].validate(function(t){if(!t)return!1;e.editData.status=2,Object(w._172)(e.editData,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.edit3D=!1,n.getMapInfoLists(),n.getSearchMapInfoList(),n.$message({message:n.$t("mapmanagement.Submittedsuccessfully"),type:"success"})):n.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})})})},choseApi:function(t,e){this.needChangeAPI&&(this.choseApiEdit=!0)},editTrues:function(t){var e=this,n=this;this.$refs[t].validate(function(t){t&&(e.choseApiEdit?(e.userIdForPicEdit.projectid=e.editDatas.projectid,e.userIdForPicEdit.mapid=e.editDatas.mapid,e.userIdForPicEdit.mapname=e.editDatas.mapname,e.userIdForPicEdit.status=1,e.userIdForPicEdit.width=e.editDatas.width,e.userIdForPicEdit.length=e.editDatas.length,e.userIdForPicEdit.memo=e.editDatas.memo,e.userIdForPicEdit.distance=e.editDatas.distance,e.userIdForPicEdit.reallength=e.editDatas.reallength,e.userIdForPicEdit.realwidth=e.editDatas.realwidth,e.userIdForPicEdit.active=e.editDatas.active,e.$refs.upload.submit()):(0==e.changeImg&&(e.editDatas.status=1),Object(w._172)(e.editDatas,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.editCompany2D=!1,n.getMapInfoLists(),n.getSearchMapInfoList(),n.$message({message:n.$t("mapmanagement.editsuccess"),type:"success"})):n.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})})))})},auditTrues:function(t){var e=this,n=this;this.$refs[t].validate(function(t){t&&(e.choseApiEdit?(e.userIdForPicEdit.projectid=e.editDatas.projectid,e.userIdForPicEdit.mapid=e.editDatas.mapid,e.userIdForPicEdit.mapname=e.editDatas.mapname,e.userIdForPicEdit.status=2,e.userIdForPicEdit.width=e.editDatas.width,e.userIdForPicEdit.length=e.editDatas.length,e.userIdForPicEdit.memo=e.editDatas.memo,e.userIdForPicEdit.realwidth=e.editDatas.realwidth,e.userIdForPicEdit.reallength=e.editDatas.reallength,e.userIdForPicEdit.distance=e.editDatas.distance,e.userIdForPicEdit.active=e.editDatas.active,e.$refs.upload.submit()):(e.editDatas.status=2,Object(w._172)(e.editDatas,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(n.editCompany2D=!1,n.getMapInfoLists(),n.getSearchMapInfoList(),n.$message({message:n.$t("mapmanagement.Submittedsuccessfully"),type:"success"})):n.$message({message:"zh"==n.$store.state.i18n?t.msg:t.enMsg,type:"error"})})))})},delMap:function(t){if(5==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio||4==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio)this.$message({message:this.$t("warning.permissiondelete"),type:"warning"});else{if(this.tableData[t].inuseNum<1){this.statusList=[{index:1,value:"Draft"},{index:2,value:"Audit"},{index:3,value:"Pass"},{index:4,value:"Fail"},{index:5,value:"Lock"}],this.imgUrl="",this.srcList=[],this.delData=this.tableData[t];var e=l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/";this.imgUrl=e+"indoormap/"+this.tableData[t].filetype,this.srcList.push((l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/")+"indoormap/"+this.tableData[t].filetype),this.del=!0}else this.tableData[t].inuseNum>0&&this.$message({message:this.$t("mapmanagements.cannotdeleted"),type:"warning"})}},delTrue:function(){var t=this,e={mapid:this.delData.mapid};Object(w.Q)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?(t.del=!1,t.getMapInfoLists(),t.getSearchMapInfoList(),t.$message({message:t.$t("beacon.deletesuccess"),type:"success"})):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})},checkMap:function(t){var e=this;if(1!=this.tableData[t].status)if(4!=this.tableData[t].status)if(this.tableData[t].inuseNum>0?this.statusList=[{index:3,value:"Pass"},{index:5,value:"Lock"}]:this.statusList=[{index:1,value:"Draft"},{index:2,value:"Audit"},{index:3,value:"Pass"},{index:4,value:"Fail"},{index:5,value:"Lock"}],this.checkData=this.tableData[t],1==this.tableData[t].maptype){this.imgUrl="",this.srcList=[],this.imgUrl=(l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/")+"indoormap/"+this.tableData[t].filetype,this.srcList.push((l.a.host&&l.a.host.endsWith("/")?l.a.host:l.a.host+"/")+"indoormap/"+this.tableData[t].filetype);var n=new Image;n.src=this.imgUrl,n.onload=function(){e.$set(e.imageInfo,"width",n.width),e.$set(e.imageInfo,"height",n.height)},this.check=!0}else this.fmapId=this.tableData[t].filename,this.fmapKey=this.tableData[t].mapkey,this.themeId=this.tableData[t].filetype,this.fmapName=this.tableData[t].appname,this.clickTrue=!0,this.check3D=!0,this.loading=!0;else e.$message({message:this.$t("mapmanagement.tit3"),type:"warning"});else e.$message({message:this.$t("mapmanagement.tit2"),type:"warning"})},onmap:function(){var t=this,e={container:document.getElementById("fengMap"),level:1,visibleLevels:[1],focusAlphaMode:!1,focusAlpha:.1,appName:t.fmapName,key:t.fmapKey,mapID:t.fmapId,defaultControlsPose:0,modelSelectedEffect:!1,defaultViewMode:s.a.FMViewMode.MODE_3D,themeID:t.themeId};this.map3d=new s.a.FMMap(e),this.map3d.on("loaded",function(){t.check3D&&(""!=t.checkData.width&&0!=t.checkData.width||""!=t.checkData.length&&0!=t.checkData.length||""!=t.checkData.realwidth&&0!=t.checkData.realwidth||""!=t.checkData.reallength&&0!=t.checkData.reallength?t.clickTrue=!1:(t.checkData.width=t.map3d.getBound().min.y,t.checkData.length=t.map3d.getBound().min.x,t.checkData.realwidth=t.map3d.getBound().max.y,t.checkData.reallength=t.map3d.getBound().max.x,t.clickTrue=!1)),t.loading=!1,t.loadScrollFloorCtrl()})},closeCheck:function(t){this.map3d.dispose(),this.check3D=!1,this.edit3D=!1,this.$refs[t].resetFields()},loadScrollFloorCtrl:function(){var t={position:s.a.FMControlPosition.RIGHT_TOP,floorButtonCount:5,offset:{x:-20,y:80},viewModeControl:!0,floorModeControl:!0,needAllLayerBtn:!1};this.scrollFloorControl=new s.a.FMToolbar(t),this.scrollFloorControl.addTo(this.map3d)},checkCancle:function(t){this.check=!1,this.$refs[t].resetFields()},checkTrue:function(t){var e=this,n=this;this.$refs[t].validate(function(i){if(!i)return!1;var r={mapid:e.checkData.mapid,status:e.checkData.status,instruction:e.checkData.instruction,width:e.checkData.width,length:e.checkData.length,realwidth:e.checkData.realwidth,reallength:e.checkData.reallength};Object(w.y)(r,e.tenantkey_A,e.tenantid_A,e.userName).then(function(e){1001==e.code?(n.check=!1,n.check3D=!1,n.getMapInfoLists(),n.getSearchMapInfoList(),n.$message({message:n.$t("mapmanagement.checksuccess"),type:"success"}),n.$refs[t].resetFields()):n.$message({message:"zh"==n.$store.state.i18n?e.msg:e.enMsg,type:"error"})})})},autoWidth:function(){return 1==this.contrForPrionum?"100px":2==this.contrForPrionum||3==this.contrForPrionum?"150px":4==this.contrForPrionum?"80px":void 0},goProject:function(){this.$router.push("/projectmanagement")},closeMap:function(){this.dialogImageUrl=""},chooseMapPoint:function(){var t=this;if(this.editCompany2D&&(this.dialogImageUrl=this.fileListEdit[0].url),""!=this.dialogImageUrl){var e=new Image;e.src=this.dialogImageUrl,e.onload=function(){t.imageX=e.width,t.imageY=e.height,t.mapInit(e.width,e.height)},this.dialogVisible=!0}else t.$message({message:this.$t("mapmanagement.tit4"),type:"warning"})}},beforeMount:function(){1==this.$store.state.userInfo.prionum||2==this.$store.state.userInfo.prionum?this.searchList={mapid:"",status:"",page:1,count:20,projectid:""}:3!=this.$store.state.userInfo.prionum&&4!=this.$store.state.userInfo.prionum&&5!=this.$store.state.userInfo.prionum||(this.searchList.projectid=this.$store.state.intoProjectid,this.getProjectListByTenantids()),this.getMapInfoLists(),this.getSearchMapInfoList()},watch:{"$i18n.locale":function(){this.i8n=this.$store.state.i18n,r()(this.$data.addRules,this.$options.data.call(this).addRules)}}},M={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:5!=t.contrForPrionum?"home":"",staticStyle:{height:"100%"}},[5!=t.contrForPrionum?i("div",{staticClass:"menu_header"},[i("Menu")],1):t._e(),t._v(" "),i("div",{staticClass:"content"},[i("el-container",{class:5==t.contrForPrionum?"user":"asi"},[3==t.contrForPrionum||4==t.contrForPrionum?i("el-aside",[i("Project")],1):t._e(),t._v(" "),i("el-main",[3==t.contrForPrionum||4==t.contrForPrionum?i("div",{staticClass:"map_pinut"},[i("el-breadcrumb",{staticStyle:{"margin-left":"0"},attrs:{separator:"/"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/projectmanagement"}}},[t._v(t._s(t.$t("index.projectmanagement")))]),t._v(" "),i("el-breadcrumb-item",[t._v(t._s(t.intoProjectName))]),t._v(" "),i("el-breadcrumb-item",[t._v(t._s(t.$t("index.Mapmanagement")))])],1),t._v(" "),i("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap","justify-content":"end"},attrs:{model:t.searchList}},[i("el-form-item",{staticStyle:{display:"flex","margin-right":"0"},attrs:{label:t.$t("mapmanagements.Mapnumber")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",remote:"","remote-method":t.remoteMapMethod,placeholder:t.$t("staffmanagement.text")},model:{value:t.searchList.mapid,callback:function(e){t.$set(t.searchList,"mapid",e)},expression:"searchList.mapid"}},t._l(t.mapOptions,function(e){return i("el-option",{key:e.maplabel,attrs:{label:e.mapname,value:e.maplabel}},[i("span",{staticStyle:{float:"left"}},[t._v(t._s(e.mapname))]),t._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.maplabel))])])}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex","margin-left":"2%"}},[i("el-button",{staticClass:"query",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("mapmanagements.search")))]),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("mapmanagements.reset")))]),t._v(" "),i("el-popover",{model:{value:t.choseMap,callback:function(e){t.choseMap=e},expression:"choseMap"}},[i("div",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.addMap2D()}}},[t._v(t._s(t.$t("mapmanagements.sDmap")))]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.addMap3D()}}},[t._v(t._s(t.$t("mapmanagements.tDmap")))])],1),t._v(" "),i("el-button",{staticClass:"del move",attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v(t._s(t.$t("mapmanagements.Addmap")))])],1)],1)],1)],1):t._e(),t._v(" "),5==t.contrForPrionum?i("div",{staticClass:"map_pinut",staticStyle:{display:"flex"}},[i("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap","margin-left":"2%"},attrs:{model:t.searchList}},[i("el-form-item",{staticStyle:{display:"flex","margin-right":"0"},attrs:{label:t.$t("mapmanagements.Mapnumber")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",remote:"","remote-method":t.remoteMapMethod,placeholder:t.$t("staffmanagement.text")},model:{value:t.searchList.mapid,callback:function(e){t.$set(t.searchList,"mapid",e)},expression:"searchList.mapid"}},t._l(t.mapOptions,function(e){return i("el-option",{key:e.maplabel,attrs:{label:e.mapname,value:e.maplabel}},[i("span",{staticStyle:{float:"left"}},[t._v(t._s(e.mapname))]),t._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.maplabel))])])}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"2%"}},[i("el-button",{staticClass:"query",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("mapmanagements.search")))]),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("mapmanagements.reset")))]),t._v(" "),i("el-popover",{attrs:{placement:"top"},model:{value:t.choseMap,callback:function(e){t.choseMap=e},expression:"choseMap"}},[i("div",{staticStyle:{display:"flex"}},[i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.addMap2D()}}},[t._v(t._s(t.$t("mapmanagements.sDmap")))]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.addMap3D()}}},[t._v(t._s(t.$t("mapmanagements.tDmap")))])],1),t._v(" "),i("el-button",{staticClass:"del move",attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v(t._s(t.$t("mapmanagements.Addmap")))])],1)],1)],1)],1):t._e(),t._v(" "),1==t.contrForPrionum||2==t.contrForPrionum?i("div",{staticClass:"map_pinut"},[i("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap"},attrs:{model:t.searchList}},[i("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("mapmanagement.mapid")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",remote:"","remote-method":t.remoteMapMethod,placeholder:t.$t("staffmanagement.text")},model:{value:t.searchList.mapid,callback:function(e){t.$set(t.searchList,"mapid",e)},expression:"searchList.mapid"}},t._l(t.mapOptions,function(e){return i("el-option",{key:e.maplabel,attrs:{label:e.mapname,value:e.maplabel}},[i("span",{staticStyle:{float:"left"}},[t._v(t._s(e.mapname))]),t._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[t._v(t._s(e.maplabel))])])}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("mapmanagement.statusstr1")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.searchList.status,callback:function(e){t.$set(t.searchList,"status",e)},expression:"searchList.status"}},t._l(t.searchStatus,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{"margin-left":"1%"}},[i("el-button",{staticClass:"query",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("terminal.search")))]),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("terminal.reset")))])],1)],1)],1):t._e(),t._v(" "),i("div",{staticClass:"content_map"},[i("el-table",{ref:"multipleTable",staticStyle:{width:"98%","text-align":"center","margin-left":"2%","z-index":"1"},attrs:{data:t.tableData,"max-height":"660",border:"","highlight-current-row":""}},[1==t.contrForPrionum||2==t.contrForPrionum?i("el-table-column",{attrs:{property:"customername",label:t.$t("mapmanagement.customername"),"show-overflow-tooltip":"","min-width":"100",align:"center"}}):t._e(),t._v(" "),i("el-table-column",{attrs:{property:"mapid",label:t.$t("mapmanagements.mapnumber"),"show-overflow-tooltip":"","min-width":"77",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"mapname",label:t.$t("mapmanagements.mapname"),"show-overflow-tooltip":"","min-width":"100",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"statusstr",label:t.$t("mapmanagements.ApprovalStatus"),"show-overflow-tooltip":"","min-width":"77",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"instruction",label:t.$t("mapmanagements.Auditopinion"),"show-overflow-tooltip":"","min-width":"95",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"maptypestr",label:t.$t("mapmanagements.mapdimension"),"show-overflow-tooltip":"","min-width":"90",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"width",label:t.$t("mapmanagements.mapwidth"),"show-overflow-tooltip":"","min-width":"110",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[i("span",{staticClass:"cell",staticStyle:{"padding-right":"0"}},[t._v(t._s(t.$t("mapmanagements.mapwidth")))]),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"130%"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.$t("mapmanagements.text1")))])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"length",label:t.$t("mapmanagements.maplength"),"show-overflow-tooltip":"","min-width":"110",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[i("span",{staticClass:"cell",staticStyle:{"padding-right":"0"}},[t._v(t._s(t.$t("mapmanagements.maplength")))]),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"130%"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.$t("mapmanagements.text2")))])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"realwidth",label:t.$t("mapmanagements.actualwidthofthemap"),"show-overflow-tooltip":"","min-width":"140",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[i("span",{staticClass:"cell",staticStyle:{"padding-right":"0"}},[t._v(t._s(t.$t("mapmanagements.actualwidthofthemap")))]),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"130%"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.$t("mapmanagements.text3")))])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"reallength",label:t.$t("mapmanagements.actuallengthofthemap"),"show-overflow-tooltip":"","min-width":"140",align:"center"},scopedSlots:t._u([{key:"header",fn:function(e){return[i("span",{staticClass:"cell",staticStyle:{"padding-right":"0"}},[t._v(t._s(t.$t("mapmanagements.actuallengthofthemap")))]),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"130%"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.$t("mapmanagements.text4")))])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"distance",label:t.$t("mapmanagements.Sensitivity"),"show-overflow-tooltip":"","min-width":"88",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"active",label:t.$t("mapmanagements.Activity"),"show-overflow-tooltip":"","min-width":"77",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"creattime",label:t.$t("mapmanagements.mapcreationtime"),"show-overflow-tooltip":"",formatter:t.formatDateCreattime,"min-width":"115",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"edittime",label:t.$t("mapmanagements.mapedittime"),"show-overflow-tooltip":"",formatter:t.formatDateEdittime,"min-width":"115",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"audittime",label:t.$t("mapmanagements.mapreviewtime"),"show-overflow-tooltip":"",formatter:t.formatDateAudittime,"min-width":"115",align:"center"}}),t._v(" "),1==t.contrForPrionum||2==t.contrForPrionum?i("el-table-column",{attrs:{property:"sysmemo",label:t.$t("mapmanagement.sysmemo"),"show-overflow-tooltip":"",align:"center","min-width":"120"}}):t._e(),t._v(" "),1!=t.contrForPrionum&&2!=t.contrForPrionum?i("el-table-column",{attrs:{property:"memo",label:t.$t("mapmanagements.Remark"),align:"center","show-overflow-tooltip":"","min-width":"120"}}):t._e(),t._v(" "),1==t.contrForPrionum||2==t.contrForPrionum||3==t.contrForPrionum||4==t.contrForPrionum||5==t.contrForPrionum?i("el-table-column",{attrs:{fixed:"right",label:t.$t("mapmanagements.operate"),align:"center","min-width":"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-dropdown",{attrs:{size:"mini",type:"primary",trigger:"click"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("staff.operate"),placement:"top"}},[i("el-button",{staticClass:"icon_button",attrs:{type:"primary"}},[i("img",{attrs:{src:n("VJ6t")}})])],1),t._v(" "),i("el-dropdown-menu",{staticClass:"selects",staticStyle:{"background-color":"rgb(219, 222, 231)"},attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{staticStyle:{"margin-top":"4%","background-color":"rgb(219, 222, 231)"}},[1==t.contrForPrionum||2==t.contrForPrionum||3==t.contrForPrionum||4==t.contrForPrionum||5==t.contrForPrionum?i("el-button",{staticClass:"edits",attrs:{size:"mini"},on:{click:function(n){return t.editMap(e.$index)}}},[t._v(t._s(t.$t("mapmanagements.edit")))]):t._e()],1),t._v(" "),i("el-dropdown-item",{staticStyle:{"margin-top":"4%","background-color":"rgb(219, 222, 231)"}},[1==t.contrForPrionum||2==t.contrForPrionum||3==t.contrForPrionum||4==t.contrForPrionum||5==t.contrForPrionum?i("el-button",{staticClass:"dels1",attrs:{size:"mini"},on:{click:function(n){return t.delMap(e.$index)}}},[t._v(t._s(t.$t("mapmanagements.delete")))]):t._e()],1),t._v(" "),i("el-dropdown-item",{staticStyle:{"margin-top":"4%","background-color":"rgb(219, 222, 231)"}},[1==t.contrForPrionum||2==t.contrForPrionum?i("el-button",{staticClass:"dels",attrs:{size:"mini"},on:{click:function(n){return t.checkMap(e.$index)}}},[t._v(t._s(t.$t("mapmanagements.examine")))]):t._e()],1)],1)],1)]}}],null,!1,1951430512)}):t._e()],1),t._v(" "),i("div",{staticClass:"block",staticStyle:{"text-align":"center",width:"100%","margin-top":"1%"}},[i("el-pagination",{attrs:{"current-page":t.currentPage1,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-size":20},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text5"),width:"30%",visible:t.add2D},on:{"update:visible":function(e){t.add2D=e},close:function(e){return t.addCancel2D("addData")}}},[i("el-upload",{ref:"upload",attrs:{action:t.ImagePath,"list-type":"picture-card","file-list":t.fileListAdd,"on-preview":t.handlePictureCardPreview,accept:".png, .jpg, .jpeg",limit:1,data:t.userIdForPic,"on-success":t.picSuccess,"on-error":t.picError,headers:t.myHeader,"auto-upload":!1,"on-exceed":t.handleExceed,"before-upload":t.beforeAvatarUpload,"on-change":t.handleChange}},[i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n              "+t._s(t.$t("mapmanagements.text6"))+"\n            ")]),t._v(" "),i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-form",{ref:"addData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.addData,"label-width":"120px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname"),prop:"mapname"}},[i("el-input",{model:{value:t.addData.mapname,callback:function(e){t.$set(t.addData,"mapname",e)},expression:"addData.mapname"}})],1),t._v(" "),i("el-form-item",{staticClass:"actual_width",attrs:{label:t.$t("mapmanagements.Actualwidth"),prop:"realwidth"}},[i("el-input",{model:{value:t.addData.realwidth,callback:function(e){t.$set(t.addData,"realwidth",e)},expression:"addData.realwidth"}}),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.chooseMapPoint()}}},[t._v(t._s(t.$t("mapmanagements.mapselection")))]),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"130%"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text7"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actuallength"),prop:"reallength"}},[i("el-input",{model:{value:t.addData.reallength,callback:function(e){t.$set(t.addData,"reallength",e)},expression:"addData.reallength"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text8"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity"),prop:"distance"}},[i("el-input",{model:{value:t.addData.distance,callback:function(e){t.$set(t.addData,"distance",e)},expression:"addData.distance"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text9"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity"),prop:"active"}},[i("el-input",{model:{value:t.addData.active,callback:function(e){t.$set(t.addData,"active",e)},expression:"addData.active"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text10"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.Project"),prop:""}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.addData.projectid,callback:function(e){t.$set(t.addData,"projectid",e)},expression:"addData.projectid"}},t._l(t.projectList,function(t){return i("el-option",{key:t.projectid,attrs:{label:t.name,value:t.projectid}})}),1)],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.addData.memo,callback:function(e){t.$set(t.addData,"memo",e)},expression:"addData.memo"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.addCancel2D("addData")}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addTrue2D("addData")}}},[t._v(t._s(t.$t("warning.Sure")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.auditTrue2D("addData")}}},[t._v(t._s(t.$t("mapmanagements.Submitreview")))])],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text5"),width:"30%",visible:t.add3D},on:{"update:visible":function(e){t.add3D=e},close:function(e){return t.addCancel3D("addData")}}},[i("el-form",{ref:"addData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.addData,"label-width":"120px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname"),prop:"mapname"}},[i("el-input",{model:{value:t.addData.mapname,callback:function(e){t.$set(t.addData,"mapname",e)},expression:"addData.mapname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.mapNumber"),prop:"filename"}},[i("el-input",{model:{value:t.addData.filename,callback:function(e){t.$set(t.addData,"filename",e)},expression:"addData.filename"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.appName"),prop:"appname"}},[i("el-input",{model:{value:t.addData.appname,callback:function(e){t.$set(t.addData,"appname",e)},expression:"addData.appname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.appKey"),prop:"mapkey"}},[i("el-input",{model:{value:t.addData.mapkey,callback:function(e){t.$set(t.addData,"mapkey",e)},expression:"addData.mapkey"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.themeId"),prop:""}},[i("el-input",{model:{value:t.themeId,callback:function(e){t.themeId=e},expression:"themeId"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity"),prop:"distance"}},[i("el-input",{model:{value:t.addData.distance,callback:function(e){t.$set(t.addData,"distance",e)},expression:"addData.distance"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text9"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity"),prop:"active"}},[i("el-input",{model:{value:t.addData.active,callback:function(e){t.$set(t.addData,"active",e)},expression:"addData.active"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text10"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.scale"),prop:"scale"}},[i("el-input",{model:{value:t.addData.scale,callback:function(e){t.$set(t.addData,"scale",e)},expression:"addData.scale"}})],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.Project"),prop:""}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.addData.projectid,callback:function(e){t.$set(t.addData,"projectid",e)},expression:"addData.projectid"}},t._l(t.projectList,function(t){return i("el-option",{key:t.projectid,attrs:{label:t.name,value:t.projectid}})}),1)],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.addData.memo,callback:function(e){t.$set(t.addData,"memo",e)},expression:"addData.memo"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.addCancel3D("addData")}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addTrue3D("addData")}}},[t._v(t._s(t.$t("warning.Sure")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.auditTrue3D("addData")}}},[t._v(t._s(t.$t("mapmanagements.Submitreview")))])],1)],1),t._v(" "),i("el-dialog",{staticClass:"mapview",attrs:{width:"60%",visible:t.dialogVisible,"append-to-body":!0},on:{"update:visible":function(e){t.dialogVisible=e},close:function(e){return t.removeMap()}}},[i("div",{ref:"mapContent",staticClass:"mapContent"},[i("div",{ref:"map",attrs:{id:"map"}}),t._v(" "),i("p",{staticClass:"map_tips"},[t._v("\n              "+t._s(t.$t("mapmanagements.text11"))),i("input",{directives:[{name:"model",rawName:"v-model",value:t.actualrange,expression:"actualrange"}],ref:"actualrange",class:2==t.featureNum?"actualrange":"actualrange_dis",attrs:{type:"text",name:"actualrange",disabled:2!=t.featureNum},domProps:{value:t.actualrange},on:{input:function(e){e.target.composing||(t.actualrange=e.target.value)}}}),t._v(t._s(t.$t("mapmanagements.text12"))+"\n            ")])]),t._v(" "),i("div",{staticClass:"mapview_dialog_footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.distanceTrue()}}},[t._v(t._s(t.$t("warning.Sure")))])],1)]),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text13"),width:"30%",visible:t.del},on:{"update:visible":function(e){t.del=e}}},[i("div",{staticClass:"imageSize"},[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.imgUrl,"preview-src-list":t.srcList}})],1),t._v(" "),i("el-form",{ref:"delData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.delData,"label-width":"100px"}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname")}},[i("el-input",{attrs:{disabled:""},model:{value:t.delData.mapname,callback:function(e){t.$set(t.delData,"mapname",e)},expression:"delData.mapname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actualwidth")}},[i("el-input",{attrs:{disabled:""},model:{value:t.delData.realwidth,callback:function(e){t.$set(t.delData,"realwidth",e)},expression:"delData.realwidth"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actuallength")}},[i("el-input",{attrs:{disabled:""},model:{value:t.delData.reallength,callback:function(e){t.$set(t.delData,"reallength",e)},expression:"delData.reallength"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity")}},[i("el-input",{attrs:{disabled:""},model:{value:t.delData.distance,callback:function(e){t.$set(t.delData,"distance",e)},expression:"delData.distance"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity")}},[i("el-input",{attrs:{disabled:""},model:{value:t.delData.active,callback:function(e){t.$set(t.delData,"active",e)},expression:"delData.active"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Auditstatus")}},[i("el-select",{attrs:{disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.delData.status,callback:function(e){t.$set(t.delData,"status",e)},expression:"delData.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64",disabled:""},model:{value:t.delData.memo,callback:function(e){t.$set(t.delData,"memo",e)},expression:"delData.memo"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.del=!1}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.delTrue("delData")}}},[t._v(t._s(t.$t("warning.Sure")))])],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{width:"30%",visible:t.edit2D},on:{"update:visible":function(e){t.edit2D=e}}},[i("div",{staticClass:"imageSize"},[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.imgUrl,"preview-src-list":t.srcList}})],1),t._v(" "),i("el-form",{ref:"editData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.editData,"label-width":"120px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname"),prop:"mapname"}},[i("el-input",{attrs:{disabled:t.passEdit},model:{value:t.editData.mapname,callback:function(e){t.$set(t.editData,"mapname",e)},expression:"editData.mapname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actualwidth"),prop:"realwidth"}},[i("el-input",{model:{value:t.editData.realwidth,callback:function(e){t.$set(t.editData,"realwidth",e)},expression:"editData.realwidth"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text15"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actuallength"),prop:"reallength"}},[i("el-input",{model:{value:t.editData.reallength,callback:function(e){t.$set(t.editData,"reallength",e)},expression:"editData.reallength"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.$t("mapmanagements.text16")))])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity"),prop:"distance"}},[i("el-input",{model:{value:t.editData.distance,callback:function(e){t.$set(t.editData,"distance",e)},expression:"editData.distance"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text17"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity"),prop:"active"}},[i("el-input",{model:{value:t.editData.active,callback:function(e){t.$set(t.editData,"active",e)},expression:"editData.active"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text18"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.Project"),prop:""}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:t.passEdit,placeholder:t.$t("terminal.choose")},model:{value:t.editData.projectid,callback:function(e){t.$set(t.editData,"projectid",e)},expression:"editData.projectid"}},t._l(t.projectList,function(t){return i("el-option",{key:t.projectid,attrs:{label:t.name,value:t.projectid}})}),1)],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Auditstatus")}},[i("el-select",{attrs:{disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.editData.status,callback:function(e){t.$set(t.editData,"status",e)},expression:"editData.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),1==t.contrForPrionum||2==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagement.sysmemo1")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.editData.sysmemo,callback:function(e){t.$set(t.editData,"sysmemo",e)},expression:"editData.sysmemo"}})],1):t._e(),t._v(" "),1!=t.contrForPrionum&&2!=t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.editData.memo,callback:function(e){t.$set(t.editData,"memo",e)},expression:"editData.memo"}})],1):t._e()],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.edit2D=!1}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editTrue("editData")}}},[t._v(t._s(t.$t("warning.Sure")))])],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text14"),width:"30%",visible:t.editCompany2D},on:{"update:visible":function(e){t.editCompany2D=e},close:function(e){return t.closeMap()}}},[i("el-upload",{ref:"upload",attrs:{disabled:t.changeImg,action:t.ImagePathEdit,"list-type":"picture-card","file-list":t.fileListEdit,"on-preview":t.handlePictureCardPreviewEdit,accept:".png, .jpg, .jpeg",limit:1,data:t.userIdForPicEdit,"on-success":t.picSuccessEdit,"on-error":t.picErrorEdit,headers:t.myHeaderEdit,"auto-upload":!1,"on-change":t.choseApi,"on-exceed":t.handleExceedEdit,"before-upload":t.beforeAvatarUploadEdit}},[i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("\n              "+t._s(t.$t("mapmanagements.text6"))+"\n            ")]),t._v(" "),i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-form",{ref:"editDatas",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.editDatas,"label-width":"120px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname"),prop:"mapname"}},[i("el-input",{attrs:{disabled:t.changeImg},model:{value:t.editDatas.mapname,callback:function(e){t.$set(t.editDatas,"mapname",e)},expression:"editDatas.mapname"}})],1),t._v(" "),i("el-form-item",{staticClass:"actual_width",attrs:{label:t.$t("mapmanagements.Actualwidth"),prop:"realwidth"}},[i("el-input",{model:{value:t.editDatas.realwidth,callback:function(e){t.$set(t.editDatas,"realwidth",e)},expression:"editDatas.realwidth"}}),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.chooseMapPoint()}}},[t._v(t._s(t.$t("mapmanagements.mapselection")))]),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{"font-size":"130%"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text15"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actuallength"),prop:"reallength"}},[i("el-input",{model:{value:t.editDatas.reallength,callback:function(e){t.$set(t.editDatas,"reallength",e)},expression:"editDatas.reallength"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v(t._s(t.$t("mapmanagements.text16")))])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity"),prop:"distance"}},[i("el-input",{model:{value:t.editDatas.distance,callback:function(e){t.$set(t.editDatas,"distance",e)},expression:"editDatas.distance"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text17"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity"),prop:"active"}},[i("el-input",{model:{value:t.editDatas.active,callback:function(e){t.$set(t.editDatas,"active",e)},expression:"editDatas.active"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                    "+t._s(t.$t("mapmanagements.text18"))+"\n                  ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.Project"),prop:""}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.editDatas.projectid,callback:function(e){t.$set(t.editDatas,"projectid",e)},expression:"editDatas.projectid"}},t._l(t.projectList,function(t){return i("el-option",{key:t.projectid,attrs:{label:t.name,value:t.projectid}})}),1)],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Auditstatus")}},[i("el-select",{attrs:{disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.editDatas.status,callback:function(e){t.$set(t.editDatas,"status",e)},expression:"editDatas.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),1==t.contrForPrionum||2==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagement.sysmemo1")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.editDatas.sysmemo,callback:function(e){t.$set(t.editDatas,"sysmemo",e)},expression:"editDatas.sysmemo"}})],1):t._e(),t._v(" "),1!=t.contrForPrionum&&2!=t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.editDatas.memo,callback:function(e){t.$set(t.editDatas,"memo",e)},expression:"editDatas.memo"}})],1):t._e()],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.editCompany2D=!1}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editTrues("editDatas")}}},[t._v(t._s(t.$t("warning.Sure")))]),t._v(" "),t.auditBtn?i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.auditTrues("editDatas")}}},[t._v(t._s(t.$t("mapmanagements.Submitreview")))]):t._e()],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text14"),width:"60%",visible:t.edit3D},on:{"update:visible":function(e){t.edit3D=e},opened:function(e){return t.onmap()},close:function(e){return t.closeCheck("editData")}}},[i("div",{staticClass:"check_3d_box"},[i("div",{staticClass:"check_3d_info"},[i("el-form",{ref:"editData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.editData,"label-width":"120px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname"),prop:"mapname"}},[i("el-input",{model:{value:t.editData.mapname,callback:function(e){t.$set(t.editData,"mapname",e)},expression:"editData.mapname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.mapNumber"),prop:"filename"}},[i("el-input",{attrs:{disabled:""},model:{value:t.editData.filename,callback:function(e){t.$set(t.editData,"filename",e)},expression:"editData.filename"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.themeId"),prop:""}},[i("el-input",{model:{value:t.themeId,callback:function(e){t.themeId=e},expression:"themeId"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity"),prop:"distance"}},[i("el-input",{model:{value:t.editData.distance,callback:function(e){t.$set(t.editData,"distance",e)},expression:"editData.distance"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                        "+t._s(t.$t("mapmanagements.text17"))+"\n                      ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity"),prop:"active"}},[i("el-input",{model:{value:t.editData.active,callback:function(e){t.$set(t.editData,"active",e)},expression:"editData.active"}}),t._v(" "),i("el-tooltip",{staticClass:"item",staticStyle:{position:"absolute","font-size":"130%",top:"50%",transform:"translateY(-50%)","margin-left":"5px"},attrs:{effect:"light",placement:"right-start"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("p",[t._v("\n                        "+t._s(t.$t("mapmanagements.text18"))+"\n                      ")])]),t._v(" "),i("i",{staticClass:"el-icon-question"})])],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.scale"),prop:"scale"}},[i("el-input",{model:{value:t.editData.scale,callback:function(e){t.$set(t.editData,"scale",e)},expression:"editData.scale"}})],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.Project"),prop:""}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:t.passEdit,placeholder:t.$t("terminal.choose")},model:{value:t.editData.projectid,callback:function(e){t.$set(t.editData,"projectid",e)},expression:"editData.projectid"}},t._l(t.projectList,function(t){return i("el-option",{key:t.projectid,attrs:{label:t.name,value:t.projectid}})}),1)],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Auditstatus")}},[i("el-select",{attrs:{disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.editData.status,callback:function(e){t.$set(t.editData,"status",e)},expression:"editData.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),1==t.contrForPrionum||2==t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagement.sysmemo1")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.editData.sysmemo,callback:function(e){t.$set(t.editData,"sysmemo",e)},expression:"editData.sysmemo"}})],1):t._e(),t._v(" "),1!=t.contrForPrionum&&2!=t.contrForPrionum?i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64"},model:{value:t.editData.memo,callback:function(e){t.$set(t.editData,"memo",e)},expression:"editData.memo"}})],1):t._e()],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.closeCheck("editData")}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editTrue3D("editData")}}},[t._v(t._s(t.$t("warning.Sure")))]),t.auditBtn?i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.auditTrues3D("editData")}}},[t._v("\n                  "+t._s(t.$t("mapmanagements.Submitreview"))+"\n                ")]):t._e()],1)],1),t._v(" "),i("div",{staticClass:"check_3d_map"},[t.edit3D?i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"fengMap","element-loading-text":t.$t("mapmanagements.text19")}}):t._e()])])]),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text20"),width:"30%",visible:t.check},on:{"update:visible":function(e){t.check=e},close:function(e){return t.checkCancle("checkData")}}},[i("div",{staticClass:"imageSize"},[i("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.imgUrl,"preview-src-list":t.srcList}})],1),t._v(" "),i("el-form",{ref:"checkData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.checkData,"label-width":"150px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.mapname,callback:function(e){t.$set(t.checkData,"mapname",e)},expression:"checkData.mapname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.imagewidth")}},[i("el-input",{attrs:{disabled:""},model:{value:t.imageInfo.height,callback:function(e){t.$set(t.imageInfo,"height",e)},expression:"imageInfo.height"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.imagelength")}},[i("el-input",{attrs:{disabled:""},model:{value:t.imageInfo.width,callback:function(e){t.$set(t.imageInfo,"width",e)},expression:"imageInfo.width"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actualwidth")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.realwidth,callback:function(e){t.$set(t.checkData,"realwidth",e)},expression:"checkData.realwidth"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Actuallength")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.reallength,callback:function(e){t.$set(t.checkData,"reallength",e)},expression:"checkData.reallength"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.distance,callback:function(e){t.$set(t.checkData,"distance",e)},expression:"checkData.distance"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.active,callback:function(e){t.$set(t.checkData,"active",e)},expression:"checkData.active"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Projectname"),prop:""}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.projectname,callback:function(e){t.$set(t.checkData,"projectname",e)},expression:"checkData.projectname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Projectid"),prop:""}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.projectid,callback:function(e){t.$set(t.checkData,"projectid",e)},expression:"checkData.projectid"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Auditstatus"),prop:"status"}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.checkData.status,callback:function(e){t.$set(t.checkData,"status",e)},expression:"checkData.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Reviewcomments")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"255"},model:{value:t.checkData.instruction,callback:function(e){t.$set(t.checkData,"instruction",e)},expression:"checkData.instruction"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Systemremarks")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64",disabled:""},model:{value:t.checkData.sysmemo,callback:function(e){t.$set(t.checkData,"sysmemo",e)},expression:"checkData.sysmemo"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64",disabled:""},model:{value:t.checkData.memo,callback:function(e){t.$set(t.checkData,"memo",e)},expression:"checkData.memo"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.checkCancle("checkData")}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.checkTrue("checkData")}}},[t._v(t._s(t.$t("warning.Sure")))])],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("mapmanagements.text20"),width:"60%",visible:t.check3D},on:{"update:visible":function(e){t.check3D=e},opened:function(e){return t.onmap()},close:function(e){return t.closeCheck("checkData")}}},[i("div",{staticClass:"check_3d_box"},[i("div",{staticClass:"check_3d_info"},[i("el-form",{ref:"checkData",staticStyle:{"text-align":"left","margin-top":"4%"},attrs:{model:t.checkData,"label-width":"150px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapname")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.mapname,callback:function(e){t.$set(t.checkData,"mapname",e)},expression:"checkData.mapname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Mapnumber")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.mapid,callback:function(e){t.$set(t.checkData,"mapid",e)},expression:"checkData.mapid"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.sensitivity")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.distance,callback:function(e){t.$set(t.checkData,"distance",e)},expression:"checkData.distance"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.activity")}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.active,callback:function(e){t.$set(t.checkData,"active",e)},expression:"checkData.active"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Projectname"),prop:""}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.projectname,callback:function(e){t.$set(t.checkData,"projectname",e)},expression:"checkData.projectname"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Projectid"),prop:""}},[i("el-input",{attrs:{disabled:""},model:{value:t.checkData.projectid,callback:function(e){t.$set(t.checkData,"projectid",e)},expression:"checkData.projectid"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Auditstatus"),prop:"status"}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.checkData.status,callback:function(e){t.$set(t.checkData,"status",e)},expression:"checkData.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Reviewcomments")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"255"},model:{value:t.checkData.instruction,callback:function(e){t.$set(t.checkData,"instruction",e)},expression:"checkData.instruction"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.Systemremarks")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64",disabled:""},model:{value:t.checkData.sysmemo,callback:function(e){t.$set(t.checkData,"sysmemo",e)},expression:"checkData.sysmemo"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("mapmanagements.remark")}},[i("el-input",{attrs:{type:"textarea","show-word-limit":"",maxlength:"64",disabled:""},model:{value:t.checkData.memo,callback:function(e){t.$set(t.checkData,"memo",e)},expression:"checkData.memo"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.closeCheck("checkData")}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary",disabled:t.clickTrue},on:{click:function(e){return t.checkTrue("checkData")}}},[t._v(t._s(t.$t("warning.Sure")))])],1)],1),t._v(" "),i("div",{staticClass:"check_3d_map"},[t.check3D?i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"fengMap","element-loading-text":t.$t("mapmanagements.text19")}}):t._e()])])])],1)],1)],1)])},staticRenderFns:[]};var S=n("VU/8")(B,M,!1,function(t){n("fqQU")},"data-v-71ba8d12",null);e.default=S.exports},yYa5:function(t,e,n){var i;i=function(){return e=[function(t,e,n){var i;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i=function(){"use strict";var t=function(e,n){return(t=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}))(e,n)};function e(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var n=function(){return(n=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function i(t,e,n,i){return new(n=n||Promise)(function(r,o){function s(t){try{A(i.next(t))}catch(t){o(t)}}function a(t){try{A(i.throw(t))}catch(t){o(t)}}function A(t){var e;t.done?r(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(s,a)}A((i=i.apply(t,e||[])).next())})}function o(t,e){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]},s={next:a(0),throw:a(1),return:a(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){var A=[s,a];if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&A[0]?i.return:A[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,A[1])).done)return r;switch(i=0,(A=r?[2&A[0],r.value]:A)[0]){case 0:case 1:r=A;break;case 4:return o.label++,{value:A[1],done:!1};case 5:o.label++,i=A[1],A=[0];continue;case 7:A=o.ops.pop(),o.trys.pop();continue;default:if(!(r=0<(r=o.trys).length&&r[r.length-1])&&(6===A[0]||2===A[0])){o=0;continue}if(3===A[0]&&(!r||A[1]>r[0]&&A[1]<r[3]))o.label=A[1];else if(6===A[0]&&o.label<r[1])o.label=r[1],r=A;else{if(!(r&&o.label<r[2])){r[2]&&o.ops.pop(),o.trys.pop();continue}o.label=r[2],o.ops.push(A)}}A=e.call(t,o)}catch(a){A=[6,a],i=0}finally{n=r=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}}}a.prototype.add=function(t,e,n,i){return new a(this.left+t,this.top+e,this.width+n,this.height+i)},a.fromClientRect=function(t,e){return new a(e.left+t.windowBounds.left,e.top+t.windowBounds.top,e.width,e.height)},a.fromDOMRectList=function(t,e){return(e=Array.from(e).find(function(t){return 0!==t.width}))?new a(e.left+t.windowBounds.left,e.top+t.windowBounds.top,e.width,e.height):a.EMPTY},a.EMPTY=new a(0,0,0,0);var s=a;function a(t,e,n,i){this.left=t,this.top=e,this.width=n,this.height=i}for(var A=function(t,e){return s.fromClientRect(t,e.getBoundingClientRect())},l=function(t){for(var e=[],n=0,i=t.length;n<i;){var r,o=t.charCodeAt(n++);55296<=o&&o<=56319&&n<i?56320==(64512&(r=t.charCodeAt(n++)))?e.push(((1023&o)<<10)+(1023&r)+65536):(e.push(o),n--):e.push(o)}return e},u=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var n=t.length;if(!n)return"";for(var i=[],r=-1,o="";++r<n;){var s=t[r];s<=65535?i.push(s):i.push(55296+((s-=65536)>>10),s%1024+56320),(r+1===n||16384<i.length)&&(o+=String.fromCharCode.apply(String,i),i.length=0)}return o},h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c="undefined"==typeof Uint8Array?[]:new Uint8Array(256),f=0;f<h.length;f++)c[h.charCodeAt(f)]=f;for(var p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="undefined"==typeof Uint8Array?[]:new Uint8Array(256),y=0;y<p.length;y++)d[p.charCodeAt(y)]=y;function m(t,e,n){return t.slice?t.slice(e,n):new Uint16Array(Array.prototype.slice.call(t,e,n))}v.prototype.get=function(t){var e;if(0<=t){if(t<55296||56319<t&&t<=65535)return e=this.index[t>>5],this.data[e=(e<<2)+(31&t)];if(t<=65535)return e=this.index[2048+(t-55296>>5)],this.data[e=(e<<2)+(31&t)];if(t<this.highStart)return e=this.index[e=2080+(t>>11)],e=this.index[e+=t>>5&63],this.data[e=(e<<2)+(31&t)];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue};var g=v;function v(t,e,n,i,r,o){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=r,this.data=o}for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x="undefined"==typeof Uint8Array?[]:new Uint8Array(256),w=0;w<b.length;w++)x[b.charCodeAt(w)]=w;function B(t,e,n,i){var r=i[n];if(Array.isArray(t)?-1!==t.indexOf(r):t===r)for(var o=n;o<=i.length;){if((a=i[++o])===e)return 1;if(a!==S)break}if(r===S)for(o=n;0<o;){var s=i[--o];if(Array.isArray(t)?-1!==t.indexOf(s):t===s)for(var a,A=n;A<=i.length;){if((a=i[++A])===e)return 1;if(a!==S)break}if(s!==S)break}}function M(t,e){for(var n=t;0<=n;){var i=e[n];if(i!==S)return i;n--}return 0}var S=10,_=13,E=15,T=17,C=18,F=19,O=20,P=21,U=22,R=24,I=25,L=26,D=27,Q=28,k=32,N=33,j=34,H=35,z=37,V=38,G=39,Y=40,K=[9001,65288],X="",W=(ue=function(t){var e,n,i,r,o=.75*t.length,s=t.length,a=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2])&&o--;o=new("undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?ArrayBuffer:Array)(o);for(var A=Array.isArray(o)?o:new Uint8Array(o),l=0;l<s;l+=4)e=d[t.charCodeAt(l)],n=d[t.charCodeAt(l+1)],i=d[t.charCodeAt(l+2)],r=d[t.charCodeAt(l+3)],A[a++]=e<<2|n>>4,A[a++]=(15&n)<<4|i>>2,A[a++]=(3&i)<<6|63&r;return o}("KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA=="),_i=Array.isArray(ue)?function(t){for(var e=t.length,n=[],i=0;i<e;i+=4)n.push(t[i+3]<<24|t[i+2]<<16|t[i+1]<<8|t[i]);return n}(ue):new Uint32Array(ue),Ei=m(ve=Array.isArray(ue)?function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n.push(t[i+1]<<8|t[i]);return n}(ue):new Uint16Array(ue),12,_i[4]/2),Ti=2===_i[5]?m(ve,(24+_i[4])/2):(ue=_i,ve=Math.ceil((24+_i[4])/4),ue.slice?ue.slice(ve,Ti):new Uint32Array(Array.prototype.slice.call(ue,ve,Ti))),new g(_i[0],_i[1],_i[2],_i[3],Ei,Ti)),Z=[30,36],q=[1,2,3,5],J=[S,8],$=[D,L],tt=q.concat(J),et=[V,G,Y,j,H],nt=[E,_],it=(rt.prototype.slice=function(){return u.apply(void 0,this.codePoints.slice(this.start,this.end))},rt);function rt(t,e,n,i){this.codePoints=t,this.required="!"===e,this.start=n,this.end=i}function ot(t){return 48<=t&&t<=57}function st(t){return ot(t)||65<=t&&t<=70||97<=t&&t<=102}function at(t){return 10===t||9===t||32===t}function At(t){return 97<=(e=t)&&e<=122||65<=e&&e<=90||128<=t||95===t;var e}function lt(t){return At(t)||ot(t)||45===t}function ut(t,e){return 92===t&&10!==e}function ht(t,e,n){return 45===t?At(e)||ut(e,n):At(t)||92===t&&10!==e}function ct(t,e,n){return 43===t||45===t?ot(e)||46===e&&ot(n):ot(46===t?e:t)}var ft={type:2},pt={type:3},dt={type:4},yt={type:13},mt={type:8},gt={type:21},vt={type:9},bt={type:10},xt={type:11},wt={type:12},Bt={type:14},Mt={type:23},St={type:1},_t={type:25},Et={type:24},Tt={type:26},Ct={type:27},Ft={type:28},Ot={type:29},Pt={type:31},Ut={type:32},Rt=(It.prototype.write=function(t){this.A=this.A.concat(l(t))},It.prototype.read=function(){for(var t=[],e=this.consumeToken();e!==Ut;)t.push(e),e=this.consumeToken();return t},It.prototype.consumeToken=function(){var t=this.consumeCodePoint();switch(t){case 34:return this.consumeStringToken(34);case 35:var e,n=this.peekCodePoint(0),i=this.peekCodePoint(1),r=this.peekCodePoint(2);if(lt(n)||ut(i,r))return e=ht(n,i,r)?2:1,{type:5,value:this.consumeName(),flags:e};break;case 36:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),yt;break;case 39:return this.consumeStringToken(39);case 40:return ft;case 41:return pt;case 42:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),Bt;break;case 43:if(ct(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 44:return dt;case 45:if(ct(r=t,e=this.peekCodePoint(0),s=this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();if(ht(r,e,s))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();if(45===e&&62===s)return this.consumeCodePoint(),this.consumeCodePoint(),Et;break;case 46:if(ct(t,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(t),this.consumeNumericToken();break;case 47:if(42===this.peekCodePoint(0))for(this.consumeCodePoint();;){var o=this.consumeCodePoint();if(42===o&&47===(o=this.consumeCodePoint()))return this.consumeToken();if(-1===o)return this.consumeToken()}break;case 58:return Tt;case 59:return Ct;case 60:if(33===this.peekCodePoint(0)&&45===this.peekCodePoint(1)&&45===this.peekCodePoint(2))return this.consumeCodePoint(),this.consumeCodePoint(),_t;break;case 64:var s=this.peekCodePoint(0),a=this.peekCodePoint(1),A=this.peekCodePoint(2);if(ht(s,a,A))return{type:7,value:this.consumeName()};break;case 91:return Ft;case 92:if(ut(t,this.peekCodePoint(0)))return this.reconsumeCodePoint(t),this.consumeIdentLikeToken();break;case 93:return Ot;case 61:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),mt;break;case 123:return xt;case 125:return wt;case 117:case 85:return a=this.peekCodePoint(0),A=this.peekCodePoint(1),43!==a||!st(A)&&63!==A||(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(t),this.consumeIdentLikeToken();case 124:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),vt;if(124===this.peekCodePoint(0))return this.consumeCodePoint(),gt;break;case 126:if(61===this.peekCodePoint(0))return this.consumeCodePoint(),bt;break;case-1:return Ut}return at(t)?(this.consumeWhiteSpace(),Pt):ot(t)?(this.reconsumeCodePoint(t),this.consumeNumericToken()):At(t)?(this.reconsumeCodePoint(t),this.consumeIdentLikeToken()):{type:6,value:u(t)}},It.prototype.consumeCodePoint=function(){var t=this.A.shift();return void 0===t?-1:t},It.prototype.reconsumeCodePoint=function(t){this.A.unshift(t)},It.prototype.peekCodePoint=function(t){return t>=this.A.length?-1:this.A[t]},It.prototype.consumeUnicodeRangeToken=function(){for(var t=[],e=this.consumeCodePoint();st(e)&&t.length<6;)t.push(e),e=this.consumeCodePoint();for(var n=!1;63===e&&t.length<6;)t.push(e),e=this.consumeCodePoint(),n=!0;if(n)return{type:30,start:parseInt(u.apply(void 0,t.map(function(t){return 63===t?48:t})),16),end:parseInt(u.apply(void 0,t.map(function(t){return 63===t?70:t})),16)};var i=parseInt(u.apply(void 0,t),16);if(45===this.peekCodePoint(0)&&st(this.peekCodePoint(1))){this.consumeCodePoint();e=this.consumeCodePoint();for(var r=[];st(e)&&r.length<6;)r.push(e),e=this.consumeCodePoint();return{type:30,start:i,end:parseInt(u.apply(void 0,r),16)}}return{type:30,start:i,end:i}},It.prototype.consumeIdentLikeToken=function(){var t=this.consumeName();return"url"===t.toLowerCase()&&40===this.peekCodePoint(0)?(this.consumeCodePoint(),this.consumeUrlToken()):40===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:19,value:t}):{type:20,value:t}},It.prototype.consumeUrlToken=function(){var t=[];if(this.consumeWhiteSpace(),-1===this.peekCodePoint(0))return{type:22,value:""};var e=this.peekCodePoint(0);if(39===e||34===e)return 0===(e=this.consumeStringToken(this.consumeCodePoint())).type&&(this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0))?(this.consumeCodePoint(),{type:22,value:e.value}):(this.consumeBadUrlRemnants(),Mt);for(;;){var n=this.consumeCodePoint();if(-1===n||41===n)return{type:22,value:u.apply(void 0,t)};if(at(n))return this.consumeWhiteSpace(),-1===this.peekCodePoint(0)||41===this.peekCodePoint(0)?(this.consumeCodePoint(),{type:22,value:u.apply(void 0,t)}):(this.consumeBadUrlRemnants(),Mt);if(34===n||39===n||40===n||0<=n&&n<=8||11===n||14<=n&&n<=31||127===n)return this.consumeBadUrlRemnants(),Mt;if(92===n){if(!ut(n,this.peekCodePoint(0)))return this.consumeBadUrlRemnants(),Mt;t.push(this.consumeEscapedCodePoint())}else t.push(n)}},It.prototype.consumeWhiteSpace=function(){for(;at(this.peekCodePoint(0));)this.consumeCodePoint()},It.prototype.consumeBadUrlRemnants=function(){for(;;){var t=this.consumeCodePoint();if(41===t||-1===t)return;ut(t,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},It.prototype.consumeStringSlice=function(t){for(var e="";0<t;){var n=Math.min(5e4,t);e+=u.apply(void 0,this.A.splice(0,n)),t-=n}return this.A.shift(),e},It.prototype.consumeStringToken=function(t){for(var e="",n=0;;){var i,r=this.A[n];if(-1===r||void 0===r||r===t)return{type:0,value:e+=this.consumeStringSlice(n)};if(10===r)return this.A.splice(0,n),St;92===r&&-1!==(i=this.A[n+1])&&void 0!==i&&(10===i?(e+=this.consumeStringSlice(n),n=-1,this.A.shift()):ut(r,i)&&(e=(e+=this.consumeStringSlice(n))+u(this.consumeEscapedCodePoint()),n=-1)),n++}},It.prototype.consumeNumber=function(){var t=[],e=4;for(43!==(n=this.peekCodePoint(0))&&45!==n||t.push(this.consumeCodePoint());ot(this.peekCodePoint(0));)t.push(this.consumeCodePoint());var n=this.peekCodePoint(0),i=this.peekCodePoint(1);if(46===n&&ot(i))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;ot(this.peekCodePoint(0));)t.push(this.consumeCodePoint());n=this.peekCodePoint(0),i=this.peekCodePoint(1);var r=this.peekCodePoint(2);if((69===n||101===n)&&((43===i||45===i)&&ot(r)||ot(i)))for(t.push(this.consumeCodePoint(),this.consumeCodePoint()),e=8;ot(this.peekCodePoint(0));)t.push(this.consumeCodePoint());return[function(t){var e=0,n=1;43!==t[e]&&45!==t[e]||(45===t[e]&&(n=-1),e++);for(var i=[];ot(t[e]);)i.push(t[e++]);var r=i.length?parseInt(u.apply(void 0,i),10):0;46===t[e]&&e++;for(var o=[];ot(t[e]);)o.push(t[e++]);var s=o.length,a=s?parseInt(u.apply(void 0,o),10):0,A=(69!==t[e]&&101!==t[e]||e++,1);43!==t[e]&&45!==t[e]||(45===t[e]&&(A=-1),e++);for(var l=[];ot(t[e]);)l.push(t[e++]);var h=l.length?parseInt(u.apply(void 0,l),10):0;return n*(r+a*Math.pow(10,-s))*Math.pow(10,A*h)}(t),e]},It.prototype.consumeNumericToken=function(){var t=(e=this.consumeNumber())[0],e=e[1],n=this.peekCodePoint(0);return ht(n,this.peekCodePoint(1),this.peekCodePoint(2))?{type:15,number:t,flags:e,unit:this.consumeName()}:37===n?(this.consumeCodePoint(),{type:16,number:t,flags:e}):{type:17,number:t,flags:e}},It.prototype.consumeEscapedCodePoint=function(){var t=this.consumeCodePoint();if(st(t)){for(var e=u(t);st(this.peekCodePoint(0))&&e.length<6;)e+=u(this.consumeCodePoint());at(this.peekCodePoint(0))&&this.consumeCodePoint();var n=parseInt(e,16);return 0===n||55296<=n&&n<=57343||1114111<n?65533:n}return-1===t?65533:t},It.prototype.consumeName=function(){for(var t="";;){var e=this.consumeCodePoint();if(lt(e))t+=u(e);else{if(!ut(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),t;t+=u(this.consumeEscapedCodePoint())}}},It);function It(){this.A=[]}Dt.create=function(t){var e=new Rt;return e.write(t),new Dt(e.read())},Dt.parseValue=function(t){return Dt.create(t).parseComponentValue()},Dt.parseValues=function(t){return Dt.create(t).parseComponentValues()},Dt.prototype.parseComponentValue=function(){for(var t=this.consumeToken();31===t.type;)t=this.consumeToken();if(32===t.type)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(t);for(var e=this.consumeComponentValue();31===(t=this.consumeToken()).type;);if(32===t.type)return e;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},Dt.prototype.parseComponentValues=function(){for(var t=[];;){var e=this.consumeComponentValue();if(32===e.type)return t;t.push(e),t.push()}},Dt.prototype.consumeComponentValue=function(){var t=this.consumeToken();switch(t.type){case 11:case 28:case 2:return this.consumeSimpleBlock(t.type);case 19:return this.consumeFunction(t)}return t},Dt.prototype.consumeSimpleBlock=function(t){for(var e={type:t,values:[]},n=this.consumeToken();;){if(32===n.type||ie(n,t))return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue()),n=this.consumeToken()}},Dt.prototype.consumeFunction=function(t){for(var e={name:t.value,values:[],type:18};;){var n=this.consumeToken();if(32===n.type||3===n.type)return e;this.reconsumeToken(n),e.values.push(this.consumeComponentValue())}},Dt.prototype.consumeToken=function(){var t=this.B.shift();return void 0===t?Ut:t},Dt.prototype.reconsumeToken=function(t){this.B.unshift(t)};var Lt=Dt;function Dt(t){this.B=t}function Qt(t){return 15===t.type}function kt(t){return 17===t.type}function Nt(t){return 20===t.type}function jt(t){return 0===t.type}function Ht(t,e){return Nt(t)&&t.value===e}function zt(t){return 31!==t.type}function Vt(t){return 31!==t.type&&4!==t.type}function Gt(t){var e=[],n=[];return t.forEach(function(t){if(4===t.type){if(0===n.length)throw new Error("Error parsing function args, zero tokens for arg");e.push(n),n=[]}else 31!==t.type&&n.push(t)}),n.length&&e.push(n),e}function Yt(t){return 17===t.type||15===t.type}function Kt(t){return 16===t.type||Yt(t)}function Xt(t){return 1<t.length?[t[0],t[1]]:[t[0]]}function Wt(t,e,n){var i=t[0];t=t[1];return[ae(i,e),ae(void 0!==t?t:i,n)]}function Zt(t){return 15===t.type&&("deg"===t.unit||"grad"===t.unit||"rad"===t.unit||"turn"===t.unit)}function qt(t){switch(t.filter(Nt).map(function(t){return t.value}).join(" ")){case"to bottom right":case"to right bottom":case"left top":case"top left":return[re,re];case"to top":case"bottom":return ne(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[re,se];case"to right":case"left":return ne(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[se,se];case"to bottom":case"top":return ne(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[se,re];case"to left":case"right":return ne(270)}return 0}function Jt(t){return 0==(255&t)}function $t(t){var e=255&t,n=255&t>>8,i=255&t>>16;t=255&t>>24;return e<255?"rgba("+t+","+i+","+n+","+e/255+")":"rgb("+t+","+i+","+n+")"}function te(t,e){var n;return 17===t.type?t.number:16!==t.type?0:(n=3===e?1:255,3===e?t.number/100*n:Math.round(t.number/100*n))}function ee(t,e){if(15===e.type)switch(e.unit){case"deg":return Math.PI*e.number/180;case"grad":return Math.PI/200*e.number;case"rad":return e.number;case"turn":return 2*Math.PI*e.number}throw new Error("Unsupported angle type")}function ne(t){return Math.PI*t/180}var ie=function(t,e){return 11===e&&12===t.type||28===e&&29===t.type||2===e&&3===t.type},re={type:17,number:0,flags:4},oe={type:16,number:50,flags:4},se={type:16,number:100,flags:4},ae=function(t,e){if(16===t.type)return t.number/100*e;if(Qt(t))switch(t.unit){case"rem":case"em":return 16*t.number;default:return t.number}return t.number},Ae=function(t,e){if(18===e.type){var n=be[e.name];if(void 0===n)throw new Error('Attempting to parse an unsupported color function "'+e.name+'"');return n(t,e.values)}if(5===e.type){var i,r,o,s;if(3===e.value.length)return i=e.value.substring(0,1),r=e.value.substring(1,2),o=e.value.substring(2,3),le(parseInt(i+i,16),parseInt(r+r,16),parseInt(o+o,16),1);if(4===e.value.length)return i=e.value.substring(0,1),r=e.value.substring(1,2),o=e.value.substring(2,3),s=e.value.substring(3,4),le(parseInt(i+i,16),parseInt(r+r,16),parseInt(o+o,16),parseInt(s+s,16)/255);if(6===e.value.length)return i=e.value.substring(0,2),r=e.value.substring(2,4),o=e.value.substring(4,6),le(parseInt(i,16),parseInt(r,16),parseInt(o,16),1);if(8===e.value.length)return i=e.value.substring(0,2),r=e.value.substring(2,4),o=e.value.substring(4,6),s=e.value.substring(6,8),le(parseInt(i,16),parseInt(r,16),parseInt(o,16),parseInt(s,16)/255)}return 20===e.type&&void 0!==(e=xe[e.value.toUpperCase()])?e:xe.TRANSPARENT},le=function(t,e,n,i){return(t<<24|e<<16|n<<8|Math.round(255*i)<<0)>>>0},ue=function(t,e){var n,i,r;return 3===(e=e.filter(Vt)).length?(n=(r=e.map(te))[0],i=r[1],r=r[2],le(n,i,r,1)):4!==e.length?0:(n=(e=e.map(te))[0],i=e[1],r=e[2],e=e[3],le(n,i,r,e))};function he(t,e,n){return n<0&&(n+=1),1<=n&&--n,n<1/6?(e-t)*n*6+t:n<.5?e:n<2/3?6*(e-t)*(2/3-n)+t:t}function ce(t,e){return Ae(t,Lt.create(e).parseComponentValue())}function fe(t,e){return t=Ae(t,e[0]),(e=e[1])&&Kt(e)?{color:t,stop:e}:{color:t,stop:null}}function pe(t,e){var n=t[0],i=t[t.length-1];null===n.stop&&(n.stop=re),null===i.stop&&(i.stop=se);for(var r=[],o=0,s=0;s<t.length;s++){var a=t[s].stop;null!==a?(o<(a=ae(a,e))?r.push(a):r.push(o),o=a):r.push(null)}var A=null;for(s=0;s<r.length;s++){var l=r[s];if(null===l)null===A&&(A=s);else if(null!==A){for(var u=s-A,h=(l-r[A-1])/(1+u),c=1;c<=u;c++)r[A+c-1]=h*c;A=null}}return t.map(function(t,n){return{color:t.color,stop:Math.max(Math.min(1,r[n]/e),0)}})}function de(t,e){return Math.sqrt(t*t+e*e)}function ye(t,e,n,i,r){return[[0,0],[0,e],[t,0],[t,e]].reduce(function(t,e){var o=e[0],s=e[1];s=de(n-o,i-s);return(r?s<t.optimumDistance:s>t.optimumDistance)?{optimumCorner:e,optimumDistance:s}:t},{optimumDistance:r?1/0:-1/0,optimumCorner:null}).optimumCorner}function me(t,e){var n;if(22===e.type)return n={url:e.value,type:0},t.cache.addImage(e.value),n;if(18!==e.type)throw new Error("Unsupported image type "+e.type);if(void 0===(n=Fe[e.name]))throw new Error('Attempting to parse an unsupported image function "'+e.name+'"');return n(t,e.values)}var ge,ve=function(t,e){var n=(o=e.filter(Vt))[0],i=o[1],r=o[2],o=(e=o[3],(17===n.type?ne(n.number):ee(0,n))/(2*Math.PI));t=Kt(i)?i.number/100:0,n=Kt(r)?r.number/100:0,i=void 0!==e&&Kt(e)?ae(e,1):1;return 0==t?le(255*n,255*n,255*n,1):(t=he(e=2*n-(r=n<=.5?n*(1+t):n+t-n*t),r,o+1/3),n=he(e,r,o),o=he(e,r,o-1/3),le(255*t,255*n,255*o,i))},be={hsl:ve,hsla:ve,rgb:ue,rgba:ue},xe={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},we={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(t){if(Nt(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Be={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Me="closest-side",Se="farthest-side",_e="closest-corner",Ee="farthest-corner",Te="ellipse",Ce="contain",Fe={"linear-gradient":function(t,e){var n=ne(180),i=[];return Gt(e).forEach(function(e,r){if(0===r){if(20===(r=e[0]).type&&"to"===r.value)return void(n=qt(e));if(Zt(r))return void(n=ee(0,r))}e=fe(t,e),i.push(e)}),{angle:n,stops:i,type:1}},"-moz-linear-gradient":ve=function(t,e){var n=ne(180),i=[];return Gt(e).forEach(function(e,r){if(0===r){if(20===(r=e[0]).type&&-1!==["top","left","right","bottom"].indexOf(r.value))return void(n=qt(e));if(Zt(r))return void(n=(ee(0,r)+ne(270))%ne(360))}e=fe(t,e),i.push(e)}),{angle:n,stops:i,type:1}},"-ms-linear-gradient":ve,"-o-linear-gradient":ve,"-webkit-linear-gradient":ve,"radial-gradient":function(t,e){var n=0,i=3,r=[],o=[];return Gt(e).forEach(function(e,s){var a,A=!0;0===s&&(a=!1,A=e.reduce(function(t,e){if(a)if(Nt(e))switch(e.value){case"center":return o.push(oe),t;case"top":case"left":return o.push(re),t;case"right":case"bottom":return o.push(se),t}else(Kt(e)||Yt(e))&&o.push(e);else if(Nt(e))switch(e.value){case"circle":return n=0,!1;case Te:return!(n=1);case"at":return!(a=!0);case Me:return i=0,!1;case"cover":case Se:return!(i=1);case Ce:case _e:return!(i=2);case Ee:return!(i=3)}else if(Yt(e)||Kt(e))return(i=Array.isArray(i)?i:[]).push(e),!1;return t},A)),A&&(e=fe(t,e),r.push(e))}),{size:i,shape:n,stops:r,position:o,type:2}},"-moz-radial-gradient":ue=function(t,e){var n=0,i=3,r=[],o=[];return Gt(e).forEach(function(e,s){var a=!0;0===s?a=e.reduce(function(t,e){if(Nt(e))switch(e.value){case"center":return o.push(oe),!1;case"top":case"left":return o.push(re),!1;case"right":case"bottom":return o.push(se),!1}else if(Kt(e)||Yt(e))return o.push(e),!1;return t},a):1===s&&(a=e.reduce(function(t,e){if(Nt(e))switch(e.value){case"circle":return n=0,!1;case Te:return!(n=1);case Ce:case Me:return i=0,!1;case Se:return!(i=1);case _e:return!(i=2);case"cover":case Ee:return!(i=3)}else if(Yt(e)||Kt(e))return(i=Array.isArray(i)?i:[]).push(e),!1;return t},a)),a&&(e=fe(t,e),r.push(e))}),{size:i,shape:n,stops:r,position:o,type:2}},"-ms-radial-gradient":ue,"-o-radial-gradient":ue,"-webkit-radial-gradient":ue,"-webkit-gradient":function(t,e){var n=ne(180),i=[],r=1;return Gt(e).forEach(function(e,n){var o;e=e[0];if(0===n){if(Nt(e)&&"linear"===e.value)return void(r=1);if(Nt(e)&&"radial"===e.value)return void(r=2)}18===e.type&&("from"===e.name?(o=Ae(t,e.values[0]),i.push({stop:re,color:o})):"to"===e.name?(o=Ae(t,e.values[0]),i.push({stop:se,color:o})):"color-stop"===e.name&&2===(e=e.values.filter(Vt)).length&&(o=Ae(t,e[1]),kt(e=e[0]))&&i.push({stop:{type:16,number:100*e.number,flags:e.flags},color:o}))}),1===r?{angle:(n+ne(180))%ne(360),stops:i,type:r}:{size:3,shape:0,stops:i,position:[],type:r}}},Oe={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(t,e){var n;return 0===e.length||20===(n=e[0]).type&&"none"===n.value?[]:e.filter(function(t){return Vt(t)&&!(20===t.type&&"none"===t.value||18===t.type&&!Fe[t.name])}).map(function(e){return me(t,e)})}},Pe={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(t,e){return e.map(function(t){if(Nt(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Ue={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(t,e){return Gt(e).map(function(t){return t.filter(Kt)}).map(Xt)}},Re={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(t,e){return Gt(e).map(function(t){return t.filter(Nt).map(function(t){return t.value}).join(" ")}).map(Ie)}},Ie=function(t){switch(t){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;default:return 0}};function Le(t,e){return Nt(t)&&"normal"===t.value?1.2*e:17===t.type?e*t.number:Kt(t)?ae(t,e):e}var De,Qe,ke={name:"background-size",initialValue:"0",prefix:!((ue=ge={AUTO:"auto",CONTAIN:"contain"}).COVER="cover"),type:1,parse:function(t,e){return Gt(e).map(function(t){return t.filter(Ne)})}},Ne=function(t){return Nt(t)||Kt(t)},je=(ue=function(t){return{name:"border-"+t+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}})("top"),He=ue("right"),ze=ue("bottom"),Ve=ue("left"),Ge=(ue=function(t){return{name:"border-radius-"+t,initialValue:"0 0",prefix:!1,type:1,parse:function(t,e){return Xt(e.filter(Kt))}}})("top-left"),Ye=ue("top-right"),Ke=ue("bottom-right"),Xe=ue("bottom-left"),We=(ue=function(t){return{name:"border-"+t+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(t,e){switch(e){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}})("top"),Ze=ue("right"),qe=ue("bottom"),Je=ue("left"),$e=(ue=function(t){return{name:"border-"+t+"-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Qt(e)?e.number:0}}})("top"),tn=ue("right"),en=ue("bottom"),nn=ue("left"),rn={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},on={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(t,e){return"rtl"!==e?0:1}},sn={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(t,e){return e.filter(Nt).reduce(function(t,e){return t|an(e.value)},0)}},an=function(t){switch(t){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},An={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},ln={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(t,e){return 20===e.type&&"normal"===e.value||17!==e.type&&15!==e.type?0:e.number}},un={name:"line-break",initialValue:(ue=De={}).NORMAL="normal",prefix:!(ue.STRICT="strict"),type:2,parse:function(t,e){return"strict"!==e?De.NORMAL:De.STRICT}},hn={name:"line-height",initialValue:"normal",prefix:!1,type:4},cn={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(t,e){return 20===e.type&&"none"===e.value?null:me(t,e)}},fn={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(t,e){return"inside"!==e?1:0}},pn={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;default:return-1}}},dn=(ue=function(t){return{name:"margin-"+t,initialValue:"0",prefix:!1,type:4}})("top"),yn=ue("right"),mn=ue("bottom"),gn=ue("left"),vn={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(t,e){return e.filter(Nt).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;default:return 0}})}},bn={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){return"break-word"!==e?"normal":"break-word"}},xn=(ue=function(t){return{name:"padding-"+t,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}})("top"),wn=ue("right"),Bn=ue("bottom"),Mn=ue("left"),Sn={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(t,e){switch(e){case"right":return 2;case"center":case"justify":return 1;default:return 0}}},_n={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(t,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},En={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&Ht(e[0],"none")?[]:Gt(e).map(function(e){for(var n={color:xe.TRANSPARENT,offsetX:re,offsetY:re,blur:re},i=0,r=0;r<e.length;r++){var o=e[r];Yt(o)?(0===i?n.offsetX=o:1===i?n.offsetY=o:n.blur=o,i++):n.color=Ae(t,o)}return n})}},Tn={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},Cn={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(t,e){if(20===e.type&&"none"===e.value)return null;if(18!==e.type)return null;var n=Fn[e.name];if(void 0===n)throw new Error('Attempting to parse an unsupported transform function "'+e.name+'"');return n(e.values)}},Fn={matrix:function(t){return 6===(t=t.filter(function(t){return 17===t.type}).map(function(t){return t.number})).length?t:null},matrix3d:function(t){var e=t.filter(function(t){return 17===t.type}).map(function(t){return t.number}),n=e[0],i=e[1],r=(e[2],e[3],e[4]),o=e[5],s=(e[6],e[7],e[8],e[9],e[10],e[11],e[12]);t=e[13];return e[14],e[15],16===e.length?[n,i,r,o,s,t]:null}},On=[ue={type:16,number:50,flags:4},ue],Pn={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(t,e){return 2!==(e=e.filter(Kt)).length?On:[e[0],e[1]]}},Un={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(t,e){switch(e){case"hidden":return 1;case"collapse":return 2;default:return 0}}};function Rn(t,e){return 0!=(t&e)}function In(t,e,n){return(t=t&&t[Math.min(e,t.length-1)])?n?t.open:t.close:""}function Ln(t,e){if(15===e.type)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}var Dn={name:"word-break",initialValue:"normal",prefix:!((ue=Qe={NORMAL:"normal",BREAK_ALL:"break-all"}).KEEP_ALL="keep-all"),type:2,parse:function(t,e){switch(e){case"break-all":return Qe.BREAK_ALL;case"keep-all":return Qe.KEEP_ALL;default:return Qe.NORMAL}}},Qn={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(t,e){if(20===e.type)return{auto:!0,order:0};if(kt(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},kn={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(t,e){return kt(e)?e.number:1}},Nn={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},jn={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(t,e){return e.filter(Nt).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return 0!==t})}},Hn={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(t,e){var n=[],i=[];return e.forEach(function(t){switch(t.type){case 20:case 0:n.push(t.value);break;case 17:n.push(t.number.toString());break;case 4:i.push(n.join(" ")),n.length=0}}),n.length&&i.push(n.join(" ")),i.map(function(t){return-1===t.indexOf(" ")?t:"'"+t+"'"})}},zn={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},Vn={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(t,e){return kt(e)?e.number:Nt(e)&&"bold"===e.value?700:400}},Gn={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return e.filter(Nt).map(function(t){return t.value})}},Yn={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(t,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";default:return"normal"}}},Kn={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(t,e){var n;return 0===e.length||20===(n=e[0]).type&&"none"===n.value?[]:e}},Xn={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return null;var n=e[0];if(20===n.type&&"none"===n.value)return null;for(var i=[],r=e.filter(zt),o=0;o<r.length;o++){var s=r[o],a=r[o+1];20===s.type&&(a=a&&kt(a)?a.number:1,i.push({counter:s.value,increment:a}))}return i}},Wn={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return[];for(var n=[],i=e.filter(zt),r=0;r<i.length;r++){var o=i[r],s=i[r+1];Nt(o)&&"none"!==o.value&&(s=s&&kt(s)?s.number:0,n.push({counter:o.value,reset:s}))}return n}},Zn={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(t,e){return e.filter(Qt).map(function(t){return Ln(0,t)})}},qn={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(t,e){if(0===e.length)return null;var n=e[0];if(20===n.type&&"none"===n.value)return null;var i=[],r=e.filter(jt);if(r.length%2!=0)return null;for(var o=0;o<r.length;o+=2){var s=r[o].value,a=r[o+1].value;i.push({open:s,close:a})}return i}},Jn={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(t,e){return 1===e.length&&Ht(e[0],"none")?[]:Gt(e).map(function(e){for(var n={color:255,offsetX:re,offsetY:re,blur:re,spread:re,inset:!1},i=0,r=0;r<e.length;r++){var o=e[r];Ht(o,"inset")?n.inset=!0:Yt(o)?(0===i?n.offsetX=o:1===i?n.offsetY=o:2===i?n.blur=o:n.spread=o,i++):n.color=Ae(t,o)}return n})}},$n={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(t,e){var n=[];return e.filter(Nt).forEach(function(t){switch(t.value){case"stroke":n.push(1);break;case"fill":n.push(0);break;case"markers":n.push(2)}}),[0,1,2].forEach(function(t){-1===n.indexOf(t)&&n.push(t)}),n}},ti={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},ei={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(t,e){return Qt(e)?e.number:0}},ni=(ii.prototype.isVisible=function(){return 0<this.display&&0<this.opacity&&0===this.visibility},ii.prototype.isTransparent=function(){return Jt(this.backgroundColor)},ii.prototype.isTransformed=function(){return null!==this.transform},ii.prototype.isPositioned=function(){return 0!==this.position},ii.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},ii.prototype.isFloating=function(){return 0!==this.float},ii.prototype.isInlineLevel=function(){return Rn(this.display,4)||Rn(this.display,33554432)||Rn(this.display,268435456)||Rn(this.display,536870912)||Rn(this.display,67108864)||Rn(this.display,134217728)},ii);function ii(t,e){this.animationDuration=si(t,Zn,e.animationDuration),this.backgroundClip=si(t,we,e.backgroundClip),this.backgroundColor=si(t,Be,e.backgroundColor),this.backgroundImage=si(t,Oe,e.backgroundImage),this.backgroundOrigin=si(t,Pe,e.backgroundOrigin),this.backgroundPosition=si(t,Ue,e.backgroundPosition),this.backgroundRepeat=si(t,Re,e.backgroundRepeat),this.backgroundSize=si(t,ke,e.backgroundSize),this.borderTopColor=si(t,je,e.borderTopColor),this.borderRightColor=si(t,He,e.borderRightColor),this.borderBottomColor=si(t,ze,e.borderBottomColor),this.borderLeftColor=si(t,Ve,e.borderLeftColor),this.borderTopLeftRadius=si(t,Ge,e.borderTopLeftRadius),this.borderTopRightRadius=si(t,Ye,e.borderTopRightRadius),this.borderBottomRightRadius=si(t,Ke,e.borderBottomRightRadius),this.borderBottomLeftRadius=si(t,Xe,e.borderBottomLeftRadius),this.borderTopStyle=si(t,We,e.borderTopStyle),this.borderRightStyle=si(t,Ze,e.borderRightStyle),this.borderBottomStyle=si(t,qe,e.borderBottomStyle),this.borderLeftStyle=si(t,Je,e.borderLeftStyle),this.borderTopWidth=si(t,$e,e.borderTopWidth),this.borderRightWidth=si(t,tn,e.borderRightWidth),this.borderBottomWidth=si(t,en,e.borderBottomWidth),this.borderLeftWidth=si(t,nn,e.borderLeftWidth),this.boxShadow=si(t,Jn,e.boxShadow),this.color=si(t,rn,e.color),this.direction=si(t,on,e.direction),this.display=si(t,sn,e.display),this.float=si(t,An,e.cssFloat),this.fontFamily=si(t,Hn,e.fontFamily),this.fontSize=si(t,zn,e.fontSize),this.fontStyle=si(t,Yn,e.fontStyle),this.fontVariant=si(t,Gn,e.fontVariant),this.fontWeight=si(t,Vn,e.fontWeight),this.letterSpacing=si(t,ln,e.letterSpacing),this.lineBreak=si(t,un,e.lineBreak),this.lineHeight=si(t,hn,e.lineHeight),this.listStyleImage=si(t,cn,e.listStyleImage),this.listStylePosition=si(t,fn,e.listStylePosition),this.listStyleType=si(t,pn,e.listStyleType),this.marginTop=si(t,dn,e.marginTop),this.marginRight=si(t,yn,e.marginRight),this.marginBottom=si(t,mn,e.marginBottom),this.marginLeft=si(t,gn,e.marginLeft),this.opacity=si(t,kn,e.opacity);var n=si(t,vn,e.overflow);this.overflowX=n[0],this.overflowY=n[1<n.length?1:0],this.overflowWrap=si(t,bn,e.overflowWrap),this.paddingTop=si(t,xn,e.paddingTop),this.paddingRight=si(t,wn,e.paddingRight),this.paddingBottom=si(t,Bn,e.paddingBottom),this.paddingLeft=si(t,Mn,e.paddingLeft),this.paintOrder=si(t,$n,e.paintOrder),this.position=si(t,_n,e.position),this.textAlign=si(t,Sn,e.textAlign),this.textDecorationColor=si(t,Nn,null!=(n=e.textDecorationColor)?n:e.color),this.textDecorationLine=si(t,jn,null!=(n=e.textDecorationLine)?n:e.textDecoration),this.textShadow=si(t,En,e.textShadow),this.textTransform=si(t,Tn,e.textTransform),this.transform=si(t,Cn,e.transform),this.transformOrigin=si(t,Pn,e.transformOrigin),this.visibility=si(t,Un,e.visibility),this.webkitTextStrokeColor=si(t,ti,e.webkitTextStrokeColor),this.webkitTextStrokeWidth=si(t,ei,e.webkitTextStrokeWidth),this.wordBreak=si(t,Dn,e.wordBreak),this.zIndex=si(t,Qn,e.zIndex)}for(var ri=function(t,e){this.content=si(t,Kn,e.content),this.quotes=si(t,qn,e.quotes)},oi=function(t,e){this.counterIncrement=si(t,Xn,e.counterIncrement),this.counterReset=si(t,Wn,e.counterReset)},si=function(t,e,n){var i=new Rt,r=(n=null!=n?n.toString():e.initialValue,i.write(n),new Lt(i.read()));switch(e.type){case 2:var o=r.parseComponentValue();return e.parse(t,Nt(o)?o.value:e.initialValue);case 0:return e.parse(t,r.parseComponentValue());case 1:return e.parse(t,r.parseComponentValues());case 4:return r.parseComponentValue();case 3:switch(e.format){case"angle":return ee(0,r.parseComponentValue());case"color":return Ae(t,r.parseComponentValue());case"image":return me(t,r.parseComponentValue());case"length":var s=r.parseComponentValue();return Yt(s)?s:re;case"length-percentage":return Kt(s=r.parseComponentValue())?s:re;case"time":return Ln(0,r.parseComponentValue())}}},ai=function(t,e){return 1===(t=function(){switch(t.getAttribute("data-html2canvas-debug")){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}}())||e===t},Ai=function(t,e){this.context=t,this.textNodes=[],this.elements=[],this.flags=0,ai(e,3),this.styles=new ni(t,window.getComputedStyle(e,null)),Cr(e)&&(this.styles.animationDuration.some(function(t){return 0<t})&&(e.style.animationDuration="0s"),null!==this.styles.transform)&&(e.style.transform="none"),this.bounds=A(this.context,e),ai(e,4)&&(this.flags|=16)},li="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ui="undefined"==typeof Uint8Array?[]:new Uint8Array(256),hi=0;hi<li.length;hi++)ui[li.charCodeAt(hi)]=hi;function ci(t,e,n){return t.slice?t.slice(e,n):new Uint16Array(Array.prototype.slice.call(t,e,n))}function fi(t,e,n,i,r,o){this.initialValue=t,this.errorValue=e,this.highStart=n,this.highValueIndex=i,this.index=r,this.data=o}fi.prototype.get=function(t){var e;if(0<=t){if(t<55296||56319<t&&t<=65535)return e=this.index[t>>5],this.data[e=(e<<2)+(31&t)];if(t<=65535)return e=this.index[2048+(t-55296>>5)],this.data[e=(e<<2)+(31&t)];if(t<this.highStart)return e=this.index[e=2080+(t>>11)],e=this.index[e+=t>>5&63],this.data[e=(e<<2)+(31&t)];if(t<=1114111)return this.data[this.highValueIndex]}return this.errorValue},g=fi;for(var pi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",di="undefined"==typeof Uint8Array?[]:new Uint8Array(256),yi=0;yi<pi.length;yi++)di[pi.charCodeAt(yi)]=yi;function mi(t){return Ri.get(t)}function gi(t){return 0===t[0]&&255===t[1]&&0===t[2]&&255===t[3]}function vi(t,e,n,i,r){var o="http://www.w3.org/2000/svg",s=document.createElementNS(o,"svg");o=document.createElementNS(o,"foreignObject");return s.setAttributeNS(null,"width",t.toString()),s.setAttributeNS(null,"height",e.toString()),o.setAttributeNS(null,"width","100%"),o.setAttributeNS(null,"height","100%"),o.setAttributeNS(null,"x",n.toString()),o.setAttributeNS(null,"y",i.toString()),o.setAttributeNS(null,"externalResourcesRequired","true"),s.appendChild(o),o.appendChild(r),s}function bi(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){return e(i)},i.onerror=n,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))})}function xi(t,e){this.text=t,this.bounds=e}function wi(t,e,n){var i=t.ownerDocument;if(i)return(i=i.createRange()).setStart(t,e),i.setEnd(t,e+n),i;throw new Error("Node has no owner document")}function Bi(t){var e;if(Li.SUPPORT_NATIVE_TEXT_SEGMENTATION)return e=new Intl.Segmenter(void 0,{granularity:"grapheme"}),Array.from(e.segment(t)).map(function(t){return t.segment});i=function(t){for(var e=[],n=0,i=t.length;n<i;){var r,o=t.charCodeAt(n++);55296<=o&&o<=56319&&n<i?56320==(64512&(r=t.charCodeAt(n++)))?e.push(((1023&o)<<10)+(1023&r)+65536):(e.push(o),n--):e.push(o)}return e}(t),r=i.length,s=o=0,a=i.map(mi);for(var n,i,r,o,s,a,A={next:function(){if(r<=o)return{done:!0,value:null};for(var t,e=Ii;o<r&&(e=function(t,e){var n=e-2,i=t[n],r=t[e-1];e=t[e];if(2===r&&3===e)return Ii;if(2!==r&&3!==r&&4!==r&&2!==e&&3!==e&&4!==e){if(r===Fi&&-1!==[Fi,Oi,Pi,Ui].indexOf(e))return Ii;if(!(r!==Pi&&r!==Oi||e!==Oi&&10!==e))return Ii;if((r===Ui||10===r)&&10===e)return Ii;if(13===e||5===e)return Ii;if(7===e)return Ii;if(1===r)return Ii;if(13===r&&14===e){for(;5===i;)i=t[--n];if(14===i)return Ii}if(15===r&&15===e){for(var o=0;15===i;)o++,i=t[--n];if(o%2==0)return Ii}}return""}(a,++o))===Ii;);return e===Ii&&o!==r?{done:!0,value:null}:(t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,t);var n=t.length;if(!n)return"";for(var i=[],r=-1,o="";++r<n;){var s=t[r];s<=65535?i.push(s):i.push(55296+((s-=65536)>>10),s%1024+56320),(r+1===n||16384<i.length)&&(o+=String.fromCharCode.apply(String,i),i.length=0)}return o}.apply(null,i.slice(s,o)),s=o,{value:t,done:!1})}},l=[];!(n=A.next()).done;)n.value&&l.push(n.value.slice());return l}function Mi(t,e){for(var n,i=function(t,e){var n,i,r,o,s,a,A,u,h=l(t),c=(n=h,void 0===(i=(t=(t=e)||{lineBreak:"normal",wordBreak:"normal"}).lineBreak)&&(i="strict"),r=[],o=[],s=[],n.forEach(function(t,e){var n=W.get(t);return 50<n?(s.push(!0),n-=50):s.push(!1),-1!==["normal","auto","loose"].indexOf(i)&&-1!==[8208,8211,12316,12448].indexOf(t)?(o.push(e),r.push(16)):4!==n&&11!==n?(o.push(e),31===n?r.push("strict"===i?P:z):42===n||29===n?r.push(30):43===n?r.push(131072<=t&&t<=196605||196608<=t&&t<=262141?z:30):void r.push(n)):0!==e&&-1===tt.indexOf(n=r[e-1])?(o.push(o[e-1]),r.push(n)):(o.push(e),r.push(30))}),a=(u=[o,r,s])[0],A=u[1],u=u[2],(e=[a,A="break-all"===t.wordBreak||"break-word"===t.wordBreak?A.map(function(t){return-1!==[I,30,42].indexOf(t)?z:t}):A,"keep-all"===t.wordBreak?u.map(function(t,e){return t&&19968<=n[e]&&n[e]<=40959}):void 0])[0]),f=e[1],p=e[2],d=h.length,y=0,m=0;return{next:function(){if(d<=m)return{done:!0,value:null};for(var t,e=X;m<d&&(e=function(t,e,n,i,r){if(0===n[i])return X;var o=i-1;if(Array.isArray(r)&&!0===r[o])return X;var s,a=o-1,A=1+o,l=e[o];if(i=0<=a?e[a]:0,r=e[A],2===l&&3===r)return X;if(-1!==q.indexOf(l))return"!";if(-1!==q.indexOf(r))return X;if(-1!==J.indexOf(r))return X;if(8===M(o,e))return"";if(11===W.get(t[o]))return X;if((l===k||l===N)&&11===W.get(t[A]))return X;if(7===l||7===r)return X;if(9===l)return X;if(-1===[S,_,E].indexOf(l)&&9===r)return X;if(-1!==[T,C,F,R,Q].indexOf(r))return X;if(M(o,e)===U)return X;if(B(23,U,o,e))return X;if(B([T,C],P,o,e))return X;if(B(12,12,o,e))return X;if(l===S)return"";if(23===l||23===r)return X;if(16===r||16===l)return"";if(-1!==[_,E,P].indexOf(r)||14===l)return X;if(36===i&&-1!==nt.indexOf(l))return X;if(l===Q&&36===r)return X;if(r===O)return X;if(-1!==Z.indexOf(r)&&l===I||-1!==Z.indexOf(l)&&r===I)return X;if(l===D&&-1!==[z,k,N].indexOf(r)||-1!==[z,k,N].indexOf(l)&&r===L)return X;if(-1!==Z.indexOf(l)&&-1!==$.indexOf(r)||-1!==$.indexOf(l)&&-1!==Z.indexOf(r))return X;if(-1!==[D,L].indexOf(l)&&(r===I||-1!==[U,E].indexOf(r)&&e[1+A]===I)||-1!==[U,E].indexOf(l)&&r===I||l===I&&-1!==[I,Q,R].indexOf(r))return X;if(-1!==[I,Q,R,T,C].indexOf(r))for(var u=o;0<=u;){if((s=e[u])===I)return X;if(-1===[Q,R].indexOf(s))break;u--}if(-1!==[D,L].indexOf(r))for(u=-1!==[T,C].indexOf(l)?a:o;0<=u;){if((s=e[u])===I)return X;if(-1===[Q,R].indexOf(s))break;u--}if(V===l&&-1!==[V,G,j,H].indexOf(r)||-1!==[G,j].indexOf(l)&&-1!==[G,Y].indexOf(r)||-1!==[Y,H].indexOf(l)&&r===Y)return X;if(-1!==et.indexOf(l)&&-1!==[O,L].indexOf(r)||-1!==et.indexOf(r)&&l===D)return X;if(-1!==Z.indexOf(l)&&-1!==Z.indexOf(r))return X;if(l===R&&-1!==Z.indexOf(r))return X;if(-1!==Z.concat(I).indexOf(l)&&r===U&&-1===K.indexOf(t[A])||-1!==Z.concat(I).indexOf(r)&&l===C)return X;if(41===l&&41===r){for(var h=n[o],c=1;0<h&&41===e[--h];)c++;if(c%2!=0)return X}return l===k&&r===N?X:""}(h,f,c,++m,p))===X;);return e===X&&m!==d?{done:!0,value:null}:(t=new it(h,e,y,m),y=m,{value:t,done:!1})}}}(t,{lineBreak:e.lineBreak,wordBreak:"break-word"===e.overflowWrap?"break-word":e.wordBreak}),r=[];!(n=i.next()).done;)!function(){var t,e;n.value&&(t=n.value.slice(),t=l(t),e="",t.forEach(function(t){-1===Di.indexOf(t)?e+=u(t):(e.length&&r.push(e),r.push(u(t)),e="")}),e.length)&&r.push(e)}();return r}var Si,_i,Ei,Ti,Ci,Fi=8,Oi=9,Pi=11,Ui=12,Ri=(_i=function(t){var e,n,i,r,o=.75*t.length,s=t.length,a=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2])&&o--;o=new("undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&void 0!==Uint8Array.prototype.slice?ArrayBuffer:Array)(o);for(var A=Array.isArray(o)?o:new Uint8Array(o),l=0;l<s;l+=4)e=ui[t.charCodeAt(l)],n=ui[t.charCodeAt(l+1)],i=ui[t.charCodeAt(l+2)],r=ui[t.charCodeAt(l+3)],A[a++]=e<<2|n>>4,A[a++]=(15&n)<<4|i>>2,A[a++]=(3&i)<<6|63&r;return o}("AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA="),Ei=Array.isArray(_i)?function(t){for(var e=t.length,n=[],i=0;i<e;i+=4)n.push(t[i+3]<<24|t[i+2]<<16|t[i+1]<<8|t[i]);return n}(_i):new Uint32Array(_i),ve=ci(Ti=Array.isArray(_i)?function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n.push(t[i+1]<<8|t[i]);return n}(_i):new Uint16Array(_i),12,Ei[4]/2),Si=2===Ei[5]?ci(Ti,(24+Ei[4])/2):(_i=Ei,Ti=Math.ceil((24+Ei[4])/4),_i.slice?_i.slice(Ti,Si):new Uint32Array(Array.prototype.slice.call(_i,Ti,Si))),new g(Ei[0],Ei[1],Ei[2],Ei[3],ve,Si)),Ii="",Li={get SUPPORT_RANGE_BOUNDS(){var t=function(t){if(t.createRange){var e=t.createRange();if(e.getBoundingClientRect){var n=t.createElement("boundtest");if(n.style.height="123px",n.style.display="block",t.body.appendChild(n),e.selectNode(n),e=e.getBoundingClientRect(),e=Math.round(e.height),t.body.removeChild(n),123===e)return!0}}return!1}(document);return Object.defineProperty(Li,"SUPPORT_RANGE_BOUNDS",{value:t}),t},get SUPPORT_WORD_BREAKING(){var t,e,n,i,r,o,s=Li.SUPPORT_RANGE_BOUNDS&&((t=(s=document).createElement("boundtest")).style.width="50px",t.style.display="block",t.style.fontSize="12px",t.style.letterSpacing="0px",t.style.wordSpacing="0px",s.body.appendChild(t),e=s.createRange(),t.innerHTML="function"==typeof"".repeat?"&#128104;".repeat(10):"",n=t.firstChild,i=l(n.data).map(function(t){return u(t)}),r=0,o={},i=i.every(function(t,i){e.setStart(n,r),e.setEnd(n,r+t.length);var s=e.getBoundingClientRect();return r+=t.length,t=s.x>o.x||s.y>o.y,o=s,0===i||t}),s.body.removeChild(t),i);return Object.defineProperty(Li,"SUPPORT_WORD_BREAKING",{value:s}),s},get SUPPORT_SVG_DRAWING(){var t=function(t){var e=new Image,n=t.createElement("canvas");if(!(t=n.getContext("2d")))return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{t.drawImage(e,0,0),n.toDataURL()}catch(t){return!1}return!0}(document);return Object.defineProperty(Li,"SUPPORT_SVG_DRAWING",{value:t}),t},get SUPPORT_FOREIGNOBJECT_DRAWING(){var t="function"==typeof Array.from&&"function"==typeof window.fetch?function(t){var e=t.createElement("canvas"),n=100,i=(e.width=n,e.height=n,e.getContext("2d"));if(!i)return Promise.reject(!1);i.fillStyle="rgb(0, 255, 0)",i.fillRect(0,0,n,n);var r=new Image,o=e.toDataURL();return r.src=o,r=vi(n,n,0,0,r),i.fillStyle="red",i.fillRect(0,0,n,n),bi(r).then(function(e){i.drawImage(e,0,0);var r=i.getImageData(0,0,n,n).data;return i.fillStyle="red",i.fillRect(0,0,n,n),(e=t.createElement("div")).style.backgroundImage="url("+o+")",e.style.height="100px",gi(r)?bi(vi(n,n,0,0,e)):Promise.reject(!1)}).then(function(t){return i.drawImage(t,0,0),gi(i.getImageData(0,0,n,n).data)}).catch(function(){return!1})}(document):Promise.resolve(!1);return Object.defineProperty(Li,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:t}),t},get SUPPORT_CORS_IMAGES(){var t=void 0!==(new Image).crossOrigin;return Object.defineProperty(Li,"SUPPORT_CORS_IMAGES",{value:t}),t},get SUPPORT_RESPONSE_TYPE(){var t="string"==typeof(new XMLHttpRequest).responseType;return Object.defineProperty(Li,"SUPPORT_RESPONSE_TYPE",{value:t}),t},get SUPPORT_CORS_XHR(){var t="withCredentials"in new XMLHttpRequest;return Object.defineProperty(Li,"SUPPORT_CORS_XHR",{value:t}),t},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var t=!("undefined"==typeof Intl||!Intl.Segmenter);return Object.defineProperty(Li,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:t}),t}},Di=[32,160,4961,65792,65793,4153,4241],Qi=function(t,e,n){var i,r,o,a,l,u;this.text=function(t,e){switch(e){case 1:return t.toLowerCase();case 3:return t.replace(ki,Ni);case 2:return t.toUpperCase();default:return t}}(e.data,n.textTransform),this.textBounds=(i=t,t=this.text,o=e,e=t,t=0!==(n=r=n).letterSpacing?Bi(e):(e=e,n=n,Li.SUPPORT_NATIVE_TEXT_SEGMENTATION?(u=new Intl.Segmenter(void 0,{granularity:"word"}),Array.from(u.segment(e)).map(function(t){return t.segment})):Mi(e,n)),a=[],l=0,t.forEach(function(t){var e,n,u;r.textDecorationLine.length||0<t.trim().length?Li.SUPPORT_RANGE_BOUNDS?1<(u=wi(o,l,t.length).getClientRects()).length?(e=Bi(t),n=0,e.forEach(function(t){a.push(new xi(t,s.fromDOMRectList(i,wi(o,n+l,t.length).getClientRects()))),n+=t.length})):a.push(new xi(t,s.fromDOMRectList(i,u))):(u=o.splitText(t.length),a.push(new xi(t,function(t,e){var n=e.ownerDocument;if(n){var i=n.createElement("html2canvaswrapper");if(i.appendChild(e.cloneNode(!0)),n=e.parentNode)return n.replaceChild(i,e),t=A(t,i),i.firstChild&&n.replaceChild(i.firstChild,i),t}return s.EMPTY}(i,o))),o=u):Li.SUPPORT_RANGE_BOUNDS||(o=o.splitText(t.length)),l+=t.length}),a)},ki=/(^|\s|:|-|\(|\))([a-z])/g,Ni=function(t,e,n){return 0<t.length?e+n.toUpperCase():t},ji=(e(Hi,Ci=Ai),Hi);function Hi(t,e){return(t=Ci.call(this,t,e)||this).src=e.currentSrc||e.src,t.intrinsicWidth=e.naturalWidth,t.intrinsicHeight=e.naturalHeight,t.context.cache.addImage(t.src),t}e(Gi,zi=Ai);var zi,Vi=Gi;function Gi(t,e){return(t=zi.call(this,t,e)||this).canvas=e,t.intrinsicWidth=e.width,t.intrinsicHeight=e.height,t}e(Xi,Yi=Ai);var Yi,Ki=Xi;function Xi(t,e){var n=Yi.call(this,t,e)||this,i=new XMLSerializer;t=A(t,e);return e.setAttribute("width",t.width+"px"),e.setAttribute("height",t.height+"px"),n.svg="data:image/svg+xml,"+encodeURIComponent(i.serializeToString(e)),n.intrinsicWidth=e.width.baseVal.value,n.intrinsicHeight=e.height.baseVal.value,n.context.cache.addImage(n.svg),n}e(qi,Wi=Ai);var Wi,Zi=qi;function qi(t,e){return(t=Wi.call(this,t,e)||this).value=e.value,t}e(tr,Ji=Ai);var Ji,$i=tr;function tr(t,e){return(t=Ji.call(this,t,e)||this).start=e.start,t.reversed="boolean"==typeof e.reversed&&!0===e.reversed,t}var er,nr=[{type:15,flags:0,unit:"px",number:3}],ir=[{type:16,flags:0,number:50}],rr="checkbox",or="radio",sr=707406591,ar=(e(Ar,er=Ai),Ar);function Ar(t,e){var n=er.call(this,t,e)||this;switch(n.type=e.type.toLowerCase(),n.checked=e.checked,n.value=0===(e="password"===(t=e).type?new Array(t.value.length+1).join(""):t.value).length?t.placeholder||"":e,n.type!==rr&&n.type!==or||(n.styles.backgroundColor=3739148031,n.styles.borderTopColor=n.styles.borderRightColor=n.styles.borderBottomColor=n.styles.borderLeftColor=2779096575,n.styles.borderTopWidth=n.styles.borderRightWidth=n.styles.borderBottomWidth=n.styles.borderLeftWidth=1,n.styles.borderTopStyle=n.styles.borderRightStyle=n.styles.borderBottomStyle=n.styles.borderLeftStyle=1,n.styles.backgroundClip=[0],n.styles.backgroundOrigin=[0],n.bounds=(e=n.bounds).width>e.height?new s(e.left+(e.width-e.height)/2,e.top,e.height,e.height):e.width<e.height?new s(e.left,e.top+(e.height-e.width)/2,e.width,e.width):e),n.type){case rr:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=nr;break;case or:n.styles.borderTopRightRadius=n.styles.borderTopLeftRadius=n.styles.borderBottomRightRadius=n.styles.borderBottomLeftRadius=ir}return n}e(hr,lr=Ai);var lr,ur=hr;function hr(t,e){return t=lr.call(this,t,e)||this,e=e.options[e.selectedIndex||0],t.value=e&&e.text||"",t}e(pr,cr=Ai);var cr,fr=pr;function pr(t,e){return(t=cr.call(this,t,e)||this).value=e.value,t}e(mr,dr=Ai);var dr,yr=mr;function mr(t,e){var n,i,r=dr.call(this,t,e)||this;r.src=e.src,r.width=parseInt(e.width,10)||0,r.height=parseInt(e.height,10)||0,r.backgroundColor=r.styles.backgroundColor;try{e.contentWindow&&e.contentWindow.document&&e.contentWindow.document.documentElement&&(r.tree=Mr(t,e.contentWindow.document.documentElement),n=e.contentWindow.document.documentElement?ce(t,getComputedStyle(e.contentWindow.document.documentElement).backgroundColor):xe.TRANSPARENT,i=e.contentWindow.document.body?ce(t,getComputedStyle(e.contentWindow.document.body).backgroundColor):xe.TRANSPARENT,r.backgroundColor=Jt(n)?Jt(i)?r.styles.backgroundColor:i:n)}catch(t){}return r}function gr(t){return"VIDEO"===t.tagName}function vr(t){return"STYLE"===t.tagName}function br(t){return 0<t.tagName.indexOf("-")}function xr(t){return"BODY"===t.tagName}var wr=["OL","UL","MENU"],Br=function(t,e){return new(Lr(e)?ji:Ir(e)?Vi:Rr(e)?Ki:Or(e)?Zi:Pr(e)?$i:Ur(e)?ar:kr(e)?ur:Qr(e)?fr:Dr(e)?yr:Ai)(t,e)},Mr=function(t,e){var n=Br(t,e);return n.flags|=4,function t(e,n,i,r){for(var o=n.firstChild;o;o=a){var s,a=o.nextSibling;Er(o)&&0<o.data.trim().length?i.textNodes.push(new Qi(e,o,i.styles)):Tr(o)&&(Nr(o)&&o.assignedNodes?o.assignedNodes().forEach(function(n){return t(e,n,i,r)}):(s=Br(e,o)).styles.isVisible()&&(Sr(o,s,r)?s.flags|=4:_r(s.styles)&&(s.flags|=2),-1!==wr.indexOf(o.tagName)&&(s.flags|=8),i.elements.push(s),o.slot,o.shadowRoot?t(e,o.shadowRoot,s,r):Qr(o)||Rr(o)||kr(o)||t(e,o,s,r)))}}(t,e,n,n),n},Sr=function(t,e,n){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||xr(t)&&n.styles.isTransparent()},_r=function(t){return t.isPositioned()||t.isFloating()},Er=function(t){return t.nodeType===Node.TEXT_NODE},Tr=function(t){return t.nodeType===Node.ELEMENT_NODE},Cr=function(t){return Tr(t)&&void 0!==t.style&&!Fr(t)},Fr=function(t){return"object"==r(t.className)},Or=function(t){return"LI"===t.tagName},Pr=function(t){return"OL"===t.tagName},Ur=function(t){return"INPUT"===t.tagName},Rr=function(t){return"svg"===t.tagName},Ir=function(t){return"CANVAS"===t.tagName},Lr=function(t){return"IMG"===t.tagName},Dr=function(t){return"IFRAME"===t.tagName},Qr=function(t){return"TEXTAREA"===t.tagName},kr=function(t){return"SELECT"===t.tagName},Nr=function(t){return"SLOT"===t.tagName},jr=(Hr.prototype.getCounterValue=function(t){return(t=this.counters[t])&&t.length?t[t.length-1]:1},Hr.prototype.getCounterValues=function(t){return(t=this.counters[t])||[]},Hr.prototype.pop=function(t){var e=this;t.forEach(function(t){return e.counters[t].pop()})},Hr.prototype.parse=function(t){var e=this,n=t.counterIncrement,i=(t=t.counterReset,!0),r=(null!==n&&n.forEach(function(t){var n=e.counters[t.counter];n&&0!==t.increment&&(i=!1,n.length||n.push(1),n[Math.max(0,n.length-1)]+=t.increment)}),[]);return i&&t.forEach(function(t){var n=e.counters[t.counter];r.push(t.counter),(n=n||(e.counters[t.counter]=[])).push(t.reset)}),r},Hr);function Hr(){this.counters={}}function zr(t,e,n,i,r,o){return t<e||n<t?to(t,r,0<o.length):i.integers.reduce(function(e,n,r){for(;n<=t;)t-=n,e+=i.values[r];return e},"")+o}function Vr(t,e,n,i){for(var r="";n||t--,r=i(t)+r,e<=(t/=e)*e;);return r}function Gr(t,e,n,i,r){var o=n-e+1;return(t<0?"-":"")+(Vr(Math.abs(t),o,i,function(t){return u(Math.floor(t%o)+e)})+r)}function Yr(t,e,n){void 0===n&&(n=". ");var i=e.length;return Vr(Math.abs(t),i,!1,function(t){return e[Math.floor(t%i)]})+n}function Kr(t,e,n,i,r,o){if(t<-9999||9999<t)return to(t,4,0<r.length);var s=Math.abs(t),a=r;if(0===s)return e[0]+a;for(var A=0;0<s&&A<=4;A++){var l=s%10;0==l&&Rn(o,1)&&""!==a?a=e[l]+a:1<l||1==l&&0===A||1==l&&1===A&&Rn(o,2)||1==l&&1===A&&Rn(o,4)&&100<t||1==l&&1<A&&Rn(o,8)?a=e[l]+(0<A?n[A-1]:"")+a:1==l&&0<A&&(a=n[A-1]+a),s=Math.floor(s/10)}return(t<0?i:"")+a}var Xr,Wr={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Zr={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},qr={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},Jr={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},$r="",to=function(t,e,n){var i=n?". ":"",r=n?"":"",o=n?", ":"",s=n?" ":"";switch(e){case 0:return""+s;case 1:return""+s;case 2:return""+s;case 5:var a=Gr(t,48,57,!0,i);return a.length<4?"0"+a:a;case 4:return Yr(t,"",r);case 6:return zr(t,1,3999,Wr,3,i).toLowerCase();case 7:return zr(t,1,3999,Wr,3,i);case 8:return Gr(t,945,969,!1,i);case 9:return Gr(t,97,122,!1,i);case 10:return Gr(t,65,90,!1,i);case 11:return Gr(t,1632,1641,!0,i);case 12:case 49:return zr(t,1,9999,Zr,3,i);case 35:return zr(t,1,9999,Zr,3,i).toLowerCase();case 13:return Gr(t,2534,2543,!0,i);case 14:case 30:return Gr(t,6112,6121,!0,i);case 15:return Yr(t,"",r);case 16:return Yr(t,"",r);case 17:case 48:return Kr(t,"","","",r,14);case 47:return Kr(t,"","","",r,15);case 42:return Kr(t,"","","",r,14);case 41:return Kr(t,"","","",r,15);case 26:return Kr(t,"","","",r,0);case 25:return Kr(t,"","","",r,7);case 31:return Kr(t,"","",$r,o,7);case 33:return Kr(t,"","",$r,o,0);case 32:return Kr(t,"","",$r,o,7);case 18:return Gr(t,2406,2415,!0,i);case 20:return zr(t,1,19999,Jr,3,i);case 21:return Gr(t,2790,2799,!0,i);case 22:return Gr(t,2662,2671,!0,i);case 22:return zr(t,1,10999,qr,3,i);case 23:return Yr(t,"");case 24:return Yr(t,"");case 27:return Gr(t,3302,3311,!0,i);case 28:return Yr(t,"",r);case 29:return Yr(t,"",r);case 34:return Gr(t,3792,3801,!0,i);case 37:return Gr(t,6160,6169,!0,i);case 38:return Gr(t,4160,4169,!0,i);case 39:return Gr(t,2918,2927,!0,i);case 40:return Gr(t,1776,1785,!0,i);case 43:return Gr(t,3046,3055,!0,i);case 44:return Gr(t,3174,3183,!0,i);case 45:return Gr(t,3664,3673,!0,i);case 46:return Gr(t,3872,3881,!0,i);default:return Gr(t,48,57,!0,i)}},eo="data-html2canvas-ignore",no=(io.prototype.toIFrame=function(t,e){var n,r,s,a,A=this,l=oo(t,e);return l.contentWindow?(n=t.defaultView.pageXOffset,r=t.defaultView.pageYOffset,s=l.contentWindow,a=s.document,t=ao(l).then(function(){return i(A,void 0,void 0,function(){var t,n;return o(this,function(i){switch(i.label){case 0:return this.scrolledElements.forEach(co),s&&(s.scrollTo(e.left,e.top),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||s.scrollY===e.top&&s.scrollX===e.left||(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(s.scrollX-e.left,s.scrollY-e.top,0,0))),t=this.options.onclone,void 0===(n=this.clonedReferenceElement)?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:a.fonts&&a.fonts.ready?[4,a.fonts.ready]:[3,2];case 1:i.sent(),i.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,so(a)]:[3,4];case 3:i.sent(),i.label=4;case 4:return"function"==typeof t?[2,Promise.resolve().then(function(){return t(a,n)}).then(function(){return l})]:[2,l]}})})}),a.open(),a.write(uo(document.doctype)+"<html></html>"),ho(this.referenceElement.ownerDocument,n,r),a.replaceChild(a.adoptNode(this.documentElement),a.documentElement),a.close(),t):Promise.reject("Unable to find iframe window")},io.prototype.createElementClone=function(t){var e;return ai(t,2),Ir(t)?this.createCanvasClone(t):gr(t)?this.createVideoClone(t):vr(t)?this.createStyleClone(t):(e=t.cloneNode(!1),Lr(e)&&(Lr(t)&&t.currentSrc&&t.currentSrc!==t.src&&(e.src=t.currentSrc,e.srcset=""),"lazy"===e.loading)&&(e.loading="eager"),br(e)?this.createCustomElementClone(e):e)},io.prototype.createCustomElementClone=function(t){var e=document.createElement("html2canvascustomelement");return lo(t.style,e),e},io.prototype.createStyleClone=function(t){try{var e,n,i=t.sheet;if(i&&i.cssRules)return e=[].slice.call(i.cssRules,0).reduce(function(t,e){return e&&"string"==typeof e.cssText?t+e.cssText:t},""),(n=t.cloneNode(!1)).textContent=e,n}catch(t){if(this.context.logger.error("Unable to access cssRules property",t),"SecurityError"!==t.name)throw t}return t.cloneNode(!1)},io.prototype.createCanvasClone=function(t){var e;if(this.options.inlineImages&&t.ownerDocument){var n=t.ownerDocument.createElement("img");try{return n.src=t.toDataURL(),n}catch(e){this.context.logger.info("Unable to inline canvas contents, canvas is tainted",t)}}n=t.cloneNode(!1);try{n.width=t.width,n.height=t.height;var i,r,o=t.getContext("2d"),s=n.getContext("2d");s&&(!this.options.allowTaint&&o?s.putImageData(o.getImageData(0,0,t.width,t.height),0,0):((i=null!=(e=t.getContext("webgl2"))?e:t.getContext("webgl"))&&!1===(null==(r=i.getContextAttributes())?void 0:r.preserveDrawingBuffer)&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",t),s.drawImage(t,0,0)))}catch(e){this.context.logger.info("Unable to clone canvas as it is tainted",t)}return n},io.prototype.createVideoClone=function(t){var e=t.ownerDocument.createElement("canvas"),n=(e.width=t.offsetWidth,e.height=t.offsetHeight,e.getContext("2d"));try{return n&&(n.drawImage(t,0,0,e.width,e.height),this.options.allowTaint||n.getImageData(0,0,e.width,e.height)),e}catch(e){this.context.logger.info("Unable to clone video as it is tainted",t)}return(e=t.ownerDocument.createElement("canvas")).width=t.offsetWidth,e.height=t.offsetHeight,e},io.prototype.appendChildNode=function(t,e,n){Tr(e)&&("SCRIPT"===e.tagName||e.hasAttribute(eo)||"function"==typeof this.options.ignoreElements&&this.options.ignoreElements(e))||this.options.copyStyles&&Tr(e)&&vr(e)||t.appendChild(this.cloneNode(e,n))},io.prototype.cloneChildNodes=function(t,e,n){for(var i,r=this,o=(t.shadowRoot||t).firstChild;o;o=o.nextSibling)Tr(o)&&Nr(o)&&"function"==typeof o.assignedNodes?(i=o.assignedNodes()).length&&i.forEach(function(t){return r.appendChildNode(e,t,n)}):this.appendChildNode(e,o,n)},io.prototype.cloneNode=function(t,e){var n,i,r,o,s;return Er(t)?document.createTextNode(t.data):t.ownerDocument&&(n=t.ownerDocument.defaultView)&&Tr(t)&&(Cr(t)||Fr(t))?((i=this.createElementClone(t)).style.transitionProperty="none",r=n.getComputedStyle(t),o=n.getComputedStyle(t,":before"),s=n.getComputedStyle(t,":after"),this.referenceElement===t&&Cr(i)&&(this.clonedReferenceElement=i),xr(i)&&mo(i),n=this.counters.parse(new oi(this.context,r)),o=this.resolvePseudoContent(t,i,o,Xr.BEFORE),br(t)&&(e=!0),gr(t)||this.cloneChildNodes(t,i,e),o&&i.insertBefore(o,i.firstChild),(s=this.resolvePseudoContent(t,i,s,Xr.AFTER))&&i.appendChild(s),this.counters.pop(n),(r&&(this.options.copyStyles||Fr(t))&&!Dr(t)||e)&&lo(r,i),0===t.scrollTop&&0===t.scrollLeft||this.scrolledElements.push([i,t.scrollLeft,t.scrollTop]),(Qr(t)||kr(t))&&(Qr(i)||kr(i))&&(i.value=t.value),i):t.cloneNode(!1)},io.prototype.resolvePseudoContent=function(t,e,n,i){var r=this;if(n){var o,s,a=n.content,A=e.ownerDocument;if(A&&a&&"none"!==a&&"-moz-alt-content"!==a&&"none"!==n.display)return this.counters.parse(new oi(this.context,n)),o=new ri(this.context,n),s=A.createElement("html2canvaspseudoelement"),lo(n,s),o.content.forEach(function(e){if(0===e.type)s.appendChild(A.createTextNode(e.value));else if(22===e.type){var n=A.createElement("img");n.src=e.value,n.style.opacity="1",s.appendChild(n)}else if(18===e.type){var i,a,l,u,h;"attr"===e.name?(n=e.values.filter(Nt)).length&&s.appendChild(A.createTextNode(t.getAttribute(n[0].value)||"")):"counter"===e.name?(l=(a=e.values.filter(Vt))[0],a=a[1],l&&Nt(l)&&(i=r.counters.getCounterValue(l.value),h=a&&Nt(a)?pn.parse(r.context,a.value):3,s.appendChild(A.createTextNode(to(i,h,!1))))):"counters"===e.name&&(l=(i=e.values.filter(Vt))[0],h=i[1],a=i[2],l)&&Nt(l)&&(l=r.counters.getCounterValues(l.value),u=a&&Nt(a)?pn.parse(r.context,a.value):3,h=h&&0===h.type?h.value:"",h=l.map(function(t){return to(t,u,!1)}).join(h),s.appendChild(A.createTextNode(h)))}else if(20===e.type)switch(e.value){case"open-quote":s.appendChild(A.createTextNode(In(o.quotes,r.quoteDepth++,!0)));break;case"close-quote":s.appendChild(A.createTextNode(In(o.quotes,--r.quoteDepth,!1)));break;default:s.appendChild(A.createTextNode(e.value))}}),s.className=fo+" "+po,i=i===Xr.BEFORE?" "+fo:" "+po,Fr(e)?e.className.baseValue+=i:e.className+=i,s}},io.destroy=function(t){return!!t.parentNode&&(t.parentNode.removeChild(t),!0)},io);function io(t,e,n){if(this.context=t,this.options=n,this.scrolledElements=[],this.referenceElement=e,this.counters=new jr,this.quoteDepth=0,!e.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(e.ownerDocument.documentElement,!1)}function ro(t){return new Promise(function(e){!t.complete&&t.src?(t.onload=e,t.onerror=e):e()})}(ue=Xr=Xr||{})[ue.BEFORE=0]="BEFORE",ue[ue.AFTER=1]="AFTER";var oo=function(t,e){var n=t.createElement("iframe");return n.className="html2canvas-container",n.style.visibility="hidden",n.style.position="fixed",n.style.left="-10000px",n.style.top="0px",n.style.border="0",n.width=e.width.toString(),n.height=e.height.toString(),n.scrolling="no",n.setAttribute(eo,"true"),t.body.appendChild(n),n},so=function(t){return Promise.all([].slice.call(t.images,0).map(ro))},ao=function(t){return new Promise(function(e,n){var i=t.contentWindow;if(!i)return n("No window assigned for iframe");var r=i.document;i.onload=t.onload=function(){i.onload=t.onload=null;var n=setInterval(function(){0<r.body.childNodes.length&&"complete"===r.readyState&&(clearInterval(n),e(t))},50)}})},Ao=["all","d","content"],lo=function(t,e){for(var n=t.length-1;0<=n;n--){var i=t.item(n);-1===Ao.indexOf(i)&&e.style.setProperty(i,t.getPropertyValue(i))}return e},uo=function(t){var e="";return t&&(e+="<!DOCTYPE ",t.name&&(e+=t.name),t.internalSubset&&(e+=t.internalSubset),t.publicId&&(e+='"'+t.publicId+'"'),t.systemId&&(e+='"'+t.systemId+'"'),e+=">"),e},ho=function(t,e,n){t&&t.defaultView&&(e!==t.defaultView.pageXOffset||n!==t.defaultView.pageYOffset)&&t.defaultView.scrollTo(e,n)},co=function(t){var e=t[0],n=t[1];t=t[2];e.scrollLeft=n,e.scrollTop=t},fo="___html2canvas___pseudoelement_before",po="___html2canvas___pseudoelement_after",yo='{\n    content: "" !important;\n    display: none !important;\n}',mo=function(t){go(t,"."+fo+":before"+yo+"\n         ."+po+":after"+yo)},go=function(t,e){var n=t.ownerDocument;n&&((n=n.createElement("style")).textContent=e,t.appendChild(n))},vo=(bo.getOrigin=function(t){var e=bo.U;return e?(e.href=t,e.href=e.href,e.protocol+e.hostname+e.port):"about:blank"},bo.isSameOrigin=function(t){return bo.getOrigin(t)===bo.F},bo.setContext=function(t){bo.U=t.document.createElement("a"),bo.F=bo.getOrigin(t.location.href)},bo.F="about:blank",bo);function bo(){}wo.prototype.addImage=function(t){var e=Promise.resolve();return this.has(t)||(Co(t)||_o(t))&&(this.g[t]=this.loadImage(t)).catch(function(){}),e},wo.prototype.match=function(t){return this.g[t]},wo.prototype.loadImage=function(t){return i(this,void 0,void 0,function(){var e,n,i,r,s=this;return o(this,function(o){switch(o.label){case 0:return e=vo.isSameOrigin(t),n=!Eo(t)&&!0===this.C.useCORS&&Li.SUPPORT_CORS_IMAGES&&!e,i=!Eo(t)&&!e&&!Co(t)&&"string"==typeof this.C.proxy&&Li.SUPPORT_CORS_XHR&&!n,e||!1!==this.C.allowTaint||Eo(t)||Co(t)||i||n?(r=t,i?[4,this.proxy(r)]:[3,2]):[2];case 1:r=o.sent(),o.label=2;case 2:return this.context.logger.debug("Added image "+t.substring(0,256)),[4,new Promise(function(t,e){var i=new Image;i.onload=function(){return t(i)},i.onerror=e,(To(r)||n)&&(i.crossOrigin="anonymous"),i.src=r,!0===i.complete&&setTimeout(function(){return t(i)},500),0<s.C.imageTimeout&&setTimeout(function(){return e("Timed out ("+s.C.imageTimeout+"ms) loading image")},s.C.imageTimeout)})];case 3:return[2,o.sent()]}})})},wo.prototype.has=function(t){return void 0!==this.g[t]},wo.prototype.keys=function(){return Promise.resolve(Object.keys(this.g))},wo.prototype.proxy=function(t){var e,n=this,i=this.C.proxy;if(i)return e=t.substring(0,256),new Promise(function(r,o){var s=Li.SUPPORT_RESPONSE_TYPE?"blob":"text",a=new XMLHttpRequest;a.onload=function(){var t;200===a.status?"text"==s?r(a.response):((t=new FileReader).addEventListener("load",function(){return r(t.result)},!1),t.addEventListener("error",function(t){return o(t)},!1),t.readAsDataURL(a.response)):o("Failed to proxy resource "+e+" with status code "+a.status)},a.onerror=o;var A,l=-1<i.indexOf("?")?"&":"?";a.open("GET",i+l+"url="+encodeURIComponent(t)+"&responseType="+s),"text"!=s&&a instanceof XMLHttpRequest&&(a.responseType=s),n.C.imageTimeout&&(A=n.C.imageTimeout,a.timeout=A,a.ontimeout=function(){return o("Timed out ("+A+"ms) proxying "+e)}),a.send()});throw new Error("No proxy defined")};var xo=wo;function wo(t,e){this.context=t,this.C=e,this.g={}}var Bo=/^data:image\/svg\+xml/i,Mo=/^data:image\/.*;base64,/i,So=/^data:image\/.*/i,_o=function(t){return Li.SUPPORT_SVG_DRAWING||!Fo(t)},Eo=function(t){return So.test(t)},To=function(t){return Mo.test(t)},Co=function(t){return"blob"===t.substr(0,4)},Fo=function(t){return"svg"===t.substr(-3).toLowerCase()||Bo.test(t)},Oo=(Po.prototype.add=function(t,e){return new Po(this.x+t,this.y+e)},Po);function Po(t,e){this.type=0,this.x=t,this.y=e}function Uo(t,e,n){return new Oo(t.x+(e.x-t.x)*n,t.y+(e.y-t.y)*n)}Lo.prototype.subdivide=function(t,e){var n=Uo(this.start,this.startControl,t),i=Uo(this.startControl,this.endControl,t),r=Uo(this.endControl,this.end,t),o=Uo(n,i,t);t=Uo(o,i=Uo(i,r,t),t);return e?new Lo(this.start,n,o,t):new Lo(t,i,r,this.end)},Lo.prototype.add=function(t,e){return new Lo(this.start.add(t,e),this.startControl.add(t,e),this.endControl.add(t,e),this.end.add(t,e))},Lo.prototype.reverse=function(){return new Lo(this.end,this.endControl,this.startControl,this.start)};var Ro,Io=Lo;function Lo(t,e,n,i){this.type=1,this.start=t,this.startControl=e,this.endControl=n,this.end=i}function Do(t){return 1===t.type}function Qo(t){return[t.topLeftBorderBox,t.topRightBorderBox,t.bottomRightBorderBox,t.bottomLeftBorderBox]}function ko(t){return[t.topLeftPaddingBox,t.topRightPaddingBox,t.bottomRightPaddingBox,t.bottomLeftPaddingBox]}function No(t){return 1===t.type}function jo(t,e){return t.length===e.length&&t.some(function(t,n){return t===e[n]})}function Ho(t,e){this.path=t,this.target=e,this.type=1}function zo(t){this.element=t,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}(ue=Ro=Ro||{})[ue.TOP_LEFT=0]="TOP_LEFT",ue[ue.TOP_RIGHT=1]="TOP_RIGHT",ue[ue.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",ue[ue.BOTTOM_LEFT=3]="BOTTOM_LEFT";var Vo=function(t,e,n,i,r){var o=(Math.sqrt(2)-1)/3*4,s=n*o,a=i*o,A=t+n,l=e+i;switch(r){case Ro.TOP_LEFT:return new Io(new Oo(t,l),new Oo(t,l-a),new Oo(A-s,e),new Oo(A,e));case Ro.TOP_RIGHT:return new Io(new Oo(t,e),new Oo(t+s,e),new Oo(A,l-a),new Oo(A,l));case Ro.BOTTOM_RIGHT:return new Io(new Oo(A,e),new Oo(A,e+a),new Oo(t+s,l),new Oo(t,l));default:return Ro.BOTTOM_LEFT,new Io(new Oo(A,l),new Oo(A-s,l),new Oo(t,e+a),new Oo(t,e))}},Go=(Yo.prototype.getEffects=function(t){for(var e=-1===[2,3].indexOf(this.container.styles.position),n=this.parent,i=this.effects.slice(0);n;){var r,o=n.effects.filter(function(t){return!No(t)});e||0!==n.container.styles.position||!n.parent?(i.unshift.apply(i,o),e=-1===[2,3].indexOf(n.container.styles.position),0!==n.container.styles.overflowX&&(jo(Qo(n.curves),r=ko(n.curves))||i.unshift(new Ho(r,6)))):i.unshift.apply(i,o),n=n.parent}return i.filter(function(e){return Rn(e.target,t)})},Yo);function Yo(t,e){var n,i;this.container=t,this.parent=e,this.effects=[],this.curves=new function(t){var e=t.styles,n=t.bounds,i=(y=Wt(e.borderTopLeftRadius,n.width,n.height))[0],r=y[1],o=(m=Wt(e.borderTopRightRadius,n.width,n.height))[0],s=m[1],a=(g=Wt(e.borderBottomRightRadius,n.width,n.height))[0],A=g[1],l=(v=Wt(e.borderBottomLeftRadius,n.width,n.height))[0],u=v[1],h=((b=[]).push((i+o)/n.width),b.push((l+a)/n.width),b.push((r+u)/n.height),b.push((s+A)/n.height),1<(x=Math.max.apply(Math,b))&&(i/=x,r/=x,o/=x,s/=x,a/=x,A/=x,l/=x,u/=x),n.width-o),c=n.height-A,f=n.width-a,p=n.height-u,d=e.borderTopWidth,y=e.borderRightWidth,m=e.borderBottomWidth,g=e.borderLeftWidth,v=ae(e.paddingTop,t.bounds.width),b=ae(e.paddingRight,t.bounds.width),x=ae(e.paddingBottom,t.bounds.width);t=ae(e.paddingLeft,t.bounds.width),this.topLeftBorderDoubleOuterBox=0<i||0<r?Vo(n.left+g/3,n.top+d/3,i-g/3,r-d/3,Ro.TOP_LEFT):new Oo(n.left+g/3,n.top+d/3),this.topRightBorderDoubleOuterBox=0<i||0<r?Vo(n.left+h,n.top+d/3,o-y/3,s-d/3,Ro.TOP_RIGHT):new Oo(n.left+n.width-y/3,n.top+d/3),this.bottomRightBorderDoubleOuterBox=0<a||0<A?Vo(n.left+f,n.top+c,a-y/3,A-m/3,Ro.BOTTOM_RIGHT):new Oo(n.left+n.width-y/3,n.top+n.height-m/3),this.bottomLeftBorderDoubleOuterBox=0<l||0<u?Vo(n.left+g/3,n.top+p,l-g/3,u-m/3,Ro.BOTTOM_LEFT):new Oo(n.left+g/3,n.top+n.height-m/3),this.topLeftBorderDoubleInnerBox=0<i||0<r?Vo(n.left+2*g/3,n.top+2*d/3,i-2*g/3,r-2*d/3,Ro.TOP_LEFT):new Oo(n.left+2*g/3,n.top+2*d/3),this.topRightBorderDoubleInnerBox=0<i||0<r?Vo(n.left+h,n.top+2*d/3,o-2*y/3,s-2*d/3,Ro.TOP_RIGHT):new Oo(n.left+n.width-2*y/3,n.top+2*d/3),this.bottomRightBorderDoubleInnerBox=0<a||0<A?Vo(n.left+f,n.top+c,a-2*y/3,A-2*m/3,Ro.BOTTOM_RIGHT):new Oo(n.left+n.width-2*y/3,n.top+n.height-2*m/3),this.bottomLeftBorderDoubleInnerBox=0<l||0<u?Vo(n.left+2*g/3,n.top+p,l-2*g/3,u-2*m/3,Ro.BOTTOM_LEFT):new Oo(n.left+2*g/3,n.top+n.height-2*m/3),this.topLeftBorderStroke=0<i||0<r?Vo(n.left+g/2,n.top+d/2,i-g/2,r-d/2,Ro.TOP_LEFT):new Oo(n.left+g/2,n.top+d/2),this.topRightBorderStroke=0<i||0<r?Vo(n.left+h,n.top+d/2,o-y/2,s-d/2,Ro.TOP_RIGHT):new Oo(n.left+n.width-y/2,n.top+d/2),this.bottomRightBorderStroke=0<a||0<A?Vo(n.left+f,n.top+c,a-y/2,A-m/2,Ro.BOTTOM_RIGHT):new Oo(n.left+n.width-y/2,n.top+n.height-m/2),this.bottomLeftBorderStroke=0<l||0<u?Vo(n.left+g/2,n.top+p,l-g/2,u-m/2,Ro.BOTTOM_LEFT):new Oo(n.left+g/2,n.top+n.height-m/2),this.topLeftBorderBox=0<i||0<r?Vo(n.left,n.top,i,r,Ro.TOP_LEFT):new Oo(n.left,n.top),this.topRightBorderBox=0<o||0<s?Vo(n.left+h,n.top,o,s,Ro.TOP_RIGHT):new Oo(n.left+n.width,n.top),this.bottomRightBorderBox=0<a||0<A?Vo(n.left+f,n.top+c,a,A,Ro.BOTTOM_RIGHT):new Oo(n.left+n.width,n.top+n.height),this.bottomLeftBorderBox=0<l||0<u?Vo(n.left,n.top+p,l,u,Ro.BOTTOM_LEFT):new Oo(n.left,n.top+n.height),this.topLeftPaddingBox=0<i||0<r?Vo(n.left+g,n.top+d,Math.max(0,i-g),Math.max(0,r-d),Ro.TOP_LEFT):new Oo(n.left+g,n.top+d),this.topRightPaddingBox=0<o||0<s?Vo(n.left+Math.min(h,n.width-y),n.top+d,h>n.width+y?0:Math.max(0,o-y),Math.max(0,s-d),Ro.TOP_RIGHT):new Oo(n.left+n.width-y,n.top+d),this.bottomRightPaddingBox=0<a||0<A?Vo(n.left+Math.min(f,n.width-g),n.top+Math.min(c,n.height-m),Math.max(0,a-y),Math.max(0,A-m),Ro.BOTTOM_RIGHT):new Oo(n.left+n.width-y,n.top+n.height-m),this.bottomLeftPaddingBox=0<l||0<u?Vo(n.left+g,n.top+Math.min(p,n.height-m),Math.max(0,l-g),Math.max(0,u-m),Ro.BOTTOM_LEFT):new Oo(n.left+g,n.top+n.height-m),this.topLeftContentBox=0<i||0<r?Vo(n.left+g+t,n.top+d+v,Math.max(0,i-(g+t)),Math.max(0,r-(d+v)),Ro.TOP_LEFT):new Oo(n.left+g+t,n.top+d+v),this.topRightContentBox=0<o||0<s?Vo(n.left+Math.min(h,n.width+g+t),n.top+d+v,h>n.width+g+t?0:o-g+t,s-(d+v),Ro.TOP_RIGHT):new Oo(n.left+n.width-(y+b),n.top+d+v),this.bottomRightContentBox=0<a||0<A?Vo(n.left+Math.min(f,n.width-(g+t)),n.top+Math.min(c,n.height+d+v),Math.max(0,a-(y+b)),A-(m+x),Ro.BOTTOM_RIGHT):new Oo(n.left+n.width-(y+b),n.top+n.height-(m+x)),this.bottomLeftContentBox=0<l||0<u?Vo(n.left+g+t,n.top+p,Math.max(0,l-(g+t)),u-(m+x),Ro.BOTTOM_LEFT):new Oo(n.left+g+t,n.top+n.height-(m+x))}(this.container),this.container.styles.opacity<1&&this.effects.push(new function(t){this.opacity=t,this.type=2,this.target=6}(this.container.styles.opacity)),null!==this.container.styles.transform&&(e=this.container.bounds.left+this.container.styles.transformOrigin[0].number,n=this.container.bounds.top+this.container.styles.transformOrigin[1].number,i=this.container.styles.transform,this.effects.push(new function(t,e,n){this.offsetX=t,this.offsetY=e,this.matrix=n,this.type=0,this.target=6}(e,n,i))),0!==this.container.styles.overflowX&&(jo(n=Qo(this.curves),i=ko(this.curves))?this.effects.push(new Ho(n,6)):(this.effects.push(new Ho(n,2)),this.effects.push(new Ho(i,4))))}function Ko(t,e){switch(e){case 0:return es(t.topLeftBorderBox,t.topLeftPaddingBox,t.topRightBorderBox,t.topRightPaddingBox);case 1:return es(t.topRightBorderBox,t.topRightPaddingBox,t.bottomRightBorderBox,t.bottomRightPaddingBox);case 2:return es(t.bottomRightBorderBox,t.bottomRightPaddingBox,t.bottomLeftBorderBox,t.bottomLeftPaddingBox);default:return es(t.bottomLeftBorderBox,t.bottomLeftPaddingBox,t.topLeftBorderBox,t.topLeftPaddingBox)}}function Xo(t){var e=t.bounds;t=t.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))}function Wo(t){var e=t.styles,n=t.bounds,i=ae(e.paddingLeft,n.width),r=ae(e.paddingRight,n.width),o=ae(e.paddingTop,n.width);t=ae(e.paddingBottom,n.width);return n.add(i+e.borderLeftWidth,o+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+i+r),-(e.borderTopWidth+e.borderBottomWidth+o+t))}function Zo(t,e,n){var i=0===(r=is(t.styles.backgroundOrigin,e))?t.bounds:(2===r?Wo:Xo)(t),r=0===(s=is(t.styles.backgroundClip,e))?t.bounds:(2===s?Wo:Xo)(t),o=ns(is(t.styles.backgroundSize,e),n,i),s=o[0],a=o[1];n=Wt(is(t.styles.backgroundPosition,e),i.width-s,i.height-a);return[rs(is(t.styles.backgroundRepeat,e),n,o,i,r),Math.round(i.left+n[0]),Math.round(i.top+n[1]),s,a]}function qo(t){return Nt(t)&&t.value===ge.AUTO}function Jo(t){return"number"==typeof t}function $o(t,e){for(var n=t instanceof $i?t.start:1,i=t instanceof $i&&t.reversed,r=0;r<e.length;r++){var o=e[r];o.container instanceof Zi&&"number"==typeof o.container.value&&0!==o.container.value&&(n=o.container.value),o.listValue=to(n,o.container.styles.listStyleType,!0),n+=i?-1:1}}function ts(t,e){var n=[];return Do(t)?n.push(t.subdivide(.5,!1)):n.push(t),Do(e)?n.push(e.subdivide(.5,!0)):n.push(e),n}function es(t,e,n,i){var r=[];return Do(t)?r.push(t.subdivide(.5,!1)):r.push(t),Do(n)?r.push(n.subdivide(.5,!0)):r.push(n),Do(i)?r.push(i.subdivide(.5,!0).reverse()):r.push(i),Do(e)?r.push(e.subdivide(.5,!1).reverse()):r.push(e),r}var ns=function(t,e,n){var i=e[0],r=e[1],o=e[2],s=t[0],a=t[1];if(!s)return[0,0];if(Kt(s)&&a&&Kt(a))return[ae(s,n.width),ae(a,n.height)];var A=Jo(o);if(Nt(s)&&(s.value===ge.CONTAIN||s.value===ge.COVER))return Jo(o)?n.width/n.height<o!=(s.value===ge.COVER)?[n.width,n.width/o]:[n.height*o,n.height]:[n.width,n.height];var l,u,h=Jo(i);e=Jo(r),t=h||e;if(qo(s)&&(!a||qo(a)))return h&&e?[i,r]:A||t?t&&A?[h?i:r*o,e?r:i/o]:[h?i:n.width,e?r:n.height]:[n.width,n.height];if(A)return u=l=0,Kt(s)?l=ae(s,n.width):Kt(a)&&(u=ae(a,n.height)),qo(s)?l=u*o:a&&!qo(a)||(u=l/o),[l,u];if(u=l=null,Kt(s)?l=ae(s,n.width):a&&Kt(a)&&(u=ae(a,n.height)),null!==(l=null!==(u=null===l||a&&!qo(a)?u:h&&e?l/i*r:n.height)&&qo(s)?h&&e?u/r*i:n.width:l)&&null!==u)return[l,u];throw new Error("Unable to calculate background-size for element")},is=function(t,e){return void 0===(e=t[e])?t[0]:e},rs=function(t,e,n,i,r){var o=e[0],s=e[1],a=n[0],A=n[1];switch(t){case 2:return[new Oo(Math.round(i.left),Math.round(i.top+s)),new Oo(Math.round(i.left+i.width),Math.round(i.top+s)),new Oo(Math.round(i.left+i.width),Math.round(A+i.top+s)),new Oo(Math.round(i.left),Math.round(A+i.top+s))];case 3:return[new Oo(Math.round(i.left+o),Math.round(i.top)),new Oo(Math.round(i.left+o+a),Math.round(i.top)),new Oo(Math.round(i.left+o+a),Math.round(i.height+i.top)),new Oo(Math.round(i.left+o),Math.round(i.height+i.top))];case 1:return[new Oo(Math.round(i.left+o),Math.round(i.top+s)),new Oo(Math.round(i.left+o+a),Math.round(i.top+s)),new Oo(Math.round(i.left+o+a),Math.round(i.top+s+A)),new Oo(Math.round(i.left+o),Math.round(i.top+s+A))];default:return[new Oo(Math.round(r.left),Math.round(r.top)),new Oo(Math.round(r.left+r.width),Math.round(r.top)),new Oo(Math.round(r.left+r.width),Math.round(r.height+r.top)),new Oo(Math.round(r.left),Math.round(r.height+r.top))]}},os="Hidden Text",ss=(as.prototype.parseMetrics=function(t,e){var n=this.u.createElement("div"),i=this.u.createElement("img"),r=this.u.createElement("span"),o=this.u.body;return n.style.visibility="hidden",n.style.fontFamily=t,n.style.fontSize=e,n.style.margin="0",n.style.padding="0",n.style.whiteSpace="nowrap",o.appendChild(n),i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",i.width=1,i.height=1,i.style.margin="0",i.style.padding="0",i.style.verticalAlign="baseline",r.style.fontFamily=t,r.style.fontSize=e,r.style.margin="0",r.style.padding="0",r.appendChild(this.u.createTextNode(os)),n.appendChild(r),n.appendChild(i),e=i.offsetTop-r.offsetTop+2,n.removeChild(r),n.appendChild(this.u.createTextNode(os)),n.style.lineHeight="normal",i.style.verticalAlign="super",i=i.offsetTop-n.offsetTop+2,o.removeChild(n),{baseline:e,middle:i}},as.prototype.getMetrics=function(t,e){var n=t+" "+e;return void 0===this.H[n]&&(this.H[n]=this.parseMetrics(t,e)),this.H[n]},as);function as(t){this.H={},this.u=t}e(us,As=ue=function(t,e){this.context=t,this.options=e}),us.prototype.applyEffects=function(t){for(var e=this;this.h.length;)this.popEffect();t.forEach(function(t){return e.applyEffect(t)})},us.prototype.applyEffect=function(t){this.ctx.save(),2===t.type&&(this.ctx.globalAlpha=t.opacity),0===t.type&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),No(t)&&(this.path(t.path),this.ctx.clip()),this.h.push(t)},us.prototype.popEffect=function(){this.h.pop(),this.ctx.restore()},us.prototype.renderStack=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return t.element.container.styles.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},us.prototype.renderNode=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return Rn(t.container.flags,16),t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return e.sent(),[4,this.renderNodeContent(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},us.prototype.renderTextWithLetterSpacing=function(t,e,n){var i=this;0===e?this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+n):Bi(t.text).reduce(function(e,r){return i.ctx.fillText(r,e,t.bounds.top+n),e+i.ctx.measureText(r).width},t.bounds.left)},us.prototype.createFontStyle=function(t){var e=t.fontVariant.filter(function(t){return"normal"===t||"small-caps"===t}).join(""),n=ys(t.fontFamily).join(", "),i=Qt(t.fontSize)?""+t.fontSize.number+t.fontSize.unit:t.fontSize.number+"px";return[[t.fontStyle,e,t.fontWeight,i,n].join(" "),n,i]},us.prototype.renderTextNode=function(t,e){return i(this,void 0,void 0,function(){var n,i,r,s,a,A,l=this;return o(this,function(o){return r=this.createFontStyle(e),n=r[0],i=r[1],r=r[2],this.ctx.font=n,this.ctx.direction=1===e.direction?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",r=this.fontMetrics.getMetrics(i,r),s=r.baseline,a=r.middle,A=e.paintOrder,t.textBounds.forEach(function(t){A.forEach(function(n){switch(n){case 0:l.ctx.fillStyle=$t(e.color),l.renderTextWithLetterSpacing(t,e.letterSpacing,s);var i=e.textShadow;i.length&&t.text.trim().length&&(i.slice(0).reverse().forEach(function(n){l.ctx.shadowColor=$t(n.color),l.ctx.shadowOffsetX=n.offsetX.number*l.options.scale,l.ctx.shadowOffsetY=n.offsetY.number*l.options.scale,l.ctx.shadowBlur=n.blur.number,l.renderTextWithLetterSpacing(t,e.letterSpacing,s)}),l.ctx.shadowColor="",l.ctx.shadowOffsetX=0,l.ctx.shadowOffsetY=0,l.ctx.shadowBlur=0),e.textDecorationLine.length&&(l.ctx.fillStyle=$t(e.textDecorationColor||e.color),e.textDecorationLine.forEach(function(e){switch(e){case 1:l.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top+s),t.bounds.width,1);break;case 2:l.ctx.fillRect(t.bounds.left,Math.round(t.bounds.top),t.bounds.width,1);break;case 3:l.ctx.fillRect(t.bounds.left,Math.ceil(t.bounds.top+a),t.bounds.width,1)}}));break;case 1:e.webkitTextStrokeWidth&&t.text.trim().length&&(l.ctx.strokeStyle=$t(e.webkitTextStrokeColor),l.ctx.lineWidth=e.webkitTextStrokeWidth,l.ctx.lineJoin=window.chrome?"miter":"round",l.ctx.strokeText(t.text,t.bounds.left,t.bounds.top+s)),l.ctx.strokeStyle="",l.ctx.lineWidth=0,l.ctx.lineJoin="miter"}})}),[2]})})},us.prototype.renderReplacedElement=function(t,e,n){var i;n&&0<t.intrinsicWidth&&0<t.intrinsicHeight&&(i=Wo(t),e=ko(e),this.path(e),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(n,0,0,t.intrinsicWidth,t.intrinsicHeight,i.left,i.top,i.width,i.height),this.ctx.restore())},us.prototype.renderNodeContent=function(t){return i(this,void 0,void 0,function(){var e,n,i,r,a,A,l,u,h,c,f,p;return o(this,function(o){switch(o.label){case 0:this.applyEffects(t.getEffects(4)),e=t.container,n=t.curves,i=e.styles,r=0,a=e.textNodes,o.label=1;case 1:return r<a.length?(A=a[r],[4,this.renderTextNode(A,i)]):[3,4];case 2:o.sent(),o.label=3;case 3:return r++,[3,1];case 4:if(!(e instanceof ji))return[3,8];o.label=5;case 5:return o.trys.push([5,7,,8]),[4,this.context.cache.match(e.src)];case 6:return h=o.sent(),this.renderReplacedElement(e,n,h),[3,8];case 7:return o.sent(),this.context.logger.error("Error loading image "+e.src),[3,8];case 8:if(e instanceof Vi&&this.renderReplacedElement(e,n,e.canvas),!(e instanceof Ki))return[3,12];o.label=9;case 9:return o.trys.push([9,11,,12]),[4,this.context.cache.match(e.svg)];case 10:return h=o.sent(),this.renderReplacedElement(e,n,h),[3,12];case 11:return o.sent(),this.context.logger.error("Error loading svg "+e.svg.substring(0,255)),[3,12];case 12:return e instanceof yr&&e.tree?[4,new us(this.context,{scale:this.options.scale,backgroundColor:e.backgroundColor,x:0,y:0,width:e.width,height:e.height}).render(e.tree)]:[3,14];case 13:A=o.sent(),e.width&&e.height&&this.ctx.drawImage(A,0,0,e.width,e.height,e.bounds.left,e.bounds.top,e.bounds.width,e.bounds.height),o.label=14;case 14:if(e instanceof ar&&(u=Math.min(e.bounds.width,e.bounds.height),e.type===rr?e.checked&&(this.ctx.save(),this.path([new Oo(e.bounds.left+.39363*u,e.bounds.top+.79*u),new Oo(e.bounds.left+.16*u,e.bounds.top+.5549*u),new Oo(e.bounds.left+.27347*u,e.bounds.top+.44071*u),new Oo(e.bounds.left+.39694*u,e.bounds.top+.5649*u),new Oo(e.bounds.left+.72983*u,e.bounds.top+.23*u),new Oo(e.bounds.left+.84*u,e.bounds.top+.34085*u),new Oo(e.bounds.left+.39363*u,e.bounds.top+.79*u)]),this.ctx.fillStyle=$t(sr),this.ctx.fill(),this.ctx.restore()):e.type===or&&e.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(e.bounds.left+u/2,e.bounds.top+u/2,u/4,0,2*Math.PI,!0),this.ctx.fillStyle=$t(sr),this.ctx.fill(),this.ctx.restore())),cs(e)&&e.value.length){switch(c=this.createFontStyle(i),f=c[0],u=c[1],c=this.fontMetrics.getMetrics(f,u).baseline,this.ctx.font=f,this.ctx.fillStyle=$t(i.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ps(e.styles.textAlign),p=Wo(e),l=0,e.styles.textAlign){case 1:l+=p.width/2;break;case 2:l+=p.width}u=p.add(l,0,0,-p.height/2+1),this.ctx.save(),this.path([new Oo(p.left,p.top),new Oo(p.left+p.width,p.top),new Oo(p.left+p.width,p.top+p.height),new Oo(p.left,p.top+p.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new xi(e.value,u),i.letterSpacing,c),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Rn(e.styles.display,2048))return[3,20];if(null===e.styles.listStyleImage)return[3,19];if(0!==(c=e.styles.listStyleImage).type)return[3,18];h=void 0,c=c.url,o.label=15;case 15:return o.trys.push([15,17,,18]),[4,this.context.cache.match(c)];case 16:return h=o.sent(),this.ctx.drawImage(h,e.bounds.left-(h.width+10),e.bounds.top),[3,18];case 17:return o.sent(),this.context.logger.error("Error loading list-style-image "+c),[3,18];case 18:return[3,20];case 19:t.listValue&&-1!==e.styles.listStyleType&&(f=this.createFontStyle(i)[0],this.ctx.font=f,this.ctx.fillStyle=$t(i.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",p=new s(e.bounds.left,e.bounds.top+ae(e.styles.paddingTop,e.bounds.width),e.bounds.width,Le(i.lineHeight,i.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new xi(t.listValue,p),i.letterSpacing,Le(i.lineHeight,i.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),o.label=20;case 20:return[2]}})})},us.prototype.renderStackContent=function(t){return i(this,void 0,void 0,function(){var e,n,i,r,s,a,A,l,u,h,c,f,p,d,y;return o(this,function(o){switch(o.label){case 0:return Rn(t.element.container.flags,16),[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:o.sent(),e=0,n=t.negativeZIndex,o.label=2;case 2:return e<n.length?(y=n[e],[4,this.renderStack(y)]):[3,5];case 3:o.sent(),o.label=4;case 4:return e++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:o.sent(),i=0,r=t.nonInlineLevel,o.label=7;case 7:return i<r.length?(y=r[i],[4,this.renderNode(y)]):[3,10];case 8:o.sent(),o.label=9;case 9:return i++,[3,7];case 10:s=0,a=t.nonPositionedFloats,o.label=11;case 11:return s<a.length?(y=a[s],[4,this.renderStack(y)]):[3,14];case 12:o.sent(),o.label=13;case 13:return s++,[3,11];case 14:A=0,l=t.nonPositionedInlineLevel,o.label=15;case 15:return A<l.length?(y=l[A],[4,this.renderStack(y)]):[3,18];case 16:o.sent(),o.label=17;case 17:return A++,[3,15];case 18:u=0,h=t.inlineLevel,o.label=19;case 19:return u<h.length?(y=h[u],[4,this.renderNode(y)]):[3,22];case 20:o.sent(),o.label=21;case 21:return u++,[3,19];case 22:c=0,f=t.zeroOrAutoZIndexOrTransformedOrOpacity,o.label=23;case 23:return c<f.length?(y=f[c],[4,this.renderStack(y)]):[3,26];case 24:o.sent(),o.label=25;case 25:return c++,[3,23];case 26:p=0,d=t.positiveZIndex,o.label=27;case 27:return p<d.length?(y=d[p],[4,this.renderStack(y)]):[3,30];case 28:o.sent(),o.label=29;case 29:return p++,[3,27];case 30:return[2]}})})},us.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},us.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},us.prototype.formatPath=function(t){var e=this;t.forEach(function(t,n){var i=Do(t)?t.start:t;0===n?e.ctx.moveTo(i.x,i.y):e.ctx.lineTo(i.x,i.y),Do(t)&&e.ctx.bezierCurveTo(t.startControl.x,t.startControl.y,t.endControl.x,t.endControl.y,t.end.x,t.end.y)})},us.prototype.renderRepeat=function(t,e,n,i){this.path(t),this.ctx.fillStyle=e,this.ctx.translate(n,i),this.ctx.fill(),this.ctx.translate(-n,-i)},us.prototype.resizeImage=function(t,e,n){var i;return t.width===e&&t.height===n?t:((i=(null!=(i=this.canvas.ownerDocument)?i:document).createElement("canvas")).width=Math.max(1,e),i.height=Math.max(1,n),i.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,e,n),i)},us.prototype.renderBackgroundImage=function(t){return i(this,void 0,void 0,function(){var e,n,i,r,s,a;return o(this,function(A){switch(A.label){case 0:e=t.styles.backgroundImage.length-1,n=function(n){var r,s,a,A,l,u,h,c,f,p,d,y,m,g,v,b,x;return o(this,function(o){switch(o.label){case 0:if(0!==n.type)return[3,5];r=void 0,s=n.url,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.context.cache.match(s)];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),i.context.logger.error("Error loading background-image "+s),[3,4];case 4:return r&&(a=Zo(t,e,[r.width,r.height,r.width/r.height]),u=a[0],d=a[1],y=a[2],f=a[3],p=a[4],l=i.ctx.createPattern(i.resizeImage(r,f,p),"repeat"),i.renderRepeat(u,l,d,y)),[3,6];case 5:1===n.type?(x=Zo(t,e,[null,null,null]),u=x[0],d=x[1],y=x[2],f=x[3],p=x[4],w=n.angle,B=f,M=p,S="number"==typeof w?w:(T=B/2,S=(E=M)/2,T=ae((_=w)[0],B)-T,E=S-ae(_[1],E),(Math.atan2(E,T)+2*Math.PI)%(2*Math.PI)),E=B/2,T=M/2,B=(_=Math.abs(B*Math.sin(S))+Math.abs(M*Math.cos(S)))/2,M=Math.sin(S-Math.PI/2)*B,v=[_,E-(B=Math.cos(S-Math.PI/2)*B),E+B,T-M,T+M],g=v[0],a=v[1],h=v[2],b=v[3],c=v[4],(x=document.createElement("canvas")).width=f,x.height=p,v=x.getContext("2d"),A=v.createLinearGradient(a,b,h,c),pe(n.stops,g).forEach(function(t){return A.addColorStop(t.stop,$t(t.color))}),v.fillStyle=A,v.fillRect(0,0,f,p),0<f&&0<p&&(l=i.ctx.createPattern(x,"repeat"),i.renderRepeat(u,l,d,y))):2===n.type&&(b=Zo(t,e,[null,null,null]),u=b[0],h=b[1],c=b[2],f=b[3],p=b[4],g=0===n.position.length?[oe]:n.position,d=ae(g[0],f),y=ae(g[g.length-1],p),v=function(t,e,n,i,r){var o,s,a=0,A=0;switch(t.size){case 0:0===t.shape?a=A=Math.min(Math.abs(e),Math.abs(e-i),Math.abs(n),Math.abs(n-r)):1===t.shape&&(a=Math.min(Math.abs(e),Math.abs(e-i)),A=Math.min(Math.abs(n),Math.abs(n-r)));break;case 2:0===t.shape?a=A=Math.min(de(e,n),de(e,n-r),de(e-i,n),de(e-i,n-r)):1===t.shape&&(A=(o=Math.min(Math.abs(n),Math.abs(n-r))/Math.min(Math.abs(e),Math.abs(e-i)))*(a=de((s=ye(i,r,e,n,!0))[0]-e,(s[1]-n)/o)));break;case 1:0===t.shape?a=A=Math.max(Math.abs(e),Math.abs(e-i),Math.abs(n),Math.abs(n-r)):1===t.shape&&(a=Math.max(Math.abs(e),Math.abs(e-i)),A=Math.max(Math.abs(n),Math.abs(n-r)));break;case 3:0===t.shape?a=A=Math.max(de(e,n),de(e,n-r),de(e-i,n),de(e-i,n-r)):1===t.shape&&(A=(o=Math.max(Math.abs(n),Math.abs(n-r))/Math.max(Math.abs(e),Math.abs(e-i)))*(a=de((s=ye(i,r,e,n,!1))[0]-e,(s[1]-n)/o)))}return Array.isArray(t.size)&&(a=ae(t.size[0],i),A=2===t.size.length?ae(t.size[1],r):a),[a,A]}(n,d,y,f,p),x=v[0],b=v[1],0<x)&&0<b&&(m=i.ctx.createRadialGradient(h+d,c+y,0,h+d,c+y,x),pe(n.stops,2*x).forEach(function(t){return m.addColorStop(t.stop,$t(t.color))}),i.path(u),i.ctx.fillStyle=m,x!==b?(g=t.bounds.left+.5*t.bounds.width,v=t.bounds.top+.5*t.bounds.height,x=1/(b/=x),i.ctx.save(),i.ctx.translate(g,v),i.ctx.transform(1,0,0,b,0,0),i.ctx.translate(-g,-v),i.ctx.fillRect(h,x*(c-v)+v,f,p*x),i.ctx.restore()):i.ctx.fill()),o.label=6;case 6:return e--,[2]}var w,B,M,S,_,E,T})},i=this,r=0,s=t.styles.backgroundImage.slice(0).reverse(),A.label=1;case 1:return r<s.length?(a=s[r],[5,n(a)]):[3,4];case 2:A.sent(),A.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},us.prototype.renderSolidBorder=function(t,e,n){return i(this,void 0,void 0,function(){return o(this,function(i){return this.path(Ko(n,e)),this.ctx.fillStyle=$t(t),this.ctx.fill(),[2]})})},us.prototype.renderDoubleBorder=function(t,e,n,r){return i(this,void 0,void 0,function(){var i;return o(this,function(o){switch(o.label){case 0:return e<3?[4,this.renderSolidBorder(t,n,r)]:[3,2];case 1:return o.sent(),[2];case 2:return i=function(t){switch(n){case 0:return es(t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox,t.topRightBorderBox,t.topRightBorderDoubleOuterBox);case 1:return es(t.topRightBorderBox,t.topRightBorderDoubleOuterBox,t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox);case 2:return es(t.bottomRightBorderBox,t.bottomRightBorderDoubleOuterBox,t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox);default:return es(t.bottomLeftBorderBox,t.bottomLeftBorderDoubleOuterBox,t.topLeftBorderBox,t.topLeftBorderDoubleOuterBox)}}(r),this.path(i),this.ctx.fillStyle=$t(t),this.ctx.fill(),i=function(t){switch(n){case 0:return es(t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox,t.topRightBorderDoubleInnerBox,t.topRightPaddingBox);case 1:return es(t.topRightBorderDoubleInnerBox,t.topRightPaddingBox,t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox);case 2:return es(t.bottomRightBorderDoubleInnerBox,t.bottomRightPaddingBox,t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox);default:return es(t.bottomLeftBorderDoubleInnerBox,t.bottomLeftPaddingBox,t.topLeftBorderDoubleInnerBox,t.topLeftPaddingBox)}}(r),this.path(i),this.ctx.fill(),[2]}})})},us.prototype.renderNodeBackgroundAndBorders=function(t){return i(this,void 0,void 0,function(){var e,n,i,r,s,a,A,l,u=this;return o(this,function(o){switch(o.label){case 0:return this.applyEffects(t.getEffects(2)),e=t.container.styles,n=!Jt(e.backgroundColor)||e.backgroundImage.length,i=[{style:e.borderTopStyle,color:e.borderTopColor,width:e.borderTopWidth},{style:e.borderRightStyle,color:e.borderRightColor,width:e.borderRightWidth},{style:e.borderBottomStyle,color:e.borderBottomColor,width:e.borderBottomWidth},{style:e.borderLeftStyle,color:e.borderLeftColor,width:e.borderLeftWidth}],r=fs(is(e.backgroundClip,0),t.curves),n||e.boxShadow.length?(this.ctx.save(),this.path(r),this.ctx.clip(),Jt(e.backgroundColor)||(this.ctx.fillStyle=$t(e.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:o.sent(),this.ctx.restore(),e.boxShadow.slice(0).reverse().forEach(function(e){u.ctx.save();var n,i,r,o,s=Qo(t.curves),a=e.inset?0:1e4,A=(n=-a+(e.inset?1:-1)*e.spread.number,i=(e.inset?1:-1)*e.spread.number,r=e.spread.number*(e.inset?-2:2),o=e.spread.number*(e.inset?-2:2),s.map(function(t,e){switch(e){case 0:return t.add(n,i);case 1:return t.add(n+r,i);case 2:return t.add(n+r,i+o);case 3:return t.add(n,i+o)}return t}));e.inset?(u.path(s),u.ctx.clip(),u.mask(A)):(u.mask(s),u.ctx.clip(),u.path(A)),u.ctx.shadowOffsetX=e.offsetX.number+a,u.ctx.shadowOffsetY=e.offsetY.number,u.ctx.shadowColor=$t(e.color),u.ctx.shadowBlur=e.blur.number,u.ctx.fillStyle=e.inset?$t(e.color):"rgba(0,0,0,1)",u.ctx.fill(),u.ctx.restore()}),o.label=2;case 2:a=s=0,A=i,o.label=3;case 3:return a<A.length?0!==(l=A[a]).style&&!Jt(l.color)&&0<l.width?2!==l.style?[3,5]:[4,this.renderDashedDottedBorder(l.color,l.width,s,t.curves,2)]:[3,11]:[3,13];case 4:return o.sent(),[3,11];case 5:return 3!==l.style?[3,7]:[4,this.renderDashedDottedBorder(l.color,l.width,s,t.curves,3)];case 6:return o.sent(),[3,11];case 7:return 4!==l.style?[3,9]:[4,this.renderDoubleBorder(l.color,l.width,s,t.curves)];case 8:return o.sent(),[3,11];case 9:return[4,this.renderSolidBorder(l.color,s,t.curves)];case 10:o.sent(),o.label=11;case 11:s++,o.label=12;case 12:return a++,[3,3];case 13:return[2]}})})},us.prototype.renderDashedDottedBorder=function(t,e,n,r,s){return i(this,void 0,void 0,function(){var i,a,A,l,u,h,c,f,p,d,y;return o(this,function(o){return this.ctx.save(),p=function(t){switch(n){case 0:return ts(t.topLeftBorderStroke,t.topRightBorderStroke);case 1:return ts(t.topRightBorderStroke,t.bottomRightBorderStroke);case 2:return ts(t.bottomRightBorderStroke,t.bottomLeftBorderStroke);default:return ts(t.bottomLeftBorderStroke,t.topLeftBorderStroke)}}(r),i=Ko(r,n),2===s&&(this.path(i),this.ctx.clip()),h=(Do(i[0])?(a=i[0].start.x,i[0].start):(a=i[0].x,i[0])).y,c=(Do(i[1])?(A=i[1].end.x,i[1].end):(A=i[1].x,i[1])).y,l=0===n||2===n?Math.abs(a-A):Math.abs(h-c),this.ctx.beginPath(),3===s?this.formatPath(p):this.formatPath(i.slice(0,2)),u=e<3?3*e:2*e,h=e<3?2*e:e,3===s&&(h=u=e),c=!0,l<=2*u?c=!1:l<=2*u+h?(u*=f=l/(2*u+h),h*=f):(p=Math.floor((l+h)/(u+h)),f=(l-p*u)/(p-1),h=(p=(l-(p+1)*u)/p)<=0||Math.abs(h-f)<Math.abs(h-p)?f:p),c&&(3===s?this.ctx.setLineDash([0,u+h]):this.ctx.setLineDash([u,h])),3===s?(this.ctx.lineCap="round",this.ctx.lineWidth=e):this.ctx.lineWidth=2*e+1.1,this.ctx.strokeStyle=$t(t),this.ctx.stroke(),this.ctx.setLineDash([]),2===s&&(Do(i[0])&&(d=i[3],y=i[0],this.ctx.beginPath(),this.formatPath([new Oo(d.end.x,d.end.y),new Oo(y.start.x,y.start.y)]),this.ctx.stroke()),Do(i[1]))&&(d=i[1],y=i[2],this.ctx.beginPath(),this.formatPath([new Oo(d.end.x,d.end.y),new Oo(y.start.x,y.start.y)]),this.ctx.stroke()),this.ctx.restore(),[2]})})},us.prototype.render=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=$t(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),function t(e,n,i,r){e.container.elements.forEach(function(o){var s=Rn(o.flags,4),a=Rn(o.flags,2),A=new Go(o,e);Rn(o.styles.display,2048)&&r.push(A);var l,u,h,c,f=Rn(o.flags,8)?[]:r;s||a?(l=s||o.styles.isPositioned()?i:n,a=new zo(A),o.styles.isPositioned()||o.styles.opacity<1||o.styles.isTransformed()?(u=o.styles.zIndex.order)<0?(h=0,l.negativeZIndex.some(function(t,e){return u>t.element.container.styles.zIndex.order?(h=e,!1):0<h}),l.negativeZIndex.splice(h,0,a)):0<u?(c=0,l.positiveZIndex.some(function(t,e){return u>=t.element.container.styles.zIndex.order?(c=e+1,!1):0<c}),l.positiveZIndex.splice(c,0,a)):l.zeroOrAutoZIndexOrTransformedOrOpacity.push(a):(o.styles.isFloating()?l.nonPositionedFloats:l.nonPositionedInlineLevel).push(a),t(A,a,s?a:i,f)):((o.styles.isInlineLevel()?n.inlineLevel:n.nonInlineLevel).push(A),t(A,n,i,f)),Rn(o.flags,8)&&$o(o,f)})}(i=new Go(t,null),r=new zo(i),r,n=[]),$o(i.container,n),[4,this.renderStack(r)];case 1:return e.sent(),this.applyEffects([]),[2,this.canvas]}var n,i,r})})};var As,ls=us;function us(t,e){return(t=As.call(this,t,e)||this).h=[],t.canvas=e.canvas||document.createElement("canvas"),t.ctx=t.canvas.getContext("2d"),e.canvas||(t.canvas.width=Math.floor(e.width*e.scale),t.canvas.height=Math.floor(e.height*e.scale),t.canvas.style.width=e.width+"px",t.canvas.style.height=e.height+"px"),t.fontMetrics=new ss(document),t.ctx.scale(t.options.scale,t.options.scale),t.ctx.translate(-e.x,-e.y),t.ctx.textBaseline="bottom",t.h=[],t.context.logger.debug("Canvas renderer initialized ("+e.width+"x"+e.height+") with scale "+e.scale),t}var hs,cs=function(t){return t instanceof fr||t instanceof ur||t instanceof ar&&t.type!==or&&t.type!==rr},fs=function(t,e){switch(t){case 0:return Qo(e);case 2:return[e.topLeftContentBox,e.topRightContentBox,e.bottomRightContentBox,e.bottomLeftContentBox];default:return ko(e)}},ps=function(t){switch(t){case 1:return"center";case 2:return"right";default:return"left"}},ds=["-apple-system","system-ui"],ys=function(t){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?t.filter(function(t){return-1===ds.indexOf(t)}):t},ms=(e(gs,hs=ue),gs.prototype.render=function(t){return i(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return e=vi(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,vs(e)];case 1:return e=n.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=$t(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(e,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},gs);function gs(t,e){return(t=hs.call(this,t,e)||this).canvas=e.canvas||document.createElement("canvas"),t.ctx=t.canvas.getContext("2d"),t.options=e,t.canvas.width=Math.floor(e.width*e.scale),t.canvas.height=Math.floor(e.height*e.scale),t.canvas.style.width=e.width+"px",t.canvas.style.height=e.height+"px",t.ctx.scale(t.options.scale,t.options.scale),t.ctx.translate(-e.x,-e.y),t.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+e.width+"x"+e.height+" at "+e.x+","+e.y+") with scale "+e.scale),t}var vs=function(t){return new Promise(function(e,n){var i=new Image;i.onload=function(){e(i)},i.onerror=n,i.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((new XMLSerializer).serializeToString(t))})},bs=(xs.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.debug||this.info.apply(this,t))},xs.prototype.getTime=function(){return Date.now()-this.start},xs.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&"undefined"!=typeof window&&window.console&&console.info},xs.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.warn||this.info.apply(this,t))},xs.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.enabled&&("undefined"!=typeof window&&window.console&&"function"==typeof console.error||this.info.apply(this,t))},xs.instances={},xs);function xs(t){var e=t.id;t=t.enabled;this.id=e,this.enabled=t,this.start=Date.now()}Bs.instanceCount=1;var ws=Bs;function Bs(t,e){this.windowBounds=e,this.instanceName="#"+Bs.instanceCount++,this.logger=new bs({id:this.instanceName,enabled:t.logging}),this.cache=null!=(e=t.cache)?e:new xo(this,t)}return"undefined"!=typeof window&&vo.setContext(window),function(t,e){return a=t,l=e=void 0===e?{}:e,i(void 0,void 0,void 0,function(){var t,e,i,u,h,c,f,p,d,y,m,g,v,b,x,w;return o(this,function(o){switch(o.label){case 0:if(!a||"object"!=r(a))return[2,Promise.reject("Invalid element provided as first argument")];if(!(t=a.ownerDocument))throw new Error("Element is not attached to a Document");if(e=t.defaultView)return v={allowTaint:null!=(b=l.allowTaint)&&b,imageTimeout:null!=(y=l.imageTimeout)?y:15e3,proxy:l.proxy,useCORS:null!=(m=l.useCORS)&&m},b=n({logging:null==(g=l.logging)||g,cache:l.cache},v),y={windowWidth:null!=(y=l.windowWidth)?y:e.innerWidth,windowHeight:null!=(m=l.windowHeight)?m:e.innerHeight,scrollX:null!=(g=l.scrollX)?g:e.pageXOffset,scrollY:null!=(v=l.scrollY)?v:e.pageYOffset},m=new s(y.scrollX,y.scrollY,y.windowWidth,y.windowHeight),g=new ws(b,m),y=null!=(v=l.foreignObjectRendering)&&v,v={allowTaint:null!=(b=l.allowTaint)&&b,onclone:l.onclone,ignoreElements:l.ignoreElements,inlineImages:y,copyStyles:y},g.logger.debug("Starting document clone with size "+m.width+"x"+m.height+" scrolled to "+-m.left+","+-m.top),b=new no(g,a,v),(v=b.clonedReferenceElement)?[4,b.toIFrame(t,m)]:[2,Promise.reject("Unable to find element in cloned iframe")];throw new Error("Document is not attached to a Window");case 1:return i=o.sent(),x=xr(v)||"HTML"===v.tagName?function(t){var e=t.body,n=t.documentElement;if(e&&n)return t=Math.max(Math.max(e.scrollWidth,n.scrollWidth),Math.max(e.offsetWidth,n.offsetWidth),Math.max(e.clientWidth,n.clientWidth)),n=Math.max(Math.max(e.scrollHeight,n.scrollHeight),Math.max(e.offsetHeight,n.offsetHeight),Math.max(e.clientHeight,n.clientHeight)),new s(0,0,t,n);throw new Error("Unable to get document size")}(v.ownerDocument):A(g,v),u=x.width,h=x.height,c=x.left,f=x.top,p=function(t,e,n){var i=e.ownerDocument,r=i.documentElement?ce(t,getComputedStyle(i.documentElement).backgroundColor):xe.TRANSPARENT,o=i.body?ce(t,getComputedStyle(i.body).backgroundColor):xe.TRANSPARENT;return n="string"==typeof n?ce(t,n):null===n?xe.TRANSPARENT:4294967295,e===i.documentElement?Jt(r)?Jt(o)?n:o:r:n}(g,v,l.backgroundColor),x={canvas:l.canvas,backgroundColor:p,scale:null!=(x=null!=(x=l.scale)?x:e.devicePixelRatio)?x:1,x:(null!=(x=l.x)?x:0)+c,y:(null!=(x=l.y)?x:0)+f,width:null!=(x=l.width)?x:Math.ceil(u),height:null!=(x=l.height)?x:Math.ceil(h)},y?(g.logger.debug("Document cloned, using foreign object rendering"),[4,new ms(g,x).render(v)]):[3,3];case 2:return d=o.sent(),[3,5];case 3:return g.logger.debug("Document cloned, element located at "+c+","+f+" with size "+u+"x"+h+" using computed rendering"),g.logger.debug("Starting DOM parsing"),w=Mr(g,v),p===w.styles.backgroundColor&&(w.styles.backgroundColor=xe.TRANSPARENT),g.logger.debug("Starting renderer for element at "+x.x+","+x.y+" with size "+x.width+"x"+x.height),[4,new ls(g,x).render(w)];case 4:d=o.sent(),o.label=5;case 5:return null!=(w=l.removeContainer)&&!w||no.destroy(i)||g.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore"),g.logger.debug("Finished rendering"),[2,d]}})});var a,l}},"object"==r(e)&&void 0!==t?t.exports=i():void 0!==(n="function"==typeof(i=i)?i.call(e,n,e,t):i)&&(t.exports=n)},function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,function(t){return"symbol"===i(t=function(t,e){if("object"!==i(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return String(t);if("object"!==i(n=n.call(t,e)))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string"))?t:String(t)}(r.key),r)}}n.r(e);var o=n(0),s=(n=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}var e,n;return e=t,n=[{key:"screenshot",value:function(t,e,n){fengmap.FMUtil.screenshot(t,e.leftTop,e.rightBottom,e.direction,e.rank,n,e.width,e.height)}},{key:"exportToImage",value:function(t,e,n,i){var r={};Object.assign(r,e,{dependent:{html2canvas:o}}),fengmap.FMUtil.exportToImage(t,r.bound,r,n,i)}}],null&&r(e.prototype,null),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),window.fengmap||{});s.FMExport=n,e.default=s}],n={},t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"I",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.I)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(t){return e[t]}.bind(null,r));return i},t.n=function(e){var n=e&&e.I?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.p="",t(t.s=1).default;function t(i){var r;return(n[i]||(r=n[i]={i:i,l:!1,exports:{}},e[i].call(r.exports,r,r.exports,t),r.l=!0,r)).exports}var e,n},t.exports=i()}});
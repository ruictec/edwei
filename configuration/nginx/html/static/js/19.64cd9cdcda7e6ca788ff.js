webpackJsonp([19],{ETc7:function(e,t,a){"use strict";function i(){return!!(document.fullscreen||document.mozFullScreen||document.fullscreenElement||document.msFullscreenElement||document.webkitIsFullScreen)}var s={props:{exitOnClickWrapper:{type:Boolean,default:!0},background:{type:String,default:"#333"},fullscreenClass:{type:String,default:"fullscreen"},fullscreen:{type:Boolean,default:!1},pageOnly:{type:Boolean,default:!1}},data:function(){return{support:!1,isFullscreen:!1}},computed:{isPageOnly:function(){return this.pageOnly||!this.support},wrapperClass:function(){var e=[];return this.isFullscreen&&e.push(this.fullscreenClass),e},wrapperStyle:function(){var e={};return this.isFullscreen&&(e={background:this.background,"overflow-y":"auto",width:"100%",height:"100%"},this.isPageOnly&&(e.position="fixed !important",e["z-index"]="100000 !important",e.left="0",e.top="0",e.width="100% !important",e.height="100% !important")),e}},methods:{toggle:function(e){void 0===e?this.getState()?this.exit():this.enter():e?this.enter():this.exit()},enter:function(){var e,t;this.isPageOnly?(this.isFullscreen=!0,this.onChangeFullScreen()):(t=this.fullScreenCallback,document.addEventListener("fullscreenchange",t),document.addEventListener("mozfullscreenchange",t),document.addEventListener("MSFullscreenChange",t),document.addEventListener("webkitfullscreenchange",t),(e=this.$el).requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen())},exit:function(){this.getState()&&(this.isPageOnly?(this.isFullscreen=!1,this.onChangeFullScreen()):document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())},getState:function(){return this.isPageOnly?this.isFullscreen:i()},shadeClick:function(e){e.target===this.$el&&this.exitOnClickWrapper&&this.exit()},fullScreenCallback:function(){var e;this.isFullscreen=i(),this.isFullscreen||(e=this.fullScreenCallback,document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("webkitfullscreenchange",e)),this.onChangeFullScreen()},onChangeFullScreen:function(){this.$emit("change",this.isFullscreen),this.$emit("update:fullscreen",this.isFullscreen)}},watch:{fullscreen:function(e){e!==i()&&(e?this.enter():this.exit())}},created:function(){this.support=function(){const e=document.documentElement;return"requestFullscreen"in e||"mozRequestFullScreen"in e&&document.mozFullScreenEnabled||"msRequestFullscreen"in e&&document.msFullscreenEnabled||"webkitRequestFullScreen"in e}()}},n={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.wrapperClass,style:e.wrapperStyle,on:{click:function(t){return e.shadeClick(t)}}},[e._t("default")],2)},staticRenderFns:[]},o=a("VU/8")(s,n,!1,null,null,null);t.a=o.exports},Mfxl:function(e,t){},mCec:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("pFYg"),s=a.n(i),n=a("woOf"),o=a.n(n),r=a("Dd8w"),d=a.n(r),l=a("5qI+"),c=a.n(l),u=a("3zDK"),h=a("ETc7"),m=a("c2Ch"),p=(a("ktr9"),a("czjk")),g=a("trid"),v=a("7rnj"),f=a("flqW"),b=a("Lfyu"),y=a("/LWt"),w=a("nq2H"),_=a("T18w"),x=a("Umvz"),L=a("WMwB"),k=a("Mjwz"),D=a("zOBh"),I=a("XLwt"),$=a("2YZ9"),S=a("lUmj"),A=a("eM/O"),C={components:{Fullscreen:h.a},name:"LocationIndoor",data:function(){return{scale:"",i8n:this.$store.state.i18n,checkList:[],checkList1:[],contrForPrionum:this.$store.state.userInfo.prionum,intoProjectName:this.$store.state.intoProjectName,intoProjectid:this.$store.state.intoProjectid,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,intoProjectType:this.$store.state.intoProjectType,radio1:1,isactive:"",buildingId:"",homeGround:"",warningBuildingId:"",warningGround:"",isactiveGround:!1,buildings:"",building:"",grounds:"",ground:"",groundid:"",arrangeFeatures:"",imgUrl:"",map:null,mapName:"allmap",groundData:[],userList:[],assetList:[],tboxList:[],perDeveui:"",assetDeveui:"",tboxDeveui:"",searchLists:{},searchList:{deveui:"",projectid:this.$store.state.projectid,devtype:""},sostype:!1,wsuri:"",websockNum:0,devPer:!1,showBracelet:!1,devAsset:!1,devTBox:!1,bracelet_eui:"",bracelet_soc:"",bracelet_rate:"",bracelet_tem:"",bracelet_oxygen:"",bracelet_time:"",age:"",depart:"",cardno:"",maplabel:"",sexstr:"",tel:"",worktype:"",username:"",imagePer:"",imageAsset:"",imageTBox:"",gpstime:"",assetName:"",assetType:"",assetModel:"",assetBeaconid:"",assetDepart:"",assetUser:"",assetTime:"",tboxName:"",tboxType:"",tboxMaplabel:"",tboxTime:"",tableData:[{id:"-1",name:this.$t("LocationIndoor.Totalnumber"),num:"0"},{id:"-2",name:this.$t("LocationIndoor.Totalassets"),num:"0"},{id:"-3",name:this.$t("LocationIndoor.Totalvehicle"),num:"0"},{id:"-4",name:this.$t("LocationIndoor.Jobs1"),num:"0",children:[]},{id:"-5",name:this.$t("LocationIndoor.department"),num:"0",children:[]},{id:"-6",name:this.$t("LocationIndoor.assets1"),num:"0",children:[]}],userLoading:!1,assetLoading:!1,tboxLoading:!1,userOptions:[],assetOptions:[],tboxOptions:[],visible:!1,fullscreen:!1,groundListCopy:[],newGround:"",mapTypes:!0,changemap:!0,map3d:null,fmapId:"",themeId:"",scrollFloorControl:"",layer:null,layerList:[],layer2:null,setNewMarker:!0,groundVals:"",gl:"",timer:null,searchShow:!1,buildShow:!1,groundShow:!1,settingShow:!1,time:0,mapInfo:[],btnShow:!0,timeOut:null,showEcharts:!1,show_echart:"<",loading:null,borderkey:1,isAllData:!1,allPerson:0,allCar:0,allAsste:0,dataTimer:null,roleData:{data:[],unit:"",showValue:!0},departmentData:{data:[],unit:this.$t("LocationIndoor.person"),showValue:!0},activeName:"role",sosDatas:{radius:"40%",activeRadius:"45%",data:[],digitalFlopStyle:{fontSize:12},showOriginValue:!0,activeTimeGap:2e3},isRoleData:!1,isDepartmentData:!1,isSosData:!1,showAllGround:!1,battery:"",featureMap:"",sourceMap:"",layerMap:"",moveTimers:{person:{},asset:{},tbox:{}}}},methods:{goStaff:function(e){this.$router.push({path:"/staff/staffmanagement",query:{username:e}})},goDevs:function(e){this.$router.push({path:"/device/terminal",query:{deveui:e}})},goBeacons:function(e){this.$router.push({path:"/device/beacon",query:{beaconid:e}})},ages:function(e){if(""==e||null==e)return 0;var t=e.match(/^(\d{1,4})(-|\/)(\d{1,2})\2(\d{1,2})$/);if(null==t)return 0;var a=new Date(t[1],t[3]-1,t[4]);return a.getFullYear()==t[1]&&a.getMonth()+1==t[3]&&a.getDate()==t[4]?(new Date).getFullYear()-t[1]:0},getData:function(){var e=this;this.dataTimer&&(clearInterval(this.dataTimer),this.dataTimer=null),e.isDepartmentData=!1,e.isRoleData=!1,e.isSosData=!1,e.isAllData=!1,e.getWarnNumLists(),e.dataTimer=setInterval(function(){e.getWarnNumLists()},1e4)},getCountNums:function(){var e=this,t=Math.floor((new Date).getTime()/1e3),a={projectid:this.$store.state.projectid,buildid:this.building,groundid:this.groundid,gpstype:1,devtype:0,time:t};Object(m._28)(a,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){if(1001==t.code){if(e.allPerson=t.data.devnum,e.allCar=t.data.tboxnum,e.allAsste=t.data.assetnum,(e.allPerson||e.allCar||e.allAsste)&&(e.isAllData=!0),e.borderkey++,t.data.list){var a=t.data.list;if(e.roleData={data:[],showValue:!0,unit:""},e.departmentData={data:[],showValue:!0,unit:""},a.length>0){for(var i=0;i<a.length;i++)switch(a[i].type){case 1:e.roleData.data.push({name:a[i].name,value:a[i].num});break;case 2:e.departmentData.data.push({name:a[i].name,value:a[i].num})}e.roleData=d()({},e.roleData),e.departmentData=d()({},e.departmentData),e.departmentData.data.length>0&&(e.isDepartmentData=!0),e.roleData.data.length>0&&(e.isRoleData=!0)}}}else e.$message({message:"zh"==e.$store.state.i18n?t.msg:t.enMsg,type:"error"})})},getWarnNumLists:function(){var e=this,t={superid:this.$store.state.userInfo.superid,projectid:this.$store.state.projectid,buildid:this.building,groundid:this.groundid,status:1,endtype:8};e.sosDatas.data=[],e.sosDatas=d()({},e.sosDatas),Object(m._102)(t,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){e.getCountNums(),1001==t.code?t.data.length>0&&(t.data.forEach(function(t){e.sosDatas.data.push({name:"zh"==e.$store.state.i18n?t.typestr:t.entype,value:t.warn_status1_num})}),e.sosDatas=d()({},e.sosDatas),e.isSosData=!0):e.$message({message:"zh"==e.$store.state.i18n?t.msg:t.enMsg,type:"error"})})},showEchart:function(){(this.tableData[0].num>0||this.tableData[1].num>0)&&(this.showEcharts?this.show_echart="<":this.show_echart=">",this.showEcharts=!this.showEcharts)},getMapid:function(e){var t=this;Object(m._62)({buildid:e},t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code&&(t.fmapId=e.data[0])})},echartsInit:function(e){if(this.mapTypes)var t=document.getElementById("echarts"),a=I.init(t),i=document.getElementById("echarts1"),s=I.init(i),n=document.getElementById("echarts2"),o=I.init(n),r=document.getElementById("echarts3"),d=I.init(r);else t=document.getElementById("echarts_3D"),a=I.init(t),i=document.getElementById("echarts1_3D"),s=I.init(i),n=document.getElementById("echarts2_3D"),o=I.init(n),r=document.getElementById("echarts3_3D"),d=I.init(r);var l,c,u,h,m={arr1:[],arr2:[],arr3:[],arr4:[]};e.forEach(function(e){if(e.type){var t="arr"+e.type;m[t].push({name:e.name,value:e.num})}}),l={title:{text:this.$t("LocationIndoor.Jobsdistribution"),left:"center",textStyle:{fontSize:15}},tooltip:{trigger:"item",confine:!0},legend:{orient:"horizontal",left:"left",top:"10%",show:!1},series:[{name:this.$t("LocationIndoor.Jobsdistribution"),top:"0%",type:"pie",radius:"45%",data:m.arr1,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},c={title:{text:this.$t("LocationIndoor.Sectordistribution"),left:"center",textStyle:{fontSize:15}},tooltip:{trigger:"item",confine:!0},legend:{orient:"horizontal",left:"left",top:"10%",show:!1},series:[{name:this.$t("LocationIndoor.Sectordistribution"),top:"0%",type:"pie",radius:"45%",data:m.arr2,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},u={title:{text:this.$t("LocationIndoor.Assetdistribution"),left:"center",textStyle:{fontSize:15}},tooltip:{trigger:"item",confine:!0},legend:{orient:"horizontal",left:"left",top:"10%",show:!1},series:[{name:this.$t("LocationIndoor.Assetdistribution"),type:"pie",top:"0%",radius:"45%",data:m.arr3,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},h={title:{text:this.$t("LocationIndoor.Vehicledistribution"),left:"center",textStyle:{fontSize:15}},tooltip:{trigger:"item",confine:!0},legend:{orient:"horizontal",left:"left",top:"-10%",show:!1},series:[{name:this.$t("LocationIndoor.Vehicledistribution"),type:"pie",radius:"45%",top:"0%",data:m.arr4,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},l&&a.setOption(l),c&&s.setOption(c),u&&o.setOption(u),h&&d.setOption(h)},changeSetting:function(){var e=this,t=this;clearInterval(t.timeOut),t.timeOut=null,t.websock;var a=t.checkList.filter(function(e){return!t.checkList1.includes(e)});t.checkList1=t.checkList;var i=[t.$t("LocationIndoor.personnel"),t.$t("LocationIndoor.assets"),t.$t("LocationIndoor.vehicle")],s=[t.$t("LocationIndoor.minute1"),t.$t("LocationIndoor.minute5"),t.$t("LocationIndoor.minute10"),t.$t("LocationIndoor.minute20"),t.$t("LocationIndoor.minute30"),t.$t("LocationIndoor.hour")];if(a[0]){t.checkList.forEach(function(e,n){i.includes(a[0])&&i.includes(e)&&e!==a[0]&&t.checkList.splice(n,1),s.includes(a[0])&&s.includes(e)&&e!==a[0]&&t.checkList.splice(n,1)});var n=s.indexOf(a[0]);if(n>-1){t.time=[60,300,600,1200,1800,3600][n];var o={projectid:t.$store.state.projectid,buildid:t.building,groundid:t.groundid,gpstype:1,devtype:0,time:t.time};Object(m._60)(o,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){if(1001===e.code){t.mapInfo=e.data;var a=t.mapInfo.map(function(e){return e.deveui});if(t.map)for(var i=t.map.getLayers().getArray(),s=1;s<i.length;s++)t.map.removeLayer(i[s]),s--;else t.layerList.forEach(function(e){e.remove()});for(var n=function(e){4===t.mapInfo[e].devtype&&(-1==t.checkList.indexOf(t.$t("LocationIndoor.assets"))&&-1==t.checkList.indexOf(t.$t("LocationIndoor.personnel"))||0===t.checkList.length)&&(t.map3d?(t.groundListCopy.forEach(function(a){a.ground==t.mapInfo[e].ground&&(t.mapInfo[e].newground=a.newground)}),t.addTBox(t.groundVals,t.mapInfo[e])):t.addOrUpdateFeature("tbox",t.mapInfo[e])),(1!=t.mapInfo[e].devtype&&2!=t.mapInfo[e].devtype||-1!=t.checkList.indexOf(t.$t("LocationIndoor.vehicle"))||-1!=t.checkList.indexOf(t.$t("LocationIndoor.assets")))&&0!==t.checkList.length||(t.map3d?(t.groundListCopy.forEach(function(a){a.ground==t.mapInfo[e].ground&&(t.mapInfo[e].newground=a.newground)}),t.addMarker(t.groundVals,t.mapInfo[e])):t.addOrUpdateFeature("person",t.mapInfo[e])),3===t.mapInfo[e].devtype&&(-1==t.checkList.indexOf(t.$t("LocationIndoor.vehicle"))&&-1==t.checkList.indexOf(t.$t("LocationIndoor.personnel"))||0===t.checkList.length)&&(t.map3d?(t.groundListCopy.forEach(function(a){a.ground==t.mapInfo[e].ground&&(t.mapInfo[e].newground=a.newground)}),t.addAsset(t.groundVals,t.mapInfo[e])):t.addOrUpdateFeature("asset",t.mapInfo[e]))},o=0;o<t.mapInfo.length;o++)n(o);t.hideLayers(a),t.timeOut=setInterval(function(){t.delTimeOut()},1e4)}})}else t.timeOut=setInterval(function(){t.delTimeOut()},1e4),t.hideLayers()}else{if(0!==t.checkList.length&&t.checkList.every(function(e){return s.includes(e)}))t.timeOut=setInterval(function(){t.delTimeOut()},1e4),this.hideLayers();else{t.time=0;var r={projectid:t.$store.state.projectid,buildid:t.building,groundid:t.groundid,gpstype:1,devtype:0,time:t.time};Object(m._60)(r,t.tenantkey_A,t.tenantid_A,t.userName).then(function(a){if(1001===a.code){if(t.mapInfo=a.data,t.map3d)t.layerList.forEach(function(e){e.remove()});else for(var i=t.map.getLayers().getArray(),s=1;s<i.length;s++)t.map.removeLayer(i[s]),s--;for(var n=function(e){4===t.mapInfo[e].devtype&&(t.map3d?(t.groundListCopy.forEach(function(a){a.ground==t.mapInfo[e].ground&&(t.mapInfo[e].newground=a.newground)}),t.addTBox(t.groundVals,t.mapInfo[e])):t.addOrUpdateFeature("tbox",t.mapInfo[e])),1!==t.mapInfo[e].devtype&&2!==t.mapInfo[e].devtype||(t.map3d?(t.groundListCopy.forEach(function(a){a.ground==t.mapInfo[e].ground&&(t.mapInfo[e].newground=a.newground)}),t.addMarker(t.groundVals,t.mapInfo[e])):t.addOrUpdateFeature("person",t.mapInfo[e])),3===t.mapInfo[e].devtype&&(t.map3d?(t.groundListCopy.forEach(function(a){a.ground==t.mapInfo[e].ground&&(t.mapInfo[e].newground=a.newground)}),t.addAsset(t.groundVals,t.mapInfo[e])):t.addOrUpdateFeature("asset",t.mapInfo[e]))},o=0;o<t.mapInfo.length;o++)n(o);t.timeOut=setInterval(function(){t.delTimeOut()},1e4),e.hideLayers()}})}}this.checkList1=this.checkList},hideLayers:function(e){var t=this,a=[];if(this.checkList.forEach(function(e){e===t.$t("LocationIndoor.personnel")&&a.push(1),e===t.$t("LocationIndoor.assets")&&a.push(3),e===t.$t("LocationIndoor.vehicle")&&a.push(4)}),this.map)for(var i=t.map.getLayers().getArray(),s=1;s<i.length;s++)(0!==a.length||e)&&(!a.includes(i[s].getSource().getFeatures()[0].values_.devtype)&&0!==a.length||e&&!e.includes(i[s].getSource().getFeatures()[0].values_.deveui))?i[s].setVisible(!1):i[s].setVisible(!0);else t.layerList.forEach(function(t){(0!==a.length||e)&&(!a.includes(t.selfAttr.devtype)&&0!==a.length||e&&!e.includes(t.selfAttr.deveui))?t.visible=!1:t.visible=!0})},beforeEnter:function(e){e.style.opacity=0},enter:function(e,t){Velocity(e,{opacity:1},{duration:300,complete:t}),this.showEcharts=!1,this.show_echart="<"},leave:function(e,t){Velocity(e,{opacity:0},{duration:300,complete:t})},showSearch:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.searchShow=!this.searchShow,this.buildShow=!1,this.groundShow=!1,this.settingShow=!1},showBuild:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.buildShow=!this.buildShow,this.searchShow=!1,this.groundShow=!1,this.settingShow=!1},showGround:function(){var e=this;this.mapTypes?(I.init(document.getElementById("echarts")).dispose(),I.init(document.getElementById("echarts1")).dispose(),I.init(document.getElementById("echarts2")).dispose(),I.init(document.getElementById("echarts3")).dispose()):(I.init(document.getElementById("echarts_3D")).dispose(),I.init(document.getElementById("echarts1_3D")).dispose(),I.init(document.getElementById("echarts2_3D")).dispose(),I.init(document.getElementById("echarts3_3D")).dispose()),e.getGroundDevNums(e.groundid),this.timer&&(clearInterval(this.timer),this.timer=null),this.groundShow||(e.timer=setInterval(function(){e.getGroundDevNums(e.groundid)},5e3)),this.groundShow=!this.groundShow,this.buildShow=!1,this.searchShow=!1,this.settingShow=!1},showSetting:function(){this.timer&&(clearInterval(this.timer),this.timer=null),this.settingShow=!this.settingShow,this.groundShow=!1,this.buildShow=!1,this.searchShow=!1},selectGrounds:function(e){var t=e.row,a=this;if(this.map3d){if(a.groundListCopy.find(function(e){return e.newground==a.map3d.getLevel()}).groundid==t.id)return"cell-blue"}else{var i=void 0;if(i="B"==t.ground.slice(0,1)?-t.ground.slice(1):t.ground.slice(1),a.isactiveGround==i)return"cell-blue"}},remoteUserMethod:function(e){var t=this;""!==e?(this.userLoading=!0,setTimeout(function(){t.userLoading=!1,t.userOptions=t.userList.filter(function(t){return t.value.toLowerCase().indexOf(e.toLowerCase())>-1?t.value.toLowerCase().indexOf(e.toLowerCase())>-1:t.username.toLowerCase().indexOf(e.toLowerCase())>-1?t.username.toLowerCase().indexOf(e.toLowerCase())>-1:void 0})},200)):this.userOptions=[]},remoteAssetMethod:function(e){var t=this;""!==e?(this.assetLoading=!0,setTimeout(function(){t.assetLoading=!1,t.assetOptions=t.assetList.filter(function(t){return t.value.toLowerCase().indexOf(e.toLowerCase())>-1?t.value.toLowerCase().indexOf(e.toLowerCase())>-1:t.name.toLowerCase().indexOf(e.toLowerCase())>-1?t.name.toLowerCase().indexOf(e.toLowerCase())>-1:void 0})},200)):this.assetOptions=[]},remoteTBoxMethod:function(e){var t=this;""!==e?(this.tboxLoading=!0,setTimeout(function(){t.tboxLoading=!1,t.tboxOptions=t.tboxList.filter(function(t){return t.value.toLowerCase().indexOf(e.toLowerCase())>-1?t.value.toLowerCase().indexOf(e.toLowerCase())>-1:t.sn.toLowerCase().indexOf(e.toLowerCase())>-1?t.sn.toLowerCase().indexOf(e.toLowerCase())>-1:void 0})},200)):this.tboxOptions=[]},searchInfo:function(e,t,a,i){var s=this;this.isAllData=!1,this.isDepartmentData=!1,this.isSosData=!1;var n=this;if(e?(this.searchLists.perDeveui=e,this.searchLists.assetDeveui="",this.searchLists.tboxDeveui=""):t?(this.searchLists.perDeveui="",this.searchLists.assetDeveui=t,this.searchLists.tboxDeveui=""):a?(this.searchLists.perDeveui="",this.searchLists.assetDeveui="",this.searchLists.tboxDeveui=a):(this.searchLists.perDeveui=this.perDeveui,this.searchLists.assetDeveui=this.assetDeveui,this.searchLists.tboxDeveui=this.tboxDeveui),this.searchLists.perDeveui&&this.searchLists.assetDeveui||this.searchLists.perDeveui&&this.searchLists.tboxDeveui||this.searchLists.assetDeveui&&this.searchLists.tboxDeveui)this.$message({message:this.$t("LocationIndoor.tet1"),type:"warning"});else{if(1==this.intoProjectType?this.searchList.devtype=1:2==this.intoProjectType&&(this.searchList.devtype=2),this.searchLists.perDeveui)this.searchList.deveui=this.searchLists.perDeveui;else if(this.searchLists.assetDeveui)this.searchList.deveui=this.searchLists.assetDeveui,this.searchList.devtype=3;else if(this.searchLists.tboxDeveui)this.searchList.deveui=this.searchLists.tboxDeveui,this.searchList.devtype=4;else if(""==this.searchLists.perDeveui&&""==this.searchLists.assetDeveui&&""==this.searchLists.tboxDeveui&&""==i)return void this.$message({message:this.$t("LocationIndoor.tet2"),type:"warning"});if("true"==n.$route.query.warning){var o=n.$store.state.sosData,r=o.buildid,d=o.groundid;e&&(n.remoteUserMethod(o.deveui),setTimeout(function(){n.perDeveui=o.deveui,n.assetDeveui="",n.tboxDeveui=""},201)),t&&(n.remoteAssetMethod(o.deveui),setTimeout(function(){n.perDeveui="",n.assetDeveui=o.deveui,n.tboxDeveui=""},201)),a&&(n.remoteTBoxMethod(o.deveui),setTimeout(function(){n.perDeveui="",n.assetDeveui="",n.tboxDeveui=o.deveui},201)),i&&(n.searchLists.perDeveui="",n.searchLists.assetDeveui="",n.searchLists.tboxDeveui="",n.perDeveui="",n.assetDeveui="",n.tboxDeveui=""),n.websock&&n.websock.close();var l=o,c=n.buildings.find(function(e){return e.id==o.buildid});if("2D"==c.buildtypestr){n.mapTypes=!0;var h={projectid:n.intoProjectid,buildid:r,groundid:d},p={buildid:r};Object(m._58)(p,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){n.grounds=e.data.reverse()}),Object(m._23)(h,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){var t=u.a.host&&u.a.host.endsWith("/")?u.a.host:u.a.host+"/";n.imgUrl=t+"indoormap/"+e.data.list[0].filetype,n.isactiveGround=e.data.list[0].ground,n.map&&n.map.setTarget("sss"),n.map3d&&(n.map3d.dispose(),n.map3d=null),n.loadingFun(),n.mapInit(e.data.list[0].length,e.data.list[0].width,1200,800,l)})}else if("3D"==c.buildtypestr){n.showAllGround=c.flag,n.mapTypes=!1;var g={buildid:o.buildid};Object(m._57)(g,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){if(1001==e.code){for(var t=0;t<e.data.length;t++){var a={groundid:e.data[t].id,ground:e.data[t].ground,newground:t+1};n.groundListCopy.push(a)}n.scale=e.data[0].scale;var i=n.groundListCopy.find(function(e){return e.groundid==o.groundid});n.fmapId=e.data[0].filename,n.themeId=e.data[0].filetype,n.map&&n.map.setTarget("sss"),n.map3d&&(n.map3d.dispose(),n.map3d=null),n.loadingFun(),n.onmap("",i.newground,l,e.data[0].appname,e.data[0].mapkey,n.groundListCopy)}else n.$message({message:"zh"==n.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}n.isactive=o.buildid,n.building=o.buildid,n.groundid=o.groundid}else Object(m._44)(n.searchList,n.tenantkey_A,n.tenantid_A,n.userName).then(function(i){if(1001==i.code)if(e&&(n.remoteUserMethod(i.data.deveui),setTimeout(function(){n.perDeveui=i.data.deveui},201)),t&&(n.remoteAssetMethod(i.data.deveui),setTimeout(function(){n.assetDeveui=i.data.deveui},201)),a&&(n.remoteTBoxMethod(i.data.deveui),setTimeout(function(){n.tboxDeveui=i.data.deveui},201)),null==i.data.gpstime||""==i.data.gpstime||0==i.data.gpstime)n.$message({message:n.$t("LocationIndoor.tet3"),type:"warning"}),s.btnShow=!1;else if(1==i.data.postype){var o=i.data.buildid,r=i.data.ground;n.websock&&n.websock.close();var d=i.data,l=n.buildings.find(function(e){return e.id==i.data.buildid});if("2D"==l.buildtypestr){n.mapTypes=!0;var c={projectid:n.intoProjectid,buildid:o,ground:r},h={buildid:o};Object(m._58)(h,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){n.grounds=e.data.reverse()}),Object(m._23)(c,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){var t=u.a.host&&u.a.host.endsWith("/")?u.a.host:u.a.host+"/";n.imgUrl=t+"indoormap/"+e.data.list[0].filetype,n.map&&n.map.setTarget("sss"),n.map3d&&(n.map3d.dispose(),n.map3d=null),n.loadingFun(),n.mapInit(e.data.list[0].length,e.data.list[0].width,1200,800,d),n.wsuri=u.a.ws+"map/"+n.searchList.deveui,n.initWebsocketOne()})}else if("3D"==l.buildtypestr){n.showAllGround=l.flag,n.mapTypes=!1;var p={buildid:o};Object(m._57)(p,n.tenantkey_A,n.tenantid_A,n.userName).then(function(e){if(1001==e.code){for(var t=0;t<e.data.length;t++){var a={groundid:e.data[t].id,ground:e.data[t].ground,newground:t+1};n.groundListCopy.push(a)}var i=n.groundListCopy.find(function(e){return e.ground==r});n.fmapId=e.data[0].filename,n.themeId=e.data[0].filetype,n.scale=e.data[0].scale,n.map&&n.map.setTarget("sss"),n.map3d&&(n.map3d.dispose(),n.map3d=null),n.loadingFun(),n.onmap("",i.newground,d,e.data[0].appname,e.data[0].mapkey,n.groundListCopy),n.wsuri=u.a.ws+"map/"+n.searchList.deveui,n.initWebsocketOne()}})}n.isactive=i.data.buildid,n.building=i.data.buildid,n.isactiveGround=i.data.ground,n.groundid=i.data.groundid}else 2==i.data.postype&&n.$confirm(s.$t("LocationIndoor.tet4"),s.$t("Building.tips"),{confirmButtonText:s.$t("terminal.confirm"),cancelButtonText:s.$t("terminal.cancel"),type:"warning",callback:function(e){"confirm"===e&&(n.perDeveui?n.$router.push({path:"/location/outdoor/locationoutdoor",query:{deveui:i.data.deveui}}):n.tboxDeveui&&n.$router.push({path:"/location/outdoor/locationoutdoor",query:{tboxDeveui:i.data.deveui}}))}});else n.$message({message:"zh"==n.$store.state.i18n?i.msg:i.enMsg,type:"error"})})}},addIconMarker:function(e,t){var a,i=new w.a({x:t.x,y:t.y,deveui:t.deveui,username:t.username,projectid:t.projectid,gpstime:t.gpstime,devtype:t.devtype,battery:t.battery?t.battery:"",type:t.type?t.type:"",geometry:new _.a([t.x,t.y])}),s=new L.a({features:[i]});a=this.sostype?new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/usersos.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}):3==t.status?new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/user1down.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}):new k.c({image:new D.a({anchor:[.5,1],src:t.colour?"https://location.rctiot.com:8079/image/"+t.colour+".png":"../../../static/user1.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})});var n=new x.a({source:s,style:a});e.addLayer(n),this.sostype=!1},addMarker:function(e,t){var a={x:t.x,y:t.y},i={x:t.x,y:t.y,deveui:t.deveui,username:t.username,projectid:t.projectid,gpstime:t.gpstime,devtype:t.devtype,type:t.type?t.type:"",level:t.newground},s=void 0;if(this.sostype)s="../../../static/usersos.png";else if(3==t.status)s="../../../static/user1down.png";else switch(t.colour){case 1:s="../../../static/1.png";break;case 2:s="../../../static/2.png";break;case 3:s="../../../static/3.png";break;case 4:s="../../../static/4.png";break;case 5:s="../../../static/5.png";break;case 6:s="../../../static/6.png";break;case 7:s="../../../static/7.png";break;case 8:s="../../../static/8.png";break;case 9:s="../../../static/9.png";break;case 10:s="../../../static/10.png";break;default:s="../../../static/user1.png"}if(this.layer=new c.a.FMCompositeMarker({layout:{style:"timage-btext",align:"center"},text:{padding:[0,0,0,0],plateStrokeWidth:1,content:{textAlign:c.a.FMTextAlign.Center,lineSpacing:2,fontSize:14,fontFamily:"Microsoft YaHei",fillColor:"rgba(0, 0, 238)",text:t.username}},x:a.x,y:a.y,image:{url:s,size:[100,100]},collision:!1,anchor:{baseon:"image",anchor:c.a.FMMarkerAnchor.CENTER}}),this.layer.selfAttr=i,this.showAllGround){var n=this.map3d.getFloor(t.newground);this.layer.addTo(n),this.layerList.push(this.layer)}else{var o=this.map3d.getLevel();n=this.map3d.getFloor(o);this.layer.addTo(n),this.layerList.push(this.layer)}this.sostype=!1},addIconAsset:function(e,t){var a=new w.a({x:t.x,y:t.y,username:t.username,projectid:t.projectid,gpstime:t.gpstime,deveui:t.deveui,devtype:t.devtype,battery:t.battery?t.battery:"",type:t.type?t.type:"",geometry:new _.a([t.x,t.y])}),i=new L.a({features:[a]}),s=new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/beacon1.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}),n=new x.a({source:i,style:s});e.addLayer(n)},addIconTBox:function(e,t){var a,i=new w.a({x:t.x,y:t.y,username:t.username,projectid:t.projectid,gpstime:t.gpstime,deveui:t.deveui,devtype:t.devtype,battery:t.battery?t.battery:"",type:t.type?t.type:"",geometry:new _.a([t.x,t.y])}),s=new L.a({features:[i]});a=this.sostype?new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/tboxsos.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}):3==t.status?new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/tboxdown.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}):new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/tbox.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})});var n=new x.a({source:s,style:a});e.addLayer(n)},addAsset:function(e,t){var a={x:t.x,y:t.y};t={x:t.x,y:t.y,username:t.username,projectid:t.projectid,gpstime:t.gpstime,deveui:t.deveui,devtype:t.devtype,type:t.type?t.type:"",level:t.newground};if(this.layer=new c.a.FMCompositeMarker({layout:{style:"timage-btext",align:"center"},text:{padding:[0,0,0,0],plateStrokeWidth:1,content:{textAlign:c.a.FMTextAlign.Center,lineSpacing:2,fontSize:14,fontFamily:"Microsoft YaHei",fillColor:"rgba(0, 0, 238)",text:t.username}},x:a.x,y:a.y,image:{url:"../../../static/beacon1.png",size:[100,100]},height:2/this.scale,collision:!1,anchor:{baseon:"image",anchor:c.a.FMMarkerAnchor.CENTER}}),this.layer.selfAttr=t,this.showAllGround){var i=this.map3d.getFloor(t.newground);this.layer.addTo(i),this.layerList.push(this.layer)}else{var s=this.map3d.getLevel();i=this.map3d.getFloor(s);this.layer.addTo(i),this.layerList.push(this.layer)}},addTBox:function(e,t){var a={x:t.x,y:t.y},i=(t={x:t.x,y:t.y,username:t.username,projectid:t.projectid,gpstime:t.gpstime,deveui:t.deveui,devtype:t.devtype,type:t.type?t.type:"",level:t.newground},void 0);if(i=this.sostype?"../../../static/tboxsos.png":3==t.status?"../../../static/tboxdown.png":"../../../static/tbox.png",this.layer=new c.a.FMCompositeMarker({layout:{style:"timage-btext",align:"center"},text:{padding:[0,0,0,0],plateStrokeWidth:1,content:{textAlign:c.a.FMTextAlign.Center,lineSpacing:2,fontSize:14,fontFamily:"Microsoft YaHei",fillColor:"rgba(0, 0, 238)",text:t.username}},x:a.x,y:a.y,height:2/this.scale,collision:!1,anchor:{baseon:"image",anchor:c.a.FMMarkerAnchor.CENTER},image:{url:i,size:[100,100]}}),this.layer.selfAttr=t,this.showAllGround){var s=this.map3d.getFloor(t.newground);this.layer.addTo(s),this.layerList.push(this.layer)}else{var n=this.map3d.getLevel();s=this.map3d.getFloor(n);this.layer.addTo(s),this.layerList.push(this.layer)}},clearBtn:function(){this.buildingId="",this.warningBuildingId="",this.warningGround="",this.homeGround="",this.searchLists={},this.perDeveui="",this.assetDeveui="",this.tboxDeveui="",this.websock&&this.websock.close(),this.searchList={deveui:"",projectid:this.$store.state.projectid,devtype:""},this.$route.query.deveui="",this.$route.query.assetDeveui="",this.getBuildingByProjectids(),this.getMemberNames(),this.getAssetNames()},delTimeOut:function(){var e=this,t=this;if(0!=this.time){var a=Date.parse(new Date).toString();a=a.substr(0,10)-this.time,this.map3d?t.layerList.forEach(function(e){e.selfAttr.gpstime<a&&e.remove()}):function(){for(var i=e.map.getLayers().getArray(),s=function(e){i[e].getSource().getFeatures()[0].values_.gpstime<a&&(i[e].getSource().getFeatures().forEach(function(t){i[e].getSource().removeFeature(t)}),t.map.removeLayer(i[e]))},n=1;n<i.length;n++)s(n)}()}},delFeature:function(e){for(var t=this,a=this.map.getLayers().getArray(),i=function(i){e.deveui==a[i].getSource().getFeatures()[0].values_.deveui&&(a[i].getSource().getFeatures().forEach(function(e){a[i].getSource().removeFeature(e)}),t.map.removeLayer(a[i]))},s=1;s<a.length;s++)i(s)},delIcon:function(e){var t=this;this.layerList.forEach(function(a,i){if(a.selfAttr.deveui==e.deveui)return a.remove(),t.layerList.splice(i,1)})},mapInit:function(e,t,a,i,s){var n=this;document.oncontextmenu=function(e){return!1},this.map&&this.map.setTarget("sss"),this.map3d&&(this.map3d.dispose(),this.map3d=null);var o=this;o.AllSource=new L.a,o.AllLayer=new x.a({source:o.AllSource});var r=[0,0,e,t],d=new v.a({code:"xkcd-image",units:"pixels",extent:r});setTimeout(function(){e>a-1&&t>i-1?a:e>a-1&&t<i-1?a:e<a&&t>i-1?i:e<a&&t<i&&e,n.$refs.map.style.width="100%",n.$refs.map.style.height="100%",n.map=new g.a({controls:Object(A.b)({zoom:!1}),layers:[new p.a({source:new f.a({url:o.imgUrl,projection:d,imageExtent:r})})],target:n.mapName,view:new b.a({projection:d,center:Object(y.y)(r),zoom:2,maxZoom:6})}),o.map.addLayer(o.AllLayer),o.AllFeatures={},n.featureMap={person:{},asset:{},tbox:{}},n.sourceMap={person:new L.a,asset:new L.a,tbox:new L.a},n.layerMap={person:new x.a({source:n.sourceMap.person}),asset:new x.a({source:n.sourceMap.asset}),tbox:new x.a({source:n.sourceMap.tbox})},n.map.addLayer(n.layerMap.person),n.map.addLayer(n.layerMap.asset),n.map.addLayer(n.layerMap.tbox),s&&n.searchLists.perDeveui?n.addOrUpdateFeature("person",s):s&&n.searchLists.assetDeveui?n.addOrUpdateFeature("asset",s):s&&n.searchLists.tboxDeveui&&n.addOrUpdateFeature("tbox",s),n.userMapMouse(n.map),n.mapClick(),n.getData(),n.loading.close()},0)},handlePushData:function(e){var t=this;e.forEach(function(e){var a=e.type,i=e.deveui,s=e.pathData,n=e.info,r=s.map(function(e){return[e.x,e.y]});if(r&&!(r.length<1)){t.featureMap[a]||(t.featureMap[a]={});var d=t.featureMap[a][i];if(d)r.length>1&&t.moveAlongPath(a,i,d,r,3e3);else{var l=o()({},n,s[0]);if(t.addOrUpdateFeature(a,l),r.length>1){var c=r.slice(1),u=t.featureMap[a][i];t.moveAlongPath(a,i,u,c,3e3)}if(r.length>1){var h=r.slice(1),m=t.featureMap[a][i];t.moveAlongPath(a,i,m,h,3e3)}}}})},moveAlongPath:function(e,t,a,i){var s=this,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3e3;if(i&&!(i.length<2)){var o=a.getGeometry(),r=i.length-1,d=n/r,l=0;this.moveTimers[e]||(this.moveTimers[e]={}),this.moveTimers[e][t]&&(cancelAnimationFrame(this.moveTimers[e][t]),this.moveTimers[e][t]=null);!function a(){if(!(l>=r)){var n=i[l],c=i[l+1],u=Date.now();!function i(){var r=Date.now()-u,h=Math.min(r/d,1),m=[n[0]+(c[0]-n[0])*h,n[1]+(c[1]-n[1])*h];o.setCoordinates(m),h<1?s.moveTimers[e][t]=requestAnimationFrame(i):(l++,a())}()}}()}},addOrUpdateFeature:function(e,t){var a=this.sourceMap[e],i=this.featureMap[e],s=t.deveui,n=[t.x,t.y],o=i[s];o?(this.animateMoveFeature(o,n),o.set("gpstime",t.gpstime),o.set("battery",t.battery),o.set("username",t.username),o.setStyle(this.getFeatureStyle(e,t))):((o=new w.a({geometry:new _.a(n),x:t.x,y:t.y,username:t.username,projectid:t.projectid,gpstime:t.gpstime,deveui:t.deveui,devtype:t.devtype,battery:t.battery})).setStyle(this.getFeatureStyle(e,t)),a.addFeature(o),i[s]=o)},animateMoveFeature:function(e,t){var a=e.getGeometry(),i=a.getCoordinates(),s=Date.now();!function e(){var n=Date.now()-s,o=Math.min(n/1e3,1),r=[i[0]+(t[0]-i[0])*o,i[1]+(t[1]-i[1])*o];a.setCoordinates(r),o<1&&requestAnimationFrame(e)}()},getFeatureStyle:function(e,t){var a="";return"person"===e?a=3===t.status?"../../../static/user1down.png":t.colour?"https://location.rctiot.com:8079/image/"+t.colour+".png":"../../../static/user1.png":"asset"===e?a="../../../static/beacon1.png":"tbox"===e&&(a=this.sostype?"../../../static/tboxsos.png":3===t.status?"../../../static/tboxdown.png":"../../../static/tbox.png"),new k.c({image:new D.a({anchor:[.5,1],src:a,scale:1}),text:new $.a({text:t.username,font:"14px sans-serif",fill:new S.a({color:"blue"}),offsetY:10})})},userMapMouse:function(e){e.on("pointermove",function(t){var a=e.forEachFeatureAtPixel(t.pixel,function(e){return e});a?""==a.values_.x&&null==a.values_.x||(e.getTargetElement().style.cursor="pointer"):e.getTargetElement().style.cursor="default"})},mapClick:function(){var e=this,t=this;this.map.on("click",function(a){var i=e.map.forEachFeatureAtPixel(a.pixel,function(e){return e});if(t.battery="",i){if(2==i.values_.type)return;if(i.values_.deveui)if(1==i.values_.devtype||2==i.values_.devtype){var s={maplabel:i.values_.deveui};Object(m._65)(s,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code?(t.battery=i.values_.battery,t.age=t.ages(e.data.member.birthday),t.depart=e.data.member.depart,t.cardno=e.data.member.cardno,t.maplabel=e.data.member.maplabel,t.sexstr="zh"==t.i8n?e.data.member.sexstr:e.data.member.ensex,t.tel=e.data.member.tel,t.worktype=e.data.member.worktype,t.username=e.data.member.username,t.gpstime=t.formatDate(i.values_.gpstime),t.imagePer=e.data.member.filename?u.a.host+"profile/"+e.data.member.filename:"1"==e.data.member.sex?"../../../static/male.png":"2"==e.data.member.sex?"../../../static/female.png":"../../../static/nosex.png",null==e.data.devHealth?(t.bracelet_eui="",t.bracelet_soc="",t.bracelet_rate="",t.bracelet_tem="",t.bracelet_oxygen="",t.bracelet_time="",t.showBracelet=!1):(t.bracelet_eui=e.data.devHealth.wristEui,t.bracelet_soc=e.data.devHealth.soc,t.bracelet_rate=e.data.devHealth.heartrate,t.bracelet_tem=e.data.devHealth.tem,t.bracelet_oxygen=e.data.devHealth.oxygen,t.bracelet_time=t.formatDate(e.data.devHealth.dataTime),t.showBracelet=!0),t.devPer=!0,t.devAsset=!1,t.devTBox=!1,t.visible=!0):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}else if(3==i.values_.devtype){var n={beaconid:i.values_.deveui};Object(m._16)(n,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code?(t.assetName=e.data.name,t.assetType=e.data.type,t.assetModel=e.data.model,t.assetBeaconid=e.data.beaconid,t.assetDepart=e.data.depart,t.assetUser=e.data.username,t.assetTime=t.formatDate(i.values_.gpstime),t.imageAsset=e.data.filename?u.a.host+"profile/"+e.data.filename:"",t.devPer=!1,t.showBracelet=!1,t.devAsset=!0,t.devTBox=!1,t.visible=!0):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}else{var o={maplabel:i.values_.deveui};Object(m._94)(o,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code?(t.battery=i.values_.battery,t.tboxName=e.data.sn,t.tboxType=e.data.type,t.tboxMaplabel=e.data.maplabel,t.tboxTime=t.formatDate(i.values_.gpstime),t.imageTBox=e.data.filename?u.a.host+"profile/"+e.data.filename:"",t.devPer=!1,t.showBracelet=!1,t.devAsset=!1,t.devTBox=!0,t.visible=!0):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}}})},datetimecut:function(e){if(!e)return"-";function t(e){return e>9?e:"0"+e}var a=new Date(e);return a.getFullYear()+"-"+t(a.getMonth()+1)+"-"+t(a.getDate())+" "+(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+t(a.getMinutes())+":"+t(a.getSeconds())},formatDate:function(e){if(null==e)return"";var t=new Date(1e3*parseInt(e)).toUTCString();return this.datetimecut(t)},addIconMarkers:function(e,t){var a,i=new w.a({x:t.x,y:t.y,username:t.username,deveui:t.deveui,projectid:t.projectid,gpstime:t.gpstime,devtype:1,battery:t.battery?t.battery:"",geometry:new _.a([t.x,t.y])}),s=new L.a({features:[i]});a=3==t.status?new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/user1down.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}):new k.c({image:new D.a({anchor:[.5,1],src:t.colour?"https://location.rctiot.com:8079/image/"+t.colour+".png":"../../../static/user1.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})});var n=new x.a({source:s,style:a});e.addLayer(n)},addMarkers:function(e,t){var a={x:e.x,y:e.y},i={x:e.x,y:e.y,username:e.username,deveui:e.deveui,projectid:e.projectid,gpstime:e.gpstime,devtype:1,level:e.newground},s=void 0;if(this.sostype)s="../../../static/usersos.png";else if(3==e.status)s="../../../static/user1down.png";else switch(e.colour){case 1:s="../../../static/1.png";break;case 2:s="../../../static/2.png";break;case 3:s="../../../static/3.png";break;case 4:s="../../../static/4.png";break;case 5:s="../../../static/5.png";break;case 6:s="../../../static/6.png";break;case 7:s="../../../static/7.png";break;case 8:s="../../../static/8.png";break;case 9:s="../../../static/9.png";break;case 10:s="../../../static/10.png";break;default:s="../../../static/user1.png"}if(this.layer=new c.a.FMCompositeMarker({layout:{style:"timage-btext",align:"center"},text:{padding:[0,0,0,0],plateStrokeWidth:1,content:{textAlign:c.a.FMTextAlign.Center,lineSpacing:2,fontSize:14,fontFamily:"Microsoft YaHei",fillColor:"rgba(0, 0, 238)",text:i.username}},x:a.x,y:a.y,height:1.7/this.scale,collision:!1,anchor:{baseon:"image",anchor:c.a.FMMarkerAnchor.CENTER},image:{url:s,size:[100,100]}}),this.layer.selfAttr=i,this.showAllGround){var n=this.map3d.getFloor(e.newground);this.layer.addTo(n),this.layerList.push(this.layer)}else{var o=this.map3d.getLevel();n=this.map3d.getFloor(o);this.layer.addTo(n),this.layerList.push(this.layer)}},addIconAssets:function(e,t){var a=new w.a({x:t.x,y:t.y,username:t.username,projectid:t.projectid,gpstime:t.gpstime,deveui:t.deveui,devtype:3,battery:t.battery?t.battery:"",geometry:new _.a([t.x,t.y])}),i=new L.a({features:[a]}),s=new k.c({image:new D.a({anchor:[.5,1],src:"../../../static/beacon1.png",scale:1}),text:new $.a({text:t.username,font:"14px font-size",fill:new S.a({color:"blue"}),offsetY:10})}),n=new x.a({source:i,style:s});e.addLayer(n)},addAssets:function(e,t){var a={x:e.x,y:e.y},i={x:e.x,y:e.y,username:e.username,projectid:e.projectid,gpstime:e.gpstime,deveui:e.deveui,devtype:3,level:e.newground};if(this.layer=new c.a.FMCompositeMarker({layout:{style:"timage-btext",align:"center"},text:{padding:[0,0,0,0],plateStrokeWidth:1,content:{textAlign:c.a.FMTextAlign.Center,lineSpacing:2,fontSize:14,fontFamily:"Microsoft YaHei",fillColor:"rgba(0, 0, 238)",text:e.username}},x:a.x,y:a.y,image:{url:"../../../static/beacon1.png",size:[100,100]},height:2/this.scale,collision:!1,anchor:{baseon:"image",anchor:c.a.FMMarkerAnchor.CENTER}}),this.layer.selfAttr=i,this.showAllGround){var s=this.map3d.getFloor(e.newground);this.layer.addTo(s),this.layerList.push(this.layer)}else{var n=this.map3d.getLevel();s=this.map3d.getFloor(n);this.layer.addTo(s),this.layerList.push(this.layer)}},getBuildingByProjectids:function(){var e=this,t=this,a={tenantid:this.$store.state.intoProjectTenantid,projectid:this.$store.state.intoProjectid};Object(m._26)(a,this.tenantkey_A,this.tenantid_A,this.userName).then(function(a){if(1001==a.code){if(t.buildings=a.data,t.$route.query.deveui)return;if(t.$route.query.assetDeveui)return;if(t.buildingId&&t.homeGround)"2D"==(i=t.buildings.find(function(e){return e.id==t.buildingId})).buildtypestr?(t.mapTypes=!0,t.getGroundLists(t.buildingId,t.homeGround)):"3D"==i.buildtypestr&&(t.showAllGround=i.flag,t.mapTypes=!1,t.getMapid(i.id),t.getGroundLists3D(t.buildingId,t.homeGround));else if(t.buildingId){"2D"==(i=t.buildings.find(function(e){return e.id==t.buildingId})).buildtypestr?(t.mapTypes=!0,t.getGroundLists(t.buildingId)):"3D"==i.buildtypestr&&(t.showAllGround=i.flag,t.mapTypes=!1,t.getMapid(i.id),t.getGroundLists3D(t.buildingId))}else if(t.warningBuildingId&&t.warningGround){var i;"2D"==(i=t.buildings.find(function(e){return e.id==t.warningBuildingId})).buildtypestr?(t.mapTypes=!0,t.getGroundLists(t.warningBuildingId,t.warningGround)):"3D"==i.buildtypestr&&(t.showAllGround=i.flag,t.mapTypes=!1,t.getMapid(i.id),t.getGroundLists3D(t.warningBuildingId,t.warningGround))}else{if(e.$route.query.deveui||e.$route.query.assetDeveui||e.$route.query.tboxDeveui)return;"2D"==t.buildings[0].buildtypestr?(t.mapTypes=!0,t.getGroundLists(t.buildings[0].id)):"3D"==t.buildings[0].buildtypestr&&(t.showAllGround=t.buildings[0].flag,t.mapTypes=!1,t.getMapid(t.buildings[0].id),t.getGroundLists3D(t.buildings[0].id))}}})},getGrounds:function(e){var t=this.buildings.find(function(t){return t.id==e});"2D"==t.buildtypestr?(this.map&&this.map.setTarget("sss"),this.map3d&&(this.map3d.dispose(),this.map3d=null),this.mapTypes=!0,this.getGroundLists(e)):"3D"==t.buildtypestr&&(this.map&&this.map.setTarget("sss"),this.map3d&&(this.map3d.dispose(),this.map3d=null),this.showAllGround=t.flag,this.mapTypes=!1,this.getMapid(t.id),this.getGroundLists3D(e,"",t))},getGroundLists:function(e,t){0!=this.websockNum&&this.websock.close();var a=this;this.isactive=e;var i={buildid:e};Object(m._58)(i,a.tenantkey_A,a.tenantid_A,a.userName).then(function(i){1001==i.code&&(0==i.data.length&&(a.groundData=[]),a.grounds=i.data.reverse(),a.building=e,t?a.getBuildGroundLists(t):a.getBuildGroundLists(i.data[i.data.length-1]))})},getGroundLists3D:function(e,t,a){0!=this.websockNum&&this.websock.close();var i=this;this.isactive=e,i.websock&&i.websock.close();var s={buildid:e};Object(m._57)(s,i.tenantkey_A,i.tenantid_A,i.userName).then(function(a){if(1001==a.code){for(var n=0;n<a.data.length;n++){var o={groundid:a.data[n].id,ground:a.data[n].ground,newground:n+1};i.groundListCopy.push(o)}i.scale=a.data[0].scale,i.showAllGround?(i.map3d&&(i.map3d.dispose(),i.map3d=null),i.$route.query.deveui&&(i.perDeveui=""),i.$route.query.assetDeveui&&(i.assetDeveui=""),0!=i.websockNum&&i.websock.close(),i.building=e,i.fmapId=a.data[0].filename,i.themeId=a.data[0].filetype,i.loadingFun(),i.onmap(i.$store.state.intoProjectid,"","",a.data[0].appname,a.data[0].mapkey,i.groundListCopy),i.wsuri=u.a.ws+"map/build_"+e,i.initWebsocket()):Object(m._58)(s,i.tenantkey_A,i.tenantid_A,i.userName).then(function(a){1001==a.code&&(i.grounds=a.data.reverse(),i.building=e,t?i.getBuildGroundLists3D(t):i.getBuildGroundLists3D(i.groundListCopy[0].ground))})}else i.$message({message:"zh"==i.$store.state.i18n?a.msg:a.enMsg,type:"error"})})},getBuildGroundLists3D:function(e){if(this.ground=e,this.map3d&&(this.map3d.dispose(),this.map3d=null),this.$route.query.deveui&&(this.perDeveui=""),this.$route.query.assetDeveui&&(this.assetDeveui=""),0!=this.websockNum&&this.websock.close(),this.tableData=[{id:"-1",name:this.$t("LocationIndoor.Totalnumber"),num:"0"},{id:"-2",name:this.$t("LocationIndoor.Totalassets"),num:"0"},{id:"-3",name:this.$t("LocationIndoor.Totalvehicle"),num:"0"},{id:"-4",name:this.$t("LocationIndoor.Jobs1"),num:"0",children:[]},{id:"-5",name:this.$t("LocationIndoor.department"),num:"0",children:[]},{id:"-6",name:this.$t("LocationIndoor.assets1"),num:"0",children:[]}],e){this.isactiveGround=e;var t=this,a={projectid:this.intoProjectid,buildid:this.building,ground:e};Object(m._23)(a,this.tenantkey_A,this.tenantid_A,this.userName).then(function(a){1001==a.code&&a.data.list.length>0&&(t.groundid=a.data.list[0].id,t.fmapId=a.data.list[0].filename,t.themeId=a.data.list[0].filetype,t.wsuri=u.a.ws+"map/"+t.groundid,t.scale=a.data.list[0].scale,0!=t.websockNum&&t.websock.close(),setTimeout(function(){var i=t.groundListCopy.find(function(t){return t.ground==e});t.loadingFun(),t.onmap(t.$store.state.intoProjectid,i.newground,"",a.data.list[0].appname,a.data.list[0].mapkey,t.groundListCopy),t.initWebsocket()},1))})}},onmap:function(e,t,a,i,s,n){var o=this;this.dataTimer&&(clearInterval(this.dataTimer),this.dataTimer=null),o.isDepartmentData=!1,o.isRoleData=!1,o.isSosData=!1,o.isAllData=!1,document.oncontextmenu=function(e){return!1},this.map&&this.map.setTarget("sss");var r=void 0;r=t||1,this.groundVals=r;o=this;var d=[];n.forEach(function(e){d.push(e.newground)});var l={container:document.getElementById("fengMap"),level:r,visibleLevels:o.showAllGround?d:[r],appName:i,key:s,mapID:o.fmapId,themeID:o.themeId,highlightPicker:["hover"],floorSpace:5,zoomRange:[1,25],buildingOptions:{level:r,floorSpace:5}};this.map3d=new c.a.FMMap(l),this.map3d.on("loaded",function(){if(o.showAllGround){var i=o.map3d.getBound();o.map3d.setFitView(i)}else{var s=o.map3d.getFloor(1).getBound();o.map3d.setFitView(s)}o.loading.close(),o.loadScrollFloorCtrl(),e&&(o.getData(),1==o.intoProjectType?o.getDevGpsLocation3D(o.groundid,o.map3d.getLevel()):2==o.intoProjectType&&o.getBeaconGpss3D(o.groundid,o.map3d.getLevel())),o.groundListCopy.forEach(function(e){e.ground==a.ground&&(a.newground=e.newground)}),a&&o.searchLists.perDeveui?o.addMarker(t,a):a&&o.searchLists.assetDeveui?o.addAsset(t,a):a&&o.searchLists.tboxDeveui&&o.addTBox(t,a)}),this.map3d.on("levelChanged",function(e){if(!o.showAllGround){0!=o.websockNum&&o.websock.close(),o.layerList.forEach(function(e){e.remove()});var t=o.groundListCopy.find(function(e){return e.newground==o.map3d.getLevel()});o.groundVals=t.ground;var a=o.map3d.getFloor(t.newground).getBound();o.map3d.setFitView(a,{animate:!0,finish:function(){o.getBuildGroundListsAll(o.groundVals,o.building),o.getData()}})}}),this.map3d.on("click",function(e){"64"!=e.targets[0].type&&"8"!=e.targets[0].type||(o.setNewMarker=!1,0==e.mouseEvent.button&&o.addPopInfoWindowLeft(e.targets[0]))})},loadingFun:function(){this.loading=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0,0,0,0.7)"})},addPopInfoWindowLeft:function(e){var t=this;if(2!=e.selfAttr.type)if(1==e.selfAttr.devtype||2==e.selfAttr.devtype){var a={maplabel:e.selfAttr.deveui};Object(m._65)(a,t.tenantkey_A,t.tenantid_A,t.userName).then(function(a){1001==a.code?(t.age=t.ages(a.data.member.birthday),t.depart=a.data.member.depart,t.cardno=a.data.member.cardno,t.maplabel=a.data.member.maplabel,t.sexstr="zh"==t.i8n?a.data.member.sexstr:a.data.member.ensex,t.tel=a.data.member.tel,t.worktype=a.data.member.worktype,t.username=a.data.member.username,t.gpstime=t.formatDate(e.selfAttr.gpstime),t.imagePer=a.data.member.filename?u.a.host+"profile/"+a.data.member.filename:"1"==a.data.member.sex?"../../../static/male.png":"2"==a.data.member.sex?"../../../static/female.png":"../../../static/nosex.png",null==a.data.devHealth?(t.bracelet_eui="",t.bracelet_soc="",t.bracelet_rate="",t.bracelet_tem="",t.bracelet_oxygen="",t.bracelet_time="",t.showBracelet=!1):(t.bracelet_eui=a.data.devHealth.wristEui,t.bracelet_soc=a.data.devHealth.soc,t.bracelet_rate=a.data.devHealth.heartrate,t.bracelet_tem=a.data.devHealth.tem,t.bracelet_oxygen=a.data.devHealth.oxygen,t.bracelet_time=t.formatDate(a.data.devHealth.dataTime),t.showBracelet=!0),t.devPer=!0,t.devAsset=!1,t.devTBox=!1,t.visible=!0):t.$message({message:"zh"==t.$store.state.i18n?a.msg:a.enMsg,type:"error"})})}else if(3==e.selfAttr.devtype){var i={beaconid:e.selfAttr.deveui};Object(m._16)(i,t.tenantkey_A,t.tenantid_A,t.userName).then(function(a){1001==a.code?(t.assetName=a.data.name,t.assetType=a.data.type,t.assetModel=a.data.model,t.assetBeaconid=a.data.beaconid,t.assetDepart=a.data.depart,t.assetUser=a.data.username,t.assetTime=t.formatDate(e.selfAttr.gpstime),t.imageAsset=a.data.filename?u.a.host+"profile/"+a.data.filename:"",t.devPer=!1,t.showBracelet=!1,t.devAsset=!0,t.devTBox=!1,t.visible=!0):t.$message({message:"zh"==t.$store.state.i18n?a.msg:a.enMsg,type:"error"})})}else{var s={maplabel:e.selfAttr.deveui};Object(m._94)(s,t.tenantkey_A,t.tenantid_A,t.userName).then(function(a){1001==a.code?(t.battery=feature.values_.battery,t.tboxName=a.data.sn,t.tboxType=a.data.type,t.tboxMaplabel=a.data.maplabel,t.tboxTime=t.formatDate(e.selfAttr.gpstime),t.imageTBox=a.data.filename?u.a.host+"profile/"+a.data.filename:"",t.devPer=!1,t.showBracelet=!1,t.devAsset=!1,t.devTBox=!0,t.visible=!0):t.$message({message:"zh"==t.$store.state.i18n?a.msg:a.enMsg,type:"error"})})}},loadScrollFloorCtrl:function(){var e={floorButtonCount:5,position:c.a.FMControlPosition.RIGHT_TOP,needAllLayerBtn:!1,viewModeControl:!0,floorModeControl:!0,offset:{x:-20,y:20}};this.scrollFloorControl=new c.a.FMToolbar(e),this.scrollFloorControl.addTo(this.map3d)},getBuildGroundLists:function(e){if(this.ground=e,this.$route.query.deveui&&(this.perDeveui=""),this.$route.query.assetDeveui&&(this.assetDeveui=""),0!=this.websockNum&&this.websock.close(),this.tableData=[{id:"-1",name:this.$t("LocationIndoor.Totalnumber"),num:"0"},{id:"-2",name:this.$t("LocationIndoor.Totalassets"),num:"0"},{id:"-3",name:this.$t("LocationIndoor.Totalvehicle"),num:"0"},{id:"-4",name:this.$t("LocationIndoor.Jobs1"),num:"0",children:[]},{id:"-5",name:this.$t("LocationIndoor.department"),num:"0",children:[]},{id:"-6",name:this.$t("LocationIndoor.assets1"),num:"0",children:[]}],e){this.isactiveGround=e;var t=this,a={projectid:this.intoProjectid,buildid:this.building,ground:e};Object(m._23)(a,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code)if(t.map&&t.map.setTarget("mapppppp"),e.data.list.length>0){var a=u.a.host&&u.a.host.endsWith("/")?u.a.host:u.a.host+"/";t.imgUrl=a+"indoormap/"+e.data.list[0].filetype,t.groundid=e.data.list[0].id,t.loadingFun(),t.mapInit(e.data.list[0].length,e.data.list[0].width,1200,800),t.wsuri=u.a.ws+"map/"+t.groundid,t.initWebsocket(),1==t.intoProjectType?t.getDevGpsLocation(t.groundid):2==t.intoProjectType&&t.getBeaconGpss(t.groundid,t.ground),t.getGroundDevNums(t.groundid),t.timer&&(clearInterval(t.timer),t.timer=null),t.groundShow&&(t.timer=setInterval(function(){t.getGroundDevNums(t.groundid)},5e3));var i=[t.$t("LocationIndoor.personnel"),t.$t("LocationIndoor.assets"),t.$t("LocationIndoor.vehicle")];clearInterval(t.timeOut),t.timeOut=null;for(var s=0;s<t.checkList.length;s++)i.includes(t.checkList[s])||(t.checkList.splice(s,1),s--)}else t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})}else this.map&&this.map.setTarget("mapppppp")},getDevGpsLocation:function(e){var t=this,a=this,i={projectid:this.$store.state.projectid,buildid:this.building,groundid:e,gpstype:1,devtype:0,time:this.time};Object(m._60)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code){t.mapInfo=e.data;for(var i=0;i<t.mapInfo.length;i++)4===t.mapInfo[i].devtype&&a.addOrUpdateFeature("tbox",t.mapInfo[i]),1===t.mapInfo[i].devtype&&a.addOrUpdateFeature("person",t.mapInfo[i]),3===t.mapInfo[i].devtype&&a.addOrUpdateFeature("asset",t.mapInfo[i]);a.hideLayers()}})},getDevGpsLocation3D:function(e,t){var a=this,i={projectid:this.$store.state.projectid,buildid:this.building,groundid:this.showAllGround?"":e,gpstype:1,devtype:0,time:this.time};Object(m._60)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&function(){for(var i=e.data,s=function(e){a.groundListCopy.forEach(function(t){t.ground==i[e].ground&&(i[e].newground=t.newground)}),4===i[e].devtype&&a.addTBox(t,i[e]),1===i[e].devtype&&a.addMarkers(i[e],t),3===i[e].devtype&&a.addAssets(i[e],t)},n=0;n<i.length;n++)s(n)}()})},getBeaconGpss:function(e){var t=this,a={projectid:this.$store.state.projectid,buildid:this.building,groundid:e,gpstype:1,devtype:0,time:this.time};Object(m._60)(a,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code)for(var a=e.data,i=0;i<a.length;i++)4===a[i].devtype&&t.addOrUpdateFeature("tbox",a[i]),2===a[i].devtype&&t.addOrUpdateFeature("person",t.mapInfo[i]),3===a[i].devtype&&t.addOrUpdateFeature("asset",a[i])})},getBeaconGpss3D:function(e,t){var a=this,i={projectid:this.$store.state.projectid,buildid:this.building,groundid:this.showAllGround?"":e,gpstype:1,devtype:0,time:this.time};Object(m._60)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&function(){for(var i=e.data,s=function(e){a.groundListCopy.forEach(function(t){t.ground==i[e].ground&&(i[e].newground=t.newground)}),4===i[e].devtype&&a.addTBox(t,i[e]),1===i[e].devtype&&a.addMarkers(i[e],t),3===i[e].devtype&&a.addAssets(i[e],t)},n=0;n<i.length;n++)s(n)}()})},getSummaries:function(e){var t=this,a=e.columns,i=e.data,s=[];return a.forEach(function(e,a){if(0!==a){var n=i.map(function(t){return Number(t[e.property])});n.every(function(e){return isNaN(e)})?s[a]="N/A":s[a]=n.reduce(function(e,t){var a=Number(t);return isNaN(a)?e:e+t},0)}else s[a]=t.$t("floormanagement.value3")}),s},getGroundDevNums:function(e){var t=this;this.groundInfoList1=[],this.groundInfoList2=[],this.groundInfoList3=[];var a=Math.floor((new Date).getTime()/1e3),i={projectid:this.$store.state.projectid,buildid:this.building,groundid:e,gpstype:1,devtype:0,time:a},s=this;Object(m._28)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){if(1001==e.code){var a=e.data.groundlist;if(a.forEach(function(e){e.devnum,e.tboxnum,e.assetnum,e.ground>0?e.ground="F"+e.ground:e.ground="B"+Math.abs(e.ground)}),s.groundData=a,s.groundData.reverse(),s.tableData[0].num=e.data.devnum,s.tableData[1].num=e.data.assetnum,s.tableData[2].num=e.data.tboxnum,e.data.list){var i=e.data.list,n=[],o=[],r=[];if(i.length>0){t.echartsInit(i);for(var d=0;d<i.length;d++)switch(i[d].type){case 1:n.push(i[d]),s.tableData[3].children=n,s.tableData[3].num=n.length;break;case 2:o.push(i[d]),s.tableData[4].children=o,s.tableData[4].num=o.length;break;case 3:r.push(i[d]),s.tableData[5].children=r,s.tableData[5].num=r.length}}else s.tableData[2].num=0,s.tableData[3].num=0,s.tableData[4].num=0}else s.tableData[0].num=0,s.tableData[1].num=0,s.tableData[2].num=0,s.tableData[3].num=0,s.tableData[4].num=0;(s.tableData[0].num>0||s.tableData[1].num>0)&&s.showEcharts?s.show_echart=">":s.show_echart="<"}})},getMemberNames:function(){var e=this,t={projectid:this.$store.state.projectid};Object(m._68)(t,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){if(1001==t.code){e.userList=t.data.map(function(e){return{value:""+e.maplabel,maplabel:""+e.maplabel,username:""+e.username}});for(var a=e.userList.length-1;a>-1;a--)""!=e.userList[a].maplabel&&null!=e.userList[a].maplabel&&void 0!=e.userList[a].maplabel||e.userList.splice(a,1)}})},getAssetNames:function(){var e=this,t={projectid:this.$store.state.projectid};Object(m._15)(t,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){if(1001==t.code){e.assetList=t.data.map(function(e){return{beaconid:""+e.beaconid,value:""+e.beaconid,name:""+e.name}});for(var a=e.assetList.length-1;a>-1;a--)""!=e.assetList[a].beaconid&&null!=e.assetList[a].beaconid&&void 0!=e.assetList[a].beaconid||e.assetList.splice(a,1)}})},getTboxSnIds:function(){var e=this,t={projectid:this.$store.state.projectid};Object(m._95)(t,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){1001==t.code&&(e.tboxList=t.data.filter(function(e){return e.maplabel}).map(function(e){return{value:""+e.maplabel,maplabel:""+e.maplabel,sn:""+e.sn}}))})},getBuildGroundListsAll:function(e,t){var a=this,i={projectid:this.intoProjectid,buildid:t};Object(m._23)(i,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){var i=t.data.list.find(function(t){return t.ground==e});a.groundid=i.id,a.wsuri=u.a.ws+"map/"+a.groundid,a.initWebsocket(),a.getGroundDevNums(a.groundid),a.timer&&(clearInterval(a.timer),a.timer=null),a.groundShow&&(a.timer=setInterval(function(){a.getGroundDevNums(a.groundid)},5e3)),1==a.intoProjectType?a.getDevGpsLocation3D(a.groundid,i.ground):2==a.intoProjectType&&a.getBeaconGpss3D(a.groundid,i.ground)})},initWebsocket:function(){if(this.websockNum=1,"undefined"==typeof WebSocket)return alert("您的浏览器不支持WebSocket"),!1;this.websock=new WebSocket(this.wsuri),this.websock.onopen=this.websocketopen,this.websock.onmessage=this.websocketonmessage,this.websock.onerror=this.websocketerror,this.websock.onclose=this.close},initWebsocketOne:function(){if(this.websockNum=1,"undefined"==typeof WebSocket)return alert("您的浏览器不支持WebSocket"),!1;this.websock=new WebSocket(this.wsuri),this.websock.onopen=this.websocketopenOne,this.websock.onmessage=this.websocketonmessage,this.websock.onerror=this.websocketerror,this.websock.onclose=this.close},websocketopenOne:function(e){},websocketopen:function(e){},websocketonmessage:function(e){var t=this,a=this;if("连接成功"!=e.data){var i,n=function(){var n=[];i=JSON.parse(e.data),0==Array.isArray(i)?n.push(i):n=i;if(n.length>1&&n.every(function(e){return e.deveui===n[0].deveui})){var o=[{type:3==n[0].devtype?"asset":4==n[0].devtype?"tbox":"person",deveui:n[0].deveui,pathData:[],info:n[0]}];n.forEach(function(e){o[0].pathData.push({x:e.x,y:e.y})}),a.handlePushData(o)}else for(var r=function(e){if(n[e].deveui&&(1==n[e].maptype||2==n[e].maptype&&a.delIcon(n[e]),2!=n[e].status)){if(!1===a.showAllGround&&a.groundid!=n[e].groundid)return setTimeout(function(){switch(n[e].devtype){case 1:case 2:a.searchInfo(n[e].deveui);break;case 3:a.searchInfo("",n[e].deveui);break;case 4:a.searchInfo("","",n[e].deveui)}},1e3),{v:{v:void 0}};1==n[e].maptype?3==n[e].devtype&&(-1==t.checkList.indexOf(t.$t("LocationIndoor.vehicle"))&&-1==t.checkList.indexOf(t.$t("LocationIndoor.personnel"))||0===t.checkList.length)?a.addOrUpdateFeature("asset",n[e]):4==n[e].devtype&&(-1==t.checkList.indexOf(t.$t("LocationIndoor.assets"))&&-1==t.checkList.indexOf(t.$t("LocationIndoor.personnel"))||0===t.checkList.length)?a.addOrUpdateFeature("tbox",n[e]):(1!=n[e].devtype&&2!=n[e].devtype||-1!=t.checkList.indexOf(t.$t("LocationIndoor.vehicle"))||-1!=t.checkList.indexOf(t.$t("LocationIndoor.assets")))&&0!==t.checkList.length||a.addOrUpdateFeature("person",n[e]):2==n[e].maptype&&(a.groundListCopy.forEach(function(t){t.ground==n[e].ground&&(n[e].newground=t.newground)}),3==n[e].devtype&&(-1==t.checkList.indexOf(t.$t("LocationIndoor.vehicle"))&&-1==t.checkList.indexOf(t.$t("LocationIndoor.personnel"))||0===t.checkList.length)?a.addAsset(n[e].ground,n[e]):4==n[e].devtype&&(-1==t.checkList.indexOf(t.$t("LocationIndoor.assets"))&&-1==t.checkList.indexOf(t.$t("LocationIndoor.personnel"))||0===t.checkList.length)?a.addTBox(n[e].ground,n[e]):(1!=n[e].devtype&&2!=n[e].devtype||-1!=t.checkList.indexOf(t.$t("LocationIndoor.vehicle"))||-1!=t.checkList.indexOf(t.$t("LocationIndoor.assets")))&&0!==t.checkList.length||a.addMarker(n[e].ground,n[e]))}},d=0;d<n.length;d++){var l=r(d);if("object"===(void 0===l?"undefined":s()(l)))return l.v}}();if("object"===(void 0===n?"undefined":s()(n)))return n.v}},close:function(e){this.websock.close()},websocketerror:function(e){},websocketSend:function(e){this.websock.send(e)},updateSize:function(){this.map&&this.map.updateSize()}},mounted:function(){clearInterval(this.timeOut),this.timeOut=null},beforeMount:function(){var e=this;this.buildingId=Number(this.$route.query.id),this.warningBuildingId=Number(this.$route.query.buildid),this.warningGround=Number(this.$route.query.ground),this.homeGround=Number(this.$route.query.homeground),this.getBuildingByProjectids(),this.getMemberNames(),this.getAssetNames(),this.getTboxSnIds(),this.$route.query.deveui?("true"==this.$route.query.sostype?this.sostype=!0:this.sostype=!1,setTimeout(function(){e.searchInfo(e.$route.query.deveui)},1e3)):this.$route.query.assetDeveui?("true"==this.$route.query.sostype?this.sostype=!0:this.sostype=!1,setTimeout(function(){e.searchInfo("",e.$route.query.assetDeveui)},1e3)):this.$route.query.tboxDeveui?("true"==this.$route.query.sostype?this.sostype=!0:this.sostype=!1,setTimeout(function(){e.searchInfo("","",e.$route.query.tboxDeveui)},1e3)):"true"==this.$route.query.sostype?(this.sostype=!0,setTimeout(function(){e.searchInfo("","","",1)},100)):this.sostype=!1},beforeDestroy:function(){clearInterval(this.timeOut),this.timeOut=null,this.map&&(this.map.setTarget("sss"),this.map=null),this.map3d&&(this.map3d.dispose(),this.map3d=null)},destroyed:function(){this.websock&&this.websock.close(),clearInterval(this.timer),clearInterval(this.dataTimer),this.timer=null,this.dataTimer=null},computed:{show1:function(){return this.$store.state.show}},watch:{show1:function(e){var t=this;setTimeout(function(){t.updateSize()},200)},"$i18n.locale":function(){this.i8n=this.$store.state.i18n},$route:{handler:function(e,t){var a=this;e.query!=t.query&&(this.buildingId=Number(this.$route.query.id),this.getBuildingByProjectids(),this.getMemberNames(),this.getAssetNames(),this.$route.query.deveui?("true"==this.$route.query.sostype?this.sostype=!0:this.sostype=!1,setTimeout(function(){a.searchInfo(a.$route.query.deveui)},100)):this.$route.query.assetDeveui?this.searchInfo("",this.$route.query.assetDeveui):this.$route.query.tboxDeveui?this.searchInfo("","",this.$route.query.tboxDeveui):"true"==this.$route.query.sostype?(this.sostype=!0,setTimeout(function(){a.searchInfo("","","",1)},100)):this.sostype=!1)},deep:!0}}},T={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content",staticStyle:{height:"100%",width:"100%"}},[a("ul",{directives:[{name:"show",rawName:"v-show",value:e.btnShow,expression:"btnShow"}],staticClass:"imags_ul"},[a("li",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("LocationIndoor.search"),placement:"left"}},[a("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"../../../static/search.png"},on:{click:function(t){return e.showSearch()}}})],1)],1),e._v(" "),a("li",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("LocationIndoor.Selectbuilding"),placement:"left"}},[a("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"../../../static/switch.png"},on:{click:function(t){return e.showBuild()}}})],1)],1),e._v(" "),a("li",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("LocationIndoor.Viewdetails"),placement:"left"}},[a("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"../../../static/detail.png"},on:{click:function(t){return e.showGround()}}})],1)],1),e._v(" "),a("li",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.$t("LocationIndoor.Parameterconfiguration"),placement:"left"}},[a("el-image",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"../../../static/edit.png"},on:{click:function(t){return e.showSetting()}}})],1)],1)]),e._v(" "),a("div",{staticClass:"inputContent",staticStyle:{display:"flex","flex-wrap":"wrap"}},[a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[e.searchShow?a("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap","margin-left":"1%"},attrs:{model:e.searchLists}},[a("el-form-item",{staticStyle:{display:"flex","margin-left":"1%","margin-right":"2%"},attrs:{label:e.$t("LocationIndoor.name")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{clearable:"",filterable:"",remote:"","remote-method":e.remoteUserMethod,placeholder:e.$t("LocationIndoor.Pleaseenter")},model:{value:e.perDeveui,callback:function(t){e.perDeveui=t},expression:"perDeveui"}},e._l(e.userOptions,function(t){return a("el-option",{key:t.maplabel,attrs:{label:t.username,value:t.maplabel}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.username))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.maplabel))])])}),1)],1),e._v(" "),a("el-form-item",{staticStyle:{display:"flex","margin-left":"1%","margin-right":"0"},attrs:{label:e.$t("LocationIndoor.asset")}},[a("el-select",{attrs:{clearable:"",filterable:"",remote:"","remote-method":e.remoteAssetMethod,placeholder:e.$t("LocationIndoor.Pleaseenter")},model:{value:e.assetDeveui,callback:function(t){e.assetDeveui=t},expression:"assetDeveui"}},e._l(e.assetOptions,function(t){return a("el-option",{key:t.beaconid,attrs:{label:t.name,value:t.beaconid}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.name))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.beaconid))])])}),1)],1),e._v(" "),1==e.intoProjectType?a("el-form-item",{staticStyle:{display:"flex","margin-left":"1%","margin-right":"2%"},attrs:{label:e.$t("LocationIndoor.carnumber")}},[a("el-select",{attrs:{clearable:"",filterable:"",remote:"","remote-method":e.remoteTBoxMethod,placeholder:e.$t("LocationIndoor.Pleaseenter")},model:{value:e.tboxDeveui,callback:function(t){e.tboxDeveui=t},expression:"tboxDeveui"}},e._l(e.tboxOptions,function(t){return a("el-option",{key:t.maplabel,attrs:{label:t.sn,value:t.maplabel}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.sn))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.maplabel))])])}),1)],1):e._e(),e._v(" "),a("el-form-item",{staticStyle:{display:"flex","margin-left":"1%"}},[a("el-button",{staticClass:"query",attrs:{type:"primary"},on:{click:function(t){return e.searchInfo()}}},[e._v(e._s(e.$t("LocationIndoor.search"))+"\n          ")]),e._v(" "),a("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(t){return e.clearBtn()}}},[e._v(e._s(e.$t("LocationIndoor.reset")))])],1)],1):e._e()],1)],1),e._v(" "),a("div",{class:e.fullscreen?"fullscreen_containers":"containers",staticStyle:{width:"100%",height:"98%"}},[a("div",{staticClass:"float_box"},[e.isAllData?a("div",{staticStyle:{width:"100%"}},[a("dv-decoration-7",{staticStyle:{width:"100%",height:"30px"}},[e._v(e._s(e.$t("LocationIndoor.statistics")))]),e._v(" "),a("dv-border-box-6",{key:e.borderkey},[a("div",{staticClass:"all_num_box"},[a("div",{staticClass:"all_num"},[a("p",[e._v(e._s(e.allPerson))]),e._v(" "),a("p",[e._v(e._s(e.$t("LocationIndoor.Numpeople")))])]),e._v(" "),a("div",{staticClass:"all_num"},[a("p",[e._v(e._s(e.allCar))]),e._v(" "),a("p",[e._v(e._s(e.$t("LocationIndoor.NumCar")))])]),e._v(" "),a("div",{staticClass:"all_num"},[a("p",[e._v(e._s(e.allAsste))]),e._v(" "),a("p",[e._v(e._s(e.$t("LocationIndoor.Numassets")))])])])])],1):e._e(),e._v(" "),a("div",{staticClass:"statistics_box"},[e.isRoleData?a("div",[a("dv-decoration-7",{staticStyle:{width:"100%",height:"30px"}},[e._v(e._s(e.$t("LocationIndoor.RoleStatistics")))]),e._v(" "),a("dv-capsule-chart",{staticClass:"rloe_data",attrs:{config:e.roleData}})],1):e._e(),e._v(" "),e.isDepartmentData?a("div",[a("dv-decoration-7",{staticStyle:{width:"100%",height:"30px","margin-top":"20px"}},[e._v(e._s(e.$t("LocationIndoor.DepartmentStatistics")))]),e._v(" "),a("dv-capsule-chart",{staticClass:"department_data",attrs:{config:e.departmentData}})],1):e._e(),e._v(" "),e.isSosData?a("div",[a("dv-decoration-7",{staticStyle:{width:"100%",height:"30px","margin-top":"20px"}},[e._v(e._s(e.$t("Breadcrumb.AlarmStatistics")))]),e._v(" "),a("dv-active-ring-chart",{staticClass:"sosDatas_data",attrs:{config:e.sosDatas}})],1):e._e()])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.mapTypes,expression:"mapTypes"}],staticClass:"mapConent"},[a("div",{ref:"map",staticClass:"allmap",attrs:{id:"allmap"}},[a("div",{staticStyle:{position:"absolute",bottom:"2%",right:"4px","z-index":"1001"}},[a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[e.settingShow?a("el-checkbox-group",{staticStyle:{display:"flex","flex-direction":"column","align-items":"flex-start"},on:{change:e.changeSetting},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.personnel")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.assets")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.vehicle")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute1")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute5")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute10")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute20")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute30")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.hour")}})],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"selectBuild"},[a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[e.buildShow?a("el-select",{staticStyle:{position:"absolute",right:"0","z-index":"1001"},attrs:{placeholder:"","popper-append-to-body":!1},on:{change:function(t){return e.getGrounds(e.isactive)}},model:{value:e.isactive,callback:function(t){e.isactive=t},expression:"isactive"}},e._l(e.buildings,function(e){return a("el-option",{key:e.id,attrs:{label:e.building,value:e.id}})}),1):e._e()],1)],1),e._v(" "),a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.groundShow,expression:"groundShow"}],staticClass:"statistics",staticStyle:{display:"flex","background-color":"#fff","border-radius":"6px","box-shadow":"1px 1px 3px 1px #b5c6dd",position:"absolute",right:"0",top:"0","z-index":"1000","align-items":"center"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:(e.tableData[0].num>0||e.tableData[1].num>0)&&e.showEcharts,expression:"\n                (tableData[0].num > 0 || tableData[1].num > 0) && showEcharts\n              "}],staticStyle:{width:"100%",height:"100%",display:"flex","flex-wrap":"wrap"}},[a("div",[a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts"}}),e._v(" "),a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts1"}})]),e._v(" "),a("div",[a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts2"}}),e._v(" "),a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts3"}})])]),e._v(" "),a("div",{staticClass:"show_echarts",on:{click:function(t){return e.showEchart()}}},[e._v("\n              "+e._s(e.show_echart)+"\n            ")]),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.groundData,border:"","max-height":"300","cell-class-name":e.selectGrounds,"summary-method":e.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("LocationIndoor.floor"),"min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"devnum",label:e.$t("LocationIndoor.Numpeople"),"min-width":"65"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tboxnum",label:e.$t("LocationIndoor.NumCar"),"min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"assetnum",label:e.$t("LocationIndoor.Numassets"),"min-width":"80"}})],1)],1)])])],1),e._v(" "),a("div",{staticClass:"selectGround",staticStyle:{"z-index":"1"}},[a("div",{staticStyle:{width:"42px","background-color":"white","box-shadow":"rgba(0, 0, 0, 0.3) 2px 2px 3px","border-radius":"2px"}},[a("div",{staticClass:"fm-layer-list",staticStyle:{overflow:"hidden"}},e._l(e.grounds,function(t,i){return a("div",{key:t,class:e.isactiveGround==t?"addclass":"",on:{click:function(a){return e.getBuildGroundLists(t)}}},[a("label",{staticStyle:{display:"inline-block","text-align":"center",width:"42px",height:"42px","line-height":"42px",margin:"0px",cursor:"pointer","font-size":"0.8em","font-weight":"bold",color:"rgb(102, 102, 102)"},attrs:{"data-gid":"2",id:"gid_24.99322021/3/1/11:04:43"}},[t>0?a("span",[e._v("F"+e._s(t))]):e._e(),e._v(" "),t<0?a("span",[e._v("B"+e._s(-t))]):e._e()]),e._v(" "),a("hr",{directives:[{name:"show",rawName:"v-show",value:e.grounds.length>1&&i!==e.grounds.length-1,expression:"grounds.length > 1 && index !== grounds.length - 1"}],staticStyle:{height:"1px","border-top":"1px solid rgba(153, 153, 153, 0.45)","border-right":"none","border-bottom":"none","border-left":"none","border-image":"initial",width:"60%",margin:"0px 20%"}})])}),0)])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.mapTypes,expression:"!mapTypes"}],staticClass:"mapConentD"},[a("div",{staticClass:"fengMap",attrs:{id:"fengMap"}},[a("div",{staticStyle:{position:"absolute",bottom:"10%",right:"2%","z-index":"1001"}},[a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[e.settingShow?a("el-checkbox-group",{staticStyle:{display:"flex","flex-direction":"column","align-items":"flex-start"},on:{change:e.changeSetting},model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.personnel")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.assets")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.vehicle")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute1")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute5")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute10")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute20")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.minute30")}}),e._v(" "),a("el-checkbox",{staticStyle:{"margin-left":"0"},attrs:{label:e.$t("LocationIndoor.hour")}})],1):e._e()],1)],1),e._v(" "),a("div",{staticClass:"selectBuild selectBuild3d"},[a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[e.buildShow?a("el-select",{staticStyle:{position:"absolute",right:"0","z-index":"1001"},attrs:{placeholder:"","popper-append-to-body":!1},on:{change:function(t){return e.getGrounds(e.isactive)}},model:{value:e.isactive,callback:function(t){e.isactive=t},expression:"isactive"}},e._l(e.buildings,function(e){return a("el-option",{key:e.building,attrs:{label:e.building,value:e.id}})}),1):e._e()],1)],1),e._v(" "),a("transition",{attrs:{css:!1},on:{"before-enter":e.beforeEnter,enter:e.enter,leave:e.leave}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.groundShow,expression:"groundShow"}],staticClass:"statistics statistics3d"},[a("div",{directives:[{name:"show",rawName:"v-show",value:(e.tableData[0].num>0||e.tableData[1].num>0)&&e.showEcharts,expression:"\n                (tableData[0].num > 0 || tableData[1].num > 0) && showEcharts\n              "}],staticStyle:{width:"100%",height:"100%",display:"flex","flex-wrap":"wrap"}},[a("div",[a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts_3D"}}),e._v(" "),a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts1_3D"}})]),e._v(" "),a("div",[a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts2_3D"}}),e._v(" "),a("div",{staticStyle:{width:"220px",height:"220px"},attrs:{id:"echarts3_3D"}})])]),e._v(" "),"yvi0xfwr"!=e.tenantid_A?a("div",{staticClass:"show_echarts",on:{click:function(t){return e.showEchart()}}},[e._v("\n              "+e._s(e.show_echart)+"\n            ")]):e._e(),e._v(" "),a("div",[a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.groundData,border:"","max-height":"500","cell-class-name":e.selectGrounds,"summary-method":e.getSummaries,"show-summary":""}},[a("el-table-column",{attrs:{prop:"name",label:e.$t("LocationIndoor.floor"),"min-width":"80"}}),e._v(" "),a("el-table-column",{attrs:{prop:"devnum",label:e.$t("LocationIndoor.Numpeople"),"min-width":"70"}}),e._v(" "),"yvi0xfwr"!=e.tenantid_A?a("el-table-column",{attrs:{prop:"tboxnum",label:e.$t("LocationIndoor.NumCar"),"min-width":"60"}}):e._e(),e._v(" "),"yvi0xfwr"!=e.tenantid_A?a("el-table-column",{attrs:{prop:"assetnum",label:e.$t("LocationIndoor.Numassets"),"min-width":"50"}}):e._e()],1)],1)])])],1),e._v(" "),a("p",{staticStyle:{position:"absolute",top:"94.5%","text-align":"left",color:"white","z-index":"11"}},[e._v("\n        "+e._s(e.$t("LocationIndoor.tet"))+"\n      ")])])]),e._v(" "),a("el-dialog",{staticClass:"Info_dialog",attrs:{visible:e.visible,width:e.showBracelet?"25%":"20%",modal:!1},on:{"update:visible":function(t){e.visible=t}}},[a("div",{staticClass:"ol-popups",attrs:{id:"popups"}},[a("div",{attrs:{id:"popup-contents"}},[a("ul",{directives:[{name:"show",rawName:"v-show",value:e.devPer,expression:"devPer"}],staticClass:"container"},[a("div",{staticClass:"left-top"},[a("el-image",{staticStyle:{width:"100%",height:"auto"},attrs:{src:e.imagePer}})],1),e._v(" "),a("div",{staticClass:"right-top"},[a("li",{staticClass:"goDev"},[e._v("\n              "+e._s(e.$t("locationoutdoor.name"))+"\n              "),a("a",{on:{click:function(t){return e.goStaff(e.username)}}},[e._v(e._s(e.username))])]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.age"))+e._s(e.age))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.sex"))+e._s(e.sexstr))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.worktype"))+e._s(e.worktype))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.department"))+e._s(e.depart))])],1),e._v(" "),e.showBracelet?a("div",{staticClass:"bottom"},[a("el-divider",{staticClass:"divider"}),e._v(" "),a("p",{staticClass:"bracelet_title"},[e._v("\n              "+e._s(e.$t("LocationIndoor.equipmentInfo"))+"\n            ")]),e._v(" "),a("li",{staticClass:"goDev bracelet_dev"},[a("span",[e._v(e._s(e.$t("terminal.deveui"))+"\n                "),a("a",{on:{click:function(t){return e.goDevs(e.maplabel)}}},[e._v(e._s(e.maplabel))])]),e._v(" "),e.battery?a("span",[e._v(e._s(e.$t("locationoutdoor.electricity"))+e._s(e.battery)+"%")]):e._e()]),e._v(" "),a("li",[e._v(e._s(e.$t("terminal.Locationupdatetime1"))+e._s(e.gpstime))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("p",{staticClass:"bracelet_title"},[e._v("\n              "+e._s(e.$t("LocationIndoor.braceletData"))+"\n            ")]),e._v(" "),a("li",{staticClass:"bracelet_dev"},[a("span",[e._v(e._s(e.$t("terminal.deveui"))+" "+e._s(e.bracelet_eui))]),e._v(" "),a("span",[e._v(e._s(e.$t("locationoutdoor.electricity"))+e._s(e.bracelet_soc)+"%")])]),e._v(" "),a("li",{staticClass:"bracelet_dev"},[a("span",[e._v(e._s(e.$t("LocationIndoor.heartRate"))+e._s(e.bracelet_rate))]),e._v(" "),a("span",[e._v(e._s(e.$t("LocationIndoor.temperature"))+e._s(e.bracelet_tem)+" °C")]),e._v(" "),a("span",[e._v(e._s(e.$t("LocationIndoor.oxygen"))+e._s(e.bracelet_oxygen))])]),e._v(" "),a("li",[e._v(e._s(e.$t("home.Dataupdatetime"))+e._s(e.bracelet_time))])],1):a("div",{staticClass:"bottom"},[a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.telephone"))+e._s(e.tel))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.cardno"))+e._s(e.cardno))]),e._v(" "),e.battery?a("el-divider",{staticClass:"divider"}):e._e(),e._v(" "),e.battery?a("li",[e._v("\n              "+e._s(e.$t("locationoutdoor.electricity"))+e._s(e.battery)+" %\n            ")]):e._e(),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",{staticClass:"goDev"},[e._v("\n              "+e._s(e.$t("terminal.deveui"))+"\n              "),a("a",{on:{click:function(t){return e.goDevs(e.maplabel)}}},[e._v(e._s(e.maplabel))])]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("terminal.Locationupdatetime1"))+e._s(e.gpstime))])],1)]),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:e.devAsset,expression:"devAsset"}],staticClass:"container"},[a("div",{staticClass:"left-top"},[a("el-image",{staticStyle:{width:"100%",height:"auto"},attrs:{src:e.imageAsset}})],1),e._v(" "),a("div",{staticClass:"right-top"},[a("li",[e._v(e._s(e.$t("locationoutdoor.AssetName"))+e._s(e.assetName))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.Assettype"))+e._s(e.assetType))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.Assetmodel"))+e._s(e.assetModel))])],1),e._v(" "),a("div",{staticClass:"bottom"},[a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",{staticClass:"goDev"},[e._v("\n              "+e._s(e.$t("LocationIndoor.TagNo"))),a("a",{on:{click:function(t){return e.goBeacons(e.assetBeaconid)}}},[e._v(e._s(e.assetBeaconid))])]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.Department"))+e._s(e.assetDepart))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.User"))+e._s(e.assetUser))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("locationoutdoor.Time"))+e._s(e.assetTime))])],1)]),e._v(" "),a("ul",{directives:[{name:"show",rawName:"v-show",value:e.devTBox,expression:"devTBox"}]},[a("el-image",{staticStyle:{width:"150px",height:"150px"},attrs:{src:e.imageTBox}}),e._v(" "),a("li",[e._v(e._s(e.$t("LocationIndoor.carnumber"))+e._s(e.tboxName))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("LocationIndoor.Vehicletype"))+e._s(e.tboxType))]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",{staticClass:"goDev"},[e._v("\n            "+e._s(e.$t("LocationIndoor.TagNo"))),a("a",{on:{click:function(t){return e.goDevs(e.tboxMaplabel)}}},[e._v(e._s(e.tboxMaplabel))])]),e._v(" "),a("el-divider",{staticClass:"divider"}),e._v(" "),a("li",[e._v(e._s(e.$t("LocationIndoor.Time"))+e._s(e.tboxTime))]),e._v(" "),a("el-divider",{staticClass:"divider"})],1)])])])],1)},staticRenderFns:[]};var O=a("VU/8")(C,T,!1,function(e){a("Mfxl")},"data-v-3ec4519a",null);t.default=O.exports}});
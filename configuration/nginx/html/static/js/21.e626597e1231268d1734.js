webpackJsonp([21],{DTya:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("5qI+"),i=n.n(s),r=(n("j5PW"),n("C7iZ"),n("qONO"),n("3zDK"),n("ETc7")),l=n("c2Ch"),o={components:{Fullscreen:r.a},name:"LocationIndoor3D",data:function(){return{contrForPrionum:this.$store.state.userInfo.prionum,intoProjectName:this.$store.state.intoProjectName,intoProjectid:this.$store.state.intoProjectid,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,intoProjectType:this.$store.state.intoProjectType,searchList:{},fullscreen:!1,isactive:"",buildings:"",changemap:!0,map:null,fmapId:"",scrollFloorControl:"",layer:null,setNewMarker:!0,popMarker:null,popMarkerList:[],uuid:1}},methods:{toggle:function(){this.$refs.fullscreen.toggle()},fullscreenChange:function(e){this.fullscreen=e},getGroundLists:function(e){this.map&&(this.map.dispose(),this.map=null,this.changemap?this.fmapId="1377110180142047234":this.fmapId="1375048284114743298",this.changemap=!this.changemap,this.onmap())},getBuildingByProjectids:function(){var e=this,t={tenantid:this.$store.state.intoProjectTenantid,projectid:this.$store.state.intoProjectid};Object(l._26)(t,this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){1001==t.code&&(e.buildings=t.data,e.fmapId="1375048284114743298",e.onmap())})},onmap:function(){var e=this,t={container:document.getElementById("fengMap"),focusAlphaMode:!0,focusAlpha:.1,appName:"地图测试",key:"5c73116e8ab887fb99cf42bf0541407f",defaultControlsPose:0,modelSelectedEffect:!1,defaultViewMode:i.a.FMViewMode.MODE_2D};this.map=new i.a.FMMap(t),this.map.openMapById(this.fmapId,function(e){}),this.map.on("loadComplete",function(){e.loadScrollFloorCtrl()}),this.map.on("focusGroundIDChanged",function(){}),this.map.on("mapClickNode",function(t){if(t.nodeType,31==t.nodeType)e.setNewMarker=!1,e.addPopInfoWindow(t.target);else if(4==t.nodeType){var n=t.domEvent.button;if(0===n){if(e.$message({message:t.mapCoord,type:"warning"}),e.setNewMarker){var s={mapCoord:{coord2:e.map.getRotationCoord(t.eventInfo.coord.x,t.eventInfo.coord.y)},groupID:e.map.focusGroupID,uuida:123};e.addMarker(s)}}else 2===n&&e.$message({message:this.$t("tet.Rightclick"),type:"warning"})}})},addMarker:function(e){var t=e.mapCoord.coord2,n=this.map.getFMGroup(e.groupID);this.layer=n.getOrCreateLayer("imageMarker");var s=new i.a.FMImageMarker({x:t.x,y:t.y,height:2,url:"../../../static/sos.png",size:32,callback:function(){s.avoid(!1),s.alwaysShow()}});s.selfAttr={deveui:123,appkey:1231231231,ten:1232131231,uuid:this.uuid},this.layer.addMarker(s),this.uuid+=1},addPopInfoWindow:function(e){var t=this;if(e){var n={width:200,height:100,content:" <div style='text-align:left'>\n          <p>deveui: "+e.selfAttr.deveui+"   </p>\n          <p>appkey: "+e.selfAttr.appkey+"   </p>\n          <p>ten: "+e.selfAttr.ten+"   </p>\n          <p>uuid: "+e.selfAttr.uuid+"   </p>\n          </div>",closeCallBack:function(e){t.setNewMarker=!0;for(var n=0;n<t.popMarkerList.length;n++)e.marker.selfAttr.uuid==t.popMarkerList[n].marker.selfAttr.uuid&&t.popMarkerList.splice(n,1)}};this.popMarker=new i.a.FMPopInfoWindow(this.map,n,e),this.popMarkerList.push(this.popMarker)}},loadScrollFloorCtrl:function(){var e=this,t={position:i.a.FMControlPosition.RIGHT_TOP,allLayer:!1,needAllLayerBtn:!1,offset:{x:-20,y:20}};this.scrollFloorControl=new i.a.FMScrollGroupsControl(this.map,t),this.scrollFloorControl.onChange(function(t,n){e.map.viewMode=i.a.FMViewMode.MODE_3D;for(var s=e.popMarkerList.length-1;s>-1;s--)e.popMarkerList[s].close();e.popMarkerList=[]})}},beforeMount:function(){this.getBuildingByProjectids()}},a={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("div",{staticClass:"inputContent"},[n("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap","margin-left":"1%"},attrs:{model:e.searchList}},[n("el-form-item",{staticStyle:{display:"flex","margin-left":"1%","margin-right":"2%"},attrs:{label:e.$t("staffmanagement.username1")}})],1)],1),e._v(" "),n("fullscreen",{ref:"fullscreen",on:{change:e.fullscreenChange}},[n("div",{class:e.fullscreen?"fullscreen_containers":"containers"},[n("div",{staticClass:"selectBuildGround"},[n("div",{staticClass:"selectBuild"},[n("el-select",{staticStyle:{width:"180px"},attrs:{"popper-append-to-body":!1,placeholder:e.$t("terminal.choose")},on:{change:function(t){return e.getGroundLists(e.isactive)}},model:{value:e.isactive,callback:function(t){e.isactive=t},expression:"isactive"}},e._l(e.buildings,function(e){return n("el-option",{key:e.id,attrs:{label:e.building,value:e.id}})}),1)],1)]),e._v(" "),n("div",{staticClass:"mapContent"})])]),e._v(" "),n("div",{attrs:{id:"fengMap"}})],1)},staticRenderFns:[]};var c=n("VU/8")(o,a,!1,function(e){n("ztMt")},"data-v-2d9645f9",null);t.default=c.exports},ETc7:function(e,t,n){"use strict";function s(){return!!(document.fullscreen||document.mozFullScreen||document.fullscreenElement||document.msFullscreenElement||document.webkitIsFullScreen)}var i={props:{exitOnClickWrapper:{type:Boolean,default:!0},background:{type:String,default:"#333"},fullscreenClass:{type:String,default:"fullscreen"},fullscreen:{type:Boolean,default:!1},pageOnly:{type:Boolean,default:!1}},data:function(){return{support:!1,isFullscreen:!1}},computed:{isPageOnly:function(){return this.pageOnly||!this.support},wrapperClass:function(){var e=[];return this.isFullscreen&&e.push(this.fullscreenClass),e},wrapperStyle:function(){var e={};return this.isFullscreen&&(e={background:this.background,"overflow-y":"auto",width:"100%",height:"100%"},this.isPageOnly&&(e.position="fixed !important",e["z-index"]="100000 !important",e.left="0",e.top="0",e.width="100% !important",e.height="100% !important")),e}},methods:{toggle:function(e){void 0===e?this.getState()?this.exit():this.enter():e?this.enter():this.exit()},enter:function(){var e,t;this.isPageOnly?(this.isFullscreen=!0,this.onChangeFullScreen()):(t=this.fullScreenCallback,document.addEventListener("fullscreenchange",t),document.addEventListener("mozfullscreenchange",t),document.addEventListener("MSFullscreenChange",t),document.addEventListener("webkitfullscreenchange",t),(e=this.$el).requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen())},exit:function(){this.getState()&&(this.isPageOnly?(this.isFullscreen=!1,this.onChangeFullScreen()):document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())},getState:function(){return this.isPageOnly?this.isFullscreen:s()},shadeClick:function(e){e.target===this.$el&&this.exitOnClickWrapper&&this.exit()},fullScreenCallback:function(){var e;this.isFullscreen=s(),this.isFullscreen||(e=this.fullScreenCallback,document.removeEventListener("fullscreenchange",e),document.removeEventListener("mozfullscreenchange",e),document.removeEventListener("MSFullscreenChange",e),document.removeEventListener("webkitfullscreenchange",e)),this.onChangeFullScreen()},onChangeFullScreen:function(){this.$emit("change",this.isFullscreen),this.$emit("update:fullscreen",this.isFullscreen)}},watch:{fullscreen:function(e){e!==s()&&(e?this.enter():this.exit())}},created:function(){this.support=function(){const e=document.documentElement;return"requestFullscreen"in e||"mozRequestFullScreen"in e&&document.mozFullScreenEnabled||"msRequestFullscreen"in e&&document.msFullscreenEnabled||"webkitRequestFullScreen"in e}()}},r={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.wrapperClass,style:e.wrapperStyle,on:{click:function(t){return e.shadeClick(t)}}},[e._t("default")],2)},staticRenderFns:[]},l=n("VU/8")(i,r,!1,null,null,null);t.a=l.exports},ztMt:function(e,t){}});
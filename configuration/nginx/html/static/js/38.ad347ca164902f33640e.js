webpackJsonp([38],{"0vCG":function(t,e){},iQFe:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),s=a.n(i),r=a("mvHQ"),n=a.n(r),o=a("3zDK"),l=a("PO8r"),d=a("nQqC"),u=a("c2Ch"),c=a("c+aE"),h={components:{Menu:l.a,basecard:d.a,System:c.a},Systemname:"UserOrder",data:function(){return{i8n:this.$store.state.i18n,tenantid_A:this.$store.state.userInfo.tenantid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,delprio:this.$store.state.userInfo.delprio,contrForPrionum:this.$store.state.userInfo.prionum,tableData:[],orderData:[],tenantidData:[],pageCount:20,searchList:{type:"",superid:this.$store.state.userInfo.tenantid,tenantid:"",priority:"",status:"",beginstatus:"1",page:1,count:20,upgrade:""},currentPage1:1,total:0,editdataForFile:{},editfilePath:o.a.host+"user/updateQuestionMapFile",editfileData:"",editfileList:[],uploadData:"",uploadeditData:"",addRules:{},haveFile:!1,edit:!1,editData:{id:"",title:"",type:"",priority:"",details:"",status:"",filename:[]},questionTypeList:[{index:1,value:this.$t("myorderde.Loginregistration")},{index:2,value:this.$t("myorderde.devicemanagement")},{index:6,value:this.$t("myorderde.alarmmanagement")},{index:7,value:this.$t("myorderde.Employeemanagement")},{index:8,value:this.$t("myorderde.assetmanagement")},{index:9,value:this.$t("myorderde.Locationmanagement")},{index:10,value:this.$t("myorderde.PersonalCenter")},{index:11,value:this.$t("myorderde.other")}],priorityList:[{index:1,value:this.$t("myorderde.important")},{index:2,value:this.$t("myorderde.commonly")}],statusList:[{index:2,value:this.$t("myorderde.Pending")},{index:3,value:this.$t("myorderde.Processing")},{index:4,value:this.$t("myorderde.Processed")},{index:5,value:this.$t("myorderde.Closed")}],editstatusList:[{index:3,value:this.$t("myorderde.Processing")},{index:4,value:this.$t("myorderde.Processed")}],deleBtnDis:!1,deleId:"",filename:"",del:!1,delData:[],multipleSelection:[]}},methods:{handleCurrentChange:function(t){this.searchList.page=t,this.searchList.count=this.pageCount,this.getQuestions()},handleSizeChange:function(t){this.pageCount=t,this.searchList.count=t,this.searchList.page=1,this.currentPage1=1,this.getQuestions()},datetimecut:function(t){if(!t)return"-";function e(t){return t>9?t:"0"+t}var a=new Date(t);return a.getFullYear()+"-"+e(a.getMonth()+1)+"-"+e(a.getDate())+" "+(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds())},formatDate:function(t,e){if(null==t.creatime||0==t.creatime)return"";var a=new Date(1e3*parseInt(t.creatime)).toUTCString();return this.datetimecut(a)},formatDataLast:function(t,e){if(null==t.lastime||0==t.creatime)return"";var a=new Date(1e3*parseInt(t.lastime));return a.getFullYear()+"-"+(a.getMonth()+1<10?"0"+(a.getMonth()+1)+"-":a.getMonth()+1+"-")+(a.getDate()<10?"0"+a.getDate()+" ":a.getDate()+" ")+(a.getHours()<10?"0"+a.getHours()+":":a.getHours()+":")+(a.getMinutes()<10?"0"+a.getMinutes()+":":a.getMinutes()+":")+(a.getSeconds()<10?"0"+a.getSeconds():a.getSeconds())},handleSelectionChange:function(t){this.multipleSelection=t},getQuestions:function(){var t=this;Object(u._83)(t.searchList,t.tenantkey_A,t.tenantid_A,t.userName).then(function(e){1001==e.code&&(t.orderData=e.data.list,t.total=e.data.size)})},searchInfo:function(){var t=this,e=this;this.searchList.page=1,this.currentPage1=1,Object(u._83)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(a){1001==a.code&&(e.orderData=a.data.list,e.total=a.data.size,a.data.list.length>0?e.$message({message:e.$t("downlink.searchsuccess"),type:"success"}):e.$message({message:e.$t("downlink.nodata"),type:"success"})),t.searchList.count=20})},clearBtn:function(){3==this.$store.state.userInfo.prionum||4==this.$store.state.userInfo.prionum?this.searchList={type:"",superid:this.$store.state.userInfo.tenantid,tenantid:"",priority:"",status:"",page:1,count:20,beginstatus:"1",upgrade:""}:1!=this.$store.state.userInfo.prionum&&2!=this.$store.state.userInfo.prionum||(this.searchList={type:"",superid:"",tenantid:"",priority:"",status:"",page:1,count:20,beginstatus:"1",upgrade:"1"}),this.currentPage1=1,this.getQuestions()},edithandleRemove:function(t,e){this.editfileList=e;for(var a=[],i=0;i<e.length;i++)a.push(e[i].name);var s={delname:t.name,id:this.editData.id,filename:a.toString()};Object(u.O)(n()(s),this.tenantkey_A,this.tenantid_A,this.userName).then(function(t){}),0==e.length?this.haveFile=!1:this.haveFile=!0},edithandlePreview:function(t){var e=document.createElement("a");e.setAttribute("download",t.name),e.setAttribute("target","_blank"),e.setAttribute("href",t.url);var a=new MouseEvent("click");e.dispatchEvent(a)},detailhandlePreview:function(t){var e=document.createElement("a");e.setAttribute("download",t.name),e.setAttribute("target","_blank"),e.setAttribute("href",t.url);var a=new MouseEvent("click");e.dispatchEvent(a)},edithandleChange:function(t,e){this.editfileList=e,e.length>0&&(this.haveFile=!0)},editFileSuccess:function(t,e,a){this.$refs.uploads.clearFiles()},delOrder:function(t){var e=this;5==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio||4==this.$store.state.userInfo.prionum&&2==this.$store.state.userInfo.delprio?this.$message({message:this.$t("warning.permissiondelete"),type:"warning"}):5==this.orderData[t].status?this.$confirm(this.$t("myorderde.deletethejob"),this.$t("Building.tips"),{confirmButtonText:this.$t("terminal.confirm"),cancelButtonText:this.$t("terminal.cancel"),type:"warning"}).then(function(){e.deleId=e.orderData[t].id,e.filename=e.orderData[t].filename,e.deleTrue()}):this.$message({message:this.$t("companyorder.tet1"),type:"warning"})},deleTrue:function(){var t=this,e={id:this.deleId,filename:this.filename},a=this;Object(u.Y)(n()(e),this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?(t.getQuestions(),a.$message({message:a.$t("downlink.deletesuccess"),type:"success"})):a.$message({message:"zh"==a.$store.state.i18n?e.msg:e.enMsg,type:"error"})})},editTer:function(t){if(3!=this.contrForPrionum&&4!=this.contrForPrionum||1!=this.orderData[t].upgrade)if(1!=this.contrForPrionum&&2!=this.contrForPrionum){if(this.editfileList=[],this.haveFile=!1,this.orderData[t].filename)for(var e=this.orderData[t].filename.split(","),a=0;a<e.length;a++)this.editfileList.push({url:o.a.host+"question/"+e[a],name:e[a]});this.editData.id=this.orderData[t].id,this.editData.title=this.orderData[t].title,this.editData.type=this.orderData[t].type,this.editData.priority=this.orderData[t].priority,this.editData.details=this.orderData[t].details,this.editData.filename=[],2==this.orderData[t].status?this.editstatusList=[{index:3,value:this.$t("myorderde.Processing")},{index:4,value:this.$t("myorderde.Processed")}]:3==this.orderData[t].status?this.editstatusList=[{index:4,value:this.$t("myorderde.Processed")}]:4==this.orderData[t].status&&(this.editstatusList=[{index:5,value:this.$t("floormanagement.close")}]),this.edit=!0}else this.$message({message:this.$t("companyorder.tet3"),type:"warning"});else this.$message({message:this.$t("companyorder.tet2"),type:"warning"})},editTrue:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var a={id:e.editData.id,status:e.editData.status};Object(u._185)(a,e.tenantkey_A,e.tenantid_A,e.userName).then(function(t){1001==t.code?(e.$message({message:e.$t("mapmanagement.Submittedsuccessfully"),type:"success"}),e.getQuestions()):e.$message({message:"zh"==e.$store.state.i18n?t.msg:t.enMsg,type:"error"}),e.edit=!1})}})},edituploadFile:function(t){this.editfileData.append("file",t.file)},editsubmitUpload:function(){var t=this,e=this;this.uploadeditData.fileData;this.editfileData=new FormData,this.$refs.uploads.submit(),this.editfileData.append("id",this.editData.id),this.editfileData.append("title",this.editData.title),this.editfileData.append("type",this.editData.type),this.editfileData.append("priority",this.editData.priority),this.editfileData.append("details",this.editData.details),this.editfileData.append("status",this.editData.status),this.editfileData.append("filename",this.editData.filename),this.$axios({method:"POST",url:"v1/user/updateQuestionMapFile",headers:{"Content-Type":"multipart/form-data"},data:this.editfileData}).then(function(a){1001==a.data.code?(e.$message({message:t.$t("mapmanagement.Submittedsuccessfully"),type:"success"}),e.getQuestions()):e.$message({message:a.data.msg,type:"error"}),e.edit=!1})},orderDetail:function(t){this.$router.push({path:"/orderdetails",query:{orderId:this.orderData[t].id,userorder:!0}})},getCustomerNames:function(){var t=this,e={superid:this.$store.state.userInfo.tenantid,beginlevel:2,endlevel:4};Object(u._33)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){t.tenantidData=e.data})}},beforeMount:function(){3==this.$store.state.userInfo.prionum||4==this.$store.state.userInfo.prionum?this.searchList={type:"",superid:this.$store.state.userInfo.tenantid,tenantid:"",priority:"",status:"",page:1,count:20,beginstatus:"1",upgrade:""}:1!=this.$store.state.userInfo.prionum&&2!=this.$store.state.userInfo.prionum||(this.searchList={type:"",superid:"",tenantid:"",priority:"",status:"",page:1,count:20,beginstatus:"1",upgrade:"1"}),this.getCustomerNames(),this.getQuestions()},watch:{"$i18n.locale":function(){this.i8n=this.$store.state.i18n,s()(this.$data.addRules,this.$options.data.call(this).addRules),s()(this.$data.questionTypeList,this.$options.data.call(this).questionTypeList),s()(this.$data.priorityList,this.$options.data.call(this).priorityList),s()(this.$data.statusList,this.$options.data.call(this).statusList),s()(this.$data.editstatusList,this.$options.data.call(this).editstatusList)}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:5!=t.contrForPrionum?"home":"",staticStyle:{height:"100%"}},[i("div",{staticClass:"menu_header"},[i("Menu")],1),t._v(" "),i("div",{staticClass:"content"},[i("el-container",{staticClass:"asi"},[i("el-aside",[i("System")],1),t._v(" "),i("el-main",[i("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap"},attrs:{model:t.searchList}},[i("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("myorder.questioncategory")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.searchList.type,callback:function(e){t.$set(t.searchList,"type",e)},expression:"searchList.type"}},t._l(t.questionTypeList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"1%","margin-right":"0"},attrs:{label:t.$t("myorder.priority")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.searchList.priority,callback:function(e){t.$set(t.searchList,"priority",e)},expression:"searchList.priority"}},t._l(t.priorityList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"1%","margin-right":"0"},attrs:{label:t.$t("myorder.Workorderstatus")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.searchList.status,callback:function(e){t.$set(t.searchList,"status",e)},expression:"searchList.status"}},t._l(t.statusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-form-item",{staticStyle:{display:"flex",width:"15%","margin-left":"1%","margin-right":"0"},attrs:{label:t.$t("companymanagement.company")}},[i("el-select",{staticStyle:{width:"95%",float:"left"},attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.searchList.tenantid,callback:function(e){t.$set(t.searchList,"tenantid",e)},expression:"searchList.tenantid"}},t._l(t.tenantidData,function(t){return i("el-option",{key:t.tenantid,attrs:{label:t.username,value:t.tenantid}})}),1)],1):t._e(),t._v(" "),i("el-form-item",{staticStyle:{"margin-left":"2%"}},[i("el-button",{staticClass:"query",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("heartbeat.search")))]),t._v(" "),i("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("heartbeat.reset")))])],1)],1),t._v(" "),i("div",{staticClass:"content_user"},[i("el-table",{ref:"multipleTable",staticStyle:{width:"98%","text-align":"center","margin-left":"2%"},attrs:{data:t.orderData,"max-height":"660",border:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{property:"id",label:t.$t("myorder.workordernumber"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"zh"==t.i8n?"typestr":"entype",label:t.$t("myorder.questioncategory1"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"title",label:t.$t("myorder.title"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"zh"==t.i8n?"prioritystr":"enpriority",label:t.$t("myorder.priority1"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"customername",label:t.$t("myorderde.company"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"creatime",label:t.$t("myorder.submissiontime"),"show-overflow-tooltip":"",align:"center",formatter:t.formatDate}}),t._v(" "),i("el-table-column",{attrs:{property:"zh"==t.i8n?"statustr":"enstatus",label:t.$t("companyorder.state"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{property:"lastime",label:t.$t("companyorder.Replytime"),"show-overflow-tooltip":"",align:"center",formatter:t.formatDataLast}}),t._v(" "),i("el-table-column",{attrs:{label:t.$t("downlink.operate"),"min-width":"100",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("myorder.Details"),placement:"top"}},[i("el-button",{staticClass:"icon_button",attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.orderDetail(e.$index,t.tableData)}}},[i("img",{attrs:{src:a("rwQA")}})])],1),t._v(" "),3==t.contrForPrionum||4==t.contrForPrionum?i("el-dropdown",{staticClass:"operation",attrs:{szie:"mini",type:"primary",trigger:"click"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("staff.operate"),placement:"top"}},[i("el-button",{staticClass:"icon_button",attrs:{type:"primary"}},[i("img",{attrs:{src:a("VJ6t")}})])],1),t._v(" "),i("el-dropdown-menu",{staticClass:"selects",staticStyle:{"background-color":"rgb(219, 222, 231)"},attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{staticStyle:{"margin-top":"4%","background-color":"rgb(219, 222, 231)"}},[2==e.row.status||3==e.row.status||4==e.row.status?i("el-button",{staticClass:"edits",attrs:{size:"mini"},on:{click:function(a){return t.editTer(e.$index,t.tableData)}}},[t._v(t._s(t.$t("companyorder.handle")))]):t._e()],1),t._v(" "),i("el-dropdown-item",{staticStyle:{"margin-top":"4%","background-color":"rgb(219, 222, 231)"}},[i("el-button",{staticClass:"dels1",attrs:{size:"mini"},on:{click:function(a){return t.delOrder(e.$index,t.tableData)}}},[t._v(t._s(t.$t("downlink.delete")))])],1)],1)],1):t._e()]}}])})],1),t._v(" "),i("div",{staticClass:"block",staticStyle:{"text-align":"center",width:"100%","margin-top":"1%"}},[i("el-pagination",{attrs:{"current-page":t.currentPage1,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-size":20},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})],1)],1),t._v(" "),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:t.$t("companyorder.Processworkorder"),width:"30%",visible:t.edit},on:{"update:visible":function(e){t.edit=e}}},[i("el-form",{ref:"editData",staticClass:"order_detail_form",staticStyle:{"text-align":"left"},attrs:{model:t.editData,"label-width":"120px",rules:t.addRules}},[i("el-form-item",{attrs:{label:t.$t("myorder.Tickettitle")}},[i("el-input",{attrs:{disabled:""},model:{value:t.editData.title,callback:function(e){t.$set(t.editData,"title",e)},expression:"editData.title"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("myorder.Tickettitle")}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.editData.type,callback:function(e){t.$set(t.editData,"type",e)},expression:"editData.type"}},t._l(t.questionTypeList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("myorder.priority")}},[i("el-select",{attrs:{clearable:"",filterable:"",disabled:"",placeholder:t.$t("terminal.choose")},model:{value:t.editData.priority,callback:function(e){t.$set(t.editData,"priority",e)},expression:"editData.priority"}},t._l(t.priorityList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("myorder.ProblemDescription")}},[i("el-input",{attrs:{type:"textarea",maxlength:"255","show-word-limit":"",disabled:""},model:{value:t.editData.details,callback:function(e){t.$set(t.editData,"details",e)},expression:"editData.details"}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("myorder.Appendix")}},[i("el-upload",{ref:"uploads",staticClass:"upload-demo",attrs:{action:t.editfilePath,data:t.editdataForFile,"on-remove":t.edithandleRemove,"file-list":t.editfileList,"on-change":t.edithandleChange,"http-request":t.edituploadFile,"auto-upload":!1,limit:5,"on-success":t.editFileSuccess,disabled:""}})],1),t._v(" "),i("el-form-item",{attrs:{label:t.$t("myorder.Workorderstatus")}},[i("el-select",{attrs:{clearable:"",filterable:"",placeholder:t.$t("terminal.choose")},model:{value:t.editData.status,callback:function(e){t.$set(t.editData,"status",e)},expression:"editData.status"}},t._l(t.editstatusList,function(t){return i("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.edit=!1}}},[t._v(t._s(t.$t("terminal.cancel")))]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editTrue("editData")}}},[t._v("\n              "+t._s(t.$t("terminal.confirm")))])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var p=a("VU/8")(h,m,!1,function(t){a("0vCG")},"data-v-52310fe6",null);e.default=p.exports}});
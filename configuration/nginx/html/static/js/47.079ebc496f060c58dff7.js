webpackJsonp([47],{kS9O:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),s=a.n(i),n=(a("3zDK"),a("PO8r")),r=a("nQqC"),o=a("Rj4H"),l=a("c2Ch"),c=a("s0MJ"),h={components:{Menu:n.a,basecard:r.a,Asset:o.a},name:"CheckWork",data:function(){return{i8n:this.$store.state.i18n,pickerOptions:{shortcuts:[{text:this.$t("terminal.pickeroptions4"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.setHours(0,0,0,0)),t.$emit("pick",[a,e])}},{text:this.$t("terminal.pickeroptions5"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.setHours(0,0,0,0)-1728e5),t.$emit("pick",[a,e])}},{text:this.$t("terminal.pickeroptions6"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.setHours(0,0,0,0)-5184e5),t.$emit("pick",[a,e])}}]},projectid:this.$store.state.intoProjectid,tenantkey_A:this.$store.state.userInfo.tenantkey,userName:this.$store.state.userInfo.username,contrForPrionum:this.$store.state.userInfo.prionum,tenantid_A:this.$store.state.userInfo.tenantid,intoProjectType:this.$store.state.intoProjectType,tableData:[],multipleSelection:[],tasktime:[],begingTime:"",endTime:"",searchList:{maplabel:"",username:"",status:"",projectid:this.$store.state.intoProjectid,begintime:"",endtime:"",page:1,count:20},total:0,pageCount:20,currentPage1:1,statusList:[{index:1,value:this.$t("checkwork.Attendance")},{index:2,value:this.$t("checkwork.Noattendance")},{index:3,value:this.$t("checkwork.Notclockedin")}],del:!1,loading:!1,deleteData:[]}},methods:{datetimecut:function(t){if(!t)return"-";function e(t){return t>9?t:"0"+t}var a=new Date(t);return a.getFullYear()+"-"+e(a.getMonth()+1)+"-"+e(a.getDate())+" "+(a.getHours()<10?"0"+a.getHours():a.getHours())+":"+e(a.getMinutes())+":"+e(a.getSeconds())},formatDatefirstime:function(t,e){if(null==t.firstime||0==t.firstime)return"";var a=new Date(1e3*parseInt(t.firstime)).toUTCString();return this.datetimecut(a)},formatDatelastime:function(t,e){if(null==t.lastime||0==t.lastime)return"";var a=new Date(1e3*parseInt(t.lastime)).toUTCString();return this.datetimecut(a)},getAttendanceLists:function(){var t=this;Object(l._18)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code&&(t.tableData=e.data.list,t.total=e.data.size)})},searchInfo:function(){var t=this;this.searchList.page=1,this.currentPage1=1,this.tasktime&&this.tasktime.length>0?(t.begingTime=t.tasktime[0],t.endTime=t.tasktime[1]):(t.begingTime="",t.endTime=""),t.begingTime=t.begingTime&&""!=t.begingTime?c.a.formatDate.format(new Date(t.begingTime),"yyyy-MM-dd hh:mm:ss"):"",t.endTime=t.endTime&&""!=t.endTime?c.a.formatDate.format(new Date(t.endTime),"yyyy-MM-dd hh:mm:ss"):"",t.begingTime.length>0&&t.endTime.length>0?(t.begingTime=Date.parse(new Date(t.begingTime)),t.endTime=Date.parse(new Date(t.endTime)),this.searchList.begintime=this.getDate(this.begingTime),this.searchList.endtime=this.getDate(this.endTime)):(this.searchList.begintime="",this.searchList.endtime=""),Object(l._18)(this.searchList,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?(t.tableData=e.data.list,t.total=e.data.size,e.data.size>0?t.$message({message:t.$t("beacon.searchsuccess"),type:"success"}):t.$message({message:t.$t("beacon.nodata"),type:"warning"})):t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"})})},getDate:function(t){var e=new Date(t);return e.getFullYear()+"-"+("0"+(e.getMonth()+1)).slice(-2)+"-"+("0"+e.getDate()).slice(-2)},handleCurrentChange:function(t){this.searchList.page=t,this.searchList.count=this.pageCount,this.getAttendanceLists()},handleSizeChange:function(t){this.pageCount=t,this.searchList.count=t,this.searchList.page=1,this.currentPage1=1,this.getAttendanceLists()},clearBtn:function(){this.searchList={maplabel:"",username:"",status:"",projectid:this.$store.state.intoProjectid,begintime:"",endtime:"",page:1,count:20},this.currentPage1=1,this.tasktime=[],this.getAttendanceLists()},handleSelectionChange:function(t){this.multipleSelection=t},delCheckList:function(){0!=this.multipleSelection.length?(this.deleteData=this.multipleSelection,this.del=!0):this.$message({message:this.$t("downlink.deletedownlink1"),type:"warning"})},deleteTrue:function(){for(var t=this,e={ids:[]},a=0;a<this.deleteData.length;a++)e.ids.push(this.deleteData[a].id);this.loading=!0,Object(l.B)(e,this.tenantkey_A,this.tenantid_A,this.userName).then(function(e){1001==e.code?(t.del=!1,t.getAttendanceLists(),t.$message({message:t.$t("downlink.deletesuccess"),type:"success"}),t.loading=!1):(t.$message({message:"zh"==t.$store.state.i18n?e.msg:e.enMsg,type:"error"}),t.loading=!1)})}},beforeMount:function(){this.getAttendanceLists()},watch:{"$i18n.locale":function(){this.i8n=this.$store.state.i18n,s()(this.$data.statusList,this.$options.data.call(this).statusList),s()(this.$data.pickerOptions,this.$options.data.call(this).pickerOptions)}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:5!=t.contrForPrionum?"home":"",staticStyle:{height:"100%"}},[5!=t.contrForPrionum?a("div",{staticClass:"menu_header"},[a("Menu")],1):t._e(),t._v(" "),a("div",{staticClass:"content"},[a("el-container",{class:5==t.contrForPrionum?"user":"asi"},[5!=t.contrForPrionum?a("el-aside",[a("Asset")],1):t._e(),t._v(" "),a("el-main",[a("div",{staticClass:"checkwork_input"},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{display:"flex","white-space":"nowrap"},attrs:{model:t.searchList}},[a("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("checkwork.Label")}},[a("el-input",{attrs:{placeholder:t.$t("checkwork.title")},model:{value:t.searchList.maplabel,callback:function(e){t.$set(t.searchList,"maplabel",e)},expression:"searchList.maplabel"}})],1),t._v(" "),a("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("checkwork.Name")}},[a("el-input",{attrs:{placeholder:t.$t("checkwork.title1")},model:{value:t.searchList.username,callback:function(e){t.$set(t.searchList,"username",e)},expression:"searchList.username"}})],1),t._v(" "),a("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"0"},attrs:{label:t.$t("checkwork.State")}},[a("el-select",{attrs:{placeholder:t.$t("checkwork.title2"),clearable:"",filterable:""},model:{value:t.searchList.status,callback:function(e){t.$set(t.searchList,"status",e)},expression:"searchList.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.index,attrs:{label:t.value,value:t.index}})}),1)],1),t._v(" "),a("el-form-item",{staticStyle:{display:"flex","margin-left":"2%","margin-right":"0","z-index":"1"},attrs:{label:t.$t("checkwork.Time")}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":t.$t("checkwork.to"),"start-placeholder":t.$t("checkwork.starttime"),"end-placeholder":t.$t("checkwork.endtime"),"picker-options":t.pickerOptions},model:{value:t.tasktime,callback:function(e){t.tasktime=e},expression:"tasktime"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-left":"1%","z-index":"1"}},[a("el-button",{staticClass:"querry",attrs:{type:"primary"},on:{click:function(e){return t.searchInfo()}}},[t._v(t._s(t.$t("checkwork.search")))]),t._v(" "),a("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.clearBtn()}}},[t._v(t._s(t.$t("checkwork.reset")))]),t._v(" "),a("el-button",{staticClass:"reset",attrs:{type:"primary"},on:{click:function(e){return t.delCheckList()}}},[t._v(t._s(t.$t("checkwork.batchdeletion")))])],1)],1)],1),t._v(" "),a("div",[a("el-table",{ref:"multipleTable",staticStyle:{width:"98%","text-align":"center","margin-left":"2%","z-index":"1"},attrs:{data:t.tableData,"max-height":"660",border:"","highlight-current-rowh":""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{property:"maplabel",label:t.$t("checkwork.labelnumber"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"username",label:t.$t("checkwork.name"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"zh"==t.i8n?"statustr":"enstatus",label:t.$t("checkwork.state"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),1==t.intoProjectType?a("el-table-column",{attrs:{property:"steps",label:t.$t("checkwork.Stepcount"),"show-overflow-tooltip":"",align:"center"}}):t._e(),t._v(" "),a("el-table-column",{attrs:{property:"retime",label:t.$t("checkwork.date"),"show-overflow-tooltip":"",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"firstime",label:t.$t("checkwork.recordtime"),"show-overflow-tooltip":"",formatter:t.formatDatefirstime,align:"center"}}),t._v(" "),a("el-table-column",{attrs:{property:"lastime",label:t.$t("checkwork.departuretime"),"show-overflow-tooltip":"",formatter:t.formatDatelastime,align:"center"}})],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{"text-align":"center",width:"100%","margin-top":"1%"}},[a("el-pagination",{attrs:{"current-page":t.currentPage1,"page-sizes":[10,20,30,40,50],layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-size":20},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage1=e},"update:current-page":function(e){t.currentPage1=e}}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:t.$t("checkwork.title3"),visible:t.del},on:{"update:visible":function(e){t.del=e}}},[a("el-table",{staticStyle:{width:"100%","text-align":"left"},attrs:{data:t.deleteData,"max-height":"660",stripe:""}},[a("el-table-column",{attrs:{property:"maplabel",label:t.$t("checkwork.labelnumber"),"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{property:"username",label:t.$t("checkwork.name"),"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{property:"zh"==t.i8n?"statustr":"enstatus",label:t.$t("checkwork.state"),"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{property:"steps",label:t.$t("checkwork.Stepcount"),"show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{property:"firstime",label:t.$t("checkwork.recordtime"),"show-overflow-tooltip":"",formatter:t.formatDatefirstime}}),t._v(" "),a("el-table-column",{attrs:{property:"lastime",label:t.$t("checkwork.departuretime"),"show-overflow-tooltip":"",formatter:t.formatDatelastime}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.del=!1,t.loading=!1}}},[t._v(t._s(t.$t("warning.Cancel")))]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){return t.deleteTrue()}}},[t._v(t._s(t.$t("warning.Sure")))])],1)],1)],1)],1)],1)])},staticRenderFns:[]};var u=a("VU/8")(h,m,!1,function(t){a("tL97")},"data-v-30322808",null);e.default=u.exports},tL97:function(t,e){}});